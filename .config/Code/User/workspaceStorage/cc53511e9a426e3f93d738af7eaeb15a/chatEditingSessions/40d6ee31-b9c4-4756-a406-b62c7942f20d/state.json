{"version":2,"sessionId":"40d6ee31-b9c4-4756-a406-b62c7942f20d","initialFileContents":[["file:///home/trang/localnsv/mAIware-server/public/dashboard.html","04b0e49"],["file:///home/trang/localnsv/mAIware-server/public/styles.css","2e100e4"]],"timeline":{"checkpoints":[{"checkpointId":"732c40ce-783a-4f42-9fd5-bb39841695a1","epoch":0,"label":"Initial State","description":"Starting point before any edits"},{"checkpointId":"b6db7708-faf9-4b88-9663-e734bd6987e1","requestId":"request_1af10ca8-d17d-442e-8756-8e3e11e7af34","epoch":1,"label":"Request request_1af10ca8-d17d-442e-8756-8e3e11e7af34"},{"checkpointId":"2bf87708-fe00-4403-aafe-9e621b89e5e7","requestId":"request_1af10ca8-d17d-442e-8756-8e3e11e7af34","undoStopId":"434d064c-a766-4d10-9ca0-27331ecddc5a","epoch":2,"label":"Request request_1af10ca8-d17d-442e-8756-8e3e11e7af34 - Stop 434d064c-a766-4d10-9ca0-27331ecddc5a"},{"checkpointId":"e877c4d3-3e27-4298-ad27-8e9f9cc6c564","requestId":"request_1af10ca8-d17d-442e-8756-8e3e11e7af34","undoStopId":"180e0b16-9b0d-4f57-9652-cebf9c5a5b48","epoch":5,"label":"Request request_1af10ca8-d17d-442e-8756-8e3e11e7af34 - Stop 180e0b16-9b0d-4f57-9652-cebf9c5a5b48"},{"checkpointId":"aee433ca-0907-4504-b108-e6a9531f3823","requestId":"request_6694fffe-f89c-4106-8293-523387669b6c","epoch":8,"label":"Request request_6694fffe-f89c-4106-8293-523387669b6c"},{"checkpointId":"808de603-767a-4212-8a34-734ce69b2a04","requestId":"request_6694fffe-f89c-4106-8293-523387669b6c","undoStopId":"45cee0b0-87f9-46b3-9bb2-1d637f08f3e6","epoch":9,"label":"Request request_6694fffe-f89c-4106-8293-523387669b6c - Stop 45cee0b0-87f9-46b3-9bb2-1d637f08f3e6"},{"checkpointId":"40def296-054b-4edf-8e45-2442650c34a4","requestId":"request_4e420508-80ce-43b8-82a1-fed6912f3e58","epoch":13,"label":"Request request_4e420508-80ce-43b8-82a1-fed6912f3e58"},{"checkpointId":"b09086ba-63a0-45a2-955f-fe3dae4e49ae","requestId":"request_4e420508-80ce-43b8-82a1-fed6912f3e58","undoStopId":"281d4801-61b5-4113-97a3-62464bc7dab0","epoch":14,"label":"Request request_4e420508-80ce-43b8-82a1-fed6912f3e58 - Stop 281d4801-61b5-4113-97a3-62464bc7dab0"},{"checkpointId":"67441ca1-0a63-41fb-90a8-62d7acf86188","requestId":"request_4e420508-80ce-43b8-82a1-fed6912f3e58","undoStopId":"46512d3b-90e7-4102-9208-a0c915315c4b","epoch":17,"label":"Request request_4e420508-80ce-43b8-82a1-fed6912f3e58 - Stop 46512d3b-90e7-4102-9208-a0c915315c4b"},{"checkpointId":"0c076fb3-1365-44ea-ad03-58c302b80e50","requestId":"request_22000fc3-1554-4fe6-b1a3-e47e57297a0e","epoch":20,"label":"Request request_22000fc3-1554-4fe6-b1a3-e47e57297a0e"},{"checkpointId":"bc7ba664-b251-4b37-baf8-722225644988","requestId":"request_22000fc3-1554-4fe6-b1a3-e47e57297a0e","undoStopId":"256ded79-1d1a-4f55-a235-cf763a0848bb","epoch":21,"label":"Request request_22000fc3-1554-4fe6-b1a3-e47e57297a0e - Stop 256ded79-1d1a-4f55-a235-cf763a0848bb"},{"checkpointId":"b8721ad8-bb64-4899-a6fc-99f31dd263ad","requestId":"request_22000fc3-1554-4fe6-b1a3-e47e57297a0e","undoStopId":"811978eb-2c45-4307-bdce-56de874d6a85","epoch":24,"label":"Request request_22000fc3-1554-4fe6-b1a3-e47e57297a0e - Stop 811978eb-2c45-4307-bdce-56de874d6a85"},{"checkpointId":"0c98ead8-7e7f-4c5a-893f-035039f45b05","requestId":"request_84fdc38b-9630-4d5e-aa54-3779d49a4552","epoch":26,"label":"Request request_84fdc38b-9630-4d5e-aa54-3779d49a4552"},{"checkpointId":"6e909bfd-6457-40e8-b0ac-059eb8d93423","requestId":"request_84fdc38b-9630-4d5e-aa54-3779d49a4552","undoStopId":"2177bde8-9e75-4d64-9187-cee3f8ebac04","epoch":27,"label":"Request request_84fdc38b-9630-4d5e-aa54-3779d49a4552 - Stop 2177bde8-9e75-4d64-9187-cee3f8ebac04"},{"checkpointId":"f6dc6a2c-6a0f-48e2-be4a-4c7384cd8519","requestId":"request_fcbfa3b8-88ac-48bc-80d5-4ae65eb5dfdf","epoch":31,"label":"Request request_fcbfa3b8-88ac-48bc-80d5-4ae65eb5dfdf"},{"checkpointId":"a2c24840-e661-4836-bdc0-6e576c7765ce","requestId":"request_fcbfa3b8-88ac-48bc-80d5-4ae65eb5dfdf","undoStopId":"f685d63c-6475-47a2-9323-a5497beece5b","epoch":32,"label":"Request request_fcbfa3b8-88ac-48bc-80d5-4ae65eb5dfdf - Stop f685d63c-6475-47a2-9323-a5497beece5b"},{"checkpointId":"effba104-9b63-4f98-9e3f-f9ee91cdf71f","requestId":"request_7d2258a4-51bc-4f20-ba08-270fe0c6db2a","epoch":35,"label":"Request request_7d2258a4-51bc-4f20-ba08-270fe0c6db2a"},{"checkpointId":"21c10170-d047-4ada-b5b4-4dd4fc39dfdc","requestId":"request_7d2258a4-51bc-4f20-ba08-270fe0c6db2a","undoStopId":"677814a1-fb66-465b-be8b-732d1c58cd70","epoch":36,"label":"Request request_7d2258a4-51bc-4f20-ba08-270fe0c6db2a - Stop 677814a1-fb66-465b-be8b-732d1c58cd70"},{"checkpointId":"35f893db-be9d-4946-b7fc-507aea6104c8","requestId":"request_5ed1c503-e959-41d2-adbb-12b539ea050b","epoch":41,"label":"Request request_5ed1c503-e959-41d2-adbb-12b539ea050b"},{"checkpointId":"1e58f90c-1d00-4e6b-b404-e02e06f9ec15","requestId":"request_5ed1c503-e959-41d2-adbb-12b539ea050b","undoStopId":"cbcd6822-75f1-4c6a-ade4-c4ef6fdea6f7","epoch":42,"label":"Request request_5ed1c503-e959-41d2-adbb-12b539ea050b - Stop cbcd6822-75f1-4c6a-ade4-c4ef6fdea6f7"},{"checkpointId":"f17e1fc3-e7bc-4871-8b0f-9c9fa30f3016","requestId":"request_d6846186-7601-45b3-9fc2-c861c84e6ee9","epoch":45,"label":"Request request_d6846186-7601-45b3-9fc2-c861c84e6ee9"},{"checkpointId":"f4f30eda-6642-4ce1-be89-28fb5ac4670f","requestId":"request_d6846186-7601-45b3-9fc2-c861c84e6ee9","undoStopId":"4191c7d5-7f5b-4f8a-b830-f92a433e48d4","epoch":46,"label":"Request request_d6846186-7601-45b3-9fc2-c861c84e6ee9 - Stop 4191c7d5-7f5b-4f8a-b830-f92a433e48d4"},{"checkpointId":"846acd1d-6d7e-42ec-b35c-d6f3f264cafd","requestId":"request_9b6d6ff6-0134-45c8-b199-39ef27e3027c","epoch":49,"label":"Request request_9b6d6ff6-0134-45c8-b199-39ef27e3027c"},{"checkpointId":"684746e4-2a10-419f-bd15-021ebd8f0bcf","requestId":"request_9b6d6ff6-0134-45c8-b199-39ef27e3027c","undoStopId":"0b848640-c4ba-4e70-bca6-67fbda6139bb","epoch":50,"label":"Request request_9b6d6ff6-0134-45c8-b199-39ef27e3027c - Stop 0b848640-c4ba-4e70-bca6-67fbda6139bb"},{"checkpointId":"aaf04578-2b06-4bb1-98b0-8abccddd3aaa","requestId":"request_319f88cc-c105-40bf-9ccf-2a83e597e944","epoch":53,"label":"Request request_319f88cc-c105-40bf-9ccf-2a83e597e944"},{"checkpointId":"d47c1712-a66c-499e-9744-f3ccc4457a06","requestId":"request_319f88cc-c105-40bf-9ccf-2a83e597e944","undoStopId":"551bed2d-3243-497d-97cb-152a6cc06229","epoch":54,"label":"Request request_319f88cc-c105-40bf-9ccf-2a83e597e944 - Stop 551bed2d-3243-497d-97cb-152a6cc06229"},{"checkpointId":"27ef1e4e-3784-4e69-ab29-1b5b28a1b9ac","requestId":"request_b10a9f11-ae66-4c50-a78d-1a768eabe969","epoch":57,"label":"Request request_b10a9f11-ae66-4c50-a78d-1a768eabe969"},{"checkpointId":"e327ee4e-6249-47de-aa6d-dfa5204e3ba0","requestId":"request_b10a9f11-ae66-4c50-a78d-1a768eabe969","undoStopId":"78b5a1ac-dfba-464b-a0f2-8d43563a509d","epoch":58,"label":"Request request_b10a9f11-ae66-4c50-a78d-1a768eabe969 - Stop 78b5a1ac-dfba-464b-a0f2-8d43563a509d"}],"currentEpoch":61,"fileBaselines":[["file:///home/trang/localnsv/mAIware-server/public/dashboard.html::request_1af10ca8-d17d-442e-8756-8e3e11e7af34",{"uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/dashboard.html","external":"file:///home/trang/localnsv/mAIware-server/public/dashboard.html","path":"/home/trang/localnsv/mAIware-server/public/dashboard.html","scheme":"file"},"requestId":"request_1af10ca8-d17d-442e-8756-8e3e11e7af34","content":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>mAIware Server Dashboard</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n    <link rel=\"stylesheet\" href=\"styles.css?v=3.0\">\n    <!-- Add Chart.js -->\n    <script src=\"https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js\"></script>\n    <!-- Add Leaflet.js for maps -->\n    <link rel=\"stylesheet\" href=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css\" />\n    <script src=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js\"></script>\n    <!-- Add Leaflet Heatmap Plugin -->\n    <script src=\"https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js\"></script>\n    <!-- Add D3.js for force-directed graph -->\n    <script src=\"https://d3js.org/d3.v7.min.js\"></script>\n    <!-- Add html2canvas for screenshots -->\n    <script src=\"https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js\"></script>\n</head>\n<body>\n    <!-- Theme Toggle Button -->\n    <button class=\"theme-toggle\" id=\"themeToggle\" onclick=\"toggleTheme()\">\n        <span class=\"icon\" id=\"themeIcon\">üåô</span>\n        <span id=\"themeText\">Dark</span>\n    </button>\n\n    <!-- Back to Top Button -->\n    <button class=\"back-to-top\" id=\"backToTop\" onclick=\"scrollToTop()\">\n        <i class=\"fas fa-arrow-up\"></i>\n    </button>\n\n    <!-- Preview Backdrop -->\n    <div class=\"preview-backdrop\" id=\"previewBackdrop\"></div>\n\n    <!-- Side Navigation Panel -->\n    <div class=\"side-panel\" id=\"sidePanel\">\n        <!-- Logo Icon (always visible) -->\n        <div class=\"panel-icon-strip\">\n            <div class=\"panel-logo-icon\">\n                <i class=\"fas fa-shield-virus\"></i>\n            </div>\n        </div>\n        \n        <!-- Analytics Preview Panel (slides out on hover) -->\n        <div class=\"graphs-preview\" id=\"graphsPreview\">\n            <div class=\"preview-header\">\n                <h3><i class=\"fas fa-chart-line\"></i> Analytics Preview</h3>\n                <p>Click anywhere to view full analytics</p>\n            </div>\n            \n            <!-- Scaled-down live view of analytics -->\n            <div class=\"analytics-miniview\" id=\"analyticsMiniview\" onclick=\"switchView('analytics')\">\n                <div class=\"miniview-preview\">\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box large\">\n                            <div class=\"box-header\">Global Threat Map</div>\n                            <div class=\"box-content map-visual\">\n                                <div class=\"map-dot\" style=\"top: 30%; left: 40%;\"></div>\n                                <div class=\"map-dot\" style=\"top: 60%; left: 70%;\"></div>\n                                <div class=\"map-dot\" style=\"top: 45%; left: 25%;\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box large\">\n                            <div class=\"box-header\">Attack Timeline</div>\n                            <div class=\"box-content chart-visual\">\n                                <div class=\"chart-bar\" style=\"height: 40%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 70%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 55%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 85%;\"></div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Top Threats</div>\n                            <div class=\"box-content list-visual\">\n                                <div class=\"list-item\"></div>\n                                <div class=\"list-item\"></div>\n                                <div class=\"list-item\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Correlations</div>\n                            <div class=\"box-content network-visual\">\n                                <div class=\"network-node\" style=\"top: 30%; left: 30%;\"></div>\n                                <div class=\"network-node\" style=\"top: 60%; left: 50%;\"></div>\n                                <div class=\"network-node\" style=\"top: 45%; left: 70%;\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Heatmap</div>\n                            <div class=\"box-content heat-visual\"></div>\n                        </div>\n                    </div>\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box wide\">\n                            <div class=\"box-header\">File Analysis & Distribution</div>\n                            <div class=\"box-content pie-visual\">\n                                <div class=\"pie-chart\"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"miniview-overlay\">\n                    <i class=\"fas fa-expand-alt\"></i>\n                    <span>Click to view analytics</span>\n                </div>\n            </div>                <!-- Home Navigation Button -->\n                <div class=\"preview-home-nav\" id=\"homeNavBtn\" onclick=\"switchView('dashboard')\">\n                    <i class=\"fas fa-home\"></i>\n                    <span>Back to Dashboard</span>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"main-content\" id=\"mainContent\">\n        <!-- DASHBOARD VIEW -->\n        <div class=\"view-container active\" id=\"dashboardView\">\n            <header class=\"dashboard-header\">\n                <div class=\"header-content\">\n                    <h1><i class=\"fas fa-shield-virus pulse-icon\"></i> mAIware Server</h1>\n                    <p class=\"subtitle\">Real-time Malware Analysis Dashboard</p>\n                </div>\n            </header>\n            \n            <!-- Real-time Threat Ticker -->\n            <div class=\"threat-ticker-container animate-slide-in\">\n                <div class=\"ticker-label\">\n                    <i class=\"fas fa-broadcast-tower pulse-icon\"></i>\n                    <span>LIVE THREAT FEED</span>\n                </div>\n                <div class=\"threat-ticker\" id=\"threat-ticker\">\n                    <div class=\"ticker-content\" id=\"ticker-content\">\n                        <span class=\"ticker-item\">System ready - Monitoring for threats...</span>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Notification Toast Container -->\n            <div id=\"notification-container\" class=\"notification-container\"></div>\n            \n            <!-- Stats Grid -->\n            <div class=\"stats-grid animate-fade-in\" id=\"stats-grid\">\n                <div class=\"stat-card info\">\n                    <i class=\"fas fa-laptop\"></i>\n                    <span class=\"stat-number\" id=\"stat-clients\">0</span>\n                    <span class=\"stat-label\">Active Clients</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card info\">\n                    <i class=\"fas fa-chart-line\"></i>\n                    <span class=\"stat-number\" id=\"stat-total\">0</span>\n                    <span class=\"stat-label\">Total Scans</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card malware\">\n                    <i class=\"fas fa-bug\"></i>\n                    <span class=\"stat-number\" id=\"stat-malware\">0</span>\n                    <span class=\"stat-label\">Malware</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card suspicious\">\n                    <i class=\"fas fa-exclamation-triangle\"></i>\n                    <span class=\"stat-number\" id=\"stat-suspicious\">0</span>\n                    <span class=\"stat-label\">Suspicious</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card benign\">\n                    <i class=\"fas fa-check-circle\"></i>\n                    <span class=\"stat-number\" id=\"stat-benign\">0</span>\n                    <span class=\"stat-label\">Benign</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n            </div>\n            \n            <!-- Recent Scans -->\n            <div class=\"scans-container animate-fade-in\">\n                <div class=\"scans-header\">\n                    <h2><i class=\"fas fa-list\"></i> Recent Scans</h2>\n                    <button class=\"refresh-btn\" onclick=\"manualRefresh()\">\n                        <i class=\"fas fa-sync-alt\"></i> Refresh\n                    </button>\n                </div>\n                \n                <table class=\"scans-table\">\n                    <thead>\n                        <tr>\n                            <th>Timestamp</th>\n                            <th>Filename</th>\n                            <th>Classification</th>\n                            <th>Client IP</th>\n                            <th>Hash (SHA256)</th>\n                        </tr>\n                    </thead>\n                    <tbody id=\"scans-tbody\">\n                        <tr>\n                            <td colspan=\"5\" class=\"empty-state\">\n                                <i class=\"fas fa-inbox\"></i>\n                                <p>No scans yet. Waiting for clients...</p>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n\n        <!-- ANALYTICS VIEW -->\n        <div class=\"view-container\" id=\"analyticsView\">\n            <div class=\"analytics-header\">\n                <button class=\"back-btn\" onclick=\"switchView('dashboard')\">\n                    <i class=\"fas fa-arrow-left\"></i> Back to Dashboard\n                </button>\n                <h1><i class=\"fas fa-chart-line\"></i> Analytics & Intelligence</h1>\n            </div>\n            \n            <div class=\"analytics-grid\" id=\"analyticsGrid\">\n                \n                <!-- Daily Analysis Chart -->\n                <div class=\"chart-container analytics-panel panel-large\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-line\"></i> Daily Analysis Trends</h2>\n                        <div class=\"chart-controls\">\n                            <button class=\"chart-btn active\" onclick=\"setChartDays(7)\">7 Days</button>\n                            <button class=\"chart-btn\" onclick=\"setChartDays(14)\">14 Days</button>\n                            <button class=\"chart-btn\" onclick=\"setChartDays(30)\">30 Days</button>\n                        </div>\n                    </div>\n                    <canvas id=\"dailyScansChart\"></canvas>\n                </div>\n                    <canvas id=\"dailyScansChart\"></canvas>\n                </div>\n\n                <!-- Geographic Threat Intelligence Map -->\n                <div class=\"map-container analytics-panel panel-large\">\n                    <div class=\"map-header\">\n                        <h2><i class=\"fas fa-globe-americas\"></i> Global Threat Intelligence Map</h2>\n                        <div class=\"map-controls\">\n                            <div class=\"map-view-toggle\">\n                                <button class=\"map-btn active\" data-view=\"markers\" onclick=\"switchMapView('markers')\">\n                                    <i class=\"fas fa-map-marker-alt\"></i> Markers\n                                </button>\n                                <button class=\"map-btn\" data-view=\"heatmap\" onclick=\"switchMapView('heatmap')\">\n                                    <i class=\"fas fa-fire\"></i> Heatmap\n                                </button>\n                                <button class=\"map-btn\" data-view=\"choropleth\" onclick=\"switchMapView('choropleth')\">\n                                    <i class=\"fas fa-globe\"></i> Choropleth\n                                </button>\n                            </div>\n                            <div class=\"map-legend\">\n                                <span class=\"legend-item\"><span class=\"legend-dot malware-dot\"></span> Malware</span>\n                                <span class=\"legend-item\"><span class=\"legend-dot suspicious-dot\"></span> Suspicious</span>\n                                <span class=\"legend-item\"><span class=\"legend-dot benign-dot\"></span> Benign</span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Geographic Context Panel -->\n                    <div class=\"geo-context-panel\" id=\"geoContext\">\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Active Regions:</span>\n                            <span class=\"context-value\" id=\"activeRegions\">0</span>\n                        </div>\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Hotspot:</span>\n                            <span class=\"context-value\" id=\"topRegion\">None</span>\n                        </div>\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Total Threats:</span>\n                            <span class=\"context-value threat-count\" id=\"geoThreatCount\">0</span>\n                        </div>\n                    </div>\n                    \n                    <div id=\"worldMap\" style=\"height: 500px; border-radius: 8px; margin-bottom: 15px;\"></div>\n                    \n                    <!-- Timeline Control -->\n                    <div class=\"map-timeline-control\">\n                        <button class=\"timeline-btn\" onclick=\"replayThreats()\" id=\"replayBtn\">\n                            <i class=\"fas fa-play\"></i> Replay Last 24h\n                        </button>\n                        <div class=\"timeline-info\" id=\"timelineInfo\">\n                            Click replay to see threat propagation over time\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Malware Source Distribution -->\n                <div class=\"chart-container analytics-panel panel-small\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-pie\"></i> Malware Source Distribution</h2>\n                    </div>\n                    <div style=\"max-width: 500px; margin: 0 auto;\">\n                        <canvas id=\"malwareSourceChart\"></canvas>\n                    </div>\n                </div>\n\n                <!-- Graph 2: \"Noisiest\" Agents Over Time -->\n                <div class=\"chart-container analytics-panel panel-large\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-desktop\"></i> \"Noisiest\" Agents Over Time</h2>\n                        <p class=\"chart-subtitle\">Threat detection trends for top 5 high-risk agents</p>\n                    </div>\n                    <div style=\"height: 300px;\">\n                        <canvas id=\"noisyAgentsChart\"></canvas>\n                    </div>\n                </div>\n\n                <!-- Advanced Analytics Grid -->\n                <div class=\"analytics-panel panel-large advanced-analytics-grid\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-area\"></i> Advanced Statistical Analysis</h2>\n                        <p class=\"chart-subtitle\">Deep dive into signature verification, packer usage, AI confidence, and entropy patterns</p>\n                    </div>\n                    \n                    <div class=\"mini-charts-grid\">\n                        <!-- Graph 3: Signature Status vs. Classification -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-certificate\"></i> Signature vs. Classification</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"signatureClassChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 4: Packer Usage vs. Classification -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-box\"></i> Packer vs. Classification</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"packerClassChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 5: Confidence Score Distribution -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-brain\"></i> AI Confidence Distribution</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"confidenceHistChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 6: File Entropy Distribution -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-chart-bar\"></i> Entropy Distribution</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"entropyBoxChart\"></canvas>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Threat Vector Correlation Explorer -->\n                <div class=\"correlation-container analytics-panel panel-large\">\n                    <div class=\"correlation-header\">\n                        <h2><i class=\"fas fa-project-diagram\"></i> Threat Vector Correlation Explorer</h2>\n                        <p class=\"correlation-subtitle\">Interactive intelligence map showing relationships between malware families, agents, APIs, and indicators</p>\n                    </div>\n                    <div class=\"graph-controls\">\n                        <button class=\"graph-btn\" onclick=\"resetGraph()\"><i class=\"fas fa-sync\"></i> Reset View</button>\n                        <button class=\"graph-btn\" onclick=\"centerGraph()\"><i class=\"fas fa-compress\"></i> Center</button>\n                        <div class=\"graph-legend\">\n                            <span class=\"legend-item\"><span class=\"node-sample malware-node\"></span> Malware Family</span>\n                            <span class=\"legend-item\"><span class=\"node-sample agent-node\"></span> Agent/System</span>\n                            <span class=\"legend-item\"><span class=\"node-sample api-node\"></span> API Call</span>\n                            <span class=\"legend-item\"><span class=\"node-sample string-node\"></span> Suspicious String</span>\n                        </div>\n                    </div>\n                    <div id=\"correlationGraph\"></div>\n                    <div id=\"nodeDetails\" class=\"node-details\" style=\"display: none;\">\n                        <h3 id=\"detailsTitle\"></h3>\n                        <div id=\"detailsContent\"></div>\n                    </div>\n                </div>\n\n                <!-- Emerging Threat Intelligence Panel -->\n                <div class=\"eti-container analytics-panel panel-large\">\n                    <div class=\"eti-header\">\n                        <h2><i class=\"fas fa-exclamation-triangle\"></i> Emerging Threat Intelligence (ETI)</h2>\n                        <p class=\"eti-subtitle\">Real-time actionable intelligence on active threats and indicators of compromise</p>\n                        <div class=\"eti-summary\">\n                            <span class=\"eti-badge\" id=\"eti-total\">0 Total Threats</span>\n                            <span class=\"eti-badge recent\" id=\"eti-recent\">0 Last 24h</span>\n                        </div>\n                    </div>\n                    \n                    <div class=\"eti-grid\">\n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-virus\"></i> Top Malware Families</h3>\n                            <div class=\"eti-subtitle-small\">Most active malware families detected</div>\n                            <div id=\"eti-malware\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-code\"></i> Top Suspicious APIs</h3>\n                            <div class=\"eti-subtitle-small\">Most frequently called malicious APIs</div>\n                            <div id=\"eti-apis\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-terminal\"></i> Top Malicious Strings</h3>\n                            <div class=\"eti-subtitle-small\">Most common IOC strings and commands</div>\n                            <div id=\"eti-strings\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-shield-alt\"></i> Top Packers/Obfuscators</h3>\n                            <div class=\"eti-subtitle-small\">Most used evasion techniques</div>\n                            <div id=\"eti-packers\" class=\"eti-list\"></div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Predictive Threat Modeler -->\n                <div class=\"modeler-container analytics-panel panel-large\">\n                    <div class=\"modeler-header\">\n                        <h2><i class=\"fas fa-flask\"></i> Predictive Threat Modeler</h2>\n                        <p class=\"modeler-subtitle\">Build hypothetical malware and predict how mAIware would classify it</p>\n                    </div>\n                    \n                    <div class=\"modeler-grid\">\n                <div class=\"modeler-builder\">\n                    <h3><i class=\"fas fa-cogs\"></i> Threat Configuration</h3>\n                    \n                    <div class=\"modeler-field\">\n                        <label>File Type</label>\n                        <select id=\"model-filetype\" class=\"modeler-select\">\n                            <option>PE32+ (GUI) x86-64</option>\n                            <option>PE32 (Console) Intel 80386</option>\n                            <option>PE32+ DLL x86-64</option>\n                            <option>MSI Installer</option>\n                            <option>PDF Document</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Packer/Obfuscator</label>\n                        <select id=\"model-packer\" class=\"modeler-select\">\n                            <option>None</option>\n                            <option>UPX</option>\n                            <option>VMProtect</option>\n                            <option>Themida</option>\n                            <option>ASPack</option>\n                            <option>Unknown (High Entropy)</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Digital Signature</label>\n                        <select id=\"model-signature\" class=\"modeler-select\">\n                            <option>Verified (Microsoft Corporation)</option>\n                            <option>Verified (Google LLC)</option>\n                            <option>Verified (Unknown Publisher)</option>\n                            <option>Not Signed</option>\n                            <option>Expired Certificate</option>\n                            <option>Self-Signed (Untrusted)</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>API Imports (select multiple)</label>\n                        <select id=\"model-apis\" class=\"modeler-select\" multiple size=\"6\">\n                            <option>CreateRemoteThread</option>\n                            <option>WriteProcessMemory</option>\n                            <option>VirtualAllocEx</option>\n                            <option>SetWindowsHookExW</option>\n                            <option>URLDownloadToFileW</option>\n                            <option>WinExec</option>\n                            <option>RegSetValueExW</option>\n                            <option>CryptEncrypt</option>\n                            <option>Socket</option>\n                            <option>ReadFile</option>\n                        </select>\n                        <small class=\"modeler-hint\">Hold Ctrl/Cmd to select multiple</small>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Suspicious Strings (select multiple)</label>\n                        <select id=\"model-strings\" class=\"modeler-select\" multiple size=\"6\">\n                            <option>http://bad-c2-server.com/payload.dat</option>\n                            <option>keylog.txt</option>\n                            <option>steal_passwords</option>\n                            <option>powershell -enc</option>\n                            <option>vssadmin.exe delete shadows</option>\n                            <option>HOW_TO_DECRYPT.txt</option>\n                            <option>crack</option>\n                            <option>patch</option>\n                            <option>disable_antivirus</option>\n                        </select>\n                        <small class=\"modeler-hint\">Hold Ctrl/Cmd to select multiple</small>\n                    </div>\n                    \n                    <button class=\"modeler-analyze-btn\" onclick=\"analyzeThreatModel()\">\n                        <i class=\"fas fa-brain\"></i> ANALYZE THREAT\n                    </button>\n                </div>\n                \n                <div class=\"modeler-results\">\n                    <h3><i class=\"fas fa-chart-line\"></i> Prediction Results</h3>\n                    <div id=\"modeler-output\" class=\"modeler-output\">\n                        <div class=\"modeler-placeholder\">\n                            <i class=\"fas fa-arrow-left\"></i>\n                            <p>Configure a threat profile and click ANALYZE to see predictions</p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n            </div>\n        </div>\n    </div>\n    \n    <script>\n        // Helper function to get CSS variable values dynamically for theming\n        function getCSSVar(varName) {\n            return getComputedStyle(document.documentElement).getPropertyValue(varName).trim();\n        }\n\n        // Back to Top Button\n        const backToTopBtn = document.getElementById('backToTop');\n        \n        window.addEventListener('scroll', () => {\n            if (window.pageYOffset > 300) {\n                backToTopBtn.classList.add('visible');\n            } else {\n                backToTopBtn.classList.remove('visible');\n            }\n        });\n\n        function scrollToTop() {\n            window.scrollTo({\n                top: 0,\n                behavior: 'smooth'\n            });\n        }\n\n        // View Switching System\n        function switchView(viewName) {\n            const views = document.querySelectorAll('.view-container');\n            \n            views.forEach(view => {\n                view.classList.remove('active');\n                if (view.id === `${viewName}View`) {\n                    view.classList.add('active');\n                }\n            });\n            \n            currentView = viewName;\n            \n            // Fix map display when switching to analytics view\n            if (viewName === 'analytics') {\n                loadAnalytics(); // Lazy load analytics components\n                setTimeout(() => {\n                    if (worldMap) {\n                        worldMap.invalidateSize();\n                    }\n                    // Capture screenshot for preview after charts has rendered\n                    setTimeout(() => {\n                        createAnalyticsMiniview();\n                    }, 1500);\n                }, 100);\n            }\n            \n            // Close graphs preview when switching views\n            document.getElementById('graphsPreview').classList.remove('show');\n            document.getElementById('previewBackdrop').classList.remove('show');\n        }\n        \n        // Side Panel Hover System\n        const sidePanel = document.getElementById('sidePanel');\n        const graphsPreview = document.getElementById('graphsPreview');\n        const previewBackdrop = document.getElementById('previewBackdrop');\n        const homeNavBtn = document.getElementById('homeNavBtn');\n        let previewTimeout;\n        let previewsRendered = false;\n        let currentView = 'dashboard';\n        \n        // Show preview panel on sidebar hover\n        sidePanel.addEventListener('mouseenter', () => {\n            clearTimeout(previewTimeout);\n            previewTimeout = setTimeout(() => {\n                graphsPreview.classList.add('show');\n                previewBackdrop.classList.add('show');\n                \n                // Show/hide home button based on current view\n                if (currentView === 'analytics') {\n                    homeNavBtn.classList.add('visible');\n                } else {\n                    homeNavBtn.classList.remove('visible');\n                }\n            }, 200);\n        });\n        \n        sidePanel.addEventListener('mouseleave', () => {\n            clearTimeout(previewTimeout);\n            setTimeout(() => {\n                if (!graphsPreview.matches(':hover')) {\n                    graphsPreview.classList.remove('show');\n                    previewBackdrop.classList.remove('show');\n                }\n            }, 100);\n        });\n        \n        // Keep preview open when hovering over it\n        graphsPreview.addEventListener('mouseleave', () => {\n            graphsPreview.classList.remove('show');\n            previewBackdrop.classList.remove('show');\n        });\n        \n        // Close preview when clicking backdrop\n        previewBackdrop.addEventListener('click', () => {\n            graphsPreview.classList.remove('show');\n            previewBackdrop.classList.remove('show');\n        });\n        \n        // Create analytics miniview by taking a screenshot\n        let isCapturingSnapshot = false;\n        let hasInitialSnapshot = false;\n        \n        async function createAnalyticsMiniview() {\n            // Simplified - no actual screenshot, just a visual preview\n            hasInitialSnapshot = true;\n        }\n        \n        // Auto-scroll on hover down in analytics view\n        let scrollInterval;\n        const analyticsGrid = document.getElementById('analyticsGrid');\n        \n        if (analyticsGrid) {\n            analyticsGrid.addEventListener('mousemove', (e) => {\n                const rect = analyticsGrid.getBoundingClientRect();\n                const mouseY = e.clientY - rect.top;\n                const triggerZone = 100; // pixels from bottom\n                \n                if (rect.height - mouseY < triggerZone) {\n                    if (!scrollInterval) {\n                        scrollInterval = setInterval(() => {\n                            analyticsGrid.scrollBy({ top: 2, behavior: 'smooth' });\n                        }, 16);\n                    }\n                } else {\n                    if (scrollInterval) {\n                        clearInterval(scrollInterval);\n                        scrollInterval = null;\n                    }\n                }\n            });\n            \n            analyticsGrid.addEventListener('mouseleave', () => {\n                if (scrollInterval) {\n                    clearInterval(scrollInterval);\n                    scrollInterval = null;\n                }\n            });\n        }\n        \n        // Theme Toggle\n        window.toggleTheme = function() {\n            const html = document.documentElement;\n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            const currentTheme = html.getAttribute('data-theme');\n            \n            if (currentTheme === 'light') {\n                html.setAttribute('data-theme', '');\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n                localStorage.setItem('theme', 'dark');\n            } else {\n                html.setAttribute('data-theme', 'light');\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n                localStorage.setItem('theme', 'light');\n            }\n        };\n        \n        // Load saved theme\n        const savedTheme = localStorage.getItem('theme');\n        if (savedTheme === 'light') {\n            document.documentElement.setAttribute('data-theme', 'light');\n            document.getElementById('themeIcon').textContent = '‚òÄÔ∏è';\n            document.getElementById('themeText').textContent = 'Light';\n        }\n        \n        let dailyChart = null;\n        let currentChartDays = 30;\n        \n        // Notification and Animation System\n        const notificationQueue = [];\n        let isShowingNotification = false;\n        \n        function showThreatNotification(scan) {\n            const container = document.getElementById('notification-container');\n            \n            const classColor = \n                scan.classification === 'Malware' ? '#ff4757' :\n                scan.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n            \n            const icon = \n                scan.classification === 'Malware' ? 'fa-skull-crossbones' :\n                scan.classification === 'Suspicious' ? 'fa-exclamation-triangle' : 'fa-check-circle';\n            \n            const notification = document.createElement('div');\n            notification.className = 'threat-notification';\n            notification.style.borderLeftColor = classColor;\n            notification.innerHTML = `\n                <div class=\"notification-icon\" style=\"color: ${classColor};\">\n                    <i class=\"fas ${icon}\"></i>\n                </div>\n                <div class=\"notification-content\">\n                    <div class=\"notification-title\">\n                        <strong>${scan.classification}</strong> detected\n                    </div>\n                    <div class=\"notification-details\">\n                        ${scan.detected_filename}\n                        ${scan.malware_family ? ` - ${scan.malware_family}` : ''}\n                    </div>\n                    <div class=\"notification-meta\">\n                        <i class=\"fas fa-desktop\"></i> ${scan.systemInfo?.hostname || scan.clientIp || 'Unknown'}\n                    </div>\n                </div>\n                <div class=\"notification-close\" onclick=\"this.parentElement.remove()\">\n                    <i class=\"fas fa-times\"></i>\n                </div>\n            `;\n            \n            container.appendChild(notification);\n            \n            // Animate in\n            setTimeout(() => notification.classList.add('show'), 10);\n            \n            // Auto-remove after 8 seconds\n            setTimeout(() => {\n                notification.classList.remove('show');\n                setTimeout(() => notification.remove(), 300);\n            }, 8000);\n        }\n        \n        function addToThreatTicker(scan) {\n            const ticker = document.getElementById('ticker-content');\n            const timestamp = new Date(scan.serverTimestamp).toLocaleTimeString();\n            \n            const classColor = \n                scan.classification === 'Malware' ? '#ff4757' :\n                scan.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n            \n            const tickerItem = document.createElement('span');\n            tickerItem.className = 'ticker-item';\n            tickerItem.style.color = classColor;\n            tickerItem.innerHTML = `\n                <i class=\"fas fa-circle\"></i>\n                [${timestamp}] ${scan.classification}: ${scan.detected_filename}\n                ${scan.malware_family ? `(${scan.malware_family})` : ''}\n                on ${scan.systemInfo?.hostname || scan.clientIp || 'Unknown'}\n            `;\n            \n            ticker.appendChild(tickerItem);\n            \n            // Keep only last 10 items\n            while (ticker.children.length > 10) {\n                ticker.removeChild(ticker.firstChild);\n            }\n        }\n        \n        function animateStatCard(elementId, newValue) {\n            const element = document.getElementById(elementId);\n            if (!element) return;\n            \n            const currentValue = parseInt(element.textContent) || 0;\n            if (newValue > currentValue) {\n                // Pulse animation\n                element.parentElement.classList.add('stat-pulse');\n                setTimeout(() => element.parentElement.classList.remove('stat-pulse'), 600);\n                \n                // Animate number increment\n                const duration = 500;\n                const steps = 20;\n                const increment = (newValue - currentValue) / steps;\n                let current = currentValue;\n                let step = 0;\n                \n                const interval = setInterval(() => {\n                    step++;\n                    current += increment;\n                    element.textContent = Math.round(current);\n                    \n                    if (step >= steps) {\n                        element.textContent = newValue;\n                        clearInterval(interval);\n                    }\n                }, duration / steps);\n            } else {\n                element.textContent = newValue;\n            }\n        }\n        \n        async function loadStats() {\n            try {\n                const response = await fetch('/api/stats');\n                const stats = await response.json();\n                \n                animateStatCard('stat-clients', stats.activeClients);\n                animateStatCard('stat-total', stats.totalScans);\n                animateStatCard('stat-malware', stats.malwareCount);\n                animateStatCard('stat-suspicious', stats.suspiciousCount);\n                animateStatCard('stat-benign', stats.benignCount);\n            } catch (error) {\n                console.error('Failed to load stats:', error);\n            }\n        }\n        \n        async function loadScans() {\n            try {\n                const response = await fetch('/api/scans?limit=50');\n                const data = await response.json();\n                \n                const tbody = document.getElementById('scans-tbody');\n                \n                if (data.scans.length === 0) {\n                    tbody.innerHTML = `\n                        <tr>\n                            <td colspan=\"5\" class=\"empty-state\">\n                                <i class=\"fas fa-inbox\"></i>\n                                <p>No scans yet. Waiting for clients...</p>\n                            </td>\n                        </tr>\n                    `;\n                    return;\n                }\n                \n                tbody.innerHTML = data.scans.map(scan => {\n                    const timestamp = new Date(scan.serverTimestamp).toLocaleString();\n                    const hash = scan.file_hashes?.sha256 || 'N/A';\n                    const hashShort = hash.length > 16 ? (hash.substring(0, 16) + '...') : hash;\n                    const isNonPe = scan.is_pe === false;\n                    const classification = isNonPe ? 'Non-PE' : (scan.classification || 'Unknown');\n                    const badgeClass = isNonPe ? 'non-pe' : classification.toLowerCase();\n                    const nonPeTag = isNonPe ? '<span class=\"badge non-pe\" title=\"Non-PE file\">Non-PE</span>' : '';\n                    return `\n                        <tr>\n                            <td>${timestamp}</td>\n                            <td>${scan.detected_filename} ${nonPeTag}</td>\n                            <td><span class=\"badge ${badgeClass}\">${classification}</span></td>\n                            <td>${scan.systemInfo?.ip || scan.clientIp || 'Unknown'}</td>\n                            <td class=\"hash\" title=\"${hash}\">${hashShort}</td>\n                        </tr>\n                    `;\n                }).join('');\n                \n            } catch (error) {\n                console.error('Failed to load scans:', error);\n            }\n        }\n        \n        async function loadDailyChart() {\n            try {\n                const response = await fetch(`/api/daily-scans?days=${currentChartDays}`);\n                const data = await response.json();\n                \n                const ctx = document.getElementById('dailyScansChart');\n                \n                // Format dates for display (MM/DD)\n                const labels = data.days.map(day => {\n                    const date = new Date(day.date);\n                    return `${date.getMonth() + 1}/${date.getDate()}`;\n                });\n                \n                // Reuse existing chart if it exists\n                if (dailyChart) {\n                    dailyChart.data.labels = labels;\n                    dailyChart.data.datasets[0].data = data.days.map(d => d.total);\n                    dailyChart.data.datasets[1].data = data.days.map(d => d.malware);\n                    dailyChart.data.datasets[2].data = data.days.map(d => d.suspicious);\n                    dailyChart.data.datasets[3].data = data.days.map(d => d.benign);\n                    dailyChart.update('none'); // Update without animation\n                    return;\n                }\n                \n                dailyChart = new Chart(ctx, {\n                    type: 'line',\n                    data: {\n                        labels: labels,\n                        datasets: [\n                            {\n                                label: 'Total Scans',\n                                data: data.days.map(d => d.total),\n                                borderColor: '#5a9cf8',\n                                backgroundColor: 'rgba(90, 156, 248, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Malware',\n                                data: data.days.map(d => d.malware),\n                                borderColor: '#ff4757',\n                                backgroundColor: 'rgba(255, 71, 87, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Suspicious',\n                                data: data.days.map(d => d.suspicious),\n                                borderColor: '#ffa502',\n                                backgroundColor: 'rgba(255, 165, 2, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Benign',\n                                data: data.days.map(d => d.benign),\n                                borderColor: '#26de81',\n                                backgroundColor: 'rgba(38, 222, 129, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        interaction: {\n                            mode: 'index',\n                            intersect: false,\n                        },\n                        plugins: {\n                            legend: {\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 12 }\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0',\n                                borderColor: 'rgba(255, 255, 255, 0.1)',\n                                borderWidth: 1\n                            }\n                        },\n                        scales: {\n                            x: {\n                                ticks: { \n                                    color: getCSSVar('--chart-text-color') || '#888',\n                                    maxRotation: 45,\n                                    minRotation: 45\n                                },\n                                grid: { \n                                    color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' \n                                }\n                            },\n                            y: {\n                                beginAtZero: true,\n                                ticks: { \n                                    color: getCSSVar('--chart-text-color') || '#888',\n                                    stepSize: 1\n                                },\n                                grid: { \n                                    color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' \n                                }\n                            }\n                        }\n                    }\n                });\n                \n            } catch (error) {\n                console.error('Failed to load daily chart:', error);\n            }\n        }\n        \n        let worldMap = null;\n        let markerLayer = null;\n        let heatmapLayer = null;\n        let choroplethLayer = null;\n        let mapInitialized = false;\n        let lastGeoDataHash = '';\n        let sourceChart = null;\n        let currentMapView = 'markers';\n        let geoDataCache = null;\n        let replayInterval = null;\n        \n        // Country boundaries for choropleth (simplified)\n        const countryCoordinates = {\n            'United States': { center: [37.0902, -95.7129], weight: 0 },\n            'China': { center: [35.8617, 104.1954], weight: 0 },\n            'United Kingdom': { center: [55.3781, -3.4360], weight: 0 },\n            'Germany': { center: [51.1657, 10.4515], weight: 0 },\n            'France': { center: [46.2276, 2.2137], weight: 0 },\n            'Russia': { center: [61.5240, 105.3188], weight: 0 },\n            'Japan': { center: [36.2048, 138.2529], weight: 0 },\n            'India': { center: [20.5937, 78.9629], weight: 0 },\n            'Brazil': { center: [-14.2350, -51.9253], weight: 0 },\n            'Australia': { center: [-25.2744, 133.7751], weight: 0 }\n        };\n        \n        function initializeMap() {\n            if (mapInitialized) return;\n            \n            try {\n                worldMap = L.map('worldMap', {\n                    zoomControl: true,\n                    scrollWheelZoom: true,\n                    preferCanvas: false,\n                    worldCopyJump: true\n                }).setView([20, 0], 2);\n                \n                // Use dark theme tiles\n                L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {\n                    attribution: '&copy; OpenStreetMap contributors',\n                    subdomains: 'abcd',\n                    maxZoom: 18,\n                    minZoom: 1,\n                    noWrap: false,\n                    bounds: [[-90, -180], [90, 180]]\n                }).addTo(worldMap);\n                \n                markerLayer = L.layerGroup().addTo(worldMap);\n                mapInitialized = true;\n                \n                // Fix map display after initialization\n                setTimeout(() => {\n                    if (worldMap) worldMap.invalidateSize();\n                }, 100);\n            } catch (error) {\n                console.error('Failed to initialize map:', error);\n            }\n        }\n        \n        // Switch between map visualization modes\n        window.switchMapView = function(view) {\n            currentMapView = view;\n            \n            // Update button states\n            document.querySelectorAll('.map-btn').forEach(btn => {\n                btn.classList.remove('active');\n            });\n            document.querySelector(`[data-view=\"${view}\"]`).classList.add('active');\n            \n            // Reload map with new view\n            if (geoDataCache) {\n                renderMapView(geoDataCache);\n            }\n        };\n        \n        // Render different map views\n        function renderMapView(data) {\n            if (!worldMap) return;\n            \n            // Clear all layers\n            if (markerLayer) markerLayer.clearLayers();\n            if (heatmapLayer) {\n                worldMap.removeLayer(heatmapLayer);\n                heatmapLayer = null;\n            }\n            if (choroplethLayer) {\n                worldMap.removeLayer(choroplethLayer);\n                choroplethLayer = null;\n            }\n            \n            switch (currentMapView) {\n                case 'markers':\n                    renderMarkers(data);\n                    break;\n                case 'heatmap':\n                    renderHeatmap(data);\n                    break;\n                case 'choropleth':\n                    renderChoropleth(data);\n                    break;\n            }\n            \n            updateGeoContext(data);\n        }\n        \n        // Render traditional markers\n        function renderMarkers(data) {\n            data.locations.forEach(location => {\n                const { lat, lng, city, country } = location.location;\n                \n                let markerColor = '#26de81'; // benign\n                if (location.malwareCount > 0) {\n                    markerColor = '#ff3b3b'; // malware\n                } else if (location.suspiciousCount > 0) {\n                    markerColor = '#ffd700'; // suspicious\n                }\n                \n                const markerSize = Math.min(24, Math.max(8, 8 + location.totalScans * 2));\n                \n                const marker = L.circleMarker([lat, lng], {\n                    radius: markerSize / 2,\n                    fillColor: markerColor,\n                    color: '#fff',\n                    weight: 2,\n                    opacity: 0.8,\n                    fillOpacity: 0.6\n                });\n                \n                const popupContent = `\n                    <div style=\"color: var(--text-primary); min-width: 200px;\">\n                        <h3 style=\"margin: 0 0 10px 0; color: var(--accent-green); font-size: 1.1rem;\">\n                            <i class=\"fas fa-map-marker-alt\" style=\"color: ${markerColor};\"></i>\n                            ${city}, ${country}\n                        </h3>\n                        <p style=\"margin: 5px 0;\"><strong>IP:</strong> ${location.ip}</p>\n                        <p style=\"margin: 5px 0;\"><strong>Total Scans:</strong> ${location.totalScans}</p>\n                        <div style=\"margin-top: 10px;\">\n                            <div><span style=\"color: #ff3b3b;\">‚óè</span> Malware: ${location.malwareCount}</div>\n                            <div><span style=\"color: #ffd700;\">‚óè</span> Suspicious: ${location.suspiciousCount}</div>\n                            <div><span style=\"color: #39ff14;\">‚óè</span> Benign: ${location.benignCount}</div>\n                        </div>\n                        <button onclick=\"filterByLocation('${country}')\" \n                                style=\"margin-top: 10px; padding: 5px 10px; background: var(--accent-green); \n                                       color: var(--bg-primary); border: none; border-radius: 5px; cursor: pointer;\">\n                            Filter by ${country}\n                        </button>\n                    </div>\n                `;\n                \n                marker.bindPopup(popupContent);\n                marker.addTo(markerLayer);\n                \n                marker.on('mouseover', function() {\n                    this.setStyle({ fillOpacity: 0.9, opacity: 1 });\n                });\n                marker.on('mouseout', function() {\n                    this.setStyle({ fillOpacity: 0.6, opacity: 0.8 });\n                });\n            });\n        }\n        \n        // Render heatmap overlay\n        function renderHeatmap(data) {\n            const heatData = [];\n            \n            data.locations.forEach(location => {\n                const { lat, lng } = location.location;\n                // Weight by threat severity: malware = 1.0, suspicious = 0.5, benign = 0.2\n                const weight = (location.malwareCount * 1.0 + \n                               location.suspiciousCount * 0.5 + \n                               location.benignCount * 0.2) / location.totalScans;\n                \n                // Add multiple points for higher intensity\n                const intensity = Math.ceil(location.totalScans * weight);\n                for (let i = 0; i < intensity; i++) {\n                    heatData.push([lat, lng, weight]);\n                }\n            });\n            \n            heatmapLayer = L.heatLayer(heatData, {\n                radius: 35,\n                blur: 25,\n                maxZoom: 10,\n                max: 1.0,\n                gradient: {\n                    0.0: '#39ff14',  // Green (low threat)\n                    0.3: '#ffd700',  // Yellow\n                    0.6: '#ffa502',  // Orange\n                    0.8: '#ff6348',  // Red\n                    1.0: '#ff3b3b'   // Bright red (high threat)\n                }\n            }).addTo(worldMap);\n        }\n        \n        // Render choropleth (country-level threat shading)\n        function renderChoropleth(data) {\n            // Aggregate threats by country\n            const countryStats = {};\n            data.locations.forEach(location => {\n                const country = location.location.country;\n                if (!countryStats[country]) {\n                    countryStats[country] = { total: 0, malware: 0, suspicious: 0 };\n                }\n                countryStats[country].total += location.totalScans;\n                countryStats[country].malware += location.malwareCount;\n                countryStats[country].suspicious += location.suspiciousCount;\n            });\n            \n            // Find max for normalization\n            const maxThreats = Math.max(...Object.values(countryStats).map(s => \n                s.malware + s.suspicious * 0.5\n            ));\n            \n            // Draw circles for countries with threat data\n            choroplethLayer = L.layerGroup();\n            \n            Object.entries(countryStats).forEach(([country, stats]) => {\n                if (countryCoordinates[country]) {\n                    const threatScore = (stats.malware + stats.suspicious * 0.5) / maxThreats;\n                    \n                    // Color gradient from green to red\n                    let color;\n                    if (threatScore < 0.2) color = '#39ff14';\n                    else if (threatScore < 0.4) color = '#ffd700';\n                    else if (threatScore < 0.6) color = '#ffa502';\n                    else if (threatScore < 0.8) color = '#ff6348';\n                    else color = '#ff3b3b';\n                    \n                    const circle = L.circle(countryCoordinates[country].center, {\n                        color: color,\n                        fillColor: color,\n                        fillOpacity: 0.4,\n                        radius: 500000 * (1 + threatScore * 2),\n                        weight: 2\n                    });\n                    \n                    circle.bindPopup(`\n                        <div style=\"color: var(--text-primary);\">\n                            <h3 style=\"color: var(--accent-green);\">${country}</h3>\n                            <p><strong>Total Threats:</strong> ${stats.total}</p>\n                            <p><strong>Malware:</strong> ${stats.malware}</p>\n                            <p><strong>Suspicious:</strong> ${stats.suspicious}</p>\n                            <p><strong>Threat Level:</strong> ${(threatScore * 100).toFixed(0)}%</p>\n                        </div>\n                    `);\n                    \n                    circle.addTo(choroplethLayer);\n                }\n            });\n            \n            choroplethLayer.addTo(worldMap);\n        }\n        \n        // Update geographic context panel\n        function updateGeoContext(data) {\n            const countries = new Set(data.locations.map(l => l.location.country));\n            document.getElementById('activeRegions').textContent = countries.size;\n            \n            // Find hotspot (country with most threats)\n            const countryThreats = {};\n            data.locations.forEach(loc => {\n                const country = loc.location.country;\n                countryThreats[country] = (countryThreats[country] || 0) + \n                    loc.malwareCount + loc.suspiciousCount;\n            });\n            \n            const hotspot = Object.entries(countryThreats)\n                .sort((a, b) => b[1] - a[1])[0];\n            \n            if (hotspot) {\n                const percentage = ((hotspot[1] / data.locations.reduce((sum, l) => \n                    sum + l.malwareCount + l.suspiciousCount, 0)) * 100).toFixed(0);\n                document.getElementById('topRegion').textContent = \n                    `${hotspot[0]} (${percentage}% of threats)`;\n            }\n            \n            const totalThreats = data.locations.reduce((sum, l) => \n                sum + l.malwareCount + l.suspiciousCount, 0);\n            document.getElementById('geoThreatCount').textContent = totalThreats;\n        }\n        \n        // Filter dashboard by geographic location\n        window.filterByLocation = function(country) {\n            console.log(`Filtering by country: ${country}`);\n            // This would filter the tables and charts - simplified for demo\n            alert(`Geographic filtering activated for ${country}.\\nIn full implementation, this would filter all dashboard data.`);\n        };\n        \n        // Replay threats over last 24 hours\n        window.replayThreats = async function() {\n            const btn = document.getElementById('replayBtn');\n            const info = document.getElementById('timelineInfo');\n            \n            if (replayInterval) {\n                clearInterval(replayInterval);\n                replayInterval = null;\n                btn.innerHTML = '<i class=\"fas fa-play\"></i> Replay Last 24h';\n                info.textContent = 'Replay stopped';\n                if (geoDataCache) renderMapView(geoDataCache);\n                return;\n            }\n            \n            if (!geoDataCache || geoDataCache.locations.length === 0) {\n                info.textContent = 'No data available for replay';\n                return;\n            }\n            \n            btn.innerHTML = '<i class=\"fas fa-stop\"></i> Stop Replay';\n            info.textContent = 'Replaying threat detection timeline...';\n            \n            // Sort locations by timestamp\n            const sortedLocations = [...geoDataCache.locations].sort((a, b) => {\n                const timeA = a.scans[0]?.timestamp || 0;\n                const timeB = b.scans[0]?.timestamp || 0;\n                return new Date(timeA) - new Date(timeB);\n            });\n            \n            if (markerLayer) markerLayer.clearLayers();\n            let index = 0;\n            \n            replayInterval = setInterval(() => {\n                if (index >= sortedLocations.length) {\n                    clearInterval(replayInterval);\n                    replayInterval = null;\n                    btn.innerHTML = '<i class=\"fas fa-play\"></i> Replay Last 24h';\n                    info.textContent = 'Replay complete';\n                    return;\n                }\n                \n                const location = sortedLocations[index];\n                const { lat, lng, city, country } = location.location;\n                \n                let markerColor = location.malwareCount > 0 ? '#ff3b3b' : \n                                 location.suspiciousCount > 0 ? '#ffd700' : '#39ff14';\n                \n                // Animated marker appearance\n                const marker = L.circleMarker([lat, lng], {\n                    radius: 0,\n                    fillColor: markerColor,\n                    color: '#fff',\n                    weight: 2,\n                    opacity: 1,\n                    fillOpacity: 0.8\n                }).addTo(markerLayer);\n                \n                // Animate marker growth\n                let size = 0;\n                const growInterval = setInterval(() => {\n                    size += 2;\n                    if (size >= 12) {\n                        clearInterval(growInterval);\n                        marker.setStyle({ opacity: 0.8, fillOpacity: 0.6 });\n                    }\n                    marker.setRadius(size / 2);\n                }, 50);\n                \n                marker.bindPopup(`\n                    <div style=\"color: var(--text-primary);\">\n                        <strong>${city}, ${country}</strong><br>\n                        ${location.scans[0]?.filename || 'Unknown file'}\n                    </div>\n                `);\n                \n                info.textContent = `Replaying: ${index + 1}/${sortedLocations.length} - ${city}, ${country}`;\n                index++;\n            }, 800); // Show new threat every 800ms\n        };\n        \n        async function loadGeoMap() {\n            try {\n                // Initialize map only once\n                if (!mapInitialized) {\n                    initializeMap();\n                }\n                \n                if (!worldMap) return;\n                \n                const response = await fetch('/api/geo-data');\n                const data = await response.json();\n                \n                // Generate hash of current data to detect changes\n                const currentHash = JSON.stringify(data.locations.map(l => \n                    `${l.ip}-${l.totalScans}-${l.malwareCount}-${l.suspiciousCount}`\n                )).substring(0, 100);\n                \n                // Skip update if data hasn't changed\n                if (currentHash === lastGeoDataHash && markerLayer && markerLayer.getLayers().length > 0) {\n                    return;\n                }\n                lastGeoDataHash = currentHash;\n                \n                // Cache data for replay and other features\n                geoDataCache = data;\n                \n                // Render current view\n                renderMapView(data);\n                \n                console.log(`Map updated with ${data.locations.length} locations in ${currentMapView} mode`);\n                \n            } catch (error) {\n                console.error('Failed to load geo map:', error);\n            }\n        }\n        \n        async function loadMalwareSources() {\n            try {\n                const response = await fetch('/api/malware-sources');\n                const data = await response.json();\n                \n                const ctx = document.getElementById('malwareSourceChart');\n                \n                const labels = data.sources.map(s => s.source);\n                const counts = data.sources.map(s => s.count);\n                \n                // Color scheme for different sources\n                const colors = [\n                    '#ff6b6b', // Email Attachment - red\n                    '#4ecdc4', // Web Download - teal\n                    '#ffe66d', // USB/External Drive - yellow\n                    '#a8dadc', // Internal Network - light blue\n                    '#95a5a6'  // Unknown - gray\n                ];\n                \n                // Reuse existing chart if it exists\n                if (sourceChart) {\n                    sourceChart.data.labels = labels;\n                    sourceChart.data.datasets[0].data = counts;\n                    sourceChart.update('none');\n                    return;\n                }\n                \n                sourceChart = new Chart(ctx, {\n                    type: 'pie',\n                    data: {\n                        labels: labels,\n                        datasets: [{\n                            data: counts,\n                            backgroundColor: colors,\n                            borderColor: '#1a1a2e',\n                            borderWidth: 2\n                        }]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: true,\n                        plugins: {\n                            legend: {\n                                position: 'bottom',\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 12 },\n                                    padding: 15\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0',\n                                borderColor: 'rgba(255, 255, 255, 0.1)',\n                                borderWidth: 1,\n                                callbacks: {\n                                    label: function(context) {\n                                        const label = context.label || '';\n                                        const value = context.parsed || 0;\n                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);\n                                        const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : 0;\n                                        return `${label}: ${value} (${percentage}%)`;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                });\n                \n            } catch (error) {\n                console.error('Failed to load malware sources:', error);\n            }\n        }\n        \n        // Graph 2: \"Noisiest\" Agents Over Time\n        let noisyAgentsChart = null;\n        async function loadNoisyAgentsChart() {\n            try {\n                const response = await fetch('/api/noisy-agents');\n                const data = await response.json();\n                \n                console.log('Noisy agents data:', data);\n                \n                const ctx = document.getElementById('noisyAgentsChart');\n                if (!ctx) return;\n                \n                // Show message if no data\n                if (!data.agents || data.agents.length === 0) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 2rem; text-align: center; color: var(--text-secondary);\">No agent data available yet. Start scanning files to see trends.</div>';\n                    return;\n                }\n                \n                const colors = [\n                    '#ff3b3b', '#39ff14', '#ffd700', '#1e90ff', '#ff1493'\n                ];\n                \n                // Reuse existing chart if it exists\n                if (noisyAgentsChart) {\n                    noisyAgentsChart.data.labels = data.dates;\n                    noisyAgentsChart.data.datasets = data.agents.map((agent, idx) => ({\n                        label: agent.agentId,\n                        data: agent.counts,\n                        borderColor: colors[idx],\n                        backgroundColor: colors[idx] + '20',\n                        tension: 0.4,\n                        borderWidth: 2,\n                        fill: false\n                    }));\n                    noisyAgentsChart.update('none');\n                    return;\n                }\n                \n                noisyAgentsChart = new Chart(ctx, {\n                    type: 'line',\n                    data: {\n                        labels: data.dates,\n                        datasets: data.agents.map((agent, idx) => ({\n                            label: agent.agentId,\n                            data: agent.counts,\n                            borderColor: colors[idx],\n                            backgroundColor: colors[idx] + '20',\n                            tension: 0.4,\n                            borderWidth: 2,\n                            fill: false\n                        }))\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load noisy agents chart:', error);\n                const ctx = document.getElementById('noisyAgentsChart');\n                if (ctx) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 2rem; text-align: center; color: var(--accent-red);\">Error loading chart data</div>';\n                }\n            }\n        }\n        \n        // Graph 3: Signature Status vs. Classification\n        let signatureClassChart = null;\n        async function loadSignatureClassChart() {\n            try {\n                const response = await fetch('/api/signature-classification');\n                const data = await response.json();\n                \n                console.log('Signature classification data:', data);\n                \n                const ctx = document.getElementById('signatureClassChart');\n                if (!ctx) {\n                    console.warn('signatureClassChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (signatureClassChart) {\n                    signatureClassChart.data.datasets[0].data = [data.benign.verified, data.suspicious.verified, data.malware.verified];\n                    signatureClassChart.data.datasets[1].data = [data.benign.unknown, data.suspicious.unknown, data.malware.unknown];\n                    signatureClassChart.data.datasets[2].data = [data.benign.untrusted, data.suspicious.untrusted, data.malware.untrusted];\n                    signatureClassChart.update('none');\n                    return;\n                }\n                \n                signatureClassChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: ['Benign', 'Suspicious', 'Malware'],\n                        datasets: [\n                            {\n                                label: 'Verified',\n                                data: [data.benign.verified, data.suspicious.verified, data.malware.verified],\n                                backgroundColor: '#39ff14',\n                                stack: 'stack0'\n                            },\n                            {\n                                label: 'Unknown',\n                                data: [data.benign.unknown, data.suspicious.unknown, data.malware.unknown],\n                                backgroundColor: '#ffd700',\n                                stack: 'stack0'\n                            },\n                            {\n                                label: 'Untrusted',\n                                data: [data.benign.untrusted, data.suspicious.untrusted, data.malware.untrusted],\n                                backgroundColor: '#ff3b3b',\n                                stack: 'stack0'\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                callbacks: {\n                                    label: function(context) {\n                                        const total = context.chart.data.datasets\n                                            .reduce((sum, ds) => sum + ds.data[context.dataIndex], 0);\n                                        const percentage = ((context.parsed.y / total) * 100).toFixed(1);\n                                        return `${context.dataset.label}: ${context.parsed.y} (${percentage}%)`;\n                                    }\n                                }\n                            }\n                        },\n                        scales: {\n                            y: {\n                                stacked: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                stacked: true,\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load signature classification chart:', error);\n                const ctx = document.getElementById('signatureClassChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 4: Packer Usage vs. Classification\n        let packerClassChart = null;\n        async function loadPackerClassChart() {\n            try {\n                const response = await fetch('/api/packer-classification');\n                const data = await response.json();\n                \n                console.log('Packer classification data:', data);\n                \n                const ctx = document.getElementById('packerClassChart');\n                if (!ctx) {\n                    console.warn('packerClassChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (packerClassChart) {\n                    packerClassChart.data.labels = data.packers;\n                    packerClassChart.data.datasets[0].data = data.benignCounts;\n                    packerClassChart.data.datasets[1].data = data.malwareCounts;\n                    packerClassChart.update('none');\n                    return;\n                }\n                \n                packerClassChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: data.packers,\n                        datasets: [\n                            {\n                                label: 'Benign Files',\n                                data: data.benignCounts,\n                                backgroundColor: '#39ff14'\n                            },\n                            {\n                                label: 'Malware Files',\n                                data: data.malwareCounts,\n                                backgroundColor: '#ff3b3b'\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load packer classification chart:', error);\n                const ctx = document.getElementById('packerClassChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 5: Confidence Score Histogram\n        let confidenceHistChart = null;\n        async function loadConfidenceHistChart() {\n            try {\n                const response = await fetch('/api/confidence-distribution');\n                const data = await response.json();\n                \n                console.log('Confidence distribution data:', data);\n                \n                const ctx = document.getElementById('confidenceHistChart');\n                if (!ctx) {\n                    console.warn('confidenceHistChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (confidenceHistChart) {\n                    confidenceHistChart.data.labels = data.bins;\n                    confidenceHistChart.data.datasets[0].data = data.counts;\n                    confidenceHistChart.update('none');\n                    return;\n                }\n                \n                confidenceHistChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: data.bins,\n                        datasets: [{\n                            label: 'Scan Count',\n                            data: data.counts,\n                            backgroundColor: '#39ff14',\n                            borderColor: '#2ed60f',\n                            borderWidth: 1\n                        }]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' },\n                                title: {\n                                    display: true,\n                                    text: 'Number of Scans',\n                                    color: '#888'\n                                }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false },\n                                title: {\n                                    display: true,\n                                    text: 'Confidence Score Range',\n                                    color: '#888'\n                                }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load confidence histogram:', error);\n                const ctx = document.getElementById('confidenceHistChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 6: File Entropy Distribution (Box Plot simulation)\n        let entropyBoxChart = null;\n        async function loadEntropyBoxChart() {\n            try {\n                const response = await fetch('/api/entropy-distribution');\n                const data = await response.json();\n                \n                console.log('Entropy distribution data:', data);\n                \n                const ctx = document.getElementById('entropyBoxChart');\n                if (!ctx) {\n                    console.warn('entropyBoxChart canvas not found');\n                    return;\n                }\n                \n                // Create violin/box plot effect with multiple bars\n                const benignData = [\n                    data.benign.min,\n                    data.benign.q1,\n                    data.benign.median,\n                    data.benign.q3,\n                    data.benign.max\n                ];\n                \n                const malwareData = [\n                    data.malware.min,\n                    data.malware.q1,\n                    data.malware.median,\n                    data.malware.q3,\n                    data.malware.max\n                ];\n                \n                // Reuse existing chart if it exists\n                if (entropyBoxChart) {\n                    entropyBoxChart.data.datasets[0].data = benignData;\n                    entropyBoxChart.data.datasets[1].data = malwareData;\n                    entropyBoxChart.update('none');\n                    return;\n                }\n                \n                entropyBoxChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: ['Min', 'Q1', 'Median', 'Q3', 'Max'],\n                        datasets: [\n                            {\n                                label: 'Benign Files',\n                                data: benignData,\n                                backgroundColor: '#39ff14',\n                                borderColor: '#2ed60f',\n                                borderWidth: 1\n                            },\n                            {\n                                label: 'Malware Files',\n                                data: malwareData,\n                                backgroundColor: '#ff3b3b',\n                                borderColor: '#cc2f2f',\n                                borderWidth: 1\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                callbacks: {\n                                    label: function(context) {\n                                        return `${context.dataset.label}: ${context.parsed.y.toFixed(3)}`;\n                                    }\n                                }\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                max: 8.0,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' },\n                                title: {\n                                    display: true,\n                                    text: 'Entropy Value',\n                                    color: '#888'\n                                }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load entropy distribution chart:', error);\n                const ctx = document.getElementById('entropyBoxChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        async function loadEmergingThreats() {\n            try {\n                const response = await fetch('/api/emerging-threats');\n                const data = await response.json();\n                \n                // Update summary badges\n                document.getElementById('eti-total').textContent = \n                    `${data.summary.totalThreats} Total Threats`;\n                document.getElementById('eti-recent').textContent = \n                    `${data.summary.recentThreats} Last 24h`;\n                \n                // Helper to render IOC list\n                const renderIOCList = (items, container) => {\n                    if (items.length === 0) {\n                        container.innerHTML = '<div class=\"eti-empty\">No threats detected</div>';\n                        return;\n                    }\n                    \n                    container.innerHTML = items.map((item, index) => {\n                        const rank = index + 1;\n                        const recentBadge = item.recent > 0 ? \n                            `<span class=\"eti-recent-badge\">${item.recent} recent</span>` : '';\n                        const agentBadge = item.agents > 0 ? \n                            `<span class=\"eti-agent-badge\">${item.agents} agents</span>` : '';\n                        \n                        return `\n                            <div class=\"eti-item\" data-rank=\"${rank}\">\n                                <div class=\"eti-rank\">${rank}</div>\n                                <div class=\"eti-content\">\n                                    <div class=\"eti-name\">${item.name}</div>\n                                    <div class=\"eti-meta\">\n                                        <span class=\"eti-count\">${item.count} occurrences</span>\n                                        ${recentBadge}\n                                        ${agentBadge}\n                                    </div>\n                                    ${item.details && item.details.length > 0 ? `\n                                        <div class=\"eti-details\">\n                                            ${item.details.slice(0, 2).join(', ')}\n                                            ${item.details.length > 2 ? '...' : ''}\n                                        </div>\n                                    ` : ''}\n                                </div>\n                            </div>\n                        `;\n                    }).join('');\n                };\n                \n                // Render each section\n                renderIOCList(data.topMalwareFamilies, document.getElementById('eti-malware'));\n                renderIOCList(data.topSuspiciousAPIs, document.getElementById('eti-apis'));\n                renderIOCList(data.topMaliciousStrings, document.getElementById('eti-strings'));\n                renderIOCList(data.topPackers, document.getElementById('eti-packers'));\n                \n            } catch (error) {\n                console.error('Failed to load emerging threats:', error);\n            }\n        }\n        \n        async function analyzeThreatModel() {\n            try {\n                // Get selected values\n                const fileType = document.getElementById('model-filetype').value;\n                const packer = document.getElementById('model-packer').value;\n                const signature = document.getElementById('model-signature').value;\n                \n                // Get multiple selections\n                const apisSelect = document.getElementById('model-apis');\n                const apiImports = Array.from(apisSelect.selectedOptions).map(opt => opt.value);\n                \n                const stringsSelect = document.getElementById('model-strings');\n                const keyStrings = Array.from(stringsSelect.selectedOptions).map(opt => opt.value);\n                \n                // Validate\n                if (apiImports.length === 0) {\n                    alert('Please select at least one API import');\n                    return;\n                }\n                if (keyStrings.length === 0) {\n                    alert('Please select at least one suspicious string');\n                    return;\n                }\n                \n                // Show loading state\n                const outputDiv = document.getElementById('modeler-output');\n                outputDiv.innerHTML = `\n                    <div class=\"modeler-loading\">\n                        <i class=\"fas fa-spinner fa-spin\"></i>\n                        <p>Analyzing threat profile...</p>\n                    </div>\n                `;\n                \n                // Send to server\n                const response = await fetch('/api/threat-model', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                        fileType,\n                        packer,\n                        signature,\n                        apiImports,\n                        keyStrings\n                    })\n                });\n                \n                const data = await response.json();\n                \n                if (data.success) {\n                    const result = data.result;\n                    const classColor = \n                        result.classification === 'Malware' ? '#ff4757' :\n                        result.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n                    \n                    outputDiv.innerHTML = `\n                        <div class=\"prediction-result\">\n                            <div class=\"prediction-header\">\n                                <div class=\"prediction-badge\" style=\"background: ${classColor};\">\n                                    ${result.classification.toUpperCase()}\n                                </div>\n                                <div class=\"prediction-confidence\">\n                                    <div class=\"confidence-label\">Confidence Score</div>\n                                    <div class=\"confidence-value\">${(parseFloat(result.confidence_score) * 100).toFixed(1)}%</div>\n                                </div>\n                            </div>\n                            \n                            ${result.malware_family ? `\n                                <div class=\"prediction-family\">\n                                    <strong>Predicted Malware Family:</strong>\n                                    <span class=\"family-name\">${result.malware_family}</span>\n                                </div>\n                            ` : ''}\n                            \n                            <div class=\"prediction-section\">\n                                <h4>Threat Analysis</h4>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-file\"></i>\n                                    <span><strong>File Type:</strong> ${result.key_findings.file_type}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-box\"></i>\n                                    <span><strong>Packer:</strong> ${result.key_findings.packer_detected}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-certificate\"></i>\n                                    <span><strong>Signature:</strong> ${result.key_findings.signature.name}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-tachometer-alt\"></i>\n                                    <span><strong>Threat Score:</strong> ${result.key_findings.threat_score}/100</span>\n                                </div>\n                            </div>\n                            \n                            <div class=\"prediction-section\">\n                                <h4>Detected Indicators</h4>\n                                <div class=\"indicator-group\">\n                                    <strong>API Imports:</strong>\n                                    <div class=\"indicator-list\">\n                                        ${result.key_findings.api_imports.map(api => \n                                            `<span class=\"indicator-tag api-tag\">${api}</span>`\n                                        ).join('')}\n                                    </div>\n                                </div>\n                                <div class=\"indicator-group\">\n                                    <strong>Suspicious Strings:</strong>\n                                    <div class=\"indicator-list\">\n                                        ${result.key_findings.key_strings.map(str => \n                                            `<span class=\"indicator-tag string-tag\">${str}</span>`\n                                        ).join('')}\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"prediction-footer\">\n                                <i class=\"fas fa-info-circle\"></i>\n                                This analysis has been added to the scan results and will appear in all visualizations.\n                            </div>\n                        </div>\n                    `;\n                } else {\n                    outputDiv.innerHTML = `\n                        <div class=\"modeler-error\">\n                            <i class=\"fas fa-exclamation-circle\"></i>\n                            <p>Analysis failed: ${data.error}</p>\n                        </div>\n                    `;\n                }\n                \n            } catch (error) {\n                console.error('Failed to analyze threat model:', error);\n                document.getElementById('modeler-output').innerHTML = `\n                    <div class=\"modeler-error\">\n                        <i class=\"fas fa-exclamation-circle\"></i>\n                        <p>Analysis failed. Please try again.</p>\n                    </div>\n                `;\n            }\n        }\n        \n        let graphSimulation = null;\n        let graphSvg = null;\n        \n        async function loadCorrelationGraph() {\n            try {\n                const response = await fetch('/api/threat-correlations');\n                const data = await response.json();\n                \n                // Clear existing graph\n                d3.select('#correlationGraph').selectAll('*').remove();\n                \n                const container = document.getElementById('correlationGraph');\n                const width = container.clientWidth;\n                const height = 600;\n                \n                // Create SVG\n                graphSvg = d3.select('#correlationGraph')\n                    .append('svg')\n                    .attr('width', width)\n                    .attr('height', height)\n                    .style('background', '#0a0a0a')\n                    .style('border-radius', '8px');\n                \n                const g = graphSvg.append('g');\n                \n                // Add zoom behavior\n                const zoom = d3.zoom()\n                    .scaleExtent([0.1, 4])\n                    .on('zoom', (event) => {\n                        g.attr('transform', event.transform);\n                    });\n                \n                graphSvg.call(zoom);\n                \n                // Color schemes for different node types\n                const colorMap = {\n                    malware: '#ff4757',\n                    agent: '#5a9cf8',\n                    api: '#ffa502',\n                    string: '#26de81'\n                };\n                \n                // Create force simulation\n                graphSimulation = d3.forceSimulation(data.nodes)\n                    .force('link', d3.forceLink(data.links)\n                        .id(d => d.id)\n                        .distance(d => d.type === 'correlated_with' ? 200 : 100)\n                        .strength(d => d.strength * 0.3))\n                    .force('charge', d3.forceManyBody().strength(-300))\n                    .force('center', d3.forceCenter(width / 2, height / 2))\n                    .force('collision', d3.forceCollide().radius(30));\n                \n                // Draw links\n                const link = g.append('g')\n                    .selectAll('line')\n                    .data(data.links)\n                    .enter()\n                    .append('line')\n                    .attr('stroke', d => {\n                        if (d.type === 'correlated_with') return '#ff6b6b';\n                        if (d.type === 'detected_by') return '#5a9cf8';\n                        if (d.type === 'uses_api') return '#ffa502';\n                        return '#26de81';\n                    })\n                    .attr('stroke-width', d => Math.sqrt(d.strength) + 1)\n                    .attr('stroke-opacity', 0.6);\n                \n                // Draw nodes\n                const node = g.append('g')\n                    .selectAll('circle')\n                    .data(data.nodes)\n                    .enter()\n                    .append('circle')\n                    .attr('r', d => {\n                        if (d.type === 'malware') return 15 + Math.min(d.count * 2, 15);\n                        if (d.type === 'agent') return 12 + Math.min(d.count, 10);\n                        return 8 + Math.min(d.count, 8);\n                    })\n                    .attr('fill', d => colorMap[d.type])\n                    .attr('stroke', '#fff')\n                    .attr('stroke-width', 2)\n                    .style('cursor', 'pointer')\n                    .call(d3.drag()\n                        .on('start', dragstarted)\n                        .on('drag', dragged)\n                        .on('end', dragended))\n                    .on('click', (event, d) => showNodeDetails(d, data))\n                    .on('mouseover', function(event, d) {\n                        d3.select(this)\n                            .transition()\n                            .duration(200)\n                            .attr('stroke-width', 4)\n                            .attr('r', function() {\n                                const currentR = parseFloat(d3.select(this).attr('r'));\n                                return currentR * 1.3;\n                            });\n                    })\n                    .on('mouseout', function(event, d) {\n                        d3.select(this)\n                            .transition()\n                            .duration(200)\n                            .attr('stroke-width', 2)\n                            .attr('r', function() {\n                                if (d.type === 'malware') return 15 + Math.min(d.count * 2, 15);\n                                if (d.type === 'agent') return 12 + Math.min(d.count, 10);\n                                return 8 + Math.min(d.count, 8);\n                            });\n                    });\n                \n                // Add labels\n                const label = g.append('g')\n                    .selectAll('text')\n                    .data(data.nodes)\n                    .enter()\n                    .append('text')\n                    .text(d => d.label.length > 20 ? d.label.substring(0, 20) + '...' : d.label)\n                    .attr('font-size', d => d.type === 'malware' ? '12px' : '10px')\n                    .attr('fill', '#e0e0e0')\n                    .attr('text-anchor', 'middle')\n                    .attr('dy', d => {\n                        if (d.type === 'malware') return 35;\n                        if (d.type === 'agent') return 25;\n                        return 20;\n                    })\n                    .style('pointer-events', 'none')\n                    .style('font-weight', d => d.type === 'malware' ? 'bold' : 'normal');\n                \n                // Update positions on simulation tick\n                graphSimulation.on('tick', () => {\n                    link\n                        .attr('x1', d => d.source.x)\n                        .attr('y1', d => d.source.y)\n                        .attr('x2', d => d.target.x)\n                        .attr('y2', d => d.target.y);\n                    \n                    node\n                        .attr('cx', d => d.x)\n                        .attr('cy', d => d.y);\n                    \n                    label\n                        .attr('x', d => d.x)\n                        .attr('y', d => d.y);\n                });\n                \n                // Drag functions\n                function dragstarted(event, d) {\n                    if (!event.active) graphSimulation.alphaTarget(0.3).restart();\n                    d.fx = d.x;\n                    d.fy = d.y;\n                }\n                \n                function dragged(event, d) {\n                    d.fx = event.x;\n                    d.fy = event.y;\n                }\n                \n                function dragended(event, d) {\n                    if (!event.active) graphSimulation.alphaTarget(0);\n                    d.fx = null;\n                    d.fy = null;\n                }\n                \n                console.log(`Correlation graph loaded: ${data.nodes.length} nodes, ${data.links.length} links`);\n                \n            } catch (error) {\n                console.error('Failed to load correlation graph:', error);\n            }\n        }\n        \n        function showNodeDetails(node, graphData) {\n            const detailsPanel = document.getElementById('nodeDetails');\n            const detailsTitle = document.getElementById('detailsTitle');\n            const detailsContent = document.getElementById('detailsContent');\n            \n            detailsTitle.textContent = node.label;\n            \n            let html = `<p><strong>Type:</strong> ${node.type.toUpperCase()}</p>`;\n            html += `<p><strong>Occurrences:</strong> ${node.count}</p>`;\n            \n            // Find connections\n            const connections = graphData.links.filter(l => \n                l.source.id === node.id || l.target.id === node.id\n            );\n            \n            if (connections.length > 0) {\n                html += `<p><strong>Connections:</strong> ${connections.length}</p>`;\n                html += '<ul style=\"margin: 10px 0; padding-left: 20px;\">';\n                connections.slice(0, 10).forEach(link => {\n                    const otherNode = link.source.id === node.id ? link.target : link.source;\n                    html += `<li>${link.type.replace(/_/g, ' ')}: ${otherNode.label}</li>`;\n                });\n                if (connections.length > 10) {\n                    html += `<li>...and ${connections.length - 10} more</li>`;\n                }\n                html += '</ul>';\n            }\n            \n            if (node.details && node.details.length > 0) {\n                html += '<p><strong>Associated Files:</strong></p>';\n                html += '<ul style=\"margin: 10px 0; padding-left: 20px; max-height: 150px; overflow-y: auto;\">';\n                node.details.slice(0, 10).forEach(file => {\n                    html += `<li>${file}</li>`;\n                });\n                if (node.details.length > 10) {\n                    html += `<li>...and ${node.details.length - 10} more</li>`;\n                }\n                html += '</ul>';\n            }\n            \n            detailsContent.innerHTML = html;\n            detailsPanel.style.display = 'block';\n        }\n        \n        function resetGraph() {\n            if (graphSimulation) {\n                graphSimulation.alpha(1).restart();\n            }\n        }\n        \n        function centerGraph() {\n            if (graphSvg) {\n                graphSvg.transition().duration(750).call(\n                    d3.zoom().transform,\n                    d3.zoomIdentity\n                );\n            }\n        }\n        \n        function setChartDays(days) {\n            currentChartDays = days;\n            \n            // Update button states\n            document.querySelectorAll('.chart-btn').forEach(btn => {\n                btn.classList.remove('active');\n            });\n            event.target.classList.add('active');\n            \n            loadDailyChart();\n        }\n        \n        function loadData() {\n            loadStats();\n            loadScans();\n            // Heavy components loaded lazily - see switchView()\n        }\n        \n        function loadDataWithoutMap() {\n            loadStats();\n            loadScans();\n        }\n        \n        // Track which analytics have been loaded\n        let analyticsLoaded = false;\n        \n        function loadAnalytics() {\n            console.log('Loading analytics view...');\n            loadDailyChart();\n            loadMalwareSources();\n            loadNoisyAgentsChart();\n            loadSignatureClassChart();\n            loadPackerClassChart();\n            loadConfidenceHistChart();\n            loadEntropyBoxChart();\n            loadEmergingThreats();\n            loadCorrelationGraph();\n            loadGeoMap();\n            \n            analyticsLoaded = true;\n        }\n        \n        // Initial load - only dashboard essentials\n        loadData();\n        \n        // Auto-scroll functionality with visual indicators\n        const scrollIndicatorUp = document.createElement('div');\n        scrollIndicatorUp.className = 'scroll-indicator scroll-up';\n        scrollIndicatorUp.innerHTML = '<i class=\"fas fa-chevron-up\"></i>';\n        document.body.appendChild(scrollIndicatorUp);\n        \n        const scrollIndicatorDown = document.createElement('div');\n        scrollIndicatorDown.className = 'scroll-indicator scroll-down';\n        scrollIndicatorDown.innerHTML = '<i class=\"fas fa-chevron-down\"></i>';\n        document.body.appendChild(scrollIndicatorDown);\n        \n        let pageScrollInterval = null;\n        const scrollSpeed = 3;\n        const triggerZone = 80; // pixels from top/bottom\n        \n        function handleAutoScroll(event) {\n            // Don't auto-scroll if page is hidden\n            if (document.hidden) return;\n            \n            const mouseY = event.clientY;\n            const windowHeight = window.innerHeight;\n            \n            // Check if near top\n            if (mouseY < triggerZone) {\n                scrollIndicatorUp.classList.add('visible');\n                scrollIndicatorDown.classList.remove('visible');\n                \n                if (!pageScrollInterval) {\n                    pageScrollInterval = setInterval(() => {\n                        if (document.hidden) {\n                            stopAutoScroll();\n                            return;\n                        }\n                        window.scrollBy({\n                            top: -scrollSpeed,\n                            behavior: 'auto'\n                        });\n                    }, 16); // ~60fps\n                }\n            }\n            // Check if near bottom\n            else if (mouseY > windowHeight - triggerZone) {\n                scrollIndicatorDown.classList.add('visible');\n                scrollIndicatorUp.classList.remove('visible');\n                \n                if (!pageScrollInterval) {\n                    pageScrollInterval = setInterval(() => {\n                        if (document.hidden) {\n                            stopAutoScroll();\n                            return;\n                        }\n                        window.scrollBy({\n                            top: scrollSpeed,\n                            behavior: 'auto'\n                        });\n                    }, 16);\n                }\n            }\n            // In neutral zone\n            else {\n                scrollIndicatorUp.classList.remove('visible');\n                scrollIndicatorDown.classList.remove('visible');\n                \n                if (pageScrollInterval) {\n                    clearInterval(pageScrollInterval);\n                    pageScrollInterval = null;\n                }\n            }\n        }\n        \n        function stopAutoScroll() {\n            scrollIndicatorUp.classList.remove('visible');\n            scrollIndicatorDown.classList.remove('visible');\n            \n            if (pageScrollInterval) {\n                clearInterval(pageScrollInterval);\n                pageScrollInterval = null;\n            }\n        }\n        \n        // Attach event listeners\n        document.addEventListener('mousemove', handleAutoScroll);\n        document.addEventListener('mouseleave', stopAutoScroll);\n        \n        // Stop scrolling when reaching top or bottom\n        let lastScrollTop = 0;\n        window.addEventListener('scroll', () => {\n            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n            const scrollHeight = document.documentElement.scrollHeight;\n            const clientHeight = document.documentElement.clientHeight;\n            \n            // At top\n            if (scrollTop === 0 && lastScrollTop > 0) {\n                stopAutoScroll();\n            }\n            // At bottom\n            if (scrollTop + clientHeight >= scrollHeight - 5) {\n                stopAutoScroll();\n            }\n            \n            lastScrollTop = scrollTop;\n        });\n        \n        // Set up Server-Sent Events for real-time updates\n        const eventSource = new EventSource('/api/events');\n        let updateDebounceTimer = null;\n        let pollingInterval = null;\n        let pendingUpdates = false;\n        \n        eventSource.onmessage = function(event) {\n            const data = JSON.parse(event.data);\n            \n            if (data.type === 'connected') {\n                console.log('Connected to server for real-time updates');\n            } else if (data.type === 'new-scan') {\n                console.log('New scan received:', data.scan.detected_filename);\n                \n                // Show notification toast\n                showThreatNotification(data.scan);\n                \n                // Add to threat ticker\n                addToThreatTicker(data.scan);\n                \n                // Debounce: batch multiple rapid scans into single update\n                pendingUpdates = true;\n                clearTimeout(updateDebounceTimer);\n                updateDebounceTimer = setTimeout(() => {\n                    if (pendingUpdates) {\n                        // Only reload lightweight data (stats + scan list)\n                        loadStats();\n                        loadScans();\n                        \n                        // If analytics view is open, refresh analytics too\n                        if (currentView === 'analytics' && analyticsLoaded) {\n                            loadAnalytics();\n                        }\n                        \n                        pendingUpdates = false;\n                        \n                        // Throttle map updates to once per 15 seconds\n                        if (!window.lastMapUpdate || Date.now() - window.lastMapUpdate > 15000) {\n                            loadGeoMap();\n                            window.lastMapUpdate = Date.now();\n                        }\n                    }\n                }, 1000); // Wait 1 second after last scan\n            }\n        };\n        \n        eventSource.onerror = function(error) {\n            console.error('SSE Error:', error);\n            // Fallback: reload data every 30 seconds if SSE connection fails (only once!)\n            if (eventSource.readyState === EventSource.CLOSED && !pollingInterval) {\n                console.log('SSE connection closed, falling back to polling...');\n                pollingInterval = setInterval(() => {\n                    loadStats();\n                    loadScans();\n                }, 30000);\n            }\n        };\n        \n        // Manual refresh button functionality\n        window.manualRefresh = function() {\n            loadData();\n        };\n    </script>\n    \n    <!-- Theme Toggle Script -->\n    <script>\n        // Theme Toggle Functionality\n        window.toggleTheme = function() {\n            const html = document.documentElement;\n            const currentTheme = html.getAttribute('data-theme');\n            const newTheme = currentTheme === 'light' ? '' : 'light';\n            \n            if (newTheme) {\n                html.setAttribute('data-theme', newTheme);\n            } else {\n                html.removeAttribute('data-theme');\n            }\n            localStorage.setItem('theme', newTheme || 'dark');\n            \n            // Update button icon and text\n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            if (newTheme === 'light') {\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n            } else {\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n            }\n        };\n        \n        // Load saved theme on page load\n        (function() {\n            const savedTheme = localStorage.getItem('theme') || 'dark';\n            if (savedTheme === 'light') {\n                document.documentElement.setAttribute('data-theme', 'light');\n            }\n            \n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            if (savedTheme === 'light') {\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n            } else {\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n            }\n        })();\n    </script>\n</body>\n</html>","epoch":3,"telemetryInfo":{}}],["file:///home/trang/localnsv/mAIware-server/public/styles.css::request_1af10ca8-d17d-442e-8756-8e3e11e7af34",{"uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/styles.css","external":"file:///home/trang/localnsv/mAIware-server/public/styles.css","path":"/home/trang/localnsv/mAIware-server/public/styles.css","scheme":"file"},"requestId":"request_1af10ca8-d17d-442e-8756-8e3e11e7af34","content":":root {\n    --bg-primary: #000000;\n    --bg-secondary: #0a0a0a;\n    --bg-card: #0f0f0f;\n    --bg-hover: #151515;\n    --text-primary: #e8f0e8;\n    --text-secondary: #9ca3af;\n    --accent-green: #39ff14;\n    --accent-green-dim: #2ed60f;\n    --accent-yellow: #ffd700;\n    --accent-red: #ff3b3b;\n    --accent-red-dim: #cc2f2f;\n    --border-color: #1a1a1a;\n    --shadow-color: rgba(0, 0, 0, 0.5);\n    --success-glow: rgba(57, 255, 20, 0.3);\n    --danger-glow: rgba(255, 59, 59, 0.3);\n    --warning-glow: rgba(255, 215, 0, 0.3);\n}\n\n[data-theme=\"light\"] {\n    --bg-primary: #f0f4f0;\n    --bg-secondary: #ffffff;\n    --bg-card: #fafafa;\n    --bg-hover: #e8f5e8;\n    --text-primary: #1a1f2e;\n    --text-secondary: #4a5568;\n    --accent-green: #2ed60f;\n    --accent-green-dim: #27b00c;\n    --accent-yellow: #cc9a00;\n    --accent-red: #dc2626;\n    --accent-red-dim: #b91c1c;\n    --border-color: #d1d5db;\n    --shadow-color: rgba(0, 0, 0, 0.1);\n    --success-glow: rgba(46, 214, 15, 0.2);\n    --danger-glow: rgba(220, 38, 38, 0.2);\n    --warning-glow: rgba(204, 154, 0, 0.2);\n}\n\n* { \n    margin: 0; \n    padding: 0; \n    box-sizing: border-box; \n}\n\nbody {\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    background: var(--bg-primary);\n    color: var(--text-primary);\n    min-height: 100vh;\n    margin: 0;\n    overflow-x: hidden;\n    position: relative;\n}\n\nbody::before {\n    content: '';\n    position: fixed;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: \n        radial-gradient(circle at 20% 50%, rgba(57, 255, 20, 0.08) 0%, transparent 50%),\n        radial-gradient(circle at 80% 80%, rgba(57, 255, 20, 0.06) 0%, transparent 50%),\n        radial-gradient(circle at 40% 20%, rgba(57, 255, 20, 0.05) 0%, transparent 50%);\n    animation: backgroundGlow 15s ease-in-out infinite;\n    pointer-events: none;\n    z-index: 0;\n}\n\n@keyframes backgroundGlow {\n    0%, 100% { \n        transform: translate(0, 0) scale(1);\n        opacity: 0.4;\n    }\n    33% { \n        transform: translate(10%, 10%) scale(1.1);\n        opacity: 0.6;\n    }\n    66% { \n        transform: translate(-10%, 5%) scale(0.95);\n        opacity: 0.5;\n    }\n}\n\nbody > * {\n    position: relative;\n    z-index: 1;\n}\n\n/* Side Panel Navigation */\n.side-panel {\n    position: fixed;\n    left: 0;\n    top: 0;\n    height: 100vh;\n    width: 70px;\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border-right: 1px solid rgba(57, 255, 20, 0.2);\n    box-shadow: 0 0 30px rgba(57, 255, 20, 0.1);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    z-index: 9999;\n    transition: all 0.3s ease;\n}\n\n.side-panel:hover {\n    background: rgba(15, 15, 15, 0.8);\n    box-shadow: 0 0 40px rgba(57, 255, 20, 0.2);\n}\n\n.panel-icon-strip {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 2rem 0;\n}\n\n.panel-logo-icon {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 50px;\n    height: 50px;\n    color: var(--accent-green);\n    font-size: 2rem;\n    animation: pulse-glow 3s ease-in-out infinite;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.panel-logo-icon:hover {\n    transform: scale(1.1);\n    filter: drop-shadow(0 0 20px var(--success-glow));\n}\n\n@keyframes pulse-glow {\n    0%, 100% { filter: drop-shadow(0 0 5px var(--success-glow)); }\n    50% { filter: drop-shadow(0 0 15px var(--success-glow)) drop-shadow(0 0 25px var(--success-glow)); }\n}\n\n/* Graphs Preview Grid */\n.graphs-preview {\n    position: fixed;\n    left: 70px;\n    top: 50%;\n    transform: translateY(-50%) translateX(-100%);\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-left: none;\n    border-radius: 0 12px 12px 0;\n    padding: 2rem;\n    width: 480px;\n    max-height: 90vh;\n    overflow-y: auto;\n    opacity: 0;\n    visibility: hidden;\n    pointer-events: none;\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease, visibility 0.3s;\n    box-shadow: 5px 0 40px rgba(57, 255, 20, 0.15);\n    z-index: 9998;\n    will-change: transform, opacity;\n}\n\n.graphs-preview::-webkit-scrollbar {\n    width: 6px;\n}\n\n.graphs-preview::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 3px;\n}\n\n.graphs-preview::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 3px;\n}\n\n.graphs-preview.show {\n    opacity: 1;\n    visibility: visible;\n    pointer-events: auto;\n    transform: translateY(-50%) translateX(0);\n}\n\n.preview-header {\n    margin-bottom: 1rem;\n    padding-bottom: 0.8rem;\n    border-bottom: 1px solid var(--border-color);\n}\n\n.preview-header h3 {\n    color: var(--accent-green);\n    font-size: 1.1rem;\n    margin-bottom: 0.3rem;\n}\n\n.preview-header p {\n    color: var(--text-secondary);\n    font-size: 0.85rem;\n}\n\n/* Analytics Miniview - Scaled down live view */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-content {\n    width: 100%;\n    height: 100%;\n    transform-origin: top left;\n    transform: scale(0.25);\n    width: 400%;\n    height: 400%;\n    pointer-events: none;\n    overflow: hidden;\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n.preview-home-nav {\n    margin-top: 1.5rem;\n    padding: 1rem;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 10px;\n    display: flex;\n    align-items: center;\n    gap: 0.8rem;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    opacity: 0;\n    visibility: hidden;\n    transform: translateY(10px);\n}\n\n.preview-home-nav.visible {\n    opacity: 1;\n    visibility: visible;\n    transform: translateY(0);\n}\n\n.preview-home-nav:hover {\n    background: var(--bg-hover);\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.preview-home-nav i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n}\n\n.preview-home-nav span {\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--text-primary);\n}\n\n.preview-label {\n    flex: 1;\n    font-size: 0.95rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    letter-spacing: 0.3px;\n}\n\n/* Analytics Miniview - Screenshot preview */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    padding: 1.5rem;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-preview {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    opacity: 0.7;\n}\n\n.preview-row {\n    display: flex;\n    gap: 1rem;\n    flex: 1;\n}\n\n.preview-box {\n    flex: 1;\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 6px;\n    position: relative;\n    overflow: hidden;\n    padding: 0.5rem;\n}\n\n.preview-box.large {\n    flex: 2;\n}\n\n.preview-box.wide {\n    flex: 1;\n    min-height: 150px;\n}\n\n.box-header {\n    font-size: 0.65rem;\n    color: var(--accent-green);\n    margin-bottom: 0.5rem;\n    opacity: 0.8;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.box-content {\n    height: calc(100% - 1.5rem);\n    position: relative;\n}\n\n.map-visual {\n    background: radial-gradient(circle at center, rgba(57, 255, 20, 0.05), transparent);\n    position: relative;\n}\n\n.map-dot {\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 10px var(--accent-green);\n    animation: map-pulse 2s ease-in-out infinite;\n}\n\n.map-dot:nth-child(2) { animation-delay: 0.5s; }\n.map-dot:nth-child(3) { animation-delay: 1s; }\n\n@keyframes map-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.6; }\n    50% { transform: scale(1.5); opacity: 1; }\n}\n\n.chart-visual {\n    display: flex;\n    align-items: flex-end;\n    justify-content: space-around;\n    height: 100%;\n    padding: 0.5rem;\n    gap: 0.3rem;\n}\n\n.chart-bar {\n    flex: 1;\n    background: linear-gradient(180deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    animation: bar-grow 2s ease-in-out infinite;\n    opacity: 0.7;\n}\n\n.chart-bar:nth-child(2) { animation-delay: 0.2s; }\n.chart-bar:nth-child(3) { animation-delay: 0.4s; }\n.chart-bar:nth-child(4) { animation-delay: 0.6s; }\n\n@keyframes bar-grow {\n    0%, 100% { transform: scaleY(0.8); }\n    50% { transform: scaleY(1); }\n}\n\n.list-visual {\n    display: flex;\n    flex-direction: column;\n    gap: 0.4rem;\n    padding: 0.3rem;\n}\n\n.list-item {\n    height: 0.4rem;\n    background: linear-gradient(90deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    opacity: 0.6;\n    animation: list-fade 3s ease-in-out infinite;\n}\n\n.list-item:nth-child(2) { animation-delay: 0.5s; width: 80%; }\n.list-item:nth-child(3) { animation-delay: 1s; width: 60%; }\n\n@keyframes list-fade {\n    0%, 100% { opacity: 0.4; }\n    50% { opacity: 0.8; }\n}\n\n.network-visual {\n    position: relative;\n    height: 100%;\n}\n\n.network-node {\n    position: absolute;\n    width: 6px;\n    height: 6px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 8px var(--accent-green);\n    animation: node-pulse 3s ease-in-out infinite;\n}\n\n.network-node:nth-child(2) { animation-delay: 0.7s; }\n.network-node:nth-child(3) { animation-delay: 1.4s; }\n\n@keyframes node-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.5; }\n    50% { transform: scale(1.3); opacity: 1; }\n}\n\n.heat-visual {\n    background: \n        radial-gradient(circle at 30% 30%, rgba(57, 255, 20, 0.3), transparent 40%),\n        radial-gradient(circle at 70% 60%, rgba(57, 255, 20, 0.2), transparent 40%),\n        radial-gradient(circle at 50% 80%, rgba(57, 255, 20, 0.25), transparent 40%);\n    animation: heat-shift 4s ease-in-out infinite;\n}\n\n@keyframes heat-shift {\n    0%, 100% { opacity: 0.5; }\n    50% { opacity: 0.8; }\n}\n\n.pie-visual {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n}\n\n.pie-chart {\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    background: conic-gradient(\n        var(--accent-green) 0deg 120deg,\n        var(--accent-yellow) 120deg 240deg,\n        var(--accent-red) 240deg 360deg\n    );\n    box-shadow: 0 0 15px rgba(57, 255, 20, 0.4);\n    animation: pie-spin 10s linear infinite;\n}\n\n@keyframes pie-spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n\n/* Main Content Area */\n.main-content {\n    margin-left: 70px;\n    min-height: 100vh;\n    padding: 2rem;\n    transition: margin-left 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    position: relative;\n}\n\n/* Backdrop overlay for preview panel */\n.preview-backdrop {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    background: rgba(0, 0, 0, 0.4);\n    backdrop-filter: blur(2px);\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    z-index: 9998;\n    pointer-events: none;\n}\n\n.preview-backdrop.show {\n    opacity: 1;\n    visibility: visible;\n}\n\n/* View Containers */\n.view-container {\n    display: none;\n    animation: fadeIn 0.4s ease-in-out;\n}\n\n.view-container.active {\n    display: block;\n}\n\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n        transform: translateY(10px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n/* Dashboard Header */\n.dashboard-header {\n    text-align: center;\n    margin-bottom: 2.5rem;\n}\n\n.header-content h1 {\n    font-size: 2.5rem;\n    margin-bottom: 0.5rem;\n    color: var(--accent-green);\n    font-weight: 700;\n    letter-spacing: 2px;\n}\n\n.header-content .subtitle {\n    font-size: 1.2rem;\n    color: var(--text-secondary);\n    font-weight: 500;\n}\n\n.pulse-icon {\n    display: inline-block;\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n@keyframes pulse-scale {\n    0%, 100% {\n        transform: scale(1);\n        filter: drop-shadow(0 0 5px var(--success-glow));\n    }\n    50% {\n        transform: scale(1.05);\n        filter: drop-shadow(0 0 15px var(--success-glow));\n    }\n}\n\n/* Animations */\n.animate-slide-in {\n    animation: slideIn 0.6s ease-out;\n}\n\n@keyframes slideIn {\n    from {\n        opacity: 0;\n        transform: translateX(-30px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n.animate-fade-in {\n    animation: fadeInUp 0.6s ease-out;\n}\n\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.container {\n    max-width: 1400px;\n    margin: 0 auto;\n}\n\n/* Theme Toggle Button */\n.theme-toggle {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    background: rgba(15, 15, 15, 0.85);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50px;\n    padding: 10px 20px;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    font-size: 1rem;\n    color: var(--text-primary);\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px rgba(57, 255, 20, 0.2);\n    font-weight: 600;\n}\n\n.theme-toggle:hover {\n    background: rgba(15, 15, 15, 0.8);\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.theme-toggle .icon {\n    font-size: 1.2rem;\n}\n\n/* Auto-scroll indicators */\n.scroll-indicator {\n    position: fixed;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 60px;\n    height: 60px;\n    background: rgba(57, 255, 20, 0.15);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 2px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    opacity: 0;\n    pointer-events: none;\n    transition: opacity 0.3s ease;\n    z-index: 10001;\n}\n\n.scroll-indicator.visible {\n    opacity: 1;\n    animation: scroll-pulse 1.5s ease-in-out infinite;\n}\n\n.scroll-indicator.scroll-up {\n    top: 20px;\n}\n\n.scroll-indicator.scroll-down {\n    bottom: 20px;\n}\n\n.scroll-indicator i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    animation: scroll-bounce 1s ease-in-out infinite;\n}\n\n.scroll-up i {\n    animation-name: scroll-bounce-up;\n}\n\n.scroll-down i {\n    animation-name: scroll-bounce-down;\n}\n\n@keyframes scroll-pulse {\n    0%, 100% {\n        box-shadow: 0 0 10px rgba(57, 255, 20, 0.3);\n    }\n    50% {\n        box-shadow: 0 0 25px rgba(57, 255, 20, 0.6);\n    }\n}\n\n@keyframes scroll-bounce-up {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(-5px);\n    }\n}\n\n@keyframes scroll-bounce-down {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(5px);\n    }\n}\n\n/* Threat Ticker */\n.threat-ticker-container {\n    background: var(--bg-secondary);\n    border: 2px solid var(--accent-green);\n    border-radius: 8px;\n    padding: 12px;\n    margin-bottom: 2rem;\n    display: flex;\n    align-items: center;\n    gap: 16px;\n    overflow: hidden;\n    box-shadow: 0 2px 8px var(--success-glow);\n}\n\n.ticker-label {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 8px 16px;\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    border-radius: 6px;\n    font-weight: 700;\n    font-size: 0.75rem;\n    color: #fff;\n    white-space: nowrap;\n    box-shadow: 0 2px 8px rgba(255, 71, 87, 0.4);\n}\n\n.ticker-label i {\n    animation: pulse-broadcast 2s infinite;\n}\n\n@keyframes pulse-broadcast {\n    0%, 100% { opacity: 1; transform: scale(1); }\n    50% { opacity: 0.6; transform: scale(0.9); }\n}\n\n.threat-ticker {\n    flex: 1;\n    overflow: hidden;\n    position: relative;\n}\n\n.ticker-content {\n    display: flex;\n    gap: 40px;\n    white-space: nowrap;\n    animation: scroll-ticker 30s linear infinite;\n}\n\n.ticker-content:hover {\n    animation-play-state: paused;\n}\n\n@keyframes scroll-ticker {\n    0% { transform: translateX(0); }\n    100% { transform: translateX(-50%); }\n}\n\n.ticker-item {\n    color: #e0e0e0;\n    font-size: 0.9rem;\n    display: inline-flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.ticker-item i {\n    font-size: 0.5rem;\n    animation: blink 1.5s infinite;\n}\n\n@keyframes blink {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.3; }\n}\n\n/* Notification System */\n.notification-container {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    max-width: 400px;\n}\n\n.threat-notification {\n    background: rgba(30, 30, 30, 0.98);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 8px;\n    padding: 16px;\n    display: flex;\n    gap: 12px;\n    align-items: flex-start;\n    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);\n    transform: translateX(450px);\n    opacity: 0;\n    transition: all 0.3s ease-out;\n}\n\n.threat-notification.show {\n    transform: translateX(0);\n    opacity: 1;\n}\n\n.notification-icon {\n    font-size: 1.5rem;\n    flex-shrink: 0;\n}\n\n.notification-content {\n    flex: 1;\n}\n\n.notification-title {\n    font-size: 0.95rem;\n    color: #e0e0e0;\n    margin-bottom: 4px;\n}\n\n.notification-title strong {\n    text-transform: uppercase;\n    font-weight: 800;\n}\n\n.notification-details {\n    font-size: 0.85rem;\n    color: #b0b0b0;\n    margin-bottom: 6px;\n}\n\n.notification-meta {\n    font-size: 0.75rem;\n    color: #888;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.notification-close {\n    cursor: pointer;\n    color: #666;\n    transition: color 0.2s;\n    font-size: 0.9rem;\n}\n\n.notification-close:hover {\n    color: #e0e0e0;\n}\n\n/* Stat Card Pulse Animation */\n.stat-pulse {\n    animation: stat-pulse-animation 0.6s ease-out;\n}\n\n@keyframes stat-pulse-animation {\n    0% { transform: scale(1); }\n    50% { transform: scale(1.05); box-shadow: 0 8px 24px rgba(90, 156, 248, 0.4); }\n    100% { transform: scale(1); }\n}\n\nh1 {\n    font-size: 2.5rem;\n    color: #5a9cf8;\n    margin-bottom: 0.5rem;\n}\n\n.subtitle {\n    color: #888;\n    font-size: 1.1rem;\n}\n\n.stats-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1.5rem;\n    margin-bottom: 3rem;\n}\n\n.stat-card {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 1.5rem;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.8rem;\n    position: relative;\n    overflow: hidden;\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.stat-card::before {\n    content: '';\n    position: absolute;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: radial-gradient(circle, var(--accent-green) 0%, transparent 70%);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover::before {\n    opacity: 0.05;\n}\n\n.stat-card:hover {\n    transform: translateY(-5px) scale(1.02);\n    border-color: var(--accent-green);\n    box-shadow: 0 10px 30px var(--success-glow);\n}\n\n.stat-card i {\n    font-size: 2.5rem;\n    opacity: 0.8;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover i {\n    transform: scale(1.1) rotateY(180deg);\n    opacity: 1;\n}\n\n.stat-number {\n    font-size: 2.5rem;\n    font-weight: 700;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover .stat-number {\n    transform: scale(1.1);\n    text-shadow: 0 0 20px currentColor;\n}\n\n.stat-label {\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n    font-weight: 600;\n}\n\n.stat-glow {\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    height: 3px;\n    background: linear-gradient(90deg, transparent, var(--accent-green), transparent);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover .stat-glow {\n    opacity: 1;\n    animation: glowSlide 2s ease-in-out infinite;\n}\n\n@keyframes glowSlide {\n    0%, 100% {\n        transform: translateX(-100%);\n    }\n    50% {\n        transform: translateX(100%);\n    }\n}\n\n.stat-card.malware {\n    border-color: rgba(255, 59, 59, 0.3);\n}\n\n.stat-card.malware i,\n.stat-card.malware .stat-number {\n    color: var(--accent-red);\n}\n\n.stat-card.malware:hover {\n    border-color: var(--accent-red);\n    box-shadow: 0 10px 30px var(--danger-glow);\n}\n\n.stat-card.suspicious {\n    border-color: rgba(255, 215, 0, 0.3);\n}\n\n.stat-card.suspicious i,\n.stat-card.suspicious .stat-number {\n    color: var(--accent-yellow);\n}\n\n.stat-card.suspicious:hover {\n    border-color: var(--accent-yellow);\n    box-shadow: 0 10px 30px var(--warning-glow);\n}\n\n.stat-card.benign i,\n.stat-card.benign .stat-number,\n.stat-card.info i,\n.stat-card.info .stat-number {\n    color: var(--accent-green);\n}\n\n/* Analytics View */\n.analytics-header {\n    display: flex;\n    align-items: center;\n    gap: 2rem;\n    margin-bottom: 2.5rem;\n}\n\n.back-btn {\n    background: var(--bg-card);\n    border: 2px solid var(--accent-green);\n    color: var(--accent-green);\n    padding: 0.8rem 1.5rem;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 600;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    transition: all 0.3s ease;\n}\n\n.back-btn:hover {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    transform: translateX(-5px);\n    box-shadow: 0 5px 20px var(--success-glow);\n}\n\n.analytics-header h1 {\n    font-size: 2rem;\n    color: var(--accent-green);\n    font-weight: 700;\n}\n\n.analytics-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));\n    gap: 2rem;\n    max-height: calc(100vh - 200px);\n    overflow-y: auto;\n    padding-right: 1rem;\n    grid-auto-flow: dense;\n}\n\n/* Panel size classes for flexible tiling */\n.analytics-panel.panel-small {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-medium {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-large {\n    grid-column: span 2;\n}\n\n@media (max-width: 1400px) {\n    .analytics-grid {\n        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));\n    }\n    \n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n}\n\n.analytics-grid::-webkit-scrollbar {\n    width: 8px;\n}\n\n.analytics-grid::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb:hover {\n    background: var(--accent-green-dim);\n}\n\n.analytics-panel {\n    animation: slideInPanel 0.5s ease-out;\n    animation-fill-mode: backwards;\n}\n\n.analytics-panel:nth-child(1) { animation-delay: 0.05s; }\n.analytics-panel:nth-child(2) { animation-delay: 0.1s; }\n.analytics-panel:nth-child(3) { animation-delay: 0.15s; }\n.analytics-panel:nth-child(4) { animation-delay: 0.2s; }\n.analytics-panel:nth-child(5) { animation-delay: 0.25s; }\n.analytics-panel:nth-child(6) { animation-delay: 0.3s; }\n\n@keyframes slideInPanel {\n    from {\n        opacity: 0;\n        transform: translateY(30px) scale(0.95);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n    }\n}\n\n/* Advanced Analytics Grid for Mini Charts */\n.advanced-analytics-grid {\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 12px;\n    padding: 1.5rem;\n}\n\n.mini-charts-grid {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 1.5rem;\n    margin-top: 1rem;\n}\n\n.mini-chart-container {\n    background: rgba(10, 10, 10, 0.6);\n    border: 1px solid rgba(57, 255, 20, 0.15);\n    border-radius: 8px;\n    padding: 1rem;\n}\n\n.mini-chart-container h3 {\n    color: var(--accent-green);\n    font-size: 0.95rem;\n    margin: 0 0 0.75rem 0;\n    font-weight: 600;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.mini-chart-container h3 i {\n    font-size: 0.9rem;\n}\n\n@media (max-width: 1200px) {\n    .mini-charts-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n/* Emerging Threat Intelligence Panel */\n.eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.1) 0%, rgba(255, 165, 2, 0.1) 100%);\n    border: 2px solid rgba(255, 71, 87, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(255, 71, 87, 0.2);\n}\n\n.eti-header {\n    margin-bottom: 24px;\n}\n\n.eti-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #ff6b6b;\n    text-shadow: 0 2px 4px rgba(255, 71, 87, 0.3);\n}\n\n.eti-header h2 i {\n    color: #ff4757;\n    margin-right: 10px;\n    animation: pulse 2s infinite;\n}\n\n@keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.6; }\n}\n\n.eti-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 8px 0 16px 0;\n}\n\n.eti-summary {\n    display: flex;\n    gap: 12px;\n    flex-wrap: wrap;\n}\n\n.eti-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 6px 14px;\n    border-radius: 20px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.eti-badge.recent {\n    background: rgba(255, 71, 87, 0.2);\n    border-color: rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.eti-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n    gap: 20px;\n}\n\n.eti-panel {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 18px;\n    transition: transform 0.3s, box-shadow 0.3s;\n}\n\n.eti-panel:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);\n}\n\n.eti-panel h3 {\n    margin: 0 0 6px 0;\n    font-size: 1.1rem;\n    color: #e0e0e0;\n}\n\n.eti-panel h3 i {\n    color: #ffa502;\n    margin-right: 8px;\n}\n\n.eti-subtitle-small {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 14px;\n}\n\n.eti-list {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n}\n\n.eti-item {\n    display: flex;\n    gap: 12px;\n    background: rgba(255, 255, 255, 0.03);\n    border: 1px solid rgba(255, 255, 255, 0.08);\n    border-radius: 8px;\n    padding: 12px;\n    transition: all 0.3s;\n}\n\n.eti-item:hover {\n    background: rgba(255, 255, 255, 0.06);\n    border-color: rgba(255, 165, 2, 0.4);\n    transform: translateX(4px);\n}\n\n.eti-rank {\n    flex-shrink: 0;\n    width: 32px;\n    height: 32px;\n    background: linear-gradient(135deg, #ff6b6b, #ffa502);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: bold;\n    font-size: 1rem;\n    color: #fff;\n    box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);\n}\n\n.eti-item[data-rank=\"1\"] .eti-rank {\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    transform: scale(1.1);\n}\n\n.eti-content {\n    flex: 1;\n    min-width: 0;\n}\n\n.eti-name {\n    font-weight: 600;\n    color: #e0e0e0;\n    font-size: 0.95rem;\n    margin-bottom: 4px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-meta {\n    display: flex;\n    gap: 8px;\n    flex-wrap: wrap;\n    align-items: center;\n}\n\n.eti-count {\n    color: #888;\n    font-size: 0.8rem;\n}\n\n.eti-recent-badge {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-agent-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-details {\n    margin-top: 6px;\n    color: #999;\n    font-size: 0.75rem;\n    font-style: italic;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-empty {\n    text-align: center;\n    color: #666;\n    padding: 20px;\n    font-style: italic;\n}\n\n/* Threat Modeler */\n.modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.1) 0%, rgba(38, 222, 129, 0.1) 100%);\n    border: 2px solid rgba(90, 156, 248, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(90, 156, 248, 0.2);\n}\n\n.modeler-header {\n    margin-bottom: 24px;\n}\n\n.modeler-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #5a9cf8;\n}\n\n.modeler-header h2 i {\n    color: #26de81;\n    margin-right: 10px;\n}\n\n.modeler-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 0;\n}\n\n.modeler-grid {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 24px;\n}\n\n@media (max-width: 1024px) {\n    .modeler-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n.modeler-builder,\n.modeler-results {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 20px;\n}\n\n.modeler-builder h3,\n.modeler-results h3 {\n    margin: 0 0 20px 0;\n    font-size: 1.2rem;\n    color: #e0e0e0;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n    padding-bottom: 10px;\n}\n\n.modeler-builder h3 i {\n    color: #26de81;\n    margin-right: 8px;\n}\n\n.modeler-results h3 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.modeler-field {\n    margin-bottom: 20px;\n}\n\n.modeler-field label {\n    display: block;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n    margin-bottom: 6px;\n    font-weight: 600;\n}\n\n.modeler-select {\n    width: 100%;\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.2);\n    border-radius: 6px;\n    color: #e0e0e0;\n    padding: 10px;\n    font-size: 0.9rem;\n    font-family: inherit;\n    cursor: pointer;\n    transition: all 0.3s;\n}\n\n.modeler-select:focus {\n    outline: none;\n    border-color: #5a9cf8;\n    background: rgba(90, 156, 248, 0.1);\n}\n\n.modeler-select option {\n    background: #1a1a2e;\n    color: #e0e0e0;\n    padding: 8px;\n}\n\n.modeler-hint {\n    display: block;\n    color: #666;\n    font-size: 0.75rem;\n    margin-top: 4px;\n    font-style: italic;\n}\n\n.modeler-analyze-btn {\n    width: 100%;\n    background: linear-gradient(135deg, #26de81, #20bf6b);\n    border: none;\n    color: #fff;\n    padding: 14px 24px;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 700;\n    cursor: pointer;\n    transition: all 0.3s;\n    box-shadow: 0 4px 12px rgba(38, 222, 129, 0.3);\n}\n\n.modeler-analyze-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(38, 222, 129, 0.4);\n}\n\n.modeler-analyze-btn i {\n    margin-right: 8px;\n}\n\n.modeler-output {\n    min-height: 400px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.modeler-placeholder {\n    text-align: center;\n    color: #666;\n}\n\n.modeler-placeholder i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n    opacity: 0.5;\n}\n\n.modeler-placeholder p {\n    font-size: 0.95rem;\n}\n\n.modeler-loading {\n    text-align: center;\n    color: #5a9cf8;\n}\n\n.modeler-loading i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.modeler-error {\n    text-align: center;\n    color: #ff4757;\n}\n\n.modeler-error i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.prediction-result {\n    width: 100%;\n}\n\n.prediction-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 24px;\n    padding: 20px;\n    background: rgba(255, 255, 255, 0.05);\n    border-radius: 8px;\n}\n\n.prediction-badge {\n    padding: 12px 24px;\n    border-radius: 8px;\n    font-size: 1.3rem;\n    font-weight: 800;\n    color: #fff;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n\n.prediction-confidence {\n    text-align: right;\n}\n\n.confidence-label {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 4px;\n}\n\n.confidence-value {\n    color: #5a9cf8;\n    font-size: 2rem;\n    font-weight: 800;\n}\n\n.prediction-family {\n    padding: 16px;\n    background: rgba(255, 71, 87, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 6px;\n    margin-bottom: 20px;\n    color: #e0e0e0;\n}\n\n.family-name {\n    color: #ff6b6b;\n    font-weight: 700;\n    font-size: 1.1rem;\n    margin-left: 8px;\n}\n\n.prediction-section {\n    margin-bottom: 20px;\n}\n\n.prediction-section h4 {\n    color: #5a9cf8;\n    font-size: 1rem;\n    margin: 0 0 12px 0;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 6px;\n}\n\n.analysis-item {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    padding: 8px 0;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n}\n\n.analysis-item i {\n    color: #ffa502;\n    width: 20px;\n}\n\n.indicator-group {\n    margin-bottom: 16px;\n}\n\n.indicator-group strong {\n    display: block;\n    color: #e0e0e0;\n    margin-bottom: 8px;\n    font-size: 0.9rem;\n}\n\n.indicator-list {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 8px;\n}\n\n.indicator-tag {\n    padding: 6px 12px;\n    border-radius: 6px;\n    font-size: 0.8rem;\n    font-weight: 600;\n    font-family: 'Courier New', monospace;\n}\n\n.api-tag {\n    background: rgba(255, 165, 2, 0.2);\n    border: 1px solid rgba(255, 165, 2, 0.4);\n    color: #ffa502;\n}\n\n.string-tag {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.prediction-footer {\n    margin-top: 20px;\n    padding: 12px;\n    background: rgba(90, 156, 248, 0.1);\n    border-radius: 6px;\n    color: #5a9cf8;\n    font-size: 0.85rem;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.scans-container {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 2rem;\n    transition: all 0.3s ease;\n}\n\n.scans-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--shadow-color);\n}\n\n.scans-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.scans-header h2 {\n    color: #5a9cf8;\n}\n\n.refresh-btn {\n    background: #5a9cf8;\n    color: white;\n    border: none;\n    padding: 0.75rem 1.5rem;\n    border-radius: 8px;\n    cursor: pointer;\n    font-size: 1rem;\n    transition: background 0.2s;\n}\n\n.refresh-btn:hover {\n    background: #4a8ce8;\n}\n\n.scans-table {\n    width: 100%;\n    border-collapse: collapse;\n}\n\n.scans-table th {\n    text-align: left;\n    padding: 1rem;\n    background: rgba(255, 255, 255, 0.05);\n    color: #5a9cf8;\n    font-weight: 600;\n}\n\n.scans-table td {\n    padding: 1rem;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.scans-table tr:hover {\n    background: rgba(255, 255, 255, 0.03);\n}\n\n.badge {\n    display: inline-block;\n    padding: 0.3rem 0.8rem;\n    border-radius: 6px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.badge.malware { background: #ff4757; color: white; }\n.badge.suspicious { background: #ffa502; color: white; }\n.badge.benign { background: #26de81; color: white; }\n.badge.non-pe { background: #4b5563; color: #fff; }\n\n.hash {\n    font-family: 'Courier New', monospace;\n    font-size: 0.85rem;\n    color: #888;\n}\n\n.empty-state {\n    text-align: center;\n    padding: 3rem;\n    color: #666;\n}\n\n.empty-state i {\n    font-size: 4rem;\n    margin-bottom: 1rem;\n    opacity: 0.3;\n}\n\n/* NEW: Chart Container Styles */\n.chart-container {\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 12px;\n    padding: 2rem;\n    margin-top: 2rem;\n}\n\n.chart-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.chart-header h2 {\n    color: var(--accent-green);\n    margin: 0;\n}\n\n.chart-subtitle {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    margin: 0.5rem 0 0 0;\n    font-weight: normal;\n}\n\n.chart-controls {\n    display: flex;\n    gap: 0.5rem;\n}\n\n.chart-btn {\n    background: rgba(255, 255, 255, 0.05);\n    color: #888;\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    padding: 0.5rem 1rem;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.2s;\n}\n\n.chart-btn:hover {\n    background: rgba(255, 255, 255, 0.1);\n    color: #e0e0e0;\n}\n\n.chart-btn.active {\n    background: #5a9cf8;\n    color: white;\n    border-color: #5a9cf8;\n}\n\n#dailyScansChart {\n    max-height: 400px;\n}\n\n@media (max-width: 1024px) {\n    .analytics-grid {\n        grid-template-columns: 1fr;\n        gap: 1.5rem;\n    }\n    \n    .analytics-panel.panel-small,\n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n    \n    .graphs-preview {\n        width: 400px;\n    }\n}\n\n@media (max-width: 768px) {\n    .main-content {\n        margin-left: 0;\n        padding: 1rem;\n    }\n    \n    .side-panel {\n        width: 50px;\n    }\n    \n    .panel-logo-icon {\n        width: 40px;\n        height: 40px;\n        font-size: 1.5rem;\n    }\n    \n    .graphs-preview {\n        left: 50px;\n        width: calc(100vw - 50px);\n        border-radius: 0;\n    }\n    \n    .dashboard-header h1 {\n        font-size: 1.8rem;\n    }\n    \n    .stats-grid {\n        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n        gap: 1rem;\n    }\n    \n    .chart-header {\n        flex-direction: column;\n        gap: 1rem;\n        align-items: flex-start;\n    }\n    \n    .chart-controls {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .chart-btn {\n        flex: 1;\n    }\n    \n    .map-view-toggle {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .map-btn {\n        flex: 1;\n        font-size: 0.8rem;\n        padding: 0.4rem 0.6rem;\n    }\n    \n    .geo-context-panel {\n        flex-direction: column;\n    }\n    \n    .context-stat {\n        width: 100%;\n    }\n    \n    .map-timeline-control {\n        flex-direction: column;\n        gap: 0.5rem;\n    }\n    \n    .timeline-info {\n        text-align: center;\n    }\n    \n    .analytics-header {\n        flex-direction: column;\n        align-items: flex-start;\n    }\n}\n\n/* Map Container */\n.map-container {\n    background: var(--bg-card);\n    border-radius: 12px;\n    padding: 24px;\n    box-shadow: 0 4px 12px var(--shadow-color);\n    border: 2px solid var(--border-color);\n    transition: all 0.3s ease;\n    min-height: 600px;\n}\n\n.map-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 8px 24px var(--shadow-color), 0 0 20px var(--success-glow);\n}\n\n#worldMap {\n    width: 100%;\n    height: 500px;\n    border-radius: 8px;\n    margin-bottom: 15px;\n    background: var(--bg-secondary);\n    border: 1px solid var(--border-color);\n    z-index: 1;\n    position: relative;\n}\n\n.map-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 20px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.map-header h2 {\n    margin: 0;\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-header h2 i {\n    color: var(--accent-green);\n    margin-right: 8px;\n}\n\n.map-controls {\n    display: flex;\n    gap: 20px;\n    align-items: center;\n    flex-wrap: wrap;\n}\n\n.map-view-toggle {\n    display: flex;\n    gap: 8px;\n    background: var(--bg-secondary);\n    padding: 4px;\n    border-radius: 8px;\n    border: 1px solid var(--border-color);\n}\n\n.map-btn {\n    background: transparent;\n    border: none;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.map-btn:hover {\n    background: var(--bg-hover);\n    color: var(--text-primary);\n}\n\n.map-btn.active {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    box-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-btn i {\n    font-size: 1rem;\n}\n\n.map-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.legend-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n}\n\n.legend-dot {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    box-shadow: 0 0 6px currentColor;\n}\n\n.malware-dot {\n    background-color: var(--accent-red);\n}\n\n.suspicious-dot {\n    background-color: var(--accent-yellow);\n}\n\n.benign-dot {\n    background-color: var(--accent-green);\n}\n\n.geo-context-panel {\n    display: flex;\n    justify-content: space-around;\n    gap: 20px;\n    padding: 15px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-bottom: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.context-stat {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 5px;\n}\n\n.context-label {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.context-value {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.context-value.threat-count {\n    color: var(--accent-red);\n    text-shadow: 0 0 10px var(--danger-glow);\n}\n\n.map-timeline-control {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 12px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-top: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.timeline-btn {\n    background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-green-dim) 100%);\n    color: var(--bg-primary);\n    border: none;\n    padding: 10px 20px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.95rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    box-shadow: 0 4px 12px var(--success-glow);\n}\n\n.timeline-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px var(--success-glow);\n    filter: brightness(1.1);\n}\n\n.timeline-btn i {\n    font-size: 1rem;\n}\n\n.timeline-info {\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-style: italic;\n}\n\n#worldMap {\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n}\n\n/* Leaflet popup customization for theme */\n.leaflet-popup-content-wrapper {\n    background: var(--bg-card) !important;\n    color: var(--text-primary) !important;\n    border: 2px solid var(--accent-green) !important;\n    box-shadow: 0 4px 15px var(--shadow-color) !important;\n    border-radius: 8px !important;\n}\n\n.leaflet-popup-tip {\n    background: var(--bg-card) !important;\n}\n\n.leaflet-popup-content h3 {\n    color: var(--accent-green) !important;\n}\n\n.leaflet-popup-content button {\n    background: var(--accent-green) !important;\n    color: var(--bg-primary) !important;\n    border: none !important;\n    padding: 8px 16px !important;\n    border-radius: 6px !important;\n    cursor: pointer !important;\n    font-weight: 600 !important;\n    transition: all 0.2s ease !important;\n}\n\n.leaflet-popup-content button:hover {\n    transform: translateY(-2px) !important;\n    box-shadow: 0 4px 12px var(--success-glow) !important;\n}\n\n/* Correlation Graph */\n.correlation-container {\n    background: rgba(255, 255, 255, 0.03);\n    border-radius: 12px;\n    padding: 24px;\n    margin-top: 24px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.correlation-header {\n    margin-bottom: 20px;\n}\n\n.correlation-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.5rem;\n    color: #e0e0e0;\n}\n\n.correlation-header h2 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.correlation-subtitle {\n    color: #888;\n    font-size: 0.9rem;\n    margin: 0;\n}\n\n.graph-controls {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 16px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.graph-btn {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.3s;\n}\n\n.graph-btn:hover {\n    background: rgba(90, 156, 248, 0.3);\n    border-color: #5a9cf8;\n}\n\n.graph-btn i {\n    margin-right: 6px;\n}\n\n.graph-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.node-sample {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    border: 2px solid #fff;\n}\n\n.malware-node {\n    background-color: #ff4757;\n}\n\n.agent-node {\n    background-color: #5a9cf8;\n}\n\n.api-node {\n    background-color: #ffa502;\n}\n\n.string-node {\n    background-color: #26de81;\n}\n\n#correlationGraph {\n    width: 100%;\n    min-height: 600px;\n    position: relative;\n    border-radius: 8px;\n    overflow: hidden;\n}\n\n.node-details {\n    position: absolute;\n    right: 24px;\n    top: 120px;\n    background: rgba(30, 30, 30, 0.95);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    border-radius: 8px;\n    padding: 16px;\n    max-width: 300px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    z-index: 1000;\n}\n\n.node-details h3 {\n    margin: 0 0 12px 0;\n    color: #5a9cf8;\n    font-size: 1.1rem;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 8px;\n}\n\n.node-details p {\n    margin: 8px 0;\n    color: #e0e0e0;\n    font-size: 0.9rem;\n}\n\n.node-details ul {\n    color: #b0b0b0;\n    font-size: 0.85rem;\n}\n\n.node-details li {\n    margin: 4px 0;\n}\n\n/* ========================================\n   LIGHT THEME CONTRAST FIXES\n   ======================================== */\n\n/* Fix 1 & 2: Analytics preview backgrounds - lighter for better green contrast */\n[data-theme=\"light\"] .eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.05) 0%, rgba(255, 165, 2, 0.05) 100%);\n    border-color: rgba(255, 71, 87, 0.2);\n}\n\n[data-theme=\"light\"] .modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.05) 0%, rgba(38, 222, 129, 0.05) 100%);\n    border-color: rgba(90, 156, 248, 0.2);\n}\n\n/* Fix 3: Theme toggle button text - darker for contrast */\n[data-theme=\"light\"] .theme-toggle {\n    color: #1a1f2e;\n    background: rgba(255, 255, 255, 0.8);\n    border-color: rgba(46, 214, 15, 0.4);\n}\n\n/* Fix 4: Daily Analysis chart - darker labels and grid (handled in JS via CSS vars) */\n[data-theme=\"light\"] {\n    --chart-text-color: #374151;\n    --chart-grid-color: rgba(0, 0, 0, 0.12);\n}\n\n:root {\n    --chart-text-color: #9ca3af;\n    --chart-grid-color: rgba(255, 255, 255, 0.1);\n}\n\n/* Fix 5: Chart container labels - darker in light theme */\n[data-theme=\"light\"] .chart-header h2,\n[data-theme=\"light\"] .chart-header {\n    color: #1a1f2e;\n}\n\n/* Fix 6: Threat Vector Correlation header - darker */\n[data-theme=\"light\"] .correlation-header h2 {\n    color: #1a1f2e;\n}\n\n[data-theme=\"light\"] .correlation-subtitle {\n    color: #4a5568;\n}\n\n/* Fix 7: ETI subtitle and summary - darker for better contrast */\n[data-theme=\"light\"] .eti-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .eti-summary {\n    color: #374151;\n}\n\n/* Fix 8: Prediction labels in threat modeler - darker */\n[data-theme=\"light\"] .modeler-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .modeler-field label {\n    color: #374151;\n}\n\n[data-theme=\"light\"] .modeler-hint {\n    color: #6b7280;\n}\n\n/* Fix 9: Analytics preview backgrounds - much lighter for green text visibility */\n[data-theme=\"light\"] .preview-box {\n    background: rgba(255, 255, 255, 0.6);\n    border-color: rgba(46, 214, 15, 0.3);\n}\n\n/* Fix 10: ETI item text - lighter for better readability */\n[data-theme=\"light\"] .eti-count {\n    color: #6b7280;\n}\n\n[data-theme=\"light\"] .eti-details {\n    color: #9ca3af;\n}\n\n[data-theme=\"light\"] .eti-name {\n    color: #1f2937;\n}\n\n/* Fix 11: Make ETI details much more visible in light theme */\n[data-theme=\"light\"] .eti-details {\n    color: #5a9cf8;\n    font-weight: 500;\n}\n\n/* Fix 12: Threat ticker text visibility in light theme */\n[data-theme=\"light\"] .ticker-item {\n    color: #374151;\n    font-weight: 500;\n}\n\n/* Back to Top Button */\n.back-to-top {\n    position: fixed;\n    bottom: 30px;\n    right: 30px;\n    width: 50px;\n    height: 50px;\n    background: linear-gradient(135deg, var(--accent-green), var(--accent-green-dim));\n    border: 2px solid var(--accent-green);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    z-index: 9998;\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px var(--success-glow);\n    color: #000;\n    font-size: 1.2rem;\n}\n\n.back-to-top.visible {\n    opacity: 1;\n    visibility: visible;\n}\n\n.back-to-top:hover {\n    transform: translateY(-5px) scale(1.1);\n    box-shadow: 0 6px 30px var(--success-glow);\n}\n\n.back-to-top:active {\n    transform: translateY(-2px) scale(1.05);\n}\n\n[data-theme=\"light\"] .back-to-top {\n    background: linear-gradient(135deg, #2ed60f, #27b00c);\n    color: #fff;\n}\n","epoch":6,"telemetryInfo":{}}],["file:///home/trang/localnsv/mAIware-server/public/dashboard.html::request_6694fffe-f89c-4106-8293-523387669b6c",{"uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/dashboard.html","external":"file:///home/trang/localnsv/mAIware-server/public/dashboard.html","path":"/home/trang/localnsv/mAIware-server/public/dashboard.html","scheme":"file"},"requestId":"request_6694fffe-f89c-4106-8293-523387669b6c","content":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>mAIware Server Dashboard</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n    <link rel=\"stylesheet\" href=\"styles.css?v=3.0\">\n    <!-- Add Chart.js -->\n    <script src=\"https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js\"></script>\n    <!-- Add Leaflet.js for maps -->\n    <link rel=\"stylesheet\" href=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css\" />\n    <script src=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js\"></script>\n    <!-- Add Leaflet Heatmap Plugin -->\n    <script src=\"https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js\"></script>\n    <!-- Add D3.js for force-directed graph -->\n    <script src=\"https://d3js.org/d3.v7.min.js\"></script>\n    <!-- Add html2canvas for screenshots -->\n    <script src=\"https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js\"></script>\n</head>\n<body>\n    <!-- Theme Toggle Button -->\n    <button class=\"theme-toggle\" id=\"themeToggle\" onclick=\"toggleTheme()\">\n        <span class=\"icon\" id=\"themeIcon\">üåô</span>\n        <span id=\"themeText\">Dark</span>\n    </button>\n\n    <!-- Back to Top Button -->\n    <button class=\"back-to-top\" id=\"backToTop\" onclick=\"scrollToTop()\">\n        <i class=\"fas fa-arrow-up\"></i>\n    </button>\n\n    <!-- Preview Backdrop -->\n    <div class=\"preview-backdrop\" id=\"previewBackdrop\"></div>\n\n    <!-- Side Navigation Panel -->\n    <div class=\"side-panel\" id=\"sidePanel\">\n        <!-- Logo Icon (always visible) -->\n        <div class=\"panel-icon-strip\">\n            <div class=\"panel-logo-icon\">\n                <i class=\"fas fa-shield-virus\"></i>\n            </div>\n        </div>\n        \n        <!-- Analytics Preview Panel (slides out on hover) -->\n        <div class=\"graphs-preview\" id=\"graphsPreview\">\n            <div class=\"preview-header\">\n                <h3><i class=\"fas fa-chart-line\"></i> Analytics Preview</h3>\n                <p>Click anywhere to view full analytics</p>\n            </div>\n            \n            <!-- Scaled-down live view of analytics -->\n            <div class=\"analytics-miniview\" id=\"analyticsMiniview\" onclick=\"switchView('analytics')\">\n                <div class=\"miniview-preview\">\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box large\">\n                            <div class=\"box-header\">Global Threat Map</div>\n                            <div class=\"box-content map-visual\">\n                                <div class=\"map-dot\" style=\"top: 30%; left: 40%;\"></div>\n                                <div class=\"map-dot\" style=\"top: 60%; left: 70%;\"></div>\n                                <div class=\"map-dot\" style=\"top: 45%; left: 25%;\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box large\">\n                            <div class=\"box-header\">Attack Timeline</div>\n                            <div class=\"box-content chart-visual\">\n                                <div class=\"chart-bar\" style=\"height: 40%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 70%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 55%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 85%;\"></div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Top Threats</div>\n                            <div class=\"box-content list-visual\">\n                                <div class=\"list-item\"></div>\n                                <div class=\"list-item\"></div>\n                                <div class=\"list-item\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Correlations</div>\n                            <div class=\"box-content network-visual\">\n                                <div class=\"network-node\" style=\"top: 30%; left: 30%;\"></div>\n                                <div class=\"network-node\" style=\"top: 60%; left: 50%;\"></div>\n                                <div class=\"network-node\" style=\"top: 45%; left: 70%;\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Heatmap</div>\n                            <div class=\"box-content heat-visual\"></div>\n                        </div>\n                    </div>\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box wide\">\n                            <div class=\"box-header\">File Analysis & Distribution</div>\n                            <div class=\"box-content pie-visual\">\n                                <div class=\"pie-chart\"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"miniview-overlay\">\n                    <i class=\"fas fa-expand-alt\"></i>\n                    <span>Click to view analytics</span>\n                </div>\n            </div>                <!-- Home Navigation Button -->\n                <div class=\"preview-home-nav\" id=\"homeNavBtn\" onclick=\"switchView('dashboard')\">\n                    <i class=\"fas fa-home\"></i>\n                    <span>Back to Dashboard</span>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"main-content\" id=\"mainContent\">\n        <!-- DASHBOARD VIEW -->\n        <div class=\"view-container active\" id=\"dashboardView\">\n            <header class=\"dashboard-header\">\n                <div class=\"header-content\">\n                    <h1><i class=\"fas fa-shield-virus pulse-icon\"></i> mAIware Server</h1>\n                    <p class=\"subtitle\">Real-time Malware Analysis Dashboard</p>\n                </div>\n            </header>\n            \n            <!-- Real-time Threat Ticker -->\n            <div class=\"threat-ticker-container animate-slide-in\">\n                <div class=\"ticker-label\">\n                    <i class=\"fas fa-broadcast-tower pulse-icon\"></i>\n                    <span>LIVE THREAT FEED</span>\n                </div>\n                <div class=\"threat-ticker\" id=\"threat-ticker\">\n                    <div class=\"ticker-content\" id=\"ticker-content\">\n                        <span class=\"ticker-item\">System ready - Monitoring for threats...</span>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Notification Toast Container -->\n            <div id=\"notification-container\" class=\"notification-container\"></div>\n            \n            <!-- Stats Grid -->\n            <div class=\"stats-grid animate-fade-in\" id=\"stats-grid\">\n                <div class=\"stat-card info\">\n                    <i class=\"fas fa-laptop\"></i>\n                    <span class=\"stat-number\" id=\"stat-clients\">0</span>\n                    <span class=\"stat-label\">Active Clients</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card info\">\n                    <i class=\"fas fa-chart-line\"></i>\n                    <span class=\"stat-number\" id=\"stat-total\">0</span>\n                    <span class=\"stat-label\">Total Scans</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card malware\">\n                    <i class=\"fas fa-bug\"></i>\n                    <span class=\"stat-number\" id=\"stat-malware\">0</span>\n                    <span class=\"stat-label\">Malware</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card suspicious\">\n                    <i class=\"fas fa-exclamation-triangle\"></i>\n                    <span class=\"stat-number\" id=\"stat-suspicious\">0</span>\n                    <span class=\"stat-label\">Suspicious</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card benign\">\n                    <i class=\"fas fa-check-circle\"></i>\n                    <span class=\"stat-number\" id=\"stat-benign\">0</span>\n                    <span class=\"stat-label\">Benign</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n            </div>\n            \n            <!-- Recent Scans -->\n            <div class=\"scans-container animate-fade-in\">\n                <div class=\"scans-header\">\n                    <h2><i class=\"fas fa-list\"></i> Recent Scans</h2>\n                    <button class=\"refresh-btn\" onclick=\"manualRefresh()\">\n                        <i class=\"fas fa-sync-alt\"></i> Refresh\n                    </button>\n                </div>\n                \n                <table class=\"scans-table\">\n                    <thead>\n                        <tr>\n                            <th>Timestamp</th>\n                            <th>Filename</th>\n                            <th>Classification</th>\n                            <th>Client IP</th>\n                            <th>Hash (SHA256)</th>\n                        </tr>\n                    </thead>\n                    <tbody id=\"scans-tbody\">\n                        <tr>\n                            <td colspan=\"5\" class=\"empty-state\">\n                                <i class=\"fas fa-inbox\"></i>\n                                <p>No scans yet. Waiting for clients...</p>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n\n        <!-- ANALYTICS VIEW -->\n        <div class=\"view-container\" id=\"analyticsView\">\n            <div class=\"analytics-header\">\n                <button class=\"back-btn\" onclick=\"switchView('dashboard')\">\n                    <i class=\"fas fa-arrow-left\"></i> Back to Dashboard\n                </button>\n                <h1><i class=\"fas fa-chart-line\"></i> Analytics & Intelligence</h1>\n            </div>\n            \n            <div class=\"analytics-grid\" id=\"analyticsGrid\">\n                \n                <!-- Daily Analysis Chart -->\n                <div class=\"chart-container analytics-panel panel-large\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-line\"></i> Daily Analysis Trends</h2>\n                        <div class=\"chart-controls\">\n                            <button class=\"chart-btn active\" onclick=\"setChartDays(7)\">7 Days</button>\n                            <button class=\"chart-btn\" onclick=\"setChartDays(14)\">14 Days</button>\n                            <button class=\"chart-btn\" onclick=\"setChartDays(30)\">30 Days</button>\n                        </div>\n                    </div>\n                    <canvas id=\"dailyScansChart\"></canvas>\n                </div>\n                    <canvas id=\"dailyScansChart\"></canvas>\n                </div>\n\n                <!-- Geographic Threat Intelligence Map -->\n                <div class=\"map-container analytics-panel panel-large\">\n                    <div class=\"map-header\">\n                        <h2><i class=\"fas fa-globe-americas\"></i> Global Threat Intelligence Map</h2>\n                        <div class=\"map-controls\">\n                            <div class=\"map-view-toggle\">\n                                <button class=\"map-btn active\" data-view=\"markers\" onclick=\"switchMapView('markers')\">\n                                    <i class=\"fas fa-map-marker-alt\"></i> Markers\n                                </button>\n                                <button class=\"map-btn\" data-view=\"heatmap\" onclick=\"switchMapView('heatmap')\">\n                                    <i class=\"fas fa-fire\"></i> Heatmap\n                                </button>\n                                <button class=\"map-btn\" data-view=\"choropleth\" onclick=\"switchMapView('choropleth')\">\n                                    <i class=\"fas fa-globe\"></i> Choropleth\n                                </button>\n                            </div>\n                            <div class=\"map-legend\">\n                                <span class=\"legend-item\"><span class=\"legend-dot malware-dot\"></span> Malware</span>\n                                <span class=\"legend-item\"><span class=\"legend-dot suspicious-dot\"></span> Suspicious</span>\n                                <span class=\"legend-item\"><span class=\"legend-dot benign-dot\"></span> Benign</span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Geographic Context Panel -->\n                    <div class=\"geo-context-panel\" id=\"geoContext\">\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Active Regions:</span>\n                            <span class=\"context-value\" id=\"activeRegions\">0</span>\n                        </div>\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Hotspot:</span>\n                            <span class=\"context-value\" id=\"topRegion\">None</span>\n                        </div>\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Total Threats:</span>\n                            <span class=\"context-value threat-count\" id=\"geoThreatCount\">0</span>\n                        </div>\n                    </div>\n                    \n                    <div id=\"worldMap\" style=\"height: 500px; border-radius: 8px; margin-bottom: 15px;\"></div>\n                    \n                    <!-- Timeline Control -->\n                    <div class=\"map-timeline-control\">\n                        <button class=\"timeline-btn\" onclick=\"replayThreats()\" id=\"replayBtn\">\n                            <i class=\"fas fa-play\"></i> Replay Last 24h\n                        </button>\n                        <div class=\"timeline-info\" id=\"timelineInfo\">\n                            Click replay to see threat propagation over time\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Malware Source Distribution -->\n                <div class=\"chart-container analytics-panel panel-small\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-pie\"></i> Malware Source Distribution</h2>\n                    </div>\n                    <div style=\"max-width: 500px; margin: 0 auto;\">\n                        <canvas id=\"malwareSourceChart\"></canvas>\n                    </div>\n                </div>\n\n                <!-- Graph 2: \"Noisiest\" Agents Over Time -->\n                <div class=\"chart-container analytics-panel panel-large\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-desktop\"></i> \"Noisiest\" Agents Over Time</h2>\n                        <p class=\"chart-subtitle\">Threat detection trends for top 5 high-risk agents</p>\n                    </div>\n                    <div style=\"height: 300px;\">\n                        <canvas id=\"noisyAgentsChart\"></canvas>\n                    </div>\n                </div>\n\n                <!-- Advanced Analytics Grid -->\n                <div class=\"analytics-panel panel-large advanced-analytics-grid\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-area\"></i> Advanced Statistical Analysis</h2>\n                        <p class=\"chart-subtitle\">Deep dive into signature verification, packer usage, AI confidence, and entropy patterns</p>\n                    </div>\n                    \n                    <div class=\"mini-charts-grid\">\n                        <!-- Graph 3: Signature Status vs. Classification -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-certificate\"></i> Signature vs. Classification</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"signatureClassChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 4: Packer Usage vs. Classification -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-box\"></i> Packer vs. Classification</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"packerClassChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 5: Confidence Score Distribution -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-brain\"></i> AI Confidence Distribution</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"confidenceHistChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 6: File Entropy Distribution -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-chart-bar\"></i> Entropy Distribution</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"entropyBoxChart\"></canvas>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Threat Vector Correlation Explorer -->\n                <div class=\"correlation-container analytics-panel panel-large\">\n                    <div class=\"correlation-header\">\n                        <h2><i class=\"fas fa-project-diagram\"></i> Threat Vector Correlation Explorer</h2>\n                        <p class=\"correlation-subtitle\">Interactive intelligence map showing relationships between malware families, agents, APIs, and indicators</p>\n                    </div>\n                    <div class=\"graph-controls\">\n                        <button class=\"graph-btn\" onclick=\"resetGraph()\"><i class=\"fas fa-sync\"></i> Reset View</button>\n                        <button class=\"graph-btn\" onclick=\"centerGraph()\"><i class=\"fas fa-compress\"></i> Center</button>\n                        <div class=\"graph-legend\">\n                            <span class=\"legend-item\"><span class=\"node-sample malware-node\"></span> Malware Family</span>\n                            <span class=\"legend-item\"><span class=\"node-sample agent-node\"></span> Agent/System</span>\n                            <span class=\"legend-item\"><span class=\"node-sample api-node\"></span> API Call</span>\n                            <span class=\"legend-item\"><span class=\"node-sample string-node\"></span> Suspicious String</span>\n                        </div>\n                    </div>\n                    <div id=\"correlationGraph\"></div>\n                    <div id=\"nodeDetails\" class=\"node-details\" style=\"display: none;\">\n                        <h3 id=\"detailsTitle\"></h3>\n                        <div id=\"detailsContent\"></div>\n                    </div>\n                </div>\n\n                <!-- Emerging Threat Intelligence Panel -->\n                <div class=\"eti-container analytics-panel panel-large\">\n                    <div class=\"eti-header\">\n                        <h2><i class=\"fas fa-exclamation-triangle\"></i> Emerging Threat Intelligence (ETI)</h2>\n                        <p class=\"eti-subtitle\">Real-time actionable intelligence on active threats and indicators of compromise</p>\n                        <div class=\"eti-summary\">\n                            <span class=\"eti-badge\" id=\"eti-total\">0 Total Threats</span>\n                            <span class=\"eti-badge recent\" id=\"eti-recent\">0 Last 24h</span>\n                        </div>\n                    </div>\n                    \n                    <div class=\"eti-grid\">\n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-virus\"></i> Top Malware Families</h3>\n                            <div class=\"eti-subtitle-small\">Most active malware families detected</div>\n                            <div id=\"eti-malware\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-code\"></i> Top Suspicious APIs</h3>\n                            <div class=\"eti-subtitle-small\">Most frequently called malicious APIs</div>\n                            <div id=\"eti-apis\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-terminal\"></i> Top Malicious Strings</h3>\n                            <div class=\"eti-subtitle-small\">Most common IOC strings and commands</div>\n                            <div id=\"eti-strings\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-shield-alt\"></i> Top Packers/Obfuscators</h3>\n                            <div class=\"eti-subtitle-small\">Most used evasion techniques</div>\n                            <div id=\"eti-packers\" class=\"eti-list\"></div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Predictive Threat Modeler -->\n                <div class=\"modeler-container analytics-panel panel-large\">\n                    <div class=\"modeler-header\">\n                        <h2><i class=\"fas fa-flask\"></i> Predictive Threat Modeler</h2>\n                        <p class=\"modeler-subtitle\">Build hypothetical malware and predict how mAIware would classify it</p>\n                    </div>\n                    \n                    <div class=\"modeler-grid\">\n                <div class=\"modeler-builder\">\n                    <h3><i class=\"fas fa-cogs\"></i> Threat Configuration</h3>\n                    \n                    <div class=\"modeler-field\">\n                        <label>File Type</label>\n                        <select id=\"model-filetype\" class=\"modeler-select\">\n                            <option>PE32+ (GUI) x86-64</option>\n                            <option>PE32 (Console) Intel 80386</option>\n                            <option>PE32+ DLL x86-64</option>\n                            <option>MSI Installer</option>\n                            <option>PDF Document</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Packer/Obfuscator</label>\n                        <select id=\"model-packer\" class=\"modeler-select\">\n                            <option>None</option>\n                            <option>UPX</option>\n                            <option>VMProtect</option>\n                            <option>Themida</option>\n                            <option>ASPack</option>\n                            <option>Unknown (High Entropy)</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Digital Signature</label>\n                        <select id=\"model-signature\" class=\"modeler-select\">\n                            <option>Verified (Microsoft Corporation)</option>\n                            <option>Verified (Google LLC)</option>\n                            <option>Verified (Unknown Publisher)</option>\n                            <option>Not Signed</option>\n                            <option>Expired Certificate</option>\n                            <option>Self-Signed (Untrusted)</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>API Imports (select multiple)</label>\n                        <select id=\"model-apis\" class=\"modeler-select\" multiple size=\"6\">\n                            <option>CreateRemoteThread</option>\n                            <option>WriteProcessMemory</option>\n                            <option>VirtualAllocEx</option>\n                            <option>SetWindowsHookExW</option>\n                            <option>URLDownloadToFileW</option>\n                            <option>WinExec</option>\n                            <option>RegSetValueExW</option>\n                            <option>CryptEncrypt</option>\n                            <option>Socket</option>\n                            <option>ReadFile</option>\n                        </select>\n                        <small class=\"modeler-hint\">Hold Ctrl/Cmd to select multiple</small>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Suspicious Strings (select multiple)</label>\n                        <select id=\"model-strings\" class=\"modeler-select\" multiple size=\"6\">\n                            <option>http://bad-c2-server.com/payload.dat</option>\n                            <option>keylog.txt</option>\n                            <option>steal_passwords</option>\n                            <option>powershell -enc</option>\n                            <option>vssadmin.exe delete shadows</option>\n                            <option>HOW_TO_DECRYPT.txt</option>\n                            <option>crack</option>\n                            <option>patch</option>\n                            <option>disable_antivirus</option>\n                        </select>\n                        <small class=\"modeler-hint\">Hold Ctrl/Cmd to select multiple</small>\n                    </div>\n                    \n                    <button class=\"modeler-analyze-btn\" onclick=\"analyzeThreatModel()\">\n                        <i class=\"fas fa-brain\"></i> ANALYZE THREAT\n                    </button>\n                </div>\n                \n                <div class=\"modeler-results\">\n                    <h3><i class=\"fas fa-chart-line\"></i> Prediction Results</h3>\n                    <div id=\"modeler-output\" class=\"modeler-output\">\n                        <div class=\"modeler-placeholder\">\n                            <i class=\"fas fa-arrow-left\"></i>\n                            <p>Configure a threat profile and click ANALYZE to see predictions</p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n            </div>\n        </div>\n    </div>\n    \n    <script>\n        // Helper function to get CSS variable values dynamically for theming\n        function getCSSVar(varName) {\n            return getComputedStyle(document.documentElement).getPropertyValue(varName).trim();\n        }\n\n        // Back to Top Button\n        const backToTopBtn = document.getElementById('backToTop');\n        \n        window.addEventListener('scroll', () => {\n            if (window.pageYOffset > 300) {\n                backToTopBtn.classList.add('visible');\n            } else {\n                backToTopBtn.classList.remove('visible');\n            }\n        });\n\n        function scrollToTop() {\n            window.scrollTo({\n                top: 0,\n                behavior: 'smooth'\n            });\n        }\n\n        // View Switching System\n        function switchView(viewName) {\n            const views = document.querySelectorAll('.view-container');\n            \n            views.forEach(view => {\n                view.classList.remove('active');\n                if (view.id === `${viewName}View`) {\n                    view.classList.add('active');\n                }\n            });\n            \n            currentView = viewName;\n            \n            // Fix map display when switching to analytics view\n            if (viewName === 'analytics') {\n                loadAnalytics(); // Lazy load analytics components\n                setTimeout(() => {\n                    if (worldMap) {\n                        worldMap.invalidateSize();\n                    }\n                    // Capture screenshot for preview after charts has rendered\n                    setTimeout(() => {\n                        createAnalyticsMiniview();\n                    }, 1500);\n                }, 100);\n            }\n            \n            // Close graphs preview when switching views\n            document.getElementById('graphsPreview').classList.remove('show');\n            document.getElementById('previewBackdrop').classList.remove('show');\n        }\n        \n        // Side Panel Hover System\n        const sidePanel = document.getElementById('sidePanel');\n        const graphsPreview = document.getElementById('graphsPreview');\n        const previewBackdrop = document.getElementById('previewBackdrop');\n        const homeNavBtn = document.getElementById('homeNavBtn');\n        let previewTimeout;\n        let previewsRendered = false;\n        let currentView = 'dashboard';\n        \n        // Show preview panel on sidebar hover\n        sidePanel.addEventListener('mouseenter', () => {\n            clearTimeout(previewTimeout);\n            previewTimeout = setTimeout(() => {\n                graphsPreview.classList.add('show');\n                previewBackdrop.classList.add('show');\n                \n                // Show/hide home button based on current view\n                if (currentView === 'analytics') {\n                    homeNavBtn.classList.add('visible');\n                } else {\n                    homeNavBtn.classList.remove('visible');\n                }\n            }, 200);\n        });\n        \n        sidePanel.addEventListener('mouseleave', () => {\n            clearTimeout(previewTimeout);\n            setTimeout(() => {\n                if (!graphsPreview.matches(':hover')) {\n                    graphsPreview.classList.remove('show');\n                    previewBackdrop.classList.remove('show');\n                }\n            }, 100);\n        });\n        \n        // Keep preview open when hovering over it\n        graphsPreview.addEventListener('mouseleave', () => {\n            graphsPreview.classList.remove('show');\n            previewBackdrop.classList.remove('show');\n        });\n        \n        // Close preview when clicking backdrop\n        previewBackdrop.addEventListener('click', () => {\n            graphsPreview.classList.remove('show');\n            previewBackdrop.classList.remove('show');\n        });\n        \n        // Create analytics miniview by taking a screenshot\n        let isCapturingSnapshot = false;\n        let hasInitialSnapshot = false;\n        \n        async function createAnalyticsMiniview() {\n            // Simplified - no actual screenshot, just a visual preview\n            hasInitialSnapshot = true;\n        }\n        \n        // Auto-scroll on hover down in analytics view\n        let scrollInterval;\n        const analyticsGrid = document.getElementById('analyticsGrid');\n        \n        if (analyticsGrid) {\n            analyticsGrid.addEventListener('mousemove', (e) => {\n                const rect = analyticsGrid.getBoundingClientRect();\n                const mouseY = e.clientY - rect.top;\n                const triggerZone = 100; // pixels from bottom\n                \n                if (rect.height - mouseY < triggerZone) {\n                    if (!scrollInterval) {\n                        scrollInterval = setInterval(() => {\n                            analyticsGrid.scrollBy({ top: 2, behavior: 'smooth' });\n                        }, 16);\n                    }\n                } else {\n                    if (scrollInterval) {\n                        clearInterval(scrollInterval);\n                        scrollInterval = null;\n                    }\n                }\n            });\n            \n            analyticsGrid.addEventListener('mouseleave', () => {\n                if (scrollInterval) {\n                    clearInterval(scrollInterval);\n                    scrollInterval = null;\n                }\n            });\n        }\n        \n        // Theme Toggle\n        window.toggleTheme = function() {\n            const html = document.documentElement;\n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            const currentTheme = html.getAttribute('data-theme');\n            \n            if (currentTheme === 'light') {\n                html.setAttribute('data-theme', '');\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n                localStorage.setItem('theme', 'dark');\n            } else {\n                html.setAttribute('data-theme', 'light');\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n                localStorage.setItem('theme', 'light');\n            }\n        };\n        \n        // Load saved theme\n        const savedTheme = localStorage.getItem('theme');\n        if (savedTheme === 'light') {\n            document.documentElement.setAttribute('data-theme', 'light');\n            document.getElementById('themeIcon').textContent = '‚òÄÔ∏è';\n            document.getElementById('themeText').textContent = 'Light';\n        }\n        \n        let dailyChart = null;\n        let currentChartDays = 30;\n        \n        // Notification and Animation System\n        const notificationQueue = [];\n        let isShowingNotification = false;\n        \n        function showThreatNotification(scan) {\n            const container = document.getElementById('notification-container');\n            \n            const classColor = \n                scan.classification === 'Malware' ? '#ff4757' :\n                scan.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n            \n            const icon = \n                scan.classification === 'Malware' ? 'fa-skull-crossbones' :\n                scan.classification === 'Suspicious' ? 'fa-exclamation-triangle' : 'fa-check-circle';\n            \n            const notification = document.createElement('div');\n            notification.className = 'threat-notification';\n            notification.style.borderLeftColor = classColor;\n            notification.innerHTML = `\n                <div class=\"notification-icon\" style=\"color: ${classColor};\">\n                    <i class=\"fas ${icon}\"></i>\n                </div>\n                <div class=\"notification-content\">\n                    <div class=\"notification-title\">\n                        <strong>${scan.classification}</strong> detected\n                    </div>\n                    <div class=\"notification-details\">\n                        ${scan.detected_filename}\n                        ${scan.malware_family ? ` - ${scan.malware_family}` : ''}\n                    </div>\n                    <div class=\"notification-meta\">\n                        <i class=\"fas fa-desktop\"></i> ${scan.systemInfo?.hostname || scan.clientIp || 'Unknown'}\n                    </div>\n                </div>\n                <div class=\"notification-close\" onclick=\"this.parentElement.remove()\">\n                    <i class=\"fas fa-times\"></i>\n                </div>\n            `;\n            \n            container.appendChild(notification);\n            \n            // Animate in\n            setTimeout(() => notification.classList.add('show'), 10);\n            \n            // Auto-remove after 8 seconds\n            setTimeout(() => {\n                notification.classList.remove('show');\n                setTimeout(() => notification.remove(), 300);\n            }, 8000);\n        }\n        \n        function addToThreatTicker(scan) {\n            const ticker = document.getElementById('ticker-content');\n            const timestamp = new Date(scan.serverTimestamp).toLocaleTimeString();\n            \n            const classColor = \n                scan.classification === 'Malware' ? '#ff4757' :\n                scan.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n            \n            const tickerItem = document.createElement('span');\n            tickerItem.className = 'ticker-item';\n            tickerItem.style.color = classColor;\n            tickerItem.innerHTML = `\n                <i class=\"fas fa-circle\"></i>\n                [${timestamp}] ${scan.classification}: ${scan.detected_filename}\n                ${scan.malware_family ? `(${scan.malware_family})` : ''}\n                on ${scan.systemInfo?.hostname || scan.clientIp || 'Unknown'}\n            `;\n            \n            ticker.appendChild(tickerItem);\n            \n            // Keep only last 10 items\n            while (ticker.children.length > 10) {\n                ticker.removeChild(ticker.firstChild);\n            }\n        }\n        \n        function animateStatCard(elementId, newValue) {\n            const element = document.getElementById(elementId);\n            if (!element) return;\n            \n            const currentValue = parseInt(element.textContent) || 0;\n            if (newValue > currentValue) {\n                // Pulse animation\n                element.parentElement.classList.add('stat-pulse');\n                setTimeout(() => element.parentElement.classList.remove('stat-pulse'), 600);\n                \n                // Animate number increment\n                const duration = 500;\n                const steps = 20;\n                const increment = (newValue - currentValue) / steps;\n                let current = currentValue;\n                let step = 0;\n                \n                const interval = setInterval(() => {\n                    step++;\n                    current += increment;\n                    element.textContent = Math.round(current);\n                    \n                    if (step >= steps) {\n                        element.textContent = newValue;\n                        clearInterval(interval);\n                    }\n                }, duration / steps);\n            } else {\n                element.textContent = newValue;\n            }\n        }\n        \n        async function loadStats() {\n            try {\n                const response = await fetch('/api/stats');\n                const stats = await response.json();\n                \n                animateStatCard('stat-clients', stats.activeClients);\n                animateStatCard('stat-total', stats.totalScans);\n                animateStatCard('stat-malware', stats.malwareCount);\n                animateStatCard('stat-suspicious', stats.suspiciousCount);\n                animateStatCard('stat-benign', stats.benignCount);\n            } catch (error) {\n                console.error('Failed to load stats:', error);\n            }\n        }\n        \n        async function loadScans() {\n            try {\n                const response = await fetch('/api/scans?limit=50');\n                const data = await response.json();\n                \n                const tbody = document.getElementById('scans-tbody');\n                \n                if (data.scans.length === 0) {\n                    tbody.innerHTML = `\n                        <tr>\n                            <td colspan=\"5\" class=\"empty-state\">\n                                <i class=\"fas fa-inbox\"></i>\n                                <p>No scans yet. Waiting for clients...</p>\n                            </td>\n                        </tr>\n                    `;\n                    return;\n                }\n                \n                tbody.innerHTML = data.scans.map(scan => {\n                    const timestamp = new Date(scan.serverTimestamp).toLocaleString();\n                    const hash = scan.file_hashes?.sha256 || 'N/A';\n                    const hashShort = hash.length > 16 ? (hash.substring(0, 16) + '...') : hash;\n                    const isNonPe = scan.is_pe === false;\n                    const classification = isNonPe ? 'Non-PE' : (scan.classification || 'Unknown');\n                    const badgeClass = isNonPe ? 'non-pe' : classification.toLowerCase();\n                    const nonPeTag = isNonPe ? '<span class=\"badge non-pe\" title=\"Non-PE file\">Non-PE</span>' : '';\n                    return `\n                        <tr>\n                            <td>${timestamp}</td>\n                            <td>${scan.detected_filename} ${nonPeTag}</td>\n                            <td><span class=\"badge ${badgeClass}\">${classification}</span></td>\n                            <td>${scan.systemInfo?.ip || scan.clientIp || 'Unknown'}</td>\n                            <td class=\"hash\" title=\"${hash}\">${hashShort}</td>\n                        </tr>\n                    `;\n                }).join('');\n                \n            } catch (error) {\n                console.error('Failed to load scans:', error);\n            }\n        }\n        \n        async function loadDailyChart() {\n            try {\n                const response = await fetch(`/api/daily-scans?days=${currentChartDays}`);\n                const data = await response.json();\n                \n                const ctx = document.getElementById('dailyScansChart');\n                \n                // Format dates for display (MM/DD)\n                const labels = data.days.map(day => {\n                    const date = new Date(day.date);\n                    return `${date.getMonth() + 1}/${date.getDate()}`;\n                });\n                \n                // Reuse existing chart if it exists\n                if (dailyChart) {\n                    dailyChart.data.labels = labels;\n                    dailyChart.data.datasets[0].data = data.days.map(d => d.total);\n                    dailyChart.data.datasets[1].data = data.days.map(d => d.malware);\n                    dailyChart.data.datasets[2].data = data.days.map(d => d.suspicious);\n                    dailyChart.data.datasets[3].data = data.days.map(d => d.benign);\n                    dailyChart.update('none'); // Update without animation\n                    return;\n                }\n                \n                dailyChart = new Chart(ctx, {\n                    type: 'line',\n                    data: {\n                        labels: labels,\n                        datasets: [\n                            {\n                                label: 'Total Scans',\n                                data: data.days.map(d => d.total),\n                                borderColor: '#5a9cf8',\n                                backgroundColor: 'rgba(90, 156, 248, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Malware',\n                                data: data.days.map(d => d.malware),\n                                borderColor: '#ff4757',\n                                backgroundColor: 'rgba(255, 71, 87, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Suspicious',\n                                data: data.days.map(d => d.suspicious),\n                                borderColor: '#ffa502',\n                                backgroundColor: 'rgba(255, 165, 2, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Benign',\n                                data: data.days.map(d => d.benign),\n                                borderColor: '#26de81',\n                                backgroundColor: 'rgba(38, 222, 129, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        interaction: {\n                            mode: 'index',\n                            intersect: false,\n                        },\n                        plugins: {\n                            legend: {\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 12 }\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0',\n                                borderColor: 'rgba(255, 255, 255, 0.1)',\n                                borderWidth: 1\n                            }\n                        },\n                        scales: {\n                            x: {\n                                ticks: { \n                                    color: getCSSVar('--chart-text-color') || '#888',\n                                    maxRotation: 45,\n                                    minRotation: 45\n                                },\n                                grid: { \n                                    color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' \n                                }\n                            },\n                            y: {\n                                beginAtZero: true,\n                                ticks: { \n                                    color: getCSSVar('--chart-text-color') || '#888',\n                                    stepSize: 1\n                                },\n                                grid: { \n                                    color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' \n                                }\n                            }\n                        }\n                    }\n                });\n                \n            } catch (error) {\n                console.error('Failed to load daily chart:', error);\n            }\n        }\n        \n        let worldMap = null;\n        let markerLayer = null;\n        let heatmapLayer = null;\n        let choroplethLayer = null;\n        let mapInitialized = false;\n        let lastGeoDataHash = '';\n        let sourceChart = null;\n        let currentMapView = 'markers';\n        let geoDataCache = null;\n        let replayInterval = null;\n        \n        // Country boundaries for choropleth (simplified)\n        const countryCoordinates = {\n            'United States': { center: [37.0902, -95.7129], weight: 0 },\n            'China': { center: [35.8617, 104.1954], weight: 0 },\n            'United Kingdom': { center: [55.3781, -3.4360], weight: 0 },\n            'Germany': { center: [51.1657, 10.4515], weight: 0 },\n            'France': { center: [46.2276, 2.2137], weight: 0 },\n            'Russia': { center: [61.5240, 105.3188], weight: 0 },\n            'Japan': { center: [36.2048, 138.2529], weight: 0 },\n            'India': { center: [20.5937, 78.9629], weight: 0 },\n            'Brazil': { center: [-14.2350, -51.9253], weight: 0 },\n            'Australia': { center: [-25.2744, 133.7751], weight: 0 }\n        };\n        \n        function initializeMap() {\n            if (mapInitialized) return;\n            \n            try {\n                worldMap = L.map('worldMap', {\n                    zoomControl: true,\n                    scrollWheelZoom: true,\n                    preferCanvas: false,\n                    worldCopyJump: true\n                }).setView([20, 0], 2);\n                \n                // Use dark theme tiles\n                L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {\n                    attribution: '&copy; OpenStreetMap contributors',\n                    subdomains: 'abcd',\n                    maxZoom: 18,\n                    minZoom: 1,\n                    noWrap: false,\n                    bounds: [[-90, -180], [90, 180]]\n                }).addTo(worldMap);\n                \n                markerLayer = L.layerGroup().addTo(worldMap);\n                mapInitialized = true;\n                \n                // Fix map display after initialization\n                setTimeout(() => {\n                    if (worldMap) worldMap.invalidateSize();\n                }, 100);\n            } catch (error) {\n                console.error('Failed to initialize map:', error);\n            }\n        }\n        \n        // Switch between map visualization modes\n        window.switchMapView = function(view) {\n            currentMapView = view;\n            \n            // Update button states\n            document.querySelectorAll('.map-btn').forEach(btn => {\n                btn.classList.remove('active');\n            });\n            document.querySelector(`[data-view=\"${view}\"]`).classList.add('active');\n            \n            // Reload map with new view\n            if (geoDataCache) {\n                renderMapView(geoDataCache);\n            }\n        };\n        \n        // Render different map views\n        function renderMapView(data) {\n            if (!worldMap) return;\n            \n            // Clear all layers\n            if (markerLayer) markerLayer.clearLayers();\n            if (heatmapLayer) {\n                worldMap.removeLayer(heatmapLayer);\n                heatmapLayer = null;\n            }\n            if (choroplethLayer) {\n                worldMap.removeLayer(choroplethLayer);\n                choroplethLayer = null;\n            }\n            \n            switch (currentMapView) {\n                case 'markers':\n                    renderMarkers(data);\n                    break;\n                case 'heatmap':\n                    renderHeatmap(data);\n                    break;\n                case 'choropleth':\n                    renderChoropleth(data);\n                    break;\n            }\n            \n            updateGeoContext(data);\n        }\n        \n        // Render traditional markers\n        function renderMarkers(data) {\n            data.locations.forEach(location => {\n                const { lat, lng, city, country } = location.location;\n                \n                let markerColor = '#26de81'; // benign\n                if (location.malwareCount > 0) {\n                    markerColor = '#ff3b3b'; // malware\n                } else if (location.suspiciousCount > 0) {\n                    markerColor = '#ffd700'; // suspicious\n                }\n                \n                const markerSize = Math.min(24, Math.max(8, 8 + location.totalScans * 2));\n                \n                const marker = L.circleMarker([lat, lng], {\n                    radius: markerSize / 2,\n                    fillColor: markerColor,\n                    color: '#fff',\n                    weight: 2,\n                    opacity: 0.8,\n                    fillOpacity: 0.6\n                });\n                \n                const popupContent = `\n                    <div style=\"color: var(--text-primary); min-width: 200px;\">\n                        <h3 style=\"margin: 0 0 10px 0; color: var(--accent-green); font-size: 1.1rem;\">\n                            <i class=\"fas fa-map-marker-alt\" style=\"color: ${markerColor};\"></i>\n                            ${city}, ${country}\n                        </h3>\n                        <p style=\"margin: 5px 0;\"><strong>IP:</strong> ${location.ip}</p>\n                        <p style=\"margin: 5px 0;\"><strong>Total Scans:</strong> ${location.totalScans}</p>\n                        <div style=\"margin-top: 10px;\">\n                            <div><span style=\"color: #ff3b3b;\">‚óè</span> Malware: ${location.malwareCount}</div>\n                            <div><span style=\"color: #ffd700;\">‚óè</span> Suspicious: ${location.suspiciousCount}</div>\n                            <div><span style=\"color: #39ff14;\">‚óè</span> Benign: ${location.benignCount}</div>\n                        </div>\n                        <button onclick=\"filterByLocation('${country}')\" \n                                style=\"margin-top: 10px; padding: 5px 10px; background: var(--accent-green); \n                                       color: var(--bg-primary); border: none; border-radius: 5px; cursor: pointer;\">\n                            Filter by ${country}\n                        </button>\n                    </div>\n                `;\n                \n                marker.bindPopup(popupContent);\n                marker.addTo(markerLayer);\n                \n                marker.on('mouseover', function() {\n                    this.setStyle({ fillOpacity: 0.9, opacity: 1 });\n                });\n                marker.on('mouseout', function() {\n                    this.setStyle({ fillOpacity: 0.6, opacity: 0.8 });\n                });\n            });\n        }\n        \n        // Render heatmap overlay\n        function renderHeatmap(data) {\n            const heatData = [];\n            \n            data.locations.forEach(location => {\n                const { lat, lng } = location.location;\n                // Weight by threat severity: malware = 1.0, suspicious = 0.5, benign = 0.2\n                const weight = (location.malwareCount * 1.0 + \n                               location.suspiciousCount * 0.5 + \n                               location.benignCount * 0.2) / location.totalScans;\n                \n                // Add multiple points for higher intensity\n                const intensity = Math.ceil(location.totalScans * weight);\n                for (let i = 0; i < intensity; i++) {\n                    heatData.push([lat, lng, weight]);\n                }\n            });\n            \n            heatmapLayer = L.heatLayer(heatData, {\n                radius: 35,\n                blur: 25,\n                maxZoom: 10,\n                max: 1.0,\n                gradient: {\n                    0.0: '#39ff14',  // Green (low threat)\n                    0.3: '#ffd700',  // Yellow\n                    0.6: '#ffa502',  // Orange\n                    0.8: '#ff6348',  // Red\n                    1.0: '#ff3b3b'   // Bright red (high threat)\n                }\n            }).addTo(worldMap);\n        }\n        \n        // Render choropleth (country-level threat shading)\n        function renderChoropleth(data) {\n            // Aggregate threats by country\n            const countryStats = {};\n            data.locations.forEach(location => {\n                const country = location.location.country;\n                if (!countryStats[country]) {\n                    countryStats[country] = { total: 0, malware: 0, suspicious: 0 };\n                }\n                countryStats[country].total += location.totalScans;\n                countryStats[country].malware += location.malwareCount;\n                countryStats[country].suspicious += location.suspiciousCount;\n            });\n            \n            // Find max for normalization\n            const maxThreats = Math.max(...Object.values(countryStats).map(s => \n                s.malware + s.suspicious * 0.5\n            ));\n            \n            // Draw circles for countries with threat data\n            choroplethLayer = L.layerGroup();\n            \n            Object.entries(countryStats).forEach(([country, stats]) => {\n                if (countryCoordinates[country]) {\n                    const threatScore = (stats.malware + stats.suspicious * 0.5) / maxThreats;\n                    \n                    // Color gradient from green to red\n                    let color;\n                    if (threatScore < 0.2) color = '#39ff14';\n                    else if (threatScore < 0.4) color = '#ffd700';\n                    else if (threatScore < 0.6) color = '#ffa502';\n                    else if (threatScore < 0.8) color = '#ff6348';\n                    else color = '#ff3b3b';\n                    \n                    const circle = L.circle(countryCoordinates[country].center, {\n                        color: color,\n                        fillColor: color,\n                        fillOpacity: 0.4,\n                        radius: 500000 * (1 + threatScore * 2),\n                        weight: 2\n                    });\n                    \n                    circle.bindPopup(`\n                        <div style=\"color: var(--text-primary);\">\n                            <h3 style=\"color: var(--accent-green);\">${country}</h3>\n                            <p><strong>Total Threats:</strong> ${stats.total}</p>\n                            <p><strong>Malware:</strong> ${stats.malware}</p>\n                            <p><strong>Suspicious:</strong> ${stats.suspicious}</p>\n                            <p><strong>Threat Level:</strong> ${(threatScore * 100).toFixed(0)}%</p>\n                        </div>\n                    `);\n                    \n                    circle.addTo(choroplethLayer);\n                }\n            });\n            \n            choroplethLayer.addTo(worldMap);\n        }\n        \n        // Update geographic context panel\n        function updateGeoContext(data) {\n            const countries = new Set(data.locations.map(l => l.location.country));\n            document.getElementById('activeRegions').textContent = countries.size;\n            \n            // Find hotspot (country with most threats)\n            const countryThreats = {};\n            data.locations.forEach(loc => {\n                const country = loc.location.country;\n                countryThreats[country] = (countryThreats[country] || 0) + \n                    loc.malwareCount + loc.suspiciousCount;\n            });\n            \n            const hotspot = Object.entries(countryThreats)\n                .sort((a, b) => b[1] - a[1])[0];\n            \n            if (hotspot) {\n                const percentage = ((hotspot[1] / data.locations.reduce((sum, l) => \n                    sum + l.malwareCount + l.suspiciousCount, 0)) * 100).toFixed(0);\n                document.getElementById('topRegion').textContent = \n                    `${hotspot[0]} (${percentage}% of threats)`;\n            }\n            \n            const totalThreats = data.locations.reduce((sum, l) => \n                sum + l.malwareCount + l.suspiciousCount, 0);\n            document.getElementById('geoThreatCount').textContent = totalThreats;\n        }\n        \n        // Filter dashboard by geographic location\n        window.filterByLocation = function(country) {\n            console.log(`Filtering by country: ${country}`);\n            // This would filter the tables and charts - simplified for demo\n            alert(`Geographic filtering activated for ${country}.\\nIn full implementation, this would filter all dashboard data.`);\n        };\n        \n        // Replay threats over last 24 hours\n        window.replayThreats = async function() {\n            const btn = document.getElementById('replayBtn');\n            const info = document.getElementById('timelineInfo');\n            \n            if (replayInterval) {\n                clearInterval(replayInterval);\n                replayInterval = null;\n                btn.innerHTML = '<i class=\"fas fa-play\"></i> Replay Last 24h';\n                info.textContent = 'Replay stopped';\n                if (geoDataCache) renderMapView(geoDataCache);\n                return;\n            }\n            \n            if (!geoDataCache || geoDataCache.locations.length === 0) {\n                info.textContent = 'No data available for replay';\n                return;\n            }\n            \n            btn.innerHTML = '<i class=\"fas fa-stop\"></i> Stop Replay';\n            info.textContent = 'Replaying threat detection timeline...';\n            \n            // Sort locations by timestamp\n            const sortedLocations = [...geoDataCache.locations].sort((a, b) => {\n                const timeA = a.scans[0]?.timestamp || 0;\n                const timeB = b.scans[0]?.timestamp || 0;\n                return new Date(timeA) - new Date(timeB);\n            });\n            \n            if (markerLayer) markerLayer.clearLayers();\n            let index = 0;\n            \n            replayInterval = setInterval(() => {\n                if (index >= sortedLocations.length) {\n                    clearInterval(replayInterval);\n                    replayInterval = null;\n                    btn.innerHTML = '<i class=\"fas fa-play\"></i> Replay Last 24h';\n                    info.textContent = 'Replay complete';\n                    return;\n                }\n                \n                const location = sortedLocations[index];\n                const { lat, lng, city, country } = location.location;\n                \n                let markerColor = location.malwareCount > 0 ? '#ff3b3b' : \n                                 location.suspiciousCount > 0 ? '#ffd700' : '#39ff14';\n                \n                // Animated marker appearance\n                const marker = L.circleMarker([lat, lng], {\n                    radius: 0,\n                    fillColor: markerColor,\n                    color: '#fff',\n                    weight: 2,\n                    opacity: 1,\n                    fillOpacity: 0.8\n                }).addTo(markerLayer);\n                \n                // Animate marker growth\n                let size = 0;\n                const growInterval = setInterval(() => {\n                    size += 2;\n                    if (size >= 12) {\n                        clearInterval(growInterval);\n                        marker.setStyle({ opacity: 0.8, fillOpacity: 0.6 });\n                    }\n                    marker.setRadius(size / 2);\n                }, 50);\n                \n                marker.bindPopup(`\n                    <div style=\"color: var(--text-primary);\">\n                        <strong>${city}, ${country}</strong><br>\n                        ${location.scans[0]?.filename || 'Unknown file'}\n                    </div>\n                `);\n                \n                info.textContent = `Replaying: ${index + 1}/${sortedLocations.length} - ${city}, ${country}`;\n                index++;\n            }, 800); // Show new threat every 800ms\n        };\n        \n        async function loadGeoMap() {\n            try {\n                // Initialize map only once\n                if (!mapInitialized) {\n                    initializeMap();\n                }\n                \n                if (!worldMap) return;\n                \n                const response = await fetch('/api/geo-data');\n                const data = await response.json();\n                \n                // Generate hash of current data to detect changes\n                const currentHash = JSON.stringify(data.locations.map(l => \n                    `${l.ip}-${l.totalScans}-${l.malwareCount}-${l.suspiciousCount}`\n                )).substring(0, 100);\n                \n                // Skip update if data hasn't changed\n                if (currentHash === lastGeoDataHash && markerLayer && markerLayer.getLayers().length > 0) {\n                    return;\n                }\n                lastGeoDataHash = currentHash;\n                \n                // Cache data for replay and other features\n                geoDataCache = data;\n                \n                // Render current view\n                renderMapView(data);\n                \n                console.log(`Map updated with ${data.locations.length} locations in ${currentMapView} mode`);\n                \n            } catch (error) {\n                console.error('Failed to load geo map:', error);\n            }\n        }\n        \n        async function loadMalwareSources() {\n            try {\n                const response = await fetch('/api/malware-sources');\n                const data = await response.json();\n                \n                const ctx = document.getElementById('malwareSourceChart');\n                \n                const labels = data.sources.map(s => s.source);\n                const counts = data.sources.map(s => s.count);\n                \n                // Color scheme for different sources\n                const colors = [\n                    '#ff6b6b', // Email Attachment - red\n                    '#4ecdc4', // Web Download - teal\n                    '#ffe66d', // USB/External Drive - yellow\n                    '#a8dadc', // Internal Network - light blue\n                    '#95a5a6'  // Unknown - gray\n                ];\n                \n                // Reuse existing chart if it exists\n                if (sourceChart) {\n                    sourceChart.data.labels = labels;\n                    sourceChart.data.datasets[0].data = counts;\n                    sourceChart.update('none');\n                    return;\n                }\n                \n                sourceChart = new Chart(ctx, {\n                    type: 'pie',\n                    data: {\n                        labels: labels,\n                        datasets: [{\n                            data: counts,\n                            backgroundColor: colors,\n                            borderColor: '#1a1a2e',\n                            borderWidth: 2\n                        }]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: true,\n                        plugins: {\n                            legend: {\n                                position: 'bottom',\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 12 },\n                                    padding: 15\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0',\n                                borderColor: 'rgba(255, 255, 255, 0.1)',\n                                borderWidth: 1,\n                                callbacks: {\n                                    label: function(context) {\n                                        const label = context.label || '';\n                                        const value = context.parsed || 0;\n                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);\n                                        const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : 0;\n                                        return `${label}: ${value} (${percentage}%)`;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                });\n                \n            } catch (error) {\n                console.error('Failed to load malware sources:', error);\n            }\n        }\n        \n        // Graph 2: \"Noisiest\" Agents Over Time\n        let noisyAgentsChart = null;\n        async function loadNoisyAgentsChart() {\n            try {\n                const response = await fetch('/api/noisy-agents');\n                const data = await response.json();\n                \n                console.log('Noisy agents data:', data);\n                \n                const ctx = document.getElementById('noisyAgentsChart');\n                if (!ctx) return;\n                \n                // Show message if no data\n                if (!data.agents || data.agents.length === 0) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 2rem; text-align: center; color: var(--text-secondary);\">No agent data available yet. Start scanning files to see trends.</div>';\n                    return;\n                }\n                \n                const colors = [\n                    '#ff3b3b', '#39ff14', '#ffd700', '#1e90ff', '#ff1493'\n                ];\n                \n                // Reuse existing chart if it exists\n                if (noisyAgentsChart) {\n                    noisyAgentsChart.data.labels = data.dates;\n                    noisyAgentsChart.data.datasets = data.agents.map((agent, idx) => ({\n                        label: agent.agentId,\n                        data: agent.counts,\n                        borderColor: colors[idx],\n                        backgroundColor: colors[idx] + '20',\n                        tension: 0.4,\n                        borderWidth: 2,\n                        fill: false\n                    }));\n                    noisyAgentsChart.update('none');\n                    return;\n                }\n                \n                noisyAgentsChart = new Chart(ctx, {\n                    type: 'line',\n                    data: {\n                        labels: data.dates,\n                        datasets: data.agents.map((agent, idx) => ({\n                            label: agent.agentId,\n                            data: agent.counts,\n                            borderColor: colors[idx],\n                            backgroundColor: colors[idx] + '20',\n                            tension: 0.4,\n                            borderWidth: 2,\n                            fill: false\n                        }))\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load noisy agents chart:', error);\n                const ctx = document.getElementById('noisyAgentsChart');\n                if (ctx) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 2rem; text-align: center; color: var(--accent-red);\">Error loading chart data</div>';\n                }\n            }\n        }\n        \n        // Graph 3: Signature Status vs. Classification\n        let signatureClassChart = null;\n        async function loadSignatureClassChart() {\n            try {\n                const response = await fetch('/api/signature-classification');\n                const data = await response.json();\n                \n                console.log('Signature classification data:', data);\n                \n                const ctx = document.getElementById('signatureClassChart');\n                if (!ctx) {\n                    console.warn('signatureClassChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (signatureClassChart) {\n                    signatureClassChart.data.datasets[0].data = [data.benign.verified, data.suspicious.verified, data.malware.verified];\n                    signatureClassChart.data.datasets[1].data = [data.benign.unknown, data.suspicious.unknown, data.malware.unknown];\n                    signatureClassChart.data.datasets[2].data = [data.benign.untrusted, data.suspicious.untrusted, data.malware.untrusted];\n                    signatureClassChart.update('none');\n                    return;\n                }\n                \n                signatureClassChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: ['Benign', 'Suspicious', 'Malware'],\n                        datasets: [\n                            {\n                                label: 'Verified',\n                                data: [data.benign.verified, data.suspicious.verified, data.malware.verified],\n                                backgroundColor: '#39ff14',\n                                stack: 'stack0'\n                            },\n                            {\n                                label: 'Unknown',\n                                data: [data.benign.unknown, data.suspicious.unknown, data.malware.unknown],\n                                backgroundColor: '#ffd700',\n                                stack: 'stack0'\n                            },\n                            {\n                                label: 'Untrusted',\n                                data: [data.benign.untrusted, data.suspicious.untrusted, data.malware.untrusted],\n                                backgroundColor: '#ff3b3b',\n                                stack: 'stack0'\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                callbacks: {\n                                    label: function(context) {\n                                        const total = context.chart.data.datasets\n                                            .reduce((sum, ds) => sum + ds.data[context.dataIndex], 0);\n                                        const percentage = ((context.parsed.y / total) * 100).toFixed(1);\n                                        return `${context.dataset.label}: ${context.parsed.y} (${percentage}%)`;\n                                    }\n                                }\n                            }\n                        },\n                        scales: {\n                            y: {\n                                stacked: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                stacked: true,\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load signature classification chart:', error);\n                const ctx = document.getElementById('signatureClassChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 4: Packer Usage vs. Classification\n        let packerClassChart = null;\n        async function loadPackerClassChart() {\n            try {\n                const response = await fetch('/api/packer-classification');\n                const data = await response.json();\n                \n                console.log('Packer classification data:', data);\n                \n                const ctx = document.getElementById('packerClassChart');\n                if (!ctx) {\n                    console.warn('packerClassChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (packerClassChart) {\n                    packerClassChart.data.labels = data.packers;\n                    packerClassChart.data.datasets[0].data = data.benignCounts;\n                    packerClassChart.data.datasets[1].data = data.malwareCounts;\n                    packerClassChart.update('none');\n                    return;\n                }\n                \n                packerClassChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: data.packers,\n                        datasets: [\n                            {\n                                label: 'Benign Files',\n                                data: data.benignCounts,\n                                backgroundColor: '#39ff14'\n                            },\n                            {\n                                label: 'Malware Files',\n                                data: data.malwareCounts,\n                                backgroundColor: '#ff3b3b'\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load packer classification chart:', error);\n                const ctx = document.getElementById('packerClassChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 5: Confidence Score Histogram\n        let confidenceHistChart = null;\n        async function loadConfidenceHistChart() {\n            try {\n                const response = await fetch('/api/confidence-distribution');\n                const data = await response.json();\n                \n                console.log('Confidence distribution data:', data);\n                \n                const ctx = document.getElementById('confidenceHistChart');\n                if (!ctx) {\n                    console.warn('confidenceHistChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (confidenceHistChart) {\n                    confidenceHistChart.data.labels = data.bins;\n                    confidenceHistChart.data.datasets[0].data = data.counts;\n                    confidenceHistChart.update('none');\n                    return;\n                }\n                \n                confidenceHistChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: data.bins,\n                        datasets: [{\n                            label: 'Scan Count',\n                            data: data.counts,\n                            backgroundColor: '#39ff14',\n                            borderColor: '#2ed60f',\n                            borderWidth: 1\n                        }]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' },\n                                title: {\n                                    display: true,\n                                    text: 'Number of Scans',\n                                    color: '#888'\n                                }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false },\n                                title: {\n                                    display: true,\n                                    text: 'Confidence Score Range',\n                                    color: '#888'\n                                }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load confidence histogram:', error);\n                const ctx = document.getElementById('confidenceHistChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 6: File Entropy Distribution (Box Plot simulation)\n        let entropyBoxChart = null;\n        async function loadEntropyBoxChart() {\n            try {\n                const response = await fetch('/api/entropy-distribution');\n                const data = await response.json();\n                \n                console.log('Entropy distribution data:', data);\n                \n                const ctx = document.getElementById('entropyBoxChart');\n                if (!ctx) {\n                    console.warn('entropyBoxChart canvas not found');\n                    return;\n                }\n                \n                // Create violin/box plot effect with multiple bars\n                const benignData = [\n                    data.benign.min,\n                    data.benign.q1,\n                    data.benign.median,\n                    data.benign.q3,\n                    data.benign.max\n                ];\n                \n                const malwareData = [\n                    data.malware.min,\n                    data.malware.q1,\n                    data.malware.median,\n                    data.malware.q3,\n                    data.malware.max\n                ];\n                \n                // Reuse existing chart if it exists\n                if (entropyBoxChart) {\n                    entropyBoxChart.data.datasets[0].data = benignData;\n                    entropyBoxChart.data.datasets[1].data = malwareData;\n                    entropyBoxChart.update('none');\n                    return;\n                }\n                \n                entropyBoxChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: ['Min', 'Q1', 'Median', 'Q3', 'Max'],\n                        datasets: [\n                            {\n                                label: 'Benign Files',\n                                data: benignData,\n                                backgroundColor: '#39ff14',\n                                borderColor: '#2ed60f',\n                                borderWidth: 1\n                            },\n                            {\n                                label: 'Malware Files',\n                                data: malwareData,\n                                backgroundColor: '#ff3b3b',\n                                borderColor: '#cc2f2f',\n                                borderWidth: 1\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                callbacks: {\n                                    label: function(context) {\n                                        return `${context.dataset.label}: ${context.parsed.y.toFixed(3)}`;\n                                    }\n                                }\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                max: 8.0,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' },\n                                title: {\n                                    display: true,\n                                    text: 'Entropy Value',\n                                    color: '#888'\n                                }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load entropy distribution chart:', error);\n                const ctx = document.getElementById('entropyBoxChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        async function loadEmergingThreats() {\n            try {\n                const response = await fetch('/api/emerging-threats');\n                const data = await response.json();\n                \n                // Update summary badges\n                document.getElementById('eti-total').textContent = \n                    `${data.summary.totalThreats} Total Threats`;\n                document.getElementById('eti-recent').textContent = \n                    `${data.summary.recentThreats} Last 24h`;\n                \n                // Helper to render IOC list\n                const renderIOCList = (items, container) => {\n                    if (items.length === 0) {\n                        container.innerHTML = '<div class=\"eti-empty\">No threats detected</div>';\n                        return;\n                    }\n                    \n                    container.innerHTML = items.map((item, index) => {\n                        const rank = index + 1;\n                        const recentBadge = item.recent > 0 ? \n                            `<span class=\"eti-recent-badge\">${item.recent} recent</span>` : '';\n                        const agentBadge = item.agents > 0 ? \n                            `<span class=\"eti-agent-badge\">${item.agents} agents</span>` : '';\n                        \n                        return `\n                            <div class=\"eti-item\" data-rank=\"${rank}\">\n                                <div class=\"eti-rank\">${rank}</div>\n                                <div class=\"eti-content\">\n                                    <div class=\"eti-name\">${item.name}</div>\n                                    <div class=\"eti-meta\">\n                                        <span class=\"eti-count\">${item.count} occurrences</span>\n                                        ${recentBadge}\n                                        ${agentBadge}\n                                    </div>\n                                    ${item.details && item.details.length > 0 ? `\n                                        <div class=\"eti-details\">\n                                            ${item.details.slice(0, 2).join(', ')}\n                                            ${item.details.length > 2 ? '...' : ''}\n                                        </div>\n                                    ` : ''}\n                                </div>\n                            </div>\n                        `;\n                    }).join('');\n                };\n                \n                // Render each section\n                renderIOCList(data.topMalwareFamilies, document.getElementById('eti-malware'));\n                renderIOCList(data.topSuspiciousAPIs, document.getElementById('eti-apis'));\n                renderIOCList(data.topMaliciousStrings, document.getElementById('eti-strings'));\n                renderIOCList(data.topPackers, document.getElementById('eti-packers'));\n                \n            } catch (error) {\n                console.error('Failed to load emerging threats:', error);\n            }\n        }\n        \n        async function analyzeThreatModel() {\n            try {\n                // Get selected values\n                const fileType = document.getElementById('model-filetype').value;\n                const packer = document.getElementById('model-packer').value;\n                const signature = document.getElementById('model-signature').value;\n                \n                // Get multiple selections\n                const apisSelect = document.getElementById('model-apis');\n                const apiImports = Array.from(apisSelect.selectedOptions).map(opt => opt.value);\n                \n                const stringsSelect = document.getElementById('model-strings');\n                const keyStrings = Array.from(stringsSelect.selectedOptions).map(opt => opt.value);\n                \n                // Validate\n                if (apiImports.length === 0) {\n                    alert('Please select at least one API import');\n                    return;\n                }\n                if (keyStrings.length === 0) {\n                    alert('Please select at least one suspicious string');\n                    return;\n                }\n                \n                // Show loading state\n                const outputDiv = document.getElementById('modeler-output');\n                outputDiv.innerHTML = `\n                    <div class=\"modeler-loading\">\n                        <i class=\"fas fa-spinner fa-spin\"></i>\n                        <p>Analyzing threat profile...</p>\n                    </div>\n                `;\n                \n                // Send to server\n                const response = await fetch('/api/threat-model', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                        fileType,\n                        packer,\n                        signature,\n                        apiImports,\n                        keyStrings\n                    })\n                });\n                \n                const data = await response.json();\n                \n                if (data.success) {\n                    const result = data.result;\n                    const classColor = \n                        result.classification === 'Malware' ? '#ff4757' :\n                        result.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n                    \n                    outputDiv.innerHTML = `\n                        <div class=\"prediction-result\">\n                            <div class=\"prediction-header\">\n                                <div class=\"prediction-badge\" style=\"background: ${classColor};\">\n                                    ${result.classification.toUpperCase()}\n                                </div>\n                                <div class=\"prediction-confidence\">\n                                    <div class=\"confidence-label\">Confidence Score</div>\n                                    <div class=\"confidence-value\">${(parseFloat(result.confidence_score) * 100).toFixed(1)}%</div>\n                                </div>\n                            </div>\n                            \n                            ${result.malware_family ? `\n                                <div class=\"prediction-family\">\n                                    <strong>Predicted Malware Family:</strong>\n                                    <span class=\"family-name\">${result.malware_family}</span>\n                                </div>\n                            ` : ''}\n                            \n                            <div class=\"prediction-section\">\n                                <h4>Threat Analysis</h4>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-file\"></i>\n                                    <span><strong>File Type:</strong> ${result.key_findings.file_type}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-box\"></i>\n                                    <span><strong>Packer:</strong> ${result.key_findings.packer_detected}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-certificate\"></i>\n                                    <span><strong>Signature:</strong> ${result.key_findings.signature.name}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-tachometer-alt\"></i>\n                                    <span><strong>Threat Score:</strong> ${result.key_findings.threat_score}/100</span>\n                                </div>\n                            </div>\n                            \n                            <div class=\"prediction-section\">\n                                <h4>Detected Indicators</h4>\n                                <div class=\"indicator-group\">\n                                    <strong>API Imports:</strong>\n                                    <div class=\"indicator-list\">\n                                        ${result.key_findings.api_imports.map(api => \n                                            `<span class=\"indicator-tag api-tag\">${api}</span>`\n                                        ).join('')}\n                                    </div>\n                                </div>\n                                <div class=\"indicator-group\">\n                                    <strong>Suspicious Strings:</strong>\n                                    <div class=\"indicator-list\">\n                                        ${result.key_findings.key_strings.map(str => \n                                            `<span class=\"indicator-tag string-tag\">${str}</span>`\n                                        ).join('')}\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"prediction-footer\">\n                                <i class=\"fas fa-info-circle\"></i>\n                                This analysis has been added to the scan results and will appear in all visualizations.\n                            </div>\n                        </div>\n                    `;\n                } else {\n                    outputDiv.innerHTML = `\n                        <div class=\"modeler-error\">\n                            <i class=\"fas fa-exclamation-circle\"></i>\n                            <p>Analysis failed: ${data.error}</p>\n                        </div>\n                    `;\n                }\n                \n            } catch (error) {\n                console.error('Failed to analyze threat model:', error);\n                document.getElementById('modeler-output').innerHTML = `\n                    <div class=\"modeler-error\">\n                        <i class=\"fas fa-exclamation-circle\"></i>\n                        <p>Analysis failed. Please try again.</p>\n                    </div>\n                `;\n            }\n        }\n        \n        let graphSimulation = null;\n        let graphSvg = null;\n        \n        async function loadCorrelationGraph() {\n            try {\n                const response = await fetch('/api/threat-correlations');\n                const data = await response.json();\n                \n                // Clear existing graph\n                d3.select('#correlationGraph').selectAll('*').remove();\n                \n                const container = document.getElementById('correlationGraph');\n                const width = container.clientWidth;\n                const height = 600;\n                \n                // Create SVG\n                graphSvg = d3.select('#correlationGraph')\n                    .append('svg')\n                    .attr('width', width)\n                    .attr('height', height)\n                    .style('background', '#0a0a0a')\n                    .style('border-radius', '8px');\n                \n                const g = graphSvg.append('g');\n                \n                // Add zoom behavior\n                const zoom = d3.zoom()\n                    .scaleExtent([0.1, 4])\n                    .on('zoom', (event) => {\n                        g.attr('transform', event.transform);\n                    });\n                \n                graphSvg.call(zoom);\n                \n                // Color schemes for different node types\n                const colorMap = {\n                    malware: '#ff4757',\n                    agent: '#5a9cf8',\n                    api: '#ffa502',\n                    string: '#26de81'\n                };\n                \n                // Create force simulation\n                graphSimulation = d3.forceSimulation(data.nodes)\n                    .force('link', d3.forceLink(data.links)\n                        .id(d => d.id)\n                        .distance(d => d.type === 'correlated_with' ? 200 : 100)\n                        .strength(d => d.strength * 0.3))\n                    .force('charge', d3.forceManyBody().strength(-300))\n                    .force('center', d3.forceCenter(width / 2, height / 2))\n                    .force('collision', d3.forceCollide().radius(30));\n                \n                // Draw links\n                const link = g.append('g')\n                    .selectAll('line')\n                    .data(data.links)\n                    .enter()\n                    .append('line')\n                    .attr('stroke', d => {\n                        if (d.type === 'correlated_with') return '#ff6b6b';\n                        if (d.type === 'detected_by') return '#5a9cf8';\n                        if (d.type === 'uses_api') return '#ffa502';\n                        return '#26de81';\n                    })\n                    .attr('stroke-width', d => Math.sqrt(d.strength) + 1)\n                    .attr('stroke-opacity', 0.6);\n                \n                // Draw nodes\n                const node = g.append('g')\n                    .selectAll('circle')\n                    .data(data.nodes)\n                    .enter()\n                    .append('circle')\n                    .attr('r', d => {\n                        if (d.type === 'malware') return 15 + Math.min(d.count * 2, 15);\n                        if (d.type === 'agent') return 12 + Math.min(d.count, 10);\n                        return 8 + Math.min(d.count, 8);\n                    })\n                    .attr('fill', d => colorMap[d.type])\n                    .attr('stroke', '#fff')\n                    .attr('stroke-width', 2)\n                    .style('cursor', 'pointer')\n                    .call(d3.drag()\n                        .on('start', dragstarted)\n                        .on('drag', dragged)\n                        .on('end', dragended))\n                    .on('click', (event, d) => showNodeDetails(d, data))\n                    .on('mouseover', function(event, d) {\n                        d3.select(this)\n                            .transition()\n                            .duration(200)\n                            .attr('stroke-width', 4)\n                            .attr('r', function() {\n                                const currentR = parseFloat(d3.select(this).attr('r'));\n                                return currentR * 1.3;\n                            });\n                    })\n                    .on('mouseout', function(event, d) {\n                        d3.select(this)\n                            .transition()\n                            .duration(200)\n                            .attr('stroke-width', 2)\n                            .attr('r', function() {\n                                if (d.type === 'malware') return 15 + Math.min(d.count * 2, 15);\n                                if (d.type === 'agent') return 12 + Math.min(d.count, 10);\n                                return 8 + Math.min(d.count, 8);\n                            });\n                    });\n                \n                // Add labels\n                const label = g.append('g')\n                    .selectAll('text')\n                    .data(data.nodes)\n                    .enter()\n                    .append('text')\n                    .text(d => d.label.length > 20 ? d.label.substring(0, 20) + '...' : d.label)\n                    .attr('font-size', d => d.type === 'malware' ? '12px' : '10px')\n                    .attr('fill', '#e0e0e0')\n                    .attr('text-anchor', 'middle')\n                    .attr('dy', d => {\n                        if (d.type === 'malware') return 35;\n                        if (d.type === 'agent') return 25;\n                        return 20;\n                    })\n                    .style('pointer-events', 'none')\n                    .style('font-weight', d => d.type === 'malware' ? 'bold' : 'normal');\n                \n                // Update positions on simulation tick\n                graphSimulation.on('tick', () => {\n                    link\n                        .attr('x1', d => d.source.x)\n                        .attr('y1', d => d.source.y)\n                        .attr('x2', d => d.target.x)\n                        .attr('y2', d => d.target.y);\n                    \n                    node\n                        .attr('cx', d => d.x)\n                        .attr('cy', d => d.y);\n                    \n                    label\n                        .attr('x', d => d.x)\n                        .attr('y', d => d.y);\n                });\n                \n                // Drag functions\n                function dragstarted(event, d) {\n                    if (!event.active) graphSimulation.alphaTarget(0.3).restart();\n                    d.fx = d.x;\n                    d.fy = d.y;\n                }\n                \n                function dragged(event, d) {\n                    d.fx = event.x;\n                    d.fy = event.y;\n                }\n                \n                function dragended(event, d) {\n                    if (!event.active) graphSimulation.alphaTarget(0);\n                    d.fx = null;\n                    d.fy = null;\n                }\n                \n                console.log(`Correlation graph loaded: ${data.nodes.length} nodes, ${data.links.length} links`);\n                \n            } catch (error) {\n                console.error('Failed to load correlation graph:', error);\n            }\n        }\n        \n        function showNodeDetails(node, graphData) {\n            const detailsPanel = document.getElementById('nodeDetails');\n            const detailsTitle = document.getElementById('detailsTitle');\n            const detailsContent = document.getElementById('detailsContent');\n            \n            detailsTitle.textContent = node.label;\n            \n            let html = `<p><strong>Type:</strong> ${node.type.toUpperCase()}</p>`;\n            html += `<p><strong>Occurrences:</strong> ${node.count}</p>`;\n            \n            // Find connections\n            const connections = graphData.links.filter(l => \n                l.source.id === node.id || l.target.id === node.id\n            );\n            \n            if (connections.length > 0) {\n                html += `<p><strong>Connections:</strong> ${connections.length}</p>`;\n                html += '<ul style=\"margin: 10px 0; padding-left: 20px;\">';\n                connections.slice(0, 10).forEach(link => {\n                    const otherNode = link.source.id === node.id ? link.target : link.source;\n                    html += `<li>${link.type.replace(/_/g, ' ')}: ${otherNode.label}</li>`;\n                });\n                if (connections.length > 10) {\n                    html += `<li>...and ${connections.length - 10} more</li>`;\n                }\n                html += '</ul>';\n            }\n            \n            if (node.details && node.details.length > 0) {\n                html += '<p><strong>Associated Files:</strong></p>';\n                html += '<ul style=\"margin: 10px 0; padding-left: 20px; max-height: 150px; overflow-y: auto;\">';\n                node.details.slice(0, 10).forEach(file => {\n                    html += `<li>${file}</li>`;\n                });\n                if (node.details.length > 10) {\n                    html += `<li>...and ${node.details.length - 10} more</li>`;\n                }\n                html += '</ul>';\n            }\n            \n            detailsContent.innerHTML = html;\n            detailsPanel.style.display = 'block';\n        }\n        \n        function resetGraph() {\n            if (graphSimulation) {\n                graphSimulation.alpha(1).restart();\n            }\n        }\n        \n        function centerGraph() {\n            if (graphSvg) {\n                graphSvg.transition().duration(750).call(\n                    d3.zoom().transform,\n                    d3.zoomIdentity\n                );\n            }\n        }\n        \n        function setChartDays(days) {\n            currentChartDays = days;\n            \n            // Update button states\n            document.querySelectorAll('.chart-btn').forEach(btn => {\n                btn.classList.remove('active');\n            });\n            event.target.classList.add('active');\n            \n            loadDailyChart();\n        }\n        \n        function loadData() {\n            loadStats();\n            loadScans();\n            // Heavy components loaded lazily - see switchView()\n        }\n        \n        function loadDataWithoutMap() {\n            loadStats();\n            loadScans();\n        }\n        \n        // Track which analytics have been loaded\n        let analyticsLoaded = false;\n        \n        function loadAnalytics() {\n            console.log('Loading analytics view...');\n            loadDailyChart();\n            loadMalwareSources();\n            loadNoisyAgentsChart();\n            loadSignatureClassChart();\n            loadPackerClassChart();\n            loadConfidenceHistChart();\n            loadEntropyBoxChart();\n            loadEmergingThreats();\n            loadCorrelationGraph();\n            loadGeoMap();\n            \n            analyticsLoaded = true;\n        }\n        \n        // Initial load - only dashboard essentials\n        loadData();\n        \n        // Auto-scroll functionality with visual indicators\n        const scrollIndicatorUp = document.createElement('div');\n        scrollIndicatorUp.className = 'scroll-indicator scroll-up';\n        scrollIndicatorUp.innerHTML = '<i class=\"fas fa-chevron-up\"></i>';\n        document.body.appendChild(scrollIndicatorUp);\n        \n        const scrollIndicatorDown = document.createElement('div');\n        scrollIndicatorDown.className = 'scroll-indicator scroll-down';\n        scrollIndicatorDown.innerHTML = '<i class=\"fas fa-chevron-down\"></i>';\n        document.body.appendChild(scrollIndicatorDown);\n        \n        let pageScrollInterval = null;\n        const scrollSpeed = 3;\n        const triggerZone = 80; // pixels from top/bottom\n        \n        function handleAutoScroll(event) {\n            // Don't auto-scroll if page is hidden\n            if (document.hidden) return;\n            \n            const mouseY = event.clientY;\n            const windowHeight = window.innerHeight;\n            \n            // Check if near top\n            if (mouseY < triggerZone) {\n                scrollIndicatorUp.classList.add('visible');\n                scrollIndicatorDown.classList.remove('visible');\n                \n                if (!pageScrollInterval) {\n                    pageScrollInterval = setInterval(() => {\n                        if (document.hidden) {\n                            stopAutoScroll();\n                            return;\n                        }\n                        window.scrollBy({\n                            top: -scrollSpeed,\n                            behavior: 'auto'\n                        });\n                    }, 16); // ~60fps\n                }\n            }\n            // Check if near bottom\n            else if (mouseY > windowHeight - triggerZone) {\n                scrollIndicatorDown.classList.add('visible');\n                scrollIndicatorUp.classList.remove('visible');\n                \n                if (!pageScrollInterval) {\n                    pageScrollInterval = setInterval(() => {\n                        if (document.hidden) {\n                            stopAutoScroll();\n                            return;\n                        }\n                        window.scrollBy({\n                            top: scrollSpeed,\n                            behavior: 'auto'\n                        });\n                    }, 16);\n                }\n            }\n            // In neutral zone\n            else {\n                scrollIndicatorUp.classList.remove('visible');\n                scrollIndicatorDown.classList.remove('visible');\n                \n                if (pageScrollInterval) {\n                    clearInterval(pageScrollInterval);\n                    pageScrollInterval = null;\n                }\n            }\n        }\n        \n        function stopAutoScroll() {\n            scrollIndicatorUp.classList.remove('visible');\n            scrollIndicatorDown.classList.remove('visible');\n            \n            if (pageScrollInterval) {\n                clearInterval(pageScrollInterval);\n                pageScrollInterval = null;\n            }\n        }\n        \n        // Attach event listeners\n        document.addEventListener('mousemove', handleAutoScroll);\n        document.addEventListener('mouseleave', stopAutoScroll);\n        \n        // Stop scrolling when reaching top or bottom\n        let lastScrollTop = 0;\n        window.addEventListener('scroll', () => {\n            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n            const scrollHeight = document.documentElement.scrollHeight;\n            const clientHeight = document.documentElement.clientHeight;\n            \n            // At top\n            if (scrollTop === 0 && lastScrollTop > 0) {\n                stopAutoScroll();\n            }\n            // At bottom\n            if (scrollTop + clientHeight >= scrollHeight - 5) {\n                stopAutoScroll();\n            }\n            \n            lastScrollTop = scrollTop;\n        });\n        \n        // Set up Server-Sent Events for real-time updates\n        const eventSource = new EventSource('/api/events');\n        let updateDebounceTimer = null;\n        let pollingInterval = null;\n        let pendingUpdates = false;\n        \n        eventSource.onmessage = function(event) {\n            const data = JSON.parse(event.data);\n            \n            if (data.type === 'connected') {\n                console.log('Connected to server for real-time updates');\n            } else if (data.type === 'new-scan') {\n                console.log('New scan received:', data.scan.detected_filename);\n                \n                // Show notification toast\n                showThreatNotification(data.scan);\n                \n                // Add to threat ticker\n                addToThreatTicker(data.scan);\n                \n                // Debounce: batch multiple rapid scans into single update\n                pendingUpdates = true;\n                clearTimeout(updateDebounceTimer);\n                updateDebounceTimer = setTimeout(() => {\n                    if (pendingUpdates) {\n                        // Only reload lightweight data (stats + scan list)\n                        loadStats();\n                        loadScans();\n                        \n                        // If analytics view is open, refresh analytics too\n                        if (currentView === 'analytics' && analyticsLoaded) {\n                            loadAnalytics();\n                        }\n                        \n                        pendingUpdates = false;\n                        \n                        // Throttle map updates to once per 15 seconds\n                        if (!window.lastMapUpdate || Date.now() - window.lastMapUpdate > 15000) {\n                            loadGeoMap();\n                            window.lastMapUpdate = Date.now();\n                        }\n                    }\n                }, 1000); // Wait 1 second after last scan\n            }\n        };\n        \n        eventSource.onerror = function(error) {\n            console.error('SSE Error:', error);\n            // Fallback: reload data every 30 seconds if SSE connection fails (only once!)\n            if (eventSource.readyState === EventSource.CLOSED && !pollingInterval) {\n                console.log('SSE connection closed, falling back to polling...');\n                pollingInterval = setInterval(() => {\n                    loadStats();\n                    loadScans();\n                }, 30000);\n            }\n        };\n        \n        // Manual refresh button functionality\n        window.manualRefresh = function() {\n            loadData();\n        };\n    </script>\n    \n    <!-- Theme Toggle Script -->\n    <script>\n        // Theme Toggle Functionality\n        window.toggleTheme = function() {\n            const html = document.documentElement;\n            const currentTheme = html.getAttribute('data-theme');\n            const newTheme = currentTheme === 'light' ? '' : 'light';\n            \n            if (newTheme) {\n                html.setAttribute('data-theme', newTheme);\n            } else {\n                html.removeAttribute('data-theme');\n            }\n            localStorage.setItem('theme', newTheme || 'dark');\n            \n            // Update button icon and text\n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            if (newTheme === 'light') {\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n            } else {\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n            }\n        };\n        \n        // Load saved theme on page load\n        (function() {\n            const savedTheme = localStorage.getItem('theme') || 'dark';\n            if (savedTheme === 'light') {\n                document.documentElement.setAttribute('data-theme', 'light');\n            }\n            \n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            if (savedTheme === 'light') {\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n            } else {\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n            }\n        })();\n    </script>\n</body>\n</html>","epoch":10,"telemetryInfo":{}}],["file:///home/trang/localnsv/mAIware-server/public/styles.css::request_4e420508-80ce-43b8-82a1-fed6912f3e58",{"uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/styles.css","external":"file:///home/trang/localnsv/mAIware-server/public/styles.css","path":"/home/trang/localnsv/mAIware-server/public/styles.css","scheme":"file"},"requestId":"request_4e420508-80ce-43b8-82a1-fed6912f3e58","content":":root {\n    --bg-primary: #000000;\n    --bg-secondary: #0a0a0a;\n    --bg-card: #0f0f0f;\n    --bg-hover: #151515;\n    --text-primary: #e8f0e8;\n    --text-secondary: #9ca3af;\n    --accent-green: #39ff14;\n    --accent-green-dim: #2ed60f;\n    --accent-yellow: #ffd700;\n    --accent-red: #ff3b3b;\n    --accent-red-dim: #cc2f2f;\n    --border-color: #1a1a1a;\n    --shadow-color: rgba(0, 0, 0, 0.5);\n    --success-glow: rgba(57, 255, 20, 0.3);\n    --danger-glow: rgba(255, 59, 59, 0.3);\n    --warning-glow: rgba(255, 215, 0, 0.3);\n}\n\n[data-theme=\"light\"] {\n    --bg-primary: #f0f4f0;\n    --bg-secondary: #ffffff;\n    --bg-card: #fafafa;\n    --bg-hover: #e8f5e8;\n    --text-primary: #1a1f2e;\n    --text-secondary: #4a5568;\n    --accent-green: #2ed60f;\n    --accent-green-dim: #27b00c;\n    --accent-yellow: #cc9a00;\n    --accent-red: #dc2626;\n    --accent-red-dim: #b91c1c;\n    --border-color: #d1d5db;\n    --shadow-color: rgba(0, 0, 0, 0.1);\n    --success-glow: rgba(46, 214, 15, 0.2);\n    --danger-glow: rgba(220, 38, 38, 0.2);\n    --warning-glow: rgba(204, 154, 0, 0.2);\n}\n\n* { \n    margin: 0; \n    padding: 0; \n    box-sizing: border-box; \n}\n\nbody {\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    background: var(--bg-primary);\n    color: var(--text-primary);\n    min-height: 100vh;\n    margin: 0;\n    overflow-x: hidden;\n    position: relative;\n}\n\nbody::before {\n    content: '';\n    position: fixed;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: \n        radial-gradient(circle at 20% 50%, rgba(57, 255, 20, 0.08) 0%, transparent 50%),\n        radial-gradient(circle at 80% 80%, rgba(57, 255, 20, 0.06) 0%, transparent 50%),\n        radial-gradient(circle at 40% 20%, rgba(57, 255, 20, 0.05) 0%, transparent 50%);\n    animation: backgroundGlow 15s ease-in-out infinite;\n    pointer-events: none;\n    z-index: 0;\n}\n\n@keyframes backgroundGlow {\n    0%, 100% { \n        transform: translate(0, 0) scale(1);\n        opacity: 0.4;\n    }\n    33% { \n        transform: translate(10%, 10%) scale(1.1);\n        opacity: 0.6;\n    }\n    66% { \n        transform: translate(-10%, 5%) scale(0.95);\n        opacity: 0.5;\n    }\n}\n\nbody > * {\n    position: relative;\n    z-index: 1;\n}\n\n/* Side Panel Navigation */\n.side-panel {\n    position: fixed;\n    left: 0;\n    top: 0;\n    height: 100vh;\n    width: 70px;\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border-right: 1px solid rgba(57, 255, 20, 0.2);\n    box-shadow: 0 0 30px rgba(57, 255, 20, 0.1);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    z-index: 9999;\n    transition: all 0.3s ease;\n}\n\n.side-panel:hover {\n    background: rgba(15, 15, 15, 0.8);\n    box-shadow: 0 0 40px rgba(57, 255, 20, 0.2);\n}\n\n.panel-icon-strip {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 2rem 0;\n}\n\n.panel-logo-icon {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 50px;\n    height: 50px;\n    color: var(--accent-green);\n    font-size: 2rem;\n    animation: pulse-glow 3s ease-in-out infinite;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.panel-logo-icon:hover {\n    transform: scale(1.1);\n    filter: drop-shadow(0 0 20px var(--success-glow));\n}\n\n@keyframes pulse-glow {\n    0%, 100% { filter: drop-shadow(0 0 5px var(--success-glow)); }\n    50% { filter: drop-shadow(0 0 15px var(--success-glow)) drop-shadow(0 0 25px var(--success-glow)); }\n}\n\n/* Graphs Preview Grid */\n.graphs-preview {\n    position: fixed;\n    left: 70px;\n    top: 50%;\n    transform: translateY(-50%) translateX(-100%);\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-left: none;\n    border-radius: 0 12px 12px 0;\n    padding: 2rem;\n    width: 480px;\n    max-height: 90vh;\n    overflow-y: auto;\n    opacity: 0;\n    visibility: hidden;\n    pointer-events: none;\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease, visibility 0.3s;\n    box-shadow: 5px 0 40px rgba(57, 255, 20, 0.15);\n    z-index: 9998;\n    will-change: transform, opacity;\n}\n\n.graphs-preview::-webkit-scrollbar {\n    width: 6px;\n}\n\n.graphs-preview::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 3px;\n}\n\n.graphs-preview::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 3px;\n}\n\n.graphs-preview.show {\n    opacity: 1;\n    visibility: visible;\n    pointer-events: auto;\n    transform: translateY(-50%) translateX(0);\n}\n\n.preview-header {\n    margin-bottom: 1rem;\n    padding-bottom: 0.8rem;\n    border-bottom: 1px solid var(--border-color);\n}\n\n.preview-header h3 {\n    color: var(--accent-green);\n    font-size: 1.1rem;\n    margin-bottom: 0.3rem;\n}\n\n.preview-header p {\n    color: var(--text-secondary);\n    font-size: 0.85rem;\n}\n\n/* Analytics Miniview - Scaled down live view */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-content {\n    width: 100%;\n    height: 100%;\n    transform-origin: top left;\n    transform: scale(0.25);\n    width: 400%;\n    height: 400%;\n    pointer-events: none;\n    overflow: hidden;\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n.preview-home-nav {\n    margin-top: 1.5rem;\n    padding: 1rem;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 10px;\n    display: flex;\n    align-items: center;\n    gap: 0.8rem;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    opacity: 0;\n    visibility: hidden;\n    transform: translateY(10px);\n}\n\n.preview-home-nav.visible {\n    opacity: 1;\n    visibility: visible;\n    transform: translateY(0);\n}\n\n.preview-home-nav:hover {\n    background: var(--bg-hover);\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.preview-home-nav i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n}\n\n.preview-home-nav span {\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--text-primary);\n}\n\n.preview-label {\n    flex: 1;\n    font-size: 0.95rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    letter-spacing: 0.3px;\n}\n\n/* Analytics Miniview - Screenshot preview */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    padding: 1.5rem;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-preview {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    opacity: 0.7;\n}\n\n.preview-row {\n    display: flex;\n    gap: 1rem;\n    flex: 1;\n}\n\n.preview-box {\n    flex: 1;\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 6px;\n    position: relative;\n    overflow: hidden;\n    padding: 0.5rem;\n}\n\n.preview-box.large {\n    flex: 2;\n}\n\n.preview-box.wide {\n    flex: 1;\n    min-height: 150px;\n}\n\n.box-header {\n    font-size: 0.65rem;\n    color: var(--accent-green);\n    margin-bottom: 0.5rem;\n    opacity: 0.8;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.box-content {\n    height: calc(100% - 1.5rem);\n    position: relative;\n}\n\n.map-visual {\n    background: radial-gradient(circle at center, rgba(57, 255, 20, 0.05), transparent);\n    position: relative;\n}\n\n.map-dot {\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 10px var(--accent-green);\n    animation: map-pulse 2s ease-in-out infinite;\n}\n\n.map-dot:nth-child(2) { animation-delay: 0.5s; }\n.map-dot:nth-child(3) { animation-delay: 1s; }\n\n@keyframes map-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.6; }\n    50% { transform: scale(1.5); opacity: 1; }\n}\n\n.chart-visual {\n    display: flex;\n    align-items: flex-end;\n    justify-content: space-around;\n    height: 100%;\n    padding: 0.5rem;\n    gap: 0.3rem;\n}\n\n.chart-bar {\n    flex: 1;\n    background: linear-gradient(180deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    animation: bar-grow 2s ease-in-out infinite;\n    opacity: 0.7;\n}\n\n.chart-bar:nth-child(2) { animation-delay: 0.2s; }\n.chart-bar:nth-child(3) { animation-delay: 0.4s; }\n.chart-bar:nth-child(4) { animation-delay: 0.6s; }\n\n@keyframes bar-grow {\n    0%, 100% { transform: scaleY(0.8); }\n    50% { transform: scaleY(1); }\n}\n\n.list-visual {\n    display: flex;\n    flex-direction: column;\n    gap: 0.4rem;\n    padding: 0.3rem;\n}\n\n.list-item {\n    height: 0.4rem;\n    background: linear-gradient(90deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    opacity: 0.6;\n    animation: list-fade 3s ease-in-out infinite;\n}\n\n.list-item:nth-child(2) { animation-delay: 0.5s; width: 80%; }\n.list-item:nth-child(3) { animation-delay: 1s; width: 60%; }\n\n@keyframes list-fade {\n    0%, 100% { opacity: 0.4; }\n    50% { opacity: 0.8; }\n}\n\n.network-visual {\n    position: relative;\n    height: 100%;\n}\n\n.network-node {\n    position: absolute;\n    width: 6px;\n    height: 6px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 8px var(--accent-green);\n    animation: node-pulse 3s ease-in-out infinite;\n}\n\n.network-node:nth-child(2) { animation-delay: 0.7s; }\n.network-node:nth-child(3) { animation-delay: 1.4s; }\n\n@keyframes node-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.5; }\n    50% { transform: scale(1.3); opacity: 1; }\n}\n\n.heat-visual {\n    background: \n        radial-gradient(circle at 30% 30%, rgba(57, 255, 20, 0.3), transparent 40%),\n        radial-gradient(circle at 70% 60%, rgba(57, 255, 20, 0.2), transparent 40%),\n        radial-gradient(circle at 50% 80%, rgba(57, 255, 20, 0.25), transparent 40%);\n    animation: heat-shift 4s ease-in-out infinite;\n}\n\n@keyframes heat-shift {\n    0%, 100% { opacity: 0.5; }\n    50% { opacity: 0.8; }\n}\n\n.pie-visual {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n}\n\n.pie-chart {\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    background: conic-gradient(\n        var(--accent-green) 0deg 120deg,\n        var(--accent-yellow) 120deg 240deg,\n        var(--accent-red) 240deg 360deg\n    );\n    box-shadow: 0 0 15px rgba(57, 255, 20, 0.4);\n    animation: pie-spin 10s linear infinite;\n}\n\n@keyframes pie-spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n\n/* Main Content Area */\n.main-content {\n    margin-left: 70px;\n    min-height: 100vh;\n    padding: 2rem;\n    transition: margin-left 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    position: relative;\n}\n\n/* Backdrop overlay for preview panel */\n.preview-backdrop {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    background: rgba(0, 0, 0, 0.4);\n    backdrop-filter: blur(2px);\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    z-index: 9998;\n    pointer-events: none;\n}\n\n.preview-backdrop.show {\n    opacity: 1;\n    visibility: visible;\n}\n\n/* View Containers */\n.view-container {\n    display: none;\n    animation: fadeIn 0.4s ease-in-out;\n}\n\n.view-container.active {\n    display: block;\n}\n\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n        transform: translateY(10px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n/* Dashboard Header */\n.dashboard-header {\n    text-align: center;\n    margin-bottom: 2.5rem;\n}\n\n.header-content h1 {\n    font-size: 2.5rem;\n    margin-bottom: 0.5rem;\n    color: var(--accent-green);\n    font-weight: 700;\n    letter-spacing: 2px;\n}\n\n.header-content .subtitle {\n    font-size: 1.2rem;\n    color: var(--text-secondary);\n    font-weight: 500;\n}\n\n.pulse-icon {\n    display: inline-block;\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n@keyframes pulse-scale {\n    0%, 100% {\n        transform: scale(1);\n        filter: drop-shadow(0 0 5px var(--success-glow));\n    }\n    50% {\n        transform: scale(1.05);\n        filter: drop-shadow(0 0 15px var(--success-glow));\n    }\n}\n\n/* Animations */\n.animate-slide-in {\n    animation: slideIn 0.6s ease-out;\n}\n\n@keyframes slideIn {\n    from {\n        opacity: 0;\n        transform: translateX(-30px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n.animate-fade-in {\n    animation: fadeInUp 0.6s ease-out;\n}\n\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.container {\n    max-width: 1400px;\n    margin: 0 auto;\n}\n\n/* Theme Toggle Button */\n.theme-toggle {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    background: rgba(15, 15, 15, 0.85);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50px;\n    padding: 10px 20px;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    font-size: 1rem;\n    color: var(--text-primary);\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px rgba(57, 255, 20, 0.2);\n    font-weight: 600;\n}\n\n.theme-toggle:hover {\n    background: rgba(15, 15, 15, 0.8);\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.theme-toggle .icon {\n    font-size: 1.2rem;\n}\n\n/* Auto-scroll indicators */\n.scroll-indicator {\n    position: fixed;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 60px;\n    height: 60px;\n    background: rgba(57, 255, 20, 0.15);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 2px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    opacity: 0;\n    pointer-events: none;\n    transition: opacity 0.3s ease;\n    z-index: 10001;\n}\n\n.scroll-indicator.visible {\n    opacity: 1;\n    animation: scroll-pulse 1.5s ease-in-out infinite;\n}\n\n.scroll-indicator.scroll-up {\n    top: 20px;\n}\n\n.scroll-indicator.scroll-down {\n    bottom: 20px;\n}\n\n.scroll-indicator i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    animation: scroll-bounce 1s ease-in-out infinite;\n}\n\n.scroll-up i {\n    animation-name: scroll-bounce-up;\n}\n\n.scroll-down i {\n    animation-name: scroll-bounce-down;\n}\n\n@keyframes scroll-pulse {\n    0%, 100% {\n        box-shadow: 0 0 10px rgba(57, 255, 20, 0.3);\n    }\n    50% {\n        box-shadow: 0 0 25px rgba(57, 255, 20, 0.6);\n    }\n}\n\n@keyframes scroll-bounce-up {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(-5px);\n    }\n}\n\n@keyframes scroll-bounce-down {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(5px);\n    }\n}\n\n/* Threat Ticker */\n.threat-ticker-container {\n    background: var(--bg-secondary);\n    border: 2px solid var(--accent-green);\n    border-radius: 8px;\n    padding: 12px;\n    margin-bottom: 2rem;\n    display: flex;\n    align-items: center;\n    gap: 16px;\n    overflow: hidden;\n    box-shadow: 0 2px 8px var(--success-glow);\n}\n\n.ticker-label {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 8px 16px;\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    border-radius: 6px;\n    font-weight: 700;\n    font-size: 0.75rem;\n    color: #fff;\n    white-space: nowrap;\n    box-shadow: 0 2px 8px rgba(255, 71, 87, 0.4);\n}\n\n.ticker-label i {\n    animation: pulse-broadcast 2s infinite;\n}\n\n@keyframes pulse-broadcast {\n    0%, 100% { opacity: 1; transform: scale(1); }\n    50% { opacity: 0.6; transform: scale(0.9); }\n}\n\n.threat-ticker {\n    flex: 1;\n    overflow: hidden;\n    position: relative;\n}\n\n.ticker-content {\n    display: flex;\n    gap: 40px;\n    white-space: nowrap;\n    animation: scroll-ticker 30s linear infinite;\n}\n\n.ticker-content:hover {\n    animation-play-state: paused;\n}\n\n@keyframes scroll-ticker {\n    0% { transform: translateX(0); }\n    100% { transform: translateX(-50%); }\n}\n\n.ticker-item {\n    color: #e0e0e0;\n    font-size: 0.9rem;\n    display: inline-flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.ticker-item i {\n    font-size: 0.5rem;\n    animation: blink 1.5s infinite;\n}\n\n@keyframes blink {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.3; }\n}\n\n/* Notification System */\n.notification-container {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    max-width: 400px;\n}\n\n.threat-notification {\n    background: rgba(30, 30, 30, 0.98);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 8px;\n    padding: 16px;\n    display: flex;\n    gap: 12px;\n    align-items: flex-start;\n    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);\n    transform: translateX(450px);\n    opacity: 0;\n    transition: all 0.3s ease-out;\n}\n\n.threat-notification.show {\n    transform: translateX(0);\n    opacity: 1;\n}\n\n.notification-icon {\n    font-size: 1.5rem;\n    flex-shrink: 0;\n}\n\n.notification-content {\n    flex: 1;\n}\n\n.notification-title {\n    font-size: 0.95rem;\n    color: #e0e0e0;\n    margin-bottom: 4px;\n}\n\n.notification-title strong {\n    text-transform: uppercase;\n    font-weight: 800;\n}\n\n.notification-details {\n    font-size: 0.85rem;\n    color: #b0b0b0;\n    margin-bottom: 6px;\n}\n\n.notification-meta {\n    font-size: 0.75rem;\n    color: #888;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.notification-close {\n    cursor: pointer;\n    color: #666;\n    transition: color 0.2s;\n    font-size: 0.9rem;\n}\n\n.notification-close:hover {\n    color: #e0e0e0;\n}\n\n/* Stat Card Pulse Animation */\n.stat-pulse {\n    animation: stat-pulse-animation 0.6s ease-out;\n}\n\n@keyframes stat-pulse-animation {\n    0% { transform: scale(1); }\n    50% { transform: scale(1.05); box-shadow: 0 8px 24px rgba(90, 156, 248, 0.4); }\n    100% { transform: scale(1); }\n}\n\nh1 {\n    font-size: 2.5rem;\n    color: #5a9cf8;\n    margin-bottom: 0.5rem;\n}\n\n.subtitle {\n    color: #888;\n    font-size: 1.1rem;\n}\n\n.stats-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1.5rem;\n    margin-bottom: 3rem;\n}\n\n.stat-card {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 1.5rem;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.8rem;\n    position: relative;\n    overflow: hidden;\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.stat-card::before {\n    content: '';\n    position: absolute;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: radial-gradient(circle, var(--accent-green) 0%, transparent 70%);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover::before {\n    opacity: 0.05;\n}\n\n.stat-card:hover {\n    transform: translateY(-5px) scale(1.02);\n    border-color: var(--accent-green);\n    box-shadow: 0 10px 30px var(--success-glow);\n}\n\n.stat-card i {\n    font-size: 2.5rem;\n    opacity: 0.8;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover i {\n    transform: scale(1.1) rotateY(180deg);\n    opacity: 1;\n}\n\n.stat-number {\n    font-size: 2.5rem;\n    font-weight: 700;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover .stat-number {\n    transform: scale(1.1);\n    text-shadow: 0 0 20px currentColor;\n}\n\n.stat-label {\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n    font-weight: 600;\n}\n\n.stat-glow {\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    height: 3px;\n    background: linear-gradient(90deg, transparent, var(--accent-green), transparent);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover .stat-glow {\n    opacity: 1;\n    animation: glowSlide 2s ease-in-out infinite;\n}\n\n@keyframes glowSlide {\n    0%, 100% {\n        transform: translateX(-100%);\n    }\n    50% {\n        transform: translateX(100%);\n    }\n}\n\n.stat-card.malware {\n    border-color: rgba(255, 59, 59, 0.3);\n}\n\n.stat-card.malware i,\n.stat-card.malware .stat-number {\n    color: var(--accent-red);\n}\n\n.stat-card.malware:hover {\n    border-color: var(--accent-red);\n    box-shadow: 0 10px 30px var(--danger-glow);\n}\n\n.stat-card.suspicious {\n    border-color: rgba(255, 215, 0, 0.3);\n}\n\n.stat-card.suspicious i,\n.stat-card.suspicious .stat-number {\n    color: var(--accent-yellow);\n}\n\n.stat-card.suspicious:hover {\n    border-color: var(--accent-yellow);\n    box-shadow: 0 10px 30px var(--warning-glow);\n}\n\n.stat-card.benign i,\n.stat-card.benign .stat-number,\n.stat-card.info i,\n.stat-card.info .stat-number {\n    color: var(--accent-green);\n}\n\n/* Analytics View */\n.analytics-header {\n    display: flex;\n    align-items: center;\n    gap: 2rem;\n    margin-bottom: 2.5rem;\n}\n\n.back-btn {\n    background: var(--bg-card);\n    border: 2px solid var(--accent-green);\n    color: var(--accent-green);\n    padding: 0.8rem 1.5rem;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 600;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    transition: all 0.3s ease;\n}\n\n.back-btn:hover {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    transform: translateX(-5px);\n    box-shadow: 0 5px 20px var(--success-glow);\n}\n\n.analytics-header h1 {\n    font-size: 2rem;\n    color: var(--accent-green);\n    font-weight: 700;\n}\n\n.analytics-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));\n    gap: 2rem;\n    max-height: calc(100vh - 200px);\n    overflow-y: auto;\n    padding-right: 1rem;\n    grid-auto-flow: dense;\n}\n\n/* Panel size classes for flexible tiling */\n.analytics-panel.panel-small {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-medium {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-large {\n    grid-column: span 2;\n}\n\n@media (max-width: 1400px) {\n    .analytics-grid {\n        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));\n    }\n    \n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n}\n\n.analytics-grid::-webkit-scrollbar {\n    width: 8px;\n}\n\n.analytics-grid::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb:hover {\n    background: var(--accent-green-dim);\n}\n\n.analytics-panel {\n    animation: slideInPanel 0.5s ease-out;\n    animation-fill-mode: backwards;\n}\n\n.analytics-panel:nth-child(1) { animation-delay: 0.05s; }\n.analytics-panel:nth-child(2) { animation-delay: 0.1s; }\n.analytics-panel:nth-child(3) { animation-delay: 0.15s; }\n.analytics-panel:nth-child(4) { animation-delay: 0.2s; }\n.analytics-panel:nth-child(5) { animation-delay: 0.25s; }\n.analytics-panel:nth-child(6) { animation-delay: 0.3s; }\n\n@keyframes slideInPanel {\n    from {\n        opacity: 0;\n        transform: translateY(30px) scale(0.95);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n    }\n}\n\n/* Advanced Analytics Grid for Mini Charts */\n.advanced-analytics-grid {\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 12px;\n    padding: 1.5rem;\n}\n\n.mini-charts-grid {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 1.5rem;\n    margin-top: 1rem;\n}\n\n.mini-chart-container {\n    background: rgba(10, 10, 10, 0.6);\n    border: 1px solid rgba(57, 255, 20, 0.15);\n    border-radius: 8px;\n    padding: 1rem;\n}\n\n.mini-chart-container h3 {\n    color: var(--accent-green);\n    font-size: 0.95rem;\n    margin: 0 0 0.75rem 0;\n    font-weight: 600;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.mini-chart-container h3 i {\n    font-size: 0.9rem;\n}\n\n@media (max-width: 1200px) {\n    .mini-charts-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n/* Emerging Threat Intelligence Panel */\n.eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.1) 0%, rgba(255, 165, 2, 0.1) 100%);\n    border: 2px solid rgba(255, 71, 87, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(255, 71, 87, 0.2);\n}\n\n.eti-header {\n    margin-bottom: 24px;\n}\n\n.eti-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #ff6b6b;\n    text-shadow: 0 2px 4px rgba(255, 71, 87, 0.3);\n}\n\n.eti-header h2 i {\n    color: #ff4757;\n    margin-right: 10px;\n    animation: pulse 2s infinite;\n}\n\n@keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.6; }\n}\n\n.eti-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 8px 0 16px 0;\n}\n\n.eti-summary {\n    display: flex;\n    gap: 12px;\n    flex-wrap: wrap;\n}\n\n.eti-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 6px 14px;\n    border-radius: 20px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.eti-badge.recent {\n    background: rgba(255, 71, 87, 0.2);\n    border-color: rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.eti-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n    gap: 20px;\n}\n\n.eti-panel {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 18px;\n    transition: transform 0.3s, box-shadow 0.3s;\n}\n\n.eti-panel:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);\n}\n\n.eti-panel h3 {\n    margin: 0 0 6px 0;\n    font-size: 1.1rem;\n    color: #e0e0e0;\n}\n\n.eti-panel h3 i {\n    color: #ffa502;\n    margin-right: 8px;\n}\n\n.eti-subtitle-small {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 14px;\n}\n\n.eti-list {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n}\n\n.eti-item {\n    display: flex;\n    gap: 12px;\n    background: rgba(255, 255, 255, 0.03);\n    border: 1px solid rgba(255, 255, 255, 0.08);\n    border-radius: 8px;\n    padding: 12px;\n    transition: all 0.3s;\n}\n\n.eti-item:hover {\n    background: rgba(255, 255, 255, 0.06);\n    border-color: rgba(255, 165, 2, 0.4);\n    transform: translateX(4px);\n}\n\n.eti-rank {\n    flex-shrink: 0;\n    width: 32px;\n    height: 32px;\n    background: linear-gradient(135deg, #ff6b6b, #ffa502);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: bold;\n    font-size: 1rem;\n    color: #fff;\n    box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);\n}\n\n.eti-item[data-rank=\"1\"] .eti-rank {\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    transform: scale(1.1);\n}\n\n.eti-content {\n    flex: 1;\n    min-width: 0;\n}\n\n.eti-name {\n    font-weight: 600;\n    color: #e0e0e0;\n    font-size: 0.95rem;\n    margin-bottom: 4px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-meta {\n    display: flex;\n    gap: 8px;\n    flex-wrap: wrap;\n    align-items: center;\n}\n\n.eti-count {\n    color: #888;\n    font-size: 0.8rem;\n}\n\n.eti-recent-badge {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-agent-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-details {\n    margin-top: 6px;\n    color: #999;\n    font-size: 0.75rem;\n    font-style: italic;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-empty {\n    text-align: center;\n    color: #666;\n    padding: 20px;\n    font-style: italic;\n}\n\n/* Threat Modeler */\n.modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.1) 0%, rgba(38, 222, 129, 0.1) 100%);\n    border: 2px solid rgba(90, 156, 248, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(90, 156, 248, 0.2);\n}\n\n.modeler-header {\n    margin-bottom: 24px;\n}\n\n.modeler-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #5a9cf8;\n}\n\n.modeler-header h2 i {\n    color: #26de81;\n    margin-right: 10px;\n}\n\n.modeler-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 0;\n}\n\n.modeler-grid {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 24px;\n}\n\n@media (max-width: 1024px) {\n    .modeler-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n.modeler-builder,\n.modeler-results {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 20px;\n}\n\n.modeler-builder h3,\n.modeler-results h3 {\n    margin: 0 0 20px 0;\n    font-size: 1.2rem;\n    color: #e0e0e0;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n    padding-bottom: 10px;\n}\n\n.modeler-builder h3 i {\n    color: #26de81;\n    margin-right: 8px;\n}\n\n.modeler-results h3 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.modeler-field {\n    margin-bottom: 20px;\n}\n\n.modeler-field label {\n    display: block;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n    margin-bottom: 6px;\n    font-weight: 600;\n}\n\n.modeler-select {\n    width: 100%;\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.2);\n    border-radius: 6px;\n    color: #e0e0e0;\n    padding: 10px;\n    font-size: 0.9rem;\n    font-family: inherit;\n    cursor: pointer;\n    transition: all 0.3s;\n}\n\n.modeler-select:focus {\n    outline: none;\n    border-color: #5a9cf8;\n    background: rgba(90, 156, 248, 0.1);\n}\n\n.modeler-select option {\n    background: #1a1a2e;\n    color: #e0e0e0;\n    padding: 8px;\n}\n\n.modeler-hint {\n    display: block;\n    color: #666;\n    font-size: 0.75rem;\n    margin-top: 4px;\n    font-style: italic;\n}\n\n.modeler-analyze-btn {\n    width: 100%;\n    background: linear-gradient(135deg, #26de81, #20bf6b);\n    border: none;\n    color: #fff;\n    padding: 14px 24px;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 700;\n    cursor: pointer;\n    transition: all 0.3s;\n    box-shadow: 0 4px 12px rgba(38, 222, 129, 0.3);\n}\n\n.modeler-analyze-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(38, 222, 129, 0.4);\n}\n\n.modeler-analyze-btn i {\n    margin-right: 8px;\n}\n\n.modeler-output {\n    min-height: 400px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.modeler-placeholder {\n    text-align: center;\n    color: #666;\n}\n\n.modeler-placeholder i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n    opacity: 0.5;\n}\n\n.modeler-placeholder p {\n    font-size: 0.95rem;\n}\n\n.modeler-loading {\n    text-align: center;\n    color: #5a9cf8;\n}\n\n.modeler-loading i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.modeler-error {\n    text-align: center;\n    color: #ff4757;\n}\n\n.modeler-error i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.prediction-result {\n    width: 100%;\n}\n\n.prediction-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 24px;\n    padding: 20px;\n    background: rgba(255, 255, 255, 0.05);\n    border-radius: 8px;\n}\n\n.prediction-badge {\n    padding: 12px 24px;\n    border-radius: 8px;\n    font-size: 1.3rem;\n    font-weight: 800;\n    color: #fff;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n\n.prediction-confidence {\n    text-align: right;\n}\n\n.confidence-label {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 4px;\n}\n\n.confidence-value {\n    color: #5a9cf8;\n    font-size: 2rem;\n    font-weight: 800;\n}\n\n.prediction-family {\n    padding: 16px;\n    background: rgba(255, 71, 87, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 6px;\n    margin-bottom: 20px;\n    color: #e0e0e0;\n}\n\n.family-name {\n    color: #ff6b6b;\n    font-weight: 700;\n    font-size: 1.1rem;\n    margin-left: 8px;\n}\n\n.prediction-section {\n    margin-bottom: 20px;\n}\n\n.prediction-section h4 {\n    color: #5a9cf8;\n    font-size: 1rem;\n    margin: 0 0 12px 0;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 6px;\n}\n\n.analysis-item {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    padding: 8px 0;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n}\n\n.analysis-item i {\n    color: #ffa502;\n    width: 20px;\n}\n\n.indicator-group {\n    margin-bottom: 16px;\n}\n\n.indicator-group strong {\n    display: block;\n    color: #e0e0e0;\n    margin-bottom: 8px;\n    font-size: 0.9rem;\n}\n\n.indicator-list {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 8px;\n}\n\n.indicator-tag {\n    padding: 6px 12px;\n    border-radius: 6px;\n    font-size: 0.8rem;\n    font-weight: 600;\n    font-family: 'Courier New', monospace;\n}\n\n.api-tag {\n    background: rgba(255, 165, 2, 0.2);\n    border: 1px solid rgba(255, 165, 2, 0.4);\n    color: #ffa502;\n}\n\n.string-tag {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.prediction-footer {\n    margin-top: 20px;\n    padding: 12px;\n    background: rgba(90, 156, 248, 0.1);\n    border-radius: 6px;\n    color: #5a9cf8;\n    font-size: 0.85rem;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.scans-container {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 2rem;\n    transition: all 0.3s ease;\n}\n\n.scans-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--shadow-color);\n}\n\n.scans-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.scans-header h2 {\n    color: #5a9cf8;\n}\n\n.refresh-btn {\n    background: #5a9cf8;\n    color: white;\n    border: none;\n    padding: 0.75rem 1.5rem;\n    border-radius: 8px;\n    cursor: pointer;\n    font-size: 1rem;\n    transition: background 0.2s;\n}\n\n.refresh-btn:hover {\n    background: #4a8ce8;\n}\n\n.scans-table {\n    width: 100%;\n    border-collapse: collapse;\n}\n\n.scans-table th {\n    text-align: left;\n    padding: 1rem;\n    background: rgba(255, 255, 255, 0.05);\n    color: #5a9cf8;\n    font-weight: 600;\n}\n\n.scans-table td {\n    padding: 1rem;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.scans-table tr:hover {\n    background: rgba(255, 255, 255, 0.03);\n}\n\n.badge {\n    display: inline-block;\n    padding: 0.3rem 0.8rem;\n    border-radius: 6px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.badge.malware { background: #ff4757; color: white; }\n.badge.suspicious { background: #ffa502; color: white; }\n.badge.benign { background: #26de81; color: white; }\n.badge.non-pe { background: #4b5563; color: #fff; }\n\n.hash {\n    font-family: 'Courier New', monospace;\n    font-size: 0.85rem;\n    color: #888;\n}\n\n.empty-state {\n    text-align: center;\n    padding: 3rem;\n    color: #666;\n}\n\n.empty-state i {\n    font-size: 4rem;\n    margin-bottom: 1rem;\n    opacity: 0.3;\n}\n\n/* NEW: Chart Container Styles */\n.chart-container {\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 12px;\n    padding: 2rem;\n    margin-top: 2rem;\n}\n\n.chart-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.chart-header h2 {\n    color: var(--accent-green);\n    margin: 0;\n}\n\n.chart-subtitle {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    margin: 0.5rem 0 0 0;\n    font-weight: normal;\n}\n\n.chart-controls {\n    display: flex;\n    gap: 0.5rem;\n}\n\n.chart-btn {\n    background: rgba(255, 255, 255, 0.05);\n    color: #888;\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    padding: 0.5rem 1rem;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.2s;\n}\n\n.chart-btn:hover {\n    background: rgba(255, 255, 255, 0.1);\n    color: #e0e0e0;\n}\n\n.chart-btn.active {\n    background: #5a9cf8;\n    color: white;\n    border-color: #5a9cf8;\n}\n\n#dailyScansChart {\n    max-height: 400px;\n}\n\n@media (max-width: 1024px) {\n    .analytics-grid {\n        grid-template-columns: 1fr;\n        gap: 1.5rem;\n    }\n    \n    .analytics-panel.panel-small,\n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n    \n    .graphs-preview {\n        width: 400px;\n    }\n}\n\n@media (max-width: 768px) {\n    .main-content {\n        margin-left: 0;\n        padding: 1rem;\n    }\n    \n    .side-panel {\n        width: 50px;\n    }\n    \n    .panel-logo-icon {\n        width: 40px;\n        height: 40px;\n        font-size: 1.5rem;\n    }\n    \n    .graphs-preview {\n        left: 50px;\n        width: calc(100vw - 50px);\n        border-radius: 0;\n    }\n    \n    .dashboard-header h1 {\n        font-size: 1.8rem;\n    }\n    \n    .stats-grid {\n        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n        gap: 1rem;\n    }\n    \n    .chart-header {\n        flex-direction: column;\n        gap: 1rem;\n        align-items: flex-start;\n    }\n    \n    .chart-controls {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .chart-btn {\n        flex: 1;\n    }\n    \n    .map-view-toggle {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .map-btn {\n        flex: 1;\n        font-size: 0.8rem;\n        padding: 0.4rem 0.6rem;\n    }\n    \n    .geo-context-panel {\n        flex-direction: column;\n    }\n    \n    .context-stat {\n        width: 100%;\n    }\n    \n    .map-timeline-control {\n        flex-direction: column;\n        gap: 0.5rem;\n    }\n    \n    .timeline-info {\n        text-align: center;\n    }\n    \n    .analytics-header {\n        flex-direction: column;\n        align-items: flex-start;\n    }\n}\n\n/* Map Container */\n.map-container {\n    background: var(--bg-card);\n    border-radius: 12px;\n    padding: 24px;\n    box-shadow: 0 4px 12px var(--shadow-color);\n    border: 2px solid var(--border-color);\n    transition: all 0.3s ease;\n    min-height: 600px;\n}\n\n.map-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 8px 24px var(--shadow-color), 0 0 20px var(--success-glow);\n}\n\n#worldMap {\n    width: 100%;\n    height: 500px;\n    border-radius: 8px;\n    margin-bottom: 15px;\n    background: var(--bg-secondary);\n    border: 1px solid var(--border-color);\n    z-index: 1;\n    position: relative;\n}\n\n.map-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 20px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.map-header h2 {\n    margin: 0;\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-header h2 i {\n    color: var(--accent-green);\n    margin-right: 8px;\n}\n\n.map-controls {\n    display: flex;\n    gap: 20px;\n    align-items: center;\n    flex-wrap: wrap;\n}\n\n.map-view-toggle {\n    display: flex;\n    gap: 8px;\n    background: var(--bg-secondary);\n    padding: 4px;\n    border-radius: 8px;\n    border: 1px solid var(--border-color);\n}\n\n.map-btn {\n    background: transparent;\n    border: none;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.map-btn:hover {\n    background: var(--bg-hover);\n    color: var(--text-primary);\n}\n\n.map-btn.active {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    box-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-btn i {\n    font-size: 1rem;\n}\n\n.map-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.legend-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n}\n\n.legend-dot {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    box-shadow: 0 0 6px currentColor;\n}\n\n.malware-dot {\n    background-color: var(--accent-red);\n}\n\n.suspicious-dot {\n    background-color: var(--accent-yellow);\n}\n\n.benign-dot {\n    background-color: var(--accent-green);\n}\n\n.geo-context-panel {\n    display: flex;\n    justify-content: space-around;\n    gap: 20px;\n    padding: 15px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-bottom: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.context-stat {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 5px;\n}\n\n.context-label {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.context-value {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.context-value.threat-count {\n    color: var(--accent-red);\n    text-shadow: 0 0 10px var(--danger-glow);\n}\n\n.map-timeline-control {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 12px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-top: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.timeline-btn {\n    background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-green-dim) 100%);\n    color: var(--bg-primary);\n    border: none;\n    padding: 10px 20px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.95rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    box-shadow: 0 4px 12px var(--success-glow);\n}\n\n.timeline-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px var(--success-glow);\n    filter: brightness(1.1);\n}\n\n.timeline-btn i {\n    font-size: 1rem;\n}\n\n.timeline-info {\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-style: italic;\n}\n\n#worldMap {\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n}\n\n/* Leaflet popup customization for theme */\n.leaflet-popup-content-wrapper {\n    background: var(--bg-card) !important;\n    color: var(--text-primary) !important;\n    border: 2px solid var(--accent-green) !important;\n    box-shadow: 0 4px 15px var(--shadow-color) !important;\n    border-radius: 8px !important;\n}\n\n.leaflet-popup-tip {\n    background: var(--bg-card) !important;\n}\n\n.leaflet-popup-content h3 {\n    color: var(--accent-green) !important;\n}\n\n.leaflet-popup-content button {\n    background: var(--accent-green) !important;\n    color: var(--bg-primary) !important;\n    border: none !important;\n    padding: 8px 16px !important;\n    border-radius: 6px !important;\n    cursor: pointer !important;\n    font-weight: 600 !important;\n    transition: all 0.2s ease !important;\n}\n\n.leaflet-popup-content button:hover {\n    transform: translateY(-2px) !important;\n    box-shadow: 0 4px 12px var(--success-glow) !important;\n}\n\n/* Correlation Graph */\n.correlation-container {\n    background: rgba(255, 255, 255, 0.03);\n    border-radius: 12px;\n    padding: 24px;\n    margin-top: 24px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.correlation-header {\n    margin-bottom: 20px;\n}\n\n.correlation-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.5rem;\n    color: #e0e0e0;\n}\n\n.correlation-header h2 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.correlation-subtitle {\n    color: #888;\n    font-size: 0.9rem;\n    margin: 0;\n}\n\n.graph-controls {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 16px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.graph-btn {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.3s;\n}\n\n.graph-btn:hover {\n    background: rgba(90, 156, 248, 0.3);\n    border-color: #5a9cf8;\n}\n\n.graph-btn i {\n    margin-right: 6px;\n}\n\n.graph-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.node-sample {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    border: 2px solid #fff;\n}\n\n.malware-node {\n    background-color: #ff4757;\n}\n\n.agent-node {\n    background-color: #5a9cf8;\n}\n\n.api-node {\n    background-color: #ffa502;\n}\n\n.string-node {\n    background-color: #26de81;\n}\n\n#correlationGraph {\n    width: 100%;\n    min-height: 600px;\n    position: relative;\n    border-radius: 8px;\n    overflow: hidden;\n}\n\n.node-details {\n    position: absolute;\n    right: 24px;\n    top: 120px;\n    background: rgba(30, 30, 30, 0.95);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    border-radius: 8px;\n    padding: 16px;\n    max-width: 300px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    z-index: 1000;\n}\n\n.node-details h3 {\n    margin: 0 0 12px 0;\n    color: #5a9cf8;\n    font-size: 1.1rem;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 8px;\n}\n\n.node-details p {\n    margin: 8px 0;\n    color: #e0e0e0;\n    font-size: 0.9rem;\n}\n\n.node-details ul {\n    color: #b0b0b0;\n    font-size: 0.85rem;\n}\n\n.node-details li {\n    margin: 4px 0;\n}\n\n/* ========================================\n   LIGHT THEME CONTRAST FIXES\n   ======================================== */\n\n/* Fix 1 & 2: Analytics preview backgrounds - lighter for better green contrast */\n[data-theme=\"light\"] .eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.05) 0%, rgba(255, 165, 2, 0.05) 100%);\n    border-color: rgba(255, 71, 87, 0.2);\n}\n\n[data-theme=\"light\"] .modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.05) 0%, rgba(38, 222, 129, 0.05) 100%);\n    border-color: rgba(90, 156, 248, 0.2);\n}\n\n/* Fix 3: Theme toggle button text - darker for contrast */\n[data-theme=\"light\"] .theme-toggle {\n    color: #1a1f2e;\n    background: rgba(255, 255, 255, 0.8);\n    border-color: rgba(46, 214, 15, 0.4);\n}\n\n/* Fix 4: Daily Analysis chart - darker labels and grid (handled in JS via CSS vars) */\n[data-theme=\"light\"] {\n    --chart-text-color: #374151;\n    --chart-grid-color: rgba(0, 0, 0, 0.12);\n}\n\n:root {\n    --chart-text-color: #9ca3af;\n    --chart-grid-color: rgba(255, 255, 255, 0.1);\n}\n\n/* Fix 5: Chart container labels - darker in light theme */\n[data-theme=\"light\"] .chart-header h2,\n[data-theme=\"light\"] .chart-header {\n    color: #1a1f2e;\n}\n\n/* Fix 6: Threat Vector Correlation header - darker */\n[data-theme=\"light\"] .correlation-header h2 {\n    color: #1a1f2e;\n}\n\n[data-theme=\"light\"] .correlation-subtitle {\n    color: #4a5568;\n}\n\n/* Fix 7: ETI subtitle and summary - darker for better contrast */\n[data-theme=\"light\"] .eti-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .eti-summary {\n    color: #374151;\n}\n\n/* Fix 8: Prediction labels in threat modeler - darker */\n[data-theme=\"light\"] .modeler-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .modeler-field label {\n    color: #374151;\n}\n\n[data-theme=\"light\"] .modeler-hint {\n    color: #6b7280;\n}\n\n/* Fix 9: Analytics preview backgrounds - much lighter for green text visibility */\n[data-theme=\"light\"] .preview-box {\n    background: rgba(255, 255, 255, 0.6);\n    border-color: rgba(46, 214, 15, 0.3);\n}\n\n/* Fix 10: ETI item text - lighter for better readability */\n[data-theme=\"light\"] .eti-count {\n    color: #6b7280;\n}\n\n[data-theme=\"light\"] .eti-details {\n    color: #9ca3af;\n}\n\n[data-theme=\"light\"] .eti-name {\n    color: #1f2937;\n}\n\n/* Fix 11: Make ETI details much more visible in light theme */\n[data-theme=\"light\"] .eti-details {\n    color: #5a9cf8;\n    font-weight: 500;\n}\n\n/* Fix 12: Threat ticker text visibility in light theme */\n[data-theme=\"light\"] .ticker-item {\n    color: #374151;\n    font-weight: 500;\n}\n\n/* Back to Top Button */\n.back-to-top {\n    position: fixed;\n    bottom: 30px;\n    right: 30px;\n    width: 50px;\n    height: 50px;\n    background: linear-gradient(135deg, var(--accent-green), var(--accent-green-dim));\n    border: 2px solid var(--accent-green);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    z-index: 9998;\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px var(--success-glow);\n    color: #000;\n    font-size: 1.2rem;\n}\n\n.back-to-top.visible {\n    opacity: 1;\n    visibility: visible;\n}\n\n.back-to-top:hover {\n    transform: translateY(-5px) scale(1.1);\n    box-shadow: 0 6px 30px var(--success-glow);\n}\n\n.back-to-top:active {\n    transform: translateY(-2px) scale(1.05);\n}\n\n[data-theme=\"light\"] .back-to-top {\n    background: linear-gradient(135deg, #2ed60f, #27b00c);\n    color: #fff;\n}\n","epoch":15,"telemetryInfo":{}}],["file:///home/trang/localnsv/mAIware-server/public/styles.css::request_22000fc3-1554-4fe6-b1a3-e47e57297a0e",{"uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/styles.css","external":"file:///home/trang/localnsv/mAIware-server/public/styles.css","path":"/home/trang/localnsv/mAIware-server/public/styles.css","scheme":"file"},"requestId":"request_22000fc3-1554-4fe6-b1a3-e47e57297a0e","content":":root {\n    --bg-primary: #000000;\n    --bg-secondary: #0a0a0a;\n    --bg-card: #0f0f0f;\n    --bg-hover: #151515;\n    --text-primary: #e8f0e8;\n    --text-secondary: #9ca3af;\n    --accent-green: #39ff14;\n    --accent-green-dim: #2ed60f;\n    --accent-yellow: #ffd700;\n    --accent-red: #ff3b3b;\n    --accent-red-dim: #cc2f2f;\n    --border-color: #1a1a1a;\n    --shadow-color: rgba(0, 0, 0, 0.5);\n    --success-glow: rgba(57, 255, 20, 0.3);\n    --danger-glow: rgba(255, 59, 59, 0.3);\n    --warning-glow: rgba(255, 215, 0, 0.3);\n}\n\n[data-theme=\"light\"] {\n    --bg-primary: #f0f4f0;\n    --bg-secondary: #ffffff;\n    --bg-card: #fafafa;\n    --bg-hover: #e8f5e8;\n    --text-primary: #1a1f2e;\n    --text-secondary: #4a5568;\n    --accent-green: #2ed60f;\n    --accent-green-dim: #27b00c;\n    --accent-yellow: #cc9a00;\n    --accent-red: #dc2626;\n    --accent-red-dim: #b91c1c;\n    --border-color: #d1d5db;\n    --shadow-color: rgba(0, 0, 0, 0.1);\n    --success-glow: rgba(46, 214, 15, 0.2);\n    --danger-glow: rgba(220, 38, 38, 0.2);\n    --warning-glow: rgba(204, 154, 0, 0.2);\n    /* Chart theming overrides for light mode */\n    --chart-text-color: #374151; /* slate-700 for better contrast */\n    --chart-grid-color: rgba(0, 0, 0, 0.08);\n}\n\n* { \n    margin: 0; \n    padding: 0; \n    box-sizing: border-box; \n}\n\nbody {\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    background: var(--bg-primary);\n    color: var(--text-primary);\n    min-height: 100vh;\n    margin: 0;\n    overflow-x: hidden;\n    position: relative;\n}\n\nbody::before {\n    content: '';\n    position: fixed;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: \n        radial-gradient(circle at 20% 50%, rgba(57, 255, 20, 0.08) 0%, transparent 50%),\n        radial-gradient(circle at 80% 80%, rgba(57, 255, 20, 0.06) 0%, transparent 50%),\n        radial-gradient(circle at 40% 20%, rgba(57, 255, 20, 0.05) 0%, transparent 50%);\n    animation: backgroundGlow 15s ease-in-out infinite;\n    pointer-events: none;\n    z-index: 0;\n}\n\n@keyframes backgroundGlow {\n    0%, 100% { \n        transform: translate(0, 0) scale(1);\n        opacity: 0.4;\n    }\n    33% { \n        transform: translate(10%, 10%) scale(1.1);\n        opacity: 0.6;\n    }\n    66% { \n        transform: translate(-10%, 5%) scale(0.95);\n        opacity: 0.5;\n    }\n}\n\nbody > * {\n    position: relative;\n    z-index: 1;\n}\n\n/* Side Panel Navigation */\n.side-panel {\n    position: fixed;\n    left: 0;\n    top: 0;\n    height: 100vh;\n    width: 70px;\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border-right: 1px solid rgba(57, 255, 20, 0.2);\n    box-shadow: 0 0 30px rgba(57, 255, 20, 0.1);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    z-index: 9999;\n    transition: all 0.3s ease;\n}\n\n.side-panel:hover {\n    background: rgba(15, 15, 15, 0.8);\n    box-shadow: 0 0 40px rgba(57, 255, 20, 0.2);\n}\n\n.panel-icon-strip {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 2rem 0;\n}\n\n.panel-logo-icon {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 50px;\n    height: 50px;\n    color: var(--accent-green);\n    font-size: 2rem;\n    animation: pulse-glow 3s ease-in-out infinite;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.panel-logo-icon:hover {\n    transform: scale(1.1);\n    filter: drop-shadow(0 0 20px var(--success-glow));\n}\n\n@keyframes pulse-glow {\n    0%, 100% { filter: drop-shadow(0 0 5px var(--success-glow)); }\n    50% { filter: drop-shadow(0 0 15px var(--success-glow)) drop-shadow(0 0 25px var(--success-glow)); }\n}\n\n/* Graphs Preview Grid */\n.graphs-preview {\n    position: fixed;\n    left: 70px;\n    top: 50%;\n    transform: translateY(-50%) translateX(-100%);\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-left: none;\n    border-radius: 0 12px 12px 0;\n    padding: 2rem;\n    width: 480px;\n    max-height: 90vh;\n    overflow-y: auto;\n    opacity: 0;\n    visibility: hidden;\n    pointer-events: none;\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease, visibility 0.3s;\n    box-shadow: 5px 0 40px rgba(57, 255, 20, 0.15);\n    z-index: 9998;\n    will-change: transform, opacity;\n}\n\n.graphs-preview::-webkit-scrollbar {\n    width: 6px;\n}\n\n.graphs-preview::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 3px;\n}\n\n.graphs-preview::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 3px;\n}\n\n.graphs-preview.show {\n    opacity: 1;\n    visibility: visible;\n    pointer-events: auto;\n    transform: translateY(-50%) translateX(0);\n}\n\n.preview-header {\n    margin-bottom: 1rem;\n    padding-bottom: 0.8rem;\n    border-bottom: 1px solid var(--border-color);\n}\n\n.preview-header h3 {\n    color: var(--accent-green);\n    font-size: 1.1rem;\n    margin-bottom: 0.3rem;\n}\n\n.preview-header p {\n    color: var(--text-secondary);\n    font-size: 0.85rem;\n}\n\n/* Analytics Miniview - Scaled down live view */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-content {\n    width: 100%;\n    height: 100%;\n    transform-origin: top left;\n    transform: scale(0.25);\n    width: 400%;\n    height: 400%;\n    pointer-events: none;\n    overflow: hidden;\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n.preview-home-nav {\n    margin-top: 1.5rem;\n    padding: 1rem;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 10px;\n    display: flex;\n    align-items: center;\n    gap: 0.8rem;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    opacity: 0;\n    visibility: hidden;\n    transform: translateY(10px);\n}\n\n.preview-home-nav.visible {\n    opacity: 1;\n    visibility: visible;\n    transform: translateY(0);\n}\n\n.preview-home-nav:hover {\n    background: var(--bg-hover);\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.preview-home-nav i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n}\n\n.preview-home-nav span {\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--text-primary);\n}\n\n.preview-label {\n    flex: 1;\n    font-size: 0.95rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    letter-spacing: 0.3px;\n}\n\n/* Analytics Miniview - Screenshot preview */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    padding: 1.5rem;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-preview {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    opacity: 0.7;\n}\n\n.preview-row {\n    display: flex;\n    gap: 1rem;\n    flex: 1;\n}\n\n.preview-box {\n    flex: 1;\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 6px;\n    position: relative;\n    overflow: hidden;\n    padding: 0.5rem;\n}\n\n.preview-box.large {\n    flex: 2;\n}\n\n.preview-box.wide {\n    flex: 1;\n    min-height: 150px;\n}\n\n.box-header {\n    font-size: 0.65rem;\n    color: var(--accent-green);\n    margin-bottom: 0.5rem;\n    opacity: 0.8;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.box-content {\n    height: calc(100% - 1.5rem);\n    position: relative;\n}\n\n.map-visual {\n    background: radial-gradient(circle at center, rgba(57, 255, 20, 0.05), transparent);\n    position: relative;\n}\n\n.map-dot {\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 10px var(--accent-green);\n    animation: map-pulse 2s ease-in-out infinite;\n}\n\n.map-dot:nth-child(2) { animation-delay: 0.5s; }\n.map-dot:nth-child(3) { animation-delay: 1s; }\n\n@keyframes map-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.6; }\n    50% { transform: scale(1.5); opacity: 1; }\n}\n\n.chart-visual {\n    display: flex;\n    align-items: flex-end;\n    justify-content: space-around;\n    height: 100%;\n    padding: 0.5rem;\n    gap: 0.3rem;\n}\n\n.chart-bar {\n    flex: 1;\n    background: linear-gradient(180deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    animation: bar-grow 2s ease-in-out infinite;\n    opacity: 0.7;\n}\n\n.chart-bar:nth-child(2) { animation-delay: 0.2s; }\n.chart-bar:nth-child(3) { animation-delay: 0.4s; }\n.chart-bar:nth-child(4) { animation-delay: 0.6s; }\n\n@keyframes bar-grow {\n    0%, 100% { transform: scaleY(0.8); }\n    50% { transform: scaleY(1); }\n}\n\n.list-visual {\n    display: flex;\n    flex-direction: column;\n    gap: 0.4rem;\n    padding: 0.3rem;\n}\n\n.list-item {\n    height: 0.4rem;\n    background: linear-gradient(90deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    opacity: 0.6;\n    animation: list-fade 3s ease-in-out infinite;\n}\n\n.list-item:nth-child(2) { animation-delay: 0.5s; width: 80%; }\n.list-item:nth-child(3) { animation-delay: 1s; width: 60%; }\n\n@keyframes list-fade {\n    0%, 100% { opacity: 0.4; }\n    50% { opacity: 0.8; }\n}\n\n.network-visual {\n    position: relative;\n    height: 100%;\n}\n\n.network-node {\n    position: absolute;\n    width: 6px;\n    height: 6px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 8px var(--accent-green);\n    animation: node-pulse 3s ease-in-out infinite;\n}\n\n.network-node:nth-child(2) { animation-delay: 0.7s; }\n.network-node:nth-child(3) { animation-delay: 1.4s; }\n\n@keyframes node-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.5; }\n    50% { transform: scale(1.3); opacity: 1; }\n}\n\n.heat-visual {\n    background: \n        radial-gradient(circle at 30% 30%, rgba(57, 255, 20, 0.3), transparent 40%),\n        radial-gradient(circle at 70% 60%, rgba(57, 255, 20, 0.2), transparent 40%),\n        radial-gradient(circle at 50% 80%, rgba(57, 255, 20, 0.25), transparent 40%);\n    animation: heat-shift 4s ease-in-out infinite;\n}\n\n@keyframes heat-shift {\n    0%, 100% { opacity: 0.5; }\n    50% { opacity: 0.8; }\n}\n\n.pie-visual {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n}\n\n.pie-chart {\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    background: conic-gradient(\n        var(--accent-green) 0deg 120deg,\n        var(--accent-yellow) 120deg 240deg,\n        var(--accent-red) 240deg 360deg\n    );\n    box-shadow: 0 0 15px rgba(57, 255, 20, 0.4);\n    animation: pie-spin 10s linear infinite;\n}\n\n@keyframes pie-spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n\n/* Main Content Area */\n.main-content {\n    margin-left: 70px;\n    min-height: 100vh;\n    padding: 2rem;\n    transition: margin-left 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    position: relative;\n}\n\n/* Backdrop overlay for preview panel */\n.preview-backdrop {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    background: rgba(0, 0, 0, 0.4);\n    backdrop-filter: blur(2px);\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    z-index: 9998;\n    pointer-events: none;\n}\n\n.preview-backdrop.show {\n    opacity: 1;\n    visibility: visible;\n}\n\n/* View Containers */\n.view-container {\n    display: none;\n    animation: fadeIn 0.4s ease-in-out;\n}\n\n.view-container.active {\n    display: block;\n}\n\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n        transform: translateY(10px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n/* Dashboard Header */\n.dashboard-header {\n    text-align: center;\n    margin-bottom: 2.5rem;\n}\n\n.header-content h1 {\n    font-size: 2.5rem;\n    margin-bottom: 0.5rem;\n    color: var(--accent-green);\n    font-weight: 700;\n    letter-spacing: 2px;\n}\n\n.header-content .subtitle {\n    font-size: 1.2rem;\n    color: var(--text-secondary);\n    font-weight: 500;\n}\n\n.pulse-icon {\n    display: inline-block;\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n@keyframes pulse-scale {\n    0%, 100% {\n        transform: scale(1);\n        filter: drop-shadow(0 0 5px var(--success-glow));\n    }\n    50% {\n        transform: scale(1.05);\n        filter: drop-shadow(0 0 15px var(--success-glow));\n    }\n}\n\n/* Animations */\n.animate-slide-in {\n    animation: slideIn 0.6s ease-out;\n}\n\n@keyframes slideIn {\n    from {\n        opacity: 0;\n        transform: translateX(-30px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n.animate-fade-in {\n    animation: fadeInUp 0.6s ease-out;\n}\n\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.container {\n    max-width: 1400px;\n    margin: 0 auto;\n}\n\n/* Theme Toggle Button */\n.theme-toggle {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    background: rgba(15, 15, 15, 0.85);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50px;\n    padding: 10px 20px;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    font-size: 1rem;\n    color: var(--text-primary);\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px rgba(57, 255, 20, 0.2);\n    font-weight: 600;\n}\n\n.theme-toggle:hover {\n    background: rgba(15, 15, 15, 0.8);\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.theme-toggle .icon {\n    font-size: 1.2rem;\n}\n\n/* Auto-scroll indicators */\n.scroll-indicator {\n    position: fixed;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 60px;\n    height: 60px;\n    background: rgba(57, 255, 20, 0.15);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 2px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    opacity: 0;\n    pointer-events: none;\n    transition: opacity 0.3s ease;\n    z-index: 10001;\n}\n\n.scroll-indicator.visible {\n    opacity: 1;\n    animation: scroll-pulse 1.5s ease-in-out infinite;\n}\n\n.scroll-indicator.scroll-up {\n    top: 20px;\n}\n\n.scroll-indicator.scroll-down {\n    bottom: 20px;\n}\n\n.scroll-indicator i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    animation: scroll-bounce 1s ease-in-out infinite;\n}\n\n.scroll-up i {\n    animation-name: scroll-bounce-up;\n}\n\n.scroll-down i {\n    animation-name: scroll-bounce-down;\n}\n\n@keyframes scroll-pulse {\n    0%, 100% {\n        box-shadow: 0 0 10px rgba(57, 255, 20, 0.3);\n    }\n    50% {\n        box-shadow: 0 0 25px rgba(57, 255, 20, 0.6);\n    }\n}\n\n@keyframes scroll-bounce-up {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(-5px);\n    }\n}\n\n@keyframes scroll-bounce-down {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(5px);\n    }\n}\n\n/* Threat Ticker */\n.threat-ticker-container {\n    background: var(--bg-secondary);\n    border: 2px solid var(--accent-green);\n    border-radius: 8px;\n    padding: 12px;\n    margin-bottom: 2rem;\n    display: flex;\n    align-items: center;\n    gap: 16px;\n    overflow: hidden;\n    box-shadow: 0 2px 8px var(--success-glow);\n}\n\n.ticker-label {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 8px 16px;\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    border-radius: 6px;\n    font-weight: 700;\n    font-size: 0.75rem;\n    color: #fff;\n    white-space: nowrap;\n    box-shadow: 0 2px 8px rgba(255, 71, 87, 0.4);\n}\n\n.ticker-label i {\n    animation: pulse-broadcast 2s infinite;\n}\n\n@keyframes pulse-broadcast {\n    0%, 100% { opacity: 1; transform: scale(1); }\n    50% { opacity: 0.6; transform: scale(0.9); }\n}\n\n.threat-ticker {\n    flex: 1;\n    overflow: hidden;\n    position: relative;\n}\n\n.ticker-content {\n    display: flex;\n    gap: 40px;\n    white-space: nowrap;\n    animation: scroll-ticker 30s linear infinite;\n}\n\n.ticker-content:hover {\n    animation-play-state: paused;\n}\n\n@keyframes scroll-ticker {\n    0% { transform: translateX(0); }\n    100% { transform: translateX(-50%); }\n}\n\n.ticker-item {\n    color: #e0e0e0;\n    font-size: 0.9rem;\n    display: inline-flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.ticker-item i {\n    font-size: 0.5rem;\n    animation: blink 1.5s infinite;\n}\n\n@keyframes blink {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.3; }\n}\n\n/* Notification System */\n.notification-container {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    max-width: 400px;\n}\n\n.threat-notification {\n    background: rgba(30, 30, 30, 0.98);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 8px;\n    padding: 16px;\n    display: flex;\n    gap: 12px;\n    align-items: flex-start;\n    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);\n    transform: translateX(450px);\n    opacity: 0;\n    transition: all 0.3s ease-out;\n}\n\n.threat-notification.show {\n    transform: translateX(0);\n    opacity: 1;\n}\n\n.notification-icon {\n    font-size: 1.5rem;\n    flex-shrink: 0;\n}\n\n.notification-content {\n    flex: 1;\n}\n\n.notification-title {\n    font-size: 0.95rem;\n    color: #e0e0e0;\n    margin-bottom: 4px;\n}\n\n.notification-title strong {\n    text-transform: uppercase;\n    font-weight: 800;\n}\n\n.notification-details {\n    font-size: 0.85rem;\n    color: #b0b0b0;\n    margin-bottom: 6px;\n}\n\n.notification-meta {\n    font-size: 0.75rem;\n    color: #888;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.notification-close {\n    cursor: pointer;\n    color: #666;\n    transition: color 0.2s;\n    font-size: 0.9rem;\n}\n\n.notification-close:hover {\n    color: #e0e0e0;\n}\n\n/* Stat Card Pulse Animation */\n.stat-pulse {\n    animation: stat-pulse-animation 0.6s ease-out;\n}\n\n@keyframes stat-pulse-animation {\n    0% { transform: scale(1); }\n    50% { transform: scale(1.05); box-shadow: 0 8px 24px rgba(90, 156, 248, 0.4); }\n    100% { transform: scale(1); }\n}\n\nh1 {\n    font-size: 2.5rem;\n    color: #5a9cf8;\n    margin-bottom: 0.5rem;\n}\n\n.subtitle {\n    color: #888;\n    font-size: 1.1rem;\n}\n\n.stats-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1.5rem;\n    margin-bottom: 3rem;\n}\n\n.stat-card {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 1.5rem;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.8rem;\n    position: relative;\n    overflow: hidden;\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.stat-card::before {\n    content: '';\n    position: absolute;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: radial-gradient(circle, var(--accent-green) 0%, transparent 70%);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover::before {\n    opacity: 0.05;\n}\n\n.stat-card:hover {\n    transform: translateY(-5px) scale(1.02);\n    border-color: var(--accent-green);\n    box-shadow: 0 10px 30px var(--success-glow);\n}\n\n.stat-card i {\n    font-size: 2.5rem;\n    opacity: 0.8;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover i {\n    transform: scale(1.1) rotateY(180deg);\n    opacity: 1;\n}\n\n.stat-number {\n    font-size: 2.5rem;\n    font-weight: 700;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover .stat-number {\n    transform: scale(1.1);\n    text-shadow: 0 0 20px currentColor;\n}\n\n.stat-label {\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n    font-weight: 600;\n}\n\n.stat-glow {\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    height: 3px;\n    background: linear-gradient(90deg, transparent, var(--accent-green), transparent);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover .stat-glow {\n    opacity: 1;\n    animation: glowSlide 2s ease-in-out infinite;\n}\n\n@keyframes glowSlide {\n    0%, 100% {\n        transform: translateX(-100%);\n    }\n    50% {\n        transform: translateX(100%);\n    }\n}\n\n.stat-card.malware {\n    border-color: rgba(255, 59, 59, 0.3);\n}\n\n.stat-card.malware i,\n.stat-card.malware .stat-number {\n    color: var(--accent-red);\n}\n\n.stat-card.malware:hover {\n    border-color: var(--accent-red);\n    box-shadow: 0 10px 30px var(--danger-glow);\n}\n\n.stat-card.suspicious {\n    border-color: rgba(255, 215, 0, 0.3);\n}\n\n.stat-card.suspicious i,\n.stat-card.suspicious .stat-number {\n    color: var(--accent-yellow);\n}\n\n.stat-card.suspicious:hover {\n    border-color: var(--accent-yellow);\n    box-shadow: 0 10px 30px var(--warning-glow);\n}\n\n.stat-card.benign i,\n.stat-card.benign .stat-number,\n.stat-card.info i,\n.stat-card.info .stat-number {\n    color: var(--accent-green);\n}\n\n/* Analytics View */\n.analytics-header {\n    display: flex;\n    align-items: center;\n    gap: 2rem;\n    margin-bottom: 2.5rem;\n}\n\n.back-btn {\n    background: var(--bg-card);\n    border: 2px solid var(--accent-green);\n    color: var(--accent-green);\n    padding: 0.8rem 1.5rem;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 600;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    transition: all 0.3s ease;\n}\n\n.back-btn:hover {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    transform: translateX(-5px);\n    box-shadow: 0 5px 20px var(--success-glow);\n}\n\n.analytics-header h1 {\n    font-size: 2rem;\n    color: var(--accent-green);\n    font-weight: 700;\n}\n\n.analytics-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));\n    gap: 2rem;\n    max-height: calc(100vh - 200px);\n    overflow-y: auto;\n    padding-right: 1rem;\n    grid-auto-flow: dense;\n}\n\n/* Panel size classes for flexible tiling */\n.analytics-panel.panel-small {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-medium {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-large {\n    grid-column: span 2;\n}\n\n@media (max-width: 1400px) {\n    .analytics-grid {\n        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));\n    }\n    \n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n}\n\n.analytics-grid::-webkit-scrollbar {\n    width: 8px;\n}\n\n.analytics-grid::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb:hover {\n    background: var(--accent-green-dim);\n}\n\n.analytics-panel {\n    animation: slideInPanel 0.5s ease-out;\n    animation-fill-mode: backwards;\n}\n\n.analytics-panel:nth-child(1) { animation-delay: 0.05s; }\n.analytics-panel:nth-child(2) { animation-delay: 0.1s; }\n.analytics-panel:nth-child(3) { animation-delay: 0.15s; }\n.analytics-panel:nth-child(4) { animation-delay: 0.2s; }\n.analytics-panel:nth-child(5) { animation-delay: 0.25s; }\n.analytics-panel:nth-child(6) { animation-delay: 0.3s; }\n\n@keyframes slideInPanel {\n    from {\n        opacity: 0;\n        transform: translateY(30px) scale(0.95);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n    }\n}\n\n/* Advanced Analytics Grid for Mini Charts */\n.advanced-analytics-grid {\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 12px;\n    padding: 1.5rem;\n}\n\n.mini-charts-grid {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 1.5rem;\n    margin-top: 1rem;\n}\n\n.mini-chart-container {\n    background: rgba(10, 10, 10, 0.6);\n    border: 1px solid rgba(57, 255, 20, 0.15);\n    border-radius: 8px;\n    padding: 1rem;\n}\n\n.mini-chart-container h3 {\n    color: var(--accent-green);\n    font-size: 0.95rem;\n    margin: 0 0 0.75rem 0;\n    font-weight: 600;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.mini-chart-container h3 i {\n    font-size: 0.9rem;\n}\n\n@media (max-width: 1200px) {\n    .mini-charts-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n/* Emerging Threat Intelligence Panel */\n.eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.1) 0%, rgba(255, 165, 2, 0.1) 100%);\n    border: 2px solid rgba(255, 71, 87, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(255, 71, 87, 0.2);\n}\n\n.eti-header {\n    margin-bottom: 24px;\n}\n\n.eti-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #ff6b6b;\n    text-shadow: 0 2px 4px rgba(255, 71, 87, 0.3);\n}\n\n.eti-header h2 i {\n    color: #ff4757;\n    margin-right: 10px;\n    animation: pulse 2s infinite;\n}\n\n@keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.6; }\n}\n\n.eti-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 8px 0 16px 0;\n}\n\n.eti-summary {\n    display: flex;\n    gap: 12px;\n    flex-wrap: wrap;\n}\n\n.eti-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 6px 14px;\n    border-radius: 20px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.eti-badge.recent {\n    background: rgba(255, 71, 87, 0.2);\n    border-color: rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.eti-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n    gap: 20px;\n}\n\n.eti-panel {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 18px;\n    transition: transform 0.3s, box-shadow 0.3s;\n}\n\n.eti-panel:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);\n}\n\n.eti-panel h3 {\n    margin: 0 0 6px 0;\n    font-size: 1.1rem;\n    color: #e0e0e0;\n}\n\n.eti-panel h3 i {\n    color: #ffa502;\n    margin-right: 8px;\n}\n\n.eti-subtitle-small {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 14px;\n}\n\n.eti-list {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n}\n\n.eti-item {\n    display: flex;\n    gap: 12px;\n    background: rgba(255, 255, 255, 0.03);\n    border: 1px solid rgba(255, 255, 255, 0.08);\n    border-radius: 8px;\n    padding: 12px;\n    transition: all 0.3s;\n}\n\n.eti-item:hover {\n    background: rgba(255, 255, 255, 0.06);\n    border-color: rgba(255, 165, 2, 0.4);\n    transform: translateX(4px);\n}\n\n.eti-rank {\n    flex-shrink: 0;\n    width: 32px;\n    height: 32px;\n    background: linear-gradient(135deg, #ff6b6b, #ffa502);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: bold;\n    font-size: 1rem;\n    color: #fff;\n    box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);\n}\n\n.eti-item[data-rank=\"1\"] .eti-rank {\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    transform: scale(1.1);\n}\n\n.eti-content {\n    flex: 1;\n    min-width: 0;\n}\n\n.eti-name {\n    font-weight: 600;\n    color: #e0e0e0;\n    font-size: 0.95rem;\n    margin-bottom: 4px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-meta {\n    display: flex;\n    gap: 8px;\n    flex-wrap: wrap;\n    align-items: center;\n}\n\n.eti-count {\n    color: #888;\n    font-size: 0.8rem;\n}\n\n.eti-recent-badge {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-agent-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-details {\n    margin-top: 6px;\n    color: #999;\n    font-size: 0.75rem;\n    font-style: italic;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-empty {\n    text-align: center;\n    color: #666;\n    padding: 20px;\n    font-style: italic;\n}\n\n/* Threat Modeler */\n.modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.1) 0%, rgba(38, 222, 129, 0.1) 100%);\n    border: 2px solid rgba(90, 156, 248, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(90, 156, 248, 0.2);\n}\n\n.modeler-header {\n    margin-bottom: 24px;\n}\n\n.modeler-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #5a9cf8;\n}\n\n.modeler-header h2 i {\n    color: #26de81;\n    margin-right: 10px;\n}\n\n.modeler-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 0;\n}\n\n.modeler-grid {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 24px;\n}\n\n@media (max-width: 1024px) {\n    .modeler-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n.modeler-builder,\n.modeler-results {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 20px;\n}\n\n.modeler-builder h3,\n.modeler-results h3 {\n    margin: 0 0 20px 0;\n    font-size: 1.2rem;\n    color: #e0e0e0;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n    padding-bottom: 10px;\n}\n\n.modeler-builder h3 i {\n    color: #26de81;\n    margin-right: 8px;\n}\n\n.modeler-results h3 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.modeler-field {\n    margin-bottom: 20px;\n}\n\n.modeler-field label {\n    display: block;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n    margin-bottom: 6px;\n    font-weight: 600;\n}\n\n.modeler-select {\n    width: 100%;\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.2);\n    border-radius: 6px;\n    color: #e0e0e0;\n    padding: 10px;\n    font-size: 0.9rem;\n    font-family: inherit;\n    cursor: pointer;\n    transition: all 0.3s;\n}\n\n.modeler-select:focus {\n    outline: none;\n    border-color: #5a9cf8;\n    background: rgba(90, 156, 248, 0.1);\n}\n\n.modeler-select option {\n    background: #1a1a2e;\n    color: #e0e0e0;\n    padding: 8px;\n}\n\n.modeler-hint {\n    display: block;\n    color: #666;\n    font-size: 0.75rem;\n    margin-top: 4px;\n    font-style: italic;\n}\n\n.modeler-analyze-btn {\n    width: 100%;\n    background: linear-gradient(135deg, #26de81, #20bf6b);\n    border: none;\n    color: #fff;\n    padding: 14px 24px;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 700;\n    cursor: pointer;\n    transition: all 0.3s;\n    box-shadow: 0 4px 12px rgba(38, 222, 129, 0.3);\n}\n\n.modeler-analyze-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(38, 222, 129, 0.4);\n}\n\n.modeler-analyze-btn i {\n    margin-right: 8px;\n}\n\n.modeler-output {\n    min-height: 400px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.modeler-placeholder {\n    text-align: center;\n    color: #666;\n}\n\n.modeler-placeholder i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n    opacity: 0.5;\n}\n\n.modeler-placeholder p {\n    font-size: 0.95rem;\n}\n\n.modeler-loading {\n    text-align: center;\n    color: #5a9cf8;\n}\n\n.modeler-loading i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.modeler-error {\n    text-align: center;\n    color: #ff4757;\n}\n\n.modeler-error i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.prediction-result {\n    width: 100%;\n}\n\n.prediction-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 24px;\n    padding: 20px;\n    background: rgba(255, 255, 255, 0.05);\n    border-radius: 8px;\n}\n\n.prediction-badge {\n    padding: 12px 24px;\n    border-radius: 8px;\n    font-size: 1.3rem;\n    font-weight: 800;\n    color: #fff;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n\n.prediction-confidence {\n    text-align: right;\n}\n\n.confidence-label {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 4px;\n}\n\n.confidence-value {\n    color: #5a9cf8;\n    font-size: 2rem;\n    font-weight: 800;\n}\n\n.prediction-family {\n    padding: 16px;\n    background: rgba(255, 71, 87, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 6px;\n    margin-bottom: 20px;\n    color: #e0e0e0;\n}\n\n.family-name {\n    color: #ff6b6b;\n    font-weight: 700;\n    font-size: 1.1rem;\n    margin-left: 8px;\n}\n\n.prediction-section {\n    margin-bottom: 20px;\n}\n\n.prediction-section h4 {\n    color: #5a9cf8;\n    font-size: 1rem;\n    margin: 0 0 12px 0;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 6px;\n}\n\n.analysis-item {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    padding: 8px 0;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n}\n\n.analysis-item i {\n    color: #ffa502;\n    width: 20px;\n}\n\n.indicator-group {\n    margin-bottom: 16px;\n}\n\n.indicator-group strong {\n    display: block;\n    color: #e0e0e0;\n    margin-bottom: 8px;\n    font-size: 0.9rem;\n}\n\n.indicator-list {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 8px;\n}\n\n.indicator-tag {\n    padding: 6px 12px;\n    border-radius: 6px;\n    font-size: 0.8rem;\n    font-weight: 600;\n    font-family: 'Courier New', monospace;\n}\n\n.api-tag {\n    background: rgba(255, 165, 2, 0.2);\n    border: 1px solid rgba(255, 165, 2, 0.4);\n    color: #ffa502;\n}\n\n.string-tag {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.prediction-footer {\n    margin-top: 20px;\n    padding: 12px;\n    background: rgba(90, 156, 248, 0.1);\n    border-radius: 6px;\n    color: #5a9cf8;\n    font-size: 0.85rem;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.scans-container {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 2rem;\n    transition: all 0.3s ease;\n}\n\n.scans-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--shadow-color);\n}\n\n.scans-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.scans-header h2 {\n    color: #5a9cf8;\n}\n\n.refresh-btn {\n    background: #5a9cf8;\n    color: white;\n    border: none;\n    padding: 0.75rem 1.5rem;\n    border-radius: 8px;\n    cursor: pointer;\n    font-size: 1rem;\n    transition: background 0.2s;\n}\n\n.refresh-btn:hover {\n    background: #4a8ce8;\n}\n\n.scans-table {\n    width: 100%;\n    border-collapse: collapse;\n}\n\n.scans-table th {\n    text-align: left;\n    padding: 1rem;\n    background: rgba(255, 255, 255, 0.05);\n    color: #5a9cf8;\n    font-weight: 600;\n}\n\n.scans-table td {\n    padding: 1rem;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.scans-table tr:hover {\n    background: rgba(255, 255, 255, 0.03);\n}\n\n.badge {\n    display: inline-block;\n    padding: 0.3rem 0.8rem;\n    border-radius: 6px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.badge.malware { background: #ff4757; color: white; }\n.badge.suspicious { background: #ffa502; color: white; }\n.badge.benign { background: #26de81; color: white; }\n.badge.non-pe { background: #4b5563; color: #fff; }\n\n.hash {\n    font-family: 'Courier New', monospace;\n    font-size: 0.85rem;\n    color: #888;\n}\n\n.empty-state {\n    text-align: center;\n    padding: 3rem;\n    color: #666;\n}\n\n.empty-state i {\n    font-size: 4rem;\n    margin-bottom: 1rem;\n    opacity: 0.3;\n}\n\n/* NEW: Chart Container Styles */\n.chart-container {\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 12px;\n    padding: 2rem;\n    margin-top: 2rem;\n}\n\n.chart-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.chart-header h2 {\n    color: var(--accent-green);\n    margin: 0;\n}\n\n.chart-subtitle {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    margin: 0.5rem 0 0 0;\n    font-weight: normal;\n}\n\n.chart-controls {\n    display: flex;\n    gap: 0.5rem;\n}\n\n.chart-btn {\n    background: rgba(255, 255, 255, 0.05);\n    color: #888;\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    padding: 0.5rem 1rem;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.2s;\n}\n\n.chart-btn:hover {\n    background: rgba(255, 255, 255, 0.1);\n    color: #e0e0e0;\n}\n\n.chart-btn.active {\n    background: #5a9cf8;\n    color: white;\n    border-color: #5a9cf8;\n}\n\n#dailyScansChart {\n    max-height: 400px;\n}\n\n@media (max-width: 1024px) {\n    .analytics-grid {\n        grid-template-columns: 1fr;\n        gap: 1.5rem;\n    }\n    \n    .analytics-panel.panel-small,\n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n    \n    .graphs-preview {\n        width: 400px;\n    }\n}\n\n@media (max-width: 768px) {\n    .main-content {\n        margin-left: 0;\n        padding: 1rem;\n    }\n    \n    .side-panel {\n        width: 50px;\n    }\n    \n    .panel-logo-icon {\n        width: 40px;\n        height: 40px;\n        font-size: 1.5rem;\n    }\n    \n    .graphs-preview {\n        left: 50px;\n        width: calc(100vw - 50px);\n        border-radius: 0;\n    }\n    \n    .dashboard-header h1 {\n        font-size: 1.8rem;\n    }\n    \n    .stats-grid {\n        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n        gap: 1rem;\n    }\n    \n    .chart-header {\n        flex-direction: column;\n        gap: 1rem;\n        align-items: flex-start;\n    }\n    \n    .chart-controls {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .chart-btn {\n        flex: 1;\n    }\n    \n    .map-view-toggle {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .map-btn {\n        flex: 1;\n        font-size: 0.8rem;\n        padding: 0.4rem 0.6rem;\n    }\n    \n    .geo-context-panel {\n        flex-direction: column;\n    }\n    \n    .context-stat {\n        width: 100%;\n    }\n    \n    .map-timeline-control {\n        flex-direction: column;\n        gap: 0.5rem;\n    }\n    \n    .timeline-info {\n        text-align: center;\n    }\n    \n    .analytics-header {\n        flex-direction: column;\n        align-items: flex-start;\n    }\n}\n\n/* Map Container */\n.map-container {\n    background: var(--bg-card);\n    border-radius: 12px;\n    padding: 24px;\n    box-shadow: 0 4px 12px var(--shadow-color);\n    border: 2px solid var(--border-color);\n    transition: all 0.3s ease;\n    min-height: 600px;\n}\n\n.map-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 8px 24px var(--shadow-color), 0 0 20px var(--success-glow);\n}\n\n#worldMap {\n    width: 100%;\n    height: 500px;\n    border-radius: 8px;\n    margin-bottom: 15px;\n    background: var(--bg-secondary);\n    border: 1px solid var(--border-color);\n    z-index: 1;\n    position: relative;\n}\n\n.map-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 20px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.map-header h2 {\n    margin: 0;\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-header h2 i {\n    color: var(--accent-green);\n    margin-right: 8px;\n}\n\n.map-controls {\n    display: flex;\n    gap: 20px;\n    align-items: center;\n    flex-wrap: wrap;\n}\n\n.map-view-toggle {\n    display: flex;\n    gap: 8px;\n    background: var(--bg-secondary);\n    padding: 4px;\n    border-radius: 8px;\n    border: 1px solid var(--border-color);\n}\n\n.map-btn {\n    background: transparent;\n    border: none;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.map-btn:hover {\n    background: var(--bg-hover);\n    color: var(--text-primary);\n}\n\n.map-btn.active {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    box-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-btn i {\n    font-size: 1rem;\n}\n\n.map-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.legend-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n}\n\n.legend-dot {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    box-shadow: 0 0 6px currentColor;\n}\n\n.malware-dot {\n    background-color: var(--accent-red);\n}\n\n.suspicious-dot {\n    background-color: var(--accent-yellow);\n}\n\n.benign-dot {\n    background-color: var(--accent-green);\n}\n\n.geo-context-panel {\n    display: flex;\n    justify-content: space-around;\n    gap: 20px;\n    padding: 15px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-bottom: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.context-stat {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 5px;\n}\n\n.context-label {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.context-value {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.context-value.threat-count {\n    color: var(--accent-red);\n    text-shadow: 0 0 10px var(--danger-glow);\n}\n\n.map-timeline-control {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 12px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-top: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.timeline-btn {\n    background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-green-dim) 100%);\n    color: var(--bg-primary);\n    border: none;\n    padding: 10px 20px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.95rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    box-shadow: 0 4px 12px var(--success-glow);\n}\n\n.timeline-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px var(--success-glow);\n    filter: brightness(1.1);\n}\n\n.timeline-btn i {\n    font-size: 1rem;\n}\n\n.timeline-info {\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-style: italic;\n}\n\n#worldMap {\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n}\n\n/* Leaflet popup customization for theme */\n.leaflet-popup-content-wrapper {\n    background: var(--bg-card) !important;\n    color: var(--text-primary) !important;\n    border: 2px solid var(--accent-green) !important;\n    box-shadow: 0 4px 15px var(--shadow-color) !important;\n    border-radius: 8px !important;\n}\n\n.leaflet-popup-tip {\n    background: var(--bg-card) !important;\n}\n\n.leaflet-popup-content h3 {\n    color: var(--accent-green) !important;\n}\n\n.leaflet-popup-content button {\n    background: var(--accent-green) !important;\n    color: var(--bg-primary) !important;\n    border: none !important;\n    padding: 8px 16px !important;\n    border-radius: 6px !important;\n    cursor: pointer !important;\n    font-weight: 600 !important;\n    transition: all 0.2s ease !important;\n}\n\n.leaflet-popup-content button:hover {\n    transform: translateY(-2px) !important;\n    box-shadow: 0 4px 12px var(--success-glow) !important;\n}\n\n/* Correlation Graph */\n.correlation-container {\n    background: rgba(255, 255, 255, 0.03);\n    border-radius: 12px;\n    padding: 24px;\n    margin-top: 24px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.correlation-header {\n    margin-bottom: 20px;\n}\n\n.correlation-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.5rem;\n    color: #e0e0e0;\n}\n\n.correlation-header h2 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.correlation-subtitle {\n    color: #888;\n    font-size: 0.9rem;\n    margin: 0;\n}\n\n.graph-controls {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 16px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.graph-btn {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.3s;\n}\n\n.graph-btn:hover {\n    background: rgba(90, 156, 248, 0.3);\n    border-color: #5a9cf8;\n}\n\n.graph-btn i {\n    margin-right: 6px;\n}\n\n.graph-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.node-sample {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    border: 2px solid #fff;\n}\n\n.malware-node {\n    background-color: #ff4757;\n}\n\n.agent-node {\n    background-color: #5a9cf8;\n}\n\n.api-node {\n    background-color: #ffa502;\n}\n\n.string-node {\n    background-color: #26de81;\n}\n\n#correlationGraph {\n    width: 100%;\n    min-height: 600px;\n    position: relative;\n    border-radius: 8px;\n    overflow: hidden;\n}\n\n.node-details {\n    position: absolute;\n    right: 24px;\n    top: 120px;\n    background: rgba(30, 30, 30, 0.95);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    border-radius: 8px;\n    padding: 16px;\n    max-width: 300px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    z-index: 1000;\n}\n\n.node-details h3 {\n    margin: 0 0 12px 0;\n    color: #5a9cf8;\n    font-size: 1.1rem;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 8px;\n}\n\n.node-details p {\n    margin: 8px 0;\n    color: #e0e0e0;\n    font-size: 0.9rem;\n}\n\n.node-details ul {\n    color: #b0b0b0;\n    font-size: 0.85rem;\n}\n\n.node-details li {\n    margin: 4px 0;\n}\n\n/* ========================================\n   LIGHT THEME CONTRAST FIXES\n   ======================================== */\n\n/* Fix 1 & 2: Analytics preview backgrounds - lighter for better green contrast */\n[data-theme=\"light\"] .eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.05) 0%, rgba(255, 165, 2, 0.05) 100%);\n    border-color: rgba(255, 71, 87, 0.2);\n}\n\n[data-theme=\"light\"] .modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.05) 0%, rgba(38, 222, 129, 0.05) 100%);\n    border-color: rgba(90, 156, 248, 0.2);\n}\n\n/* Fix 3: Theme toggle button text - darker for contrast */\n[data-theme=\"light\"] .theme-toggle {\n    color: #1a1f2e;\n    background: rgba(255, 255, 255, 0.8);\n    border-color: rgba(46, 214, 15, 0.4);\n}\n\n/* Fix 4: Daily Analysis chart - darker labels and grid (handled in JS via CSS vars) */\n[data-theme=\"light\"] {\n    --chart-text-color: #374151;\n    --chart-grid-color: rgba(0, 0, 0, 0.12);\n}\n\n:root {\n    --chart-text-color: #9ca3af;\n    --chart-grid-color: rgba(255, 255, 255, 0.1);\n}\n\n/* Fix 5: Chart container labels - darker in light theme */\n[data-theme=\"light\"] .chart-header h2,\n[data-theme=\"light\"] .chart-header {\n    color: #1a1f2e;\n}\n\n/* Fix 6: Threat Vector Correlation header - darker */\n[data-theme=\"light\"] .correlation-header h2 {\n    color: #1a1f2e;\n}\n\n[data-theme=\"light\"] .correlation-subtitle {\n    color: #4a5568;\n}\n\n/* Fix 7: ETI subtitle and summary - darker for better contrast */\n[data-theme=\"light\"] .eti-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .eti-summary {\n    color: #374151;\n}\n\n/* Fix 8: Prediction labels in threat modeler - darker */\n[data-theme=\"light\"] .modeler-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .modeler-field label {\n    color: #374151;\n}\n\n[data-theme=\"light\"] .modeler-hint {\n    color: #6b7280;\n}\n\n/* Fix 9: Analytics preview backgrounds - much lighter for green text visibility */\n[data-theme=\"light\"] .preview-box {\n    background: rgba(255, 255, 255, 0.6);\n    border-color: rgba(46, 214, 15, 0.3);\n}\n\n/* Fix 10: ETI item text - lighter for better readability */\n[data-theme=\"light\"] .eti-count {\n    color: #6b7280;\n}\n\n[data-theme=\"light\"] .eti-details {\n    color: #9ca3af;\n}\n\n[data-theme=\"light\"] .eti-name {\n    color: #1f2937;\n}\n\n/* Fix 11: Make ETI details much more visible in light theme */\n[data-theme=\"light\"] .eti-details {\n    color: #5a9cf8;\n    font-weight: 500;\n}\n\n/* Fix 12: Threat ticker text visibility in light theme */\n[data-theme=\"light\"] .ticker-item {\n    color: #374151;\n    font-weight: 500;\n}\n\n/* Back to Top Button */\n.back-to-top {\n    position: fixed;\n    bottom: 30px;\n    right: 30px;\n    width: 50px;\n    height: 50px;\n    background: linear-gradient(135deg, var(--accent-green), var(--accent-green-dim));\n    border: 2px solid var(--accent-green);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    z-index: 9998;\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px var(--success-glow);\n    color: #000;\n    font-size: 1.2rem;\n}\n\n.back-to-top.visible {\n    opacity: 1;\n    visibility: visible;\n}\n\n.back-to-top:hover {\n    transform: translateY(-5px) scale(1.1);\n    box-shadow: 0 6px 30px var(--success-glow);\n}\n\n.back-to-top:active {\n    transform: translateY(-2px) scale(1.05);\n}\n\n[data-theme=\"light\"] .back-to-top {\n    background: linear-gradient(135deg, #2ed60f, #27b00c);\n    color: #fff;\n}\n","epoch":22,"telemetryInfo":{}}],["file:///home/trang/localnsv/mAIware-server/public/styles.css::request_84fdc38b-9630-4d5e-aa54-3779d49a4552",{"uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/styles.css","external":"file:///home/trang/localnsv/mAIware-server/public/styles.css","path":"/home/trang/localnsv/mAIware-server/public/styles.css","scheme":"file"},"requestId":"request_84fdc38b-9630-4d5e-aa54-3779d49a4552","content":":root {\n    --bg-primary: #000000;\n    --bg-secondary: #0a0a0a;\n    --bg-card: #0f0f0f;\n    --bg-hover: #151515;\n    --text-primary: #e8f0e8;\n    --text-secondary: #9ca3af;\n    --accent-green: #6bd122;\n    --accent-green-dim: #8be04e;\n    --accent-yellow: #ffd700;\n    --accent-red: #ff3b3b;\n    --accent-red-dim: #cc2f2f;\n    --border-color: #1a1a1a;\n    --shadow-color: rgba(0, 0, 0, 0.5);\n    --success-glow: rgba(57, 255, 20, 0.3);\n    --danger-glow: rgba(255, 59, 59, 0.3);\n    --warning-glow: rgba(255, 215, 0, 0.3);\n    /* Chart theming */\n    --chart-text-color: #9ca3af;\n    --chart-grid-color: rgba(255, 255, 255, 0.1);\n}\n\n[data-theme=\"light\"] {\n    --bg-primary: #f0f4f0;\n    --bg-secondary: #ffffff;\n    --bg-card: #fafafa;\n    --bg-hover: #e8f5e8;\n    --text-primary: #1a1f2e;\n    --text-secondary: #4a5568;\n    --accent-green: #5bb01d;\n    --accent-green-dim: #96d667;\n    --accent-yellow: #cc9a00;\n    --accent-red: #dc2626;\n    --accent-red-dim: #b91c1c;\n    --border-color: #d1d5db;\n    --shadow-color: rgba(0, 0, 0, 0.1);\n    --success-glow: rgba(46, 214, 15, 0.2);\n    --danger-glow: rgba(220, 38, 38, 0.2);\n    --warning-glow: rgba(204, 154, 0, 0.2);\n    /* Chart theming overrides for light mode */\n    --chart-text-color: #1f2937; /* gray-800 for maximum contrast */\n    --chart-grid-color: rgba(0, 0, 0, 0.12);\n}\n\n* { \n    margin: 0; \n    padding: 0; \n    box-sizing: border-box; \n}\n\nbody {\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    background: var(--bg-primary);\n    color: var(--text-primary);\n    min-height: 100vh;\n    margin: 0;\n    overflow-x: hidden;\n    position: relative;\n}\n\nbody::before {\n    content: '';\n    position: fixed;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: \n        radial-gradient(circle at 20% 50%, rgba(57, 255, 20, 0.08) 0%, transparent 50%),\n        radial-gradient(circle at 80% 80%, rgba(57, 255, 20, 0.06) 0%, transparent 50%),\n        radial-gradient(circle at 40% 20%, rgba(57, 255, 20, 0.05) 0%, transparent 50%);\n    animation: backgroundGlow 15s ease-in-out infinite;\n    pointer-events: none;\n    z-index: 0;\n}\n\n@keyframes backgroundGlow {\n    0%, 100% { \n        transform: translate(0, 0) scale(1);\n        opacity: 0.4;\n    }\n    33% { \n        transform: translate(10%, 10%) scale(1.1);\n        opacity: 0.6;\n    }\n    66% { \n        transform: translate(-10%, 5%) scale(0.95);\n        opacity: 0.5;\n    }\n}\n\nbody > * {\n    position: relative;\n    z-index: 1;\n}\n\n/* Side Panel Navigation */\n.side-panel {\n    position: fixed;\n    left: 0;\n    top: 0;\n    height: 100vh;\n    width: 70px;\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border-right: 1px solid rgba(57, 255, 20, 0.2);\n    box-shadow: 0 0 30px rgba(57, 255, 20, 0.1);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    z-index: 9999;\n    transition: all 0.3s ease;\n}\n\n.side-panel:hover {\n    background: rgba(15, 15, 15, 0.8);\n    box-shadow: 0 0 40px rgba(57, 255, 20, 0.2);\n}\n\n.panel-icon-strip {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 2rem 0;\n}\n\n.panel-logo-icon {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 50px;\n    height: 50px;\n    color: var(--accent-green);\n    font-size: 2rem;\n    animation: pulse-glow 3s ease-in-out infinite;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.panel-logo-icon:hover {\n    transform: scale(1.1);\n    filter: drop-shadow(0 0 20px var(--success-glow));\n}\n\n@keyframes pulse-glow {\n    0%, 100% { filter: drop-shadow(0 0 5px var(--success-glow)); }\n    50% { filter: drop-shadow(0 0 15px var(--success-glow)) drop-shadow(0 0 25px var(--success-glow)); }\n}\n\n/* Graphs Preview Grid */\n.graphs-preview {\n    position: fixed;\n    left: 70px;\n    top: 50%;\n    transform: translateY(-50%) translateX(-100%);\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-left: none;\n    border-radius: 0 12px 12px 0;\n    padding: 2rem;\n    width: 480px;\n    max-height: 90vh;\n    overflow-y: auto;\n    opacity: 0;\n    visibility: hidden;\n    pointer-events: none;\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease, visibility 0.3s;\n    box-shadow: 5px 0 40px rgba(57, 255, 20, 0.15);\n    z-index: 9998;\n    will-change: transform, opacity;\n}\n\n.graphs-preview::-webkit-scrollbar {\n    width: 6px;\n}\n\n.graphs-preview::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 3px;\n}\n\n.graphs-preview::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 3px;\n}\n\n.graphs-preview.show {\n    opacity: 1;\n    visibility: visible;\n    pointer-events: auto;\n    transform: translateY(-50%) translateX(0);\n}\n\n.preview-header {\n    margin-bottom: 1rem;\n    padding-bottom: 0.8rem;\n    border-bottom: 1px solid var(--border-color);\n}\n\n.preview-header h3 {\n    color: var(--accent-green);\n    font-size: 1.1rem;\n    margin-bottom: 0.3rem;\n}\n\n.preview-header p {\n    color: var(--text-secondary);\n    font-size: 0.85rem;\n}\n\n/* Analytics Miniview - Scaled down live view */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-content {\n    width: 100%;\n    height: 100%;\n    transform-origin: top left;\n    transform: scale(0.25);\n    width: 400%;\n    height: 400%;\n    pointer-events: none;\n    overflow: hidden;\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n.preview-home-nav {\n    margin-top: 1.5rem;\n    padding: 1rem;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 10px;\n    display: flex;\n    align-items: center;\n    gap: 0.8rem;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    opacity: 0;\n    visibility: hidden;\n    transform: translateY(10px);\n}\n\n.preview-home-nav.visible {\n    opacity: 1;\n    visibility: visible;\n    transform: translateY(0);\n}\n\n.preview-home-nav:hover {\n    background: var(--bg-hover);\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.preview-home-nav i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n}\n\n.preview-home-nav span {\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--text-primary);\n}\n\n.preview-label {\n    flex: 1;\n    font-size: 0.95rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    letter-spacing: 0.3px;\n}\n\n/* Analytics Miniview - Screenshot preview */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    padding: 1.5rem;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-preview {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    opacity: 0.7;\n}\n\n.preview-row {\n    display: flex;\n    gap: 1rem;\n    flex: 1;\n}\n\n.preview-box {\n    flex: 1;\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 6px;\n    position: relative;\n    overflow: hidden;\n    padding: 0.5rem;\n}\n\n.preview-box.large {\n    flex: 2;\n}\n\n.preview-box.wide {\n    flex: 1;\n    min-height: 150px;\n}\n\n.box-header {\n    font-size: 0.65rem;\n    color: var(--accent-green);\n    margin-bottom: 0.5rem;\n    opacity: 0.8;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.box-content {\n    height: calc(100% - 1.5rem);\n    position: relative;\n}\n\n.map-visual {\n    background: radial-gradient(circle at center, rgba(57, 255, 20, 0.05), transparent);\n    position: relative;\n}\n\n.map-dot {\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 10px var(--accent-green);\n    animation: map-pulse 2s ease-in-out infinite;\n}\n\n.map-dot:nth-child(2) { animation-delay: 0.5s; }\n.map-dot:nth-child(3) { animation-delay: 1s; }\n\n@keyframes map-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.6; }\n    50% { transform: scale(1.5); opacity: 1; }\n}\n\n.chart-visual {\n    display: flex;\n    align-items: flex-end;\n    justify-content: space-around;\n    height: 100%;\n    padding: 0.5rem;\n    gap: 0.3rem;\n}\n\n.chart-bar {\n    flex: 1;\n    background: linear-gradient(180deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    animation: bar-grow 2s ease-in-out infinite;\n    opacity: 0.7;\n}\n\n.chart-bar:nth-child(2) { animation-delay: 0.2s; }\n.chart-bar:nth-child(3) { animation-delay: 0.4s; }\n.chart-bar:nth-child(4) { animation-delay: 0.6s; }\n\n@keyframes bar-grow {\n    0%, 100% { transform: scaleY(0.8); }\n    50% { transform: scaleY(1); }\n}\n\n.list-visual {\n    display: flex;\n    flex-direction: column;\n    gap: 0.4rem;\n    padding: 0.3rem;\n}\n\n.list-item {\n    height: 0.4rem;\n    background: linear-gradient(90deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    opacity: 0.6;\n    animation: list-fade 3s ease-in-out infinite;\n}\n\n.list-item:nth-child(2) { animation-delay: 0.5s; width: 80%; }\n.list-item:nth-child(3) { animation-delay: 1s; width: 60%; }\n\n@keyframes list-fade {\n    0%, 100% { opacity: 0.4; }\n    50% { opacity: 0.8; }\n}\n\n.network-visual {\n    position: relative;\n    height: 100%;\n}\n\n.network-node {\n    position: absolute;\n    width: 6px;\n    height: 6px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 8px var(--accent-green);\n    animation: node-pulse 3s ease-in-out infinite;\n}\n\n.network-node:nth-child(2) { animation-delay: 0.7s; }\n.network-node:nth-child(3) { animation-delay: 1.4s; }\n\n@keyframes node-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.5; }\n    50% { transform: scale(1.3); opacity: 1; }\n}\n\n.heat-visual {\n    background: \n        radial-gradient(circle at 30% 30%, rgba(57, 255, 20, 0.3), transparent 40%),\n        radial-gradient(circle at 70% 60%, rgba(57, 255, 20, 0.2), transparent 40%),\n        radial-gradient(circle at 50% 80%, rgba(57, 255, 20, 0.25), transparent 40%);\n    animation: heat-shift 4s ease-in-out infinite;\n}\n\n@keyframes heat-shift {\n    0%, 100% { opacity: 0.5; }\n    50% { opacity: 0.8; }\n}\n\n.pie-visual {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n}\n\n.pie-chart {\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    background: conic-gradient(\n        var(--accent-green) 0deg 120deg,\n        var(--accent-yellow) 120deg 240deg,\n        var(--accent-red) 240deg 360deg\n    );\n    box-shadow: 0 0 15px rgba(57, 255, 20, 0.4);\n    animation: pie-spin 10s linear infinite;\n}\n\n@keyframes pie-spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n\n/* Main Content Area */\n.main-content {\n    margin-left: 70px;\n    min-height: 100vh;\n    padding: 2rem;\n    transition: margin-left 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    position: relative;\n}\n\n/* Backdrop overlay for preview panel */\n.preview-backdrop {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    background: rgba(0, 0, 0, 0.4);\n    backdrop-filter: blur(2px);\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    z-index: 9998;\n    pointer-events: none;\n}\n\n.preview-backdrop.show {\n    opacity: 1;\n    visibility: visible;\n}\n\n/* View Containers */\n.view-container {\n    display: none;\n    animation: fadeIn 0.4s ease-in-out;\n}\n\n.view-container.active {\n    display: block;\n}\n\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n        transform: translateY(10px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n/* Dashboard Header */\n.dashboard-header {\n    text-align: center;\n    margin-bottom: 2.5rem;\n}\n\n.header-content h1 {\n    font-size: 2.5rem;\n    margin-bottom: 0.5rem;\n    color: var(--accent-green);\n    font-weight: 700;\n    letter-spacing: 2px;\n}\n\n.header-content .subtitle {\n    font-size: 1.2rem;\n    color: var(--text-secondary);\n    font-weight: 500;\n}\n\n.pulse-icon {\n    display: inline-block;\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n@keyframes pulse-scale {\n    0%, 100% {\n        transform: scale(1);\n        filter: drop-shadow(0 0 5px var(--success-glow));\n    }\n    50% {\n        transform: scale(1.05);\n        filter: drop-shadow(0 0 15px var(--success-glow));\n    }\n}\n\n/* Animations */\n.animate-slide-in {\n    animation: slideIn 0.6s ease-out;\n}\n\n@keyframes slideIn {\n    from {\n        opacity: 0;\n        transform: translateX(-30px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n.animate-fade-in {\n    animation: fadeInUp 0.6s ease-out;\n}\n\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.container {\n    max-width: 1400px;\n    margin: 0 auto;\n}\n\n/* Theme Toggle Button */\n.theme-toggle {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    background: rgba(15, 15, 15, 0.85);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50px;\n    padding: 10px 20px;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    font-size: 1rem;\n    color: var(--text-primary);\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px rgba(57, 255, 20, 0.2);\n    font-weight: 600;\n}\n\n.theme-toggle:hover {\n    background: rgba(15, 15, 15, 0.8);\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.theme-toggle .icon {\n    font-size: 1.2rem;\n}\n\n/* Auto-scroll indicators */\n.scroll-indicator {\n    position: fixed;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 60px;\n    height: 60px;\n    background: rgba(57, 255, 20, 0.15);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 2px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    opacity: 0;\n    pointer-events: none;\n    transition: opacity 0.3s ease;\n    z-index: 10001;\n}\n\n.scroll-indicator.visible {\n    opacity: 1;\n    animation: scroll-pulse 1.5s ease-in-out infinite;\n}\n\n.scroll-indicator.scroll-up {\n    top: 20px;\n}\n\n.scroll-indicator.scroll-down {\n    bottom: 20px;\n}\n\n.scroll-indicator i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    animation: scroll-bounce 1s ease-in-out infinite;\n}\n\n.scroll-up i {\n    animation-name: scroll-bounce-up;\n}\n\n.scroll-down i {\n    animation-name: scroll-bounce-down;\n}\n\n@keyframes scroll-pulse {\n    0%, 100% {\n        box-shadow: 0 0 10px rgba(57, 255, 20, 0.3);\n    }\n    50% {\n        box-shadow: 0 0 25px rgba(57, 255, 20, 0.6);\n    }\n}\n\n@keyframes scroll-bounce-up {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(-5px);\n    }\n}\n\n@keyframes scroll-bounce-down {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(5px);\n    }\n}\n\n/* Threat Ticker */\n.threat-ticker-container {\n    background: var(--bg-secondary);\n    border: 2px solid var(--accent-green);\n    border-radius: 8px;\n    padding: 12px;\n    margin-bottom: 2rem;\n    display: flex;\n    align-items: center;\n    gap: 16px;\n    overflow: hidden;\n    box-shadow: 0 2px 8px var(--success-glow);\n}\n\n.ticker-label {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 8px 16px;\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    border-radius: 6px;\n    font-weight: 700;\n    font-size: 0.75rem;\n    color: #fff;\n    white-space: nowrap;\n    box-shadow: 0 2px 8px rgba(255, 71, 87, 0.4);\n}\n\n.ticker-label i {\n    animation: pulse-broadcast 2s infinite;\n}\n\n@keyframes pulse-broadcast {\n    0%, 100% { opacity: 1; transform: scale(1); }\n    50% { opacity: 0.6; transform: scale(0.9); }\n}\n\n.threat-ticker {\n    flex: 1;\n    overflow: hidden;\n    position: relative;\n}\n\n.ticker-content {\n    display: flex;\n    gap: 40px;\n    white-space: nowrap;\n    animation: scroll-ticker 30s linear infinite;\n}\n\n.ticker-content:hover {\n    animation-play-state: paused;\n}\n\n@keyframes scroll-ticker {\n    0% { transform: translateX(0); }\n    100% { transform: translateX(-50%); }\n}\n\n.ticker-item {\n    color: #e0e0e0;\n    font-size: 0.9rem;\n    display: inline-flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.ticker-item i {\n    font-size: 0.5rem;\n    animation: blink 1.5s infinite;\n}\n\n@keyframes blink {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.3; }\n}\n\n/* Notification System */\n.notification-container {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    max-width: 400px;\n}\n\n.threat-notification {\n    background: rgba(30, 30, 30, 0.98);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 8px;\n    padding: 16px;\n    display: flex;\n    gap: 12px;\n    align-items: flex-start;\n    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);\n    transform: translateX(450px);\n    opacity: 0;\n    transition: all 0.3s ease-out;\n}\n\n.threat-notification.show {\n    transform: translateX(0);\n    opacity: 1;\n}\n\n.notification-icon {\n    font-size: 1.5rem;\n    flex-shrink: 0;\n}\n\n.notification-content {\n    flex: 1;\n}\n\n.notification-title {\n    font-size: 0.95rem;\n    color: #e0e0e0;\n    margin-bottom: 4px;\n}\n\n.notification-title strong {\n    text-transform: uppercase;\n    font-weight: 800;\n}\n\n.notification-details {\n    font-size: 0.85rem;\n    color: #b0b0b0;\n    margin-bottom: 6px;\n}\n\n.notification-meta {\n    font-size: 0.75rem;\n    color: #888;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.notification-close {\n    cursor: pointer;\n    color: #666;\n    transition: color 0.2s;\n    font-size: 0.9rem;\n}\n\n.notification-close:hover {\n    color: #e0e0e0;\n}\n\n/* Stat Card Pulse Animation */\n.stat-pulse {\n    animation: stat-pulse-animation 0.6s ease-out;\n}\n\n@keyframes stat-pulse-animation {\n    0% { transform: scale(1); }\n    50% { transform: scale(1.05); box-shadow: 0 8px 24px rgba(90, 156, 248, 0.4); }\n    100% { transform: scale(1); }\n}\n\nh1 {\n    font-size: 2.5rem;\n    color: #5a9cf8;\n    margin-bottom: 0.5rem;\n}\n\n.subtitle {\n    color: #888;\n    font-size: 1.1rem;\n}\n\n.stats-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1.5rem;\n    margin-bottom: 3rem;\n}\n\n.stat-card {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 1.5rem;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.8rem;\n    position: relative;\n    overflow: hidden;\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.stat-card::before {\n    content: '';\n    position: absolute;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: radial-gradient(circle, var(--accent-green) 0%, transparent 70%);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover::before {\n    opacity: 0.05;\n}\n\n.stat-card:hover {\n    transform: translateY(-5px) scale(1.02);\n    border-color: var(--accent-green);\n    box-shadow: 0 10px 30px var(--success-glow);\n}\n\n.stat-card i {\n    font-size: 2.5rem;\n    opacity: 0.8;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover i {\n    transform: scale(1.1) rotateY(180deg);\n    opacity: 1;\n}\n\n.stat-number {\n    font-size: 2.5rem;\n    font-weight: 700;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover .stat-number {\n    transform: scale(1.1);\n    text-shadow: 0 0 20px currentColor;\n}\n\n.stat-label {\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n    font-weight: 600;\n}\n\n.stat-glow {\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    height: 3px;\n    background: linear-gradient(90deg, transparent, var(--accent-green), transparent);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover .stat-glow {\n    opacity: 1;\n    animation: glowSlide 2s ease-in-out infinite;\n}\n\n@keyframes glowSlide {\n    0%, 100% {\n        transform: translateX(-100%);\n    }\n    50% {\n        transform: translateX(100%);\n    }\n}\n\n.stat-card.malware {\n    border-color: rgba(255, 59, 59, 0.3);\n}\n\n.stat-card.malware i,\n.stat-card.malware .stat-number {\n    color: var(--accent-red);\n}\n\n.stat-card.malware:hover {\n    border-color: var(--accent-red);\n    box-shadow: 0 10px 30px var(--danger-glow);\n}\n\n.stat-card.suspicious {\n    border-color: rgba(255, 215, 0, 0.3);\n}\n\n.stat-card.suspicious i,\n.stat-card.suspicious .stat-number {\n    color: var(--accent-yellow);\n}\n\n.stat-card.suspicious:hover {\n    border-color: var(--accent-yellow);\n    box-shadow: 0 10px 30px var(--warning-glow);\n}\n\n.stat-card.benign i,\n.stat-card.benign .stat-number,\n.stat-card.info i,\n.stat-card.info .stat-number {\n    color: var(--accent-green);\n}\n\n/* Analytics View */\n.analytics-header {\n    display: flex;\n    align-items: center;\n    gap: 2rem;\n    margin-bottom: 2.5rem;\n}\n\n.back-btn {\n    background: var(--bg-card);\n    border: 2px solid var(--accent-green);\n    color: var(--accent-green);\n    padding: 0.8rem 1.5rem;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 600;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    transition: all 0.3s ease;\n}\n\n.back-btn:hover {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    transform: translateX(-5px);\n    box-shadow: 0 5px 20px var(--success-glow);\n}\n\n.analytics-header h1 {\n    font-size: 2rem;\n    color: var(--accent-green);\n    font-weight: 700;\n}\n\n.analytics-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));\n    gap: 2rem;\n    max-height: calc(100vh - 200px);\n    overflow-y: auto;\n    padding-right: 1rem;\n    grid-auto-flow: dense;\n}\n\n/* Panel size classes for flexible tiling */\n.analytics-panel.panel-small {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-medium {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-large {\n    grid-column: span 2;\n}\n\n@media (max-width: 1400px) {\n    .analytics-grid {\n        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));\n    }\n    \n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n}\n\n.analytics-grid::-webkit-scrollbar {\n    width: 8px;\n}\n\n.analytics-grid::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb:hover {\n    background: var(--accent-green-dim);\n}\n\n.analytics-panel {\n    animation: slideInPanel 0.5s ease-out;\n    animation-fill-mode: backwards;\n}\n\n.analytics-panel:nth-child(1) { animation-delay: 0.05s; }\n.analytics-panel:nth-child(2) { animation-delay: 0.1s; }\n.analytics-panel:nth-child(3) { animation-delay: 0.15s; }\n.analytics-panel:nth-child(4) { animation-delay: 0.2s; }\n.analytics-panel:nth-child(5) { animation-delay: 0.25s; }\n.analytics-panel:nth-child(6) { animation-delay: 0.3s; }\n\n@keyframes slideInPanel {\n    from {\n        opacity: 0;\n        transform: translateY(30px) scale(0.95);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n    }\n}\n\n/* Advanced Analytics Grid for Mini Charts */\n.advanced-analytics-grid {\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 12px;\n    padding: 1.5rem;\n}\n\n.mini-charts-grid {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 1.5rem;\n    margin-top: 1rem;\n}\n\n.mini-chart-container {\n    background: rgba(10, 10, 10, 0.6);\n    border: 1px solid rgba(57, 255, 20, 0.15);\n    border-radius: 8px;\n    padding: 1rem;\n}\n\n.mini-chart-container h3 {\n    color: var(--accent-green);\n    font-size: 0.95rem;\n    margin: 0 0 0.75rem 0;\n    font-weight: 600;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.mini-chart-container h3 i {\n    font-size: 0.9rem;\n}\n\n@media (max-width: 1200px) {\n    .mini-charts-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n/* Emerging Threat Intelligence Panel */\n.eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.1) 0%, rgba(255, 165, 2, 0.1) 100%);\n    border: 2px solid rgba(255, 71, 87, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(255, 71, 87, 0.2);\n}\n\n.eti-header {\n    margin-bottom: 24px;\n}\n\n.eti-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #ff6b6b;\n    text-shadow: 0 2px 4px rgba(255, 71, 87, 0.3);\n}\n\n.eti-header h2 i {\n    color: #ff4757;\n    margin-right: 10px;\n    animation: pulse 2s infinite;\n}\n\n@keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.6; }\n}\n\n.eti-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 8px 0 16px 0;\n}\n\n.eti-summary {\n    display: flex;\n    gap: 12px;\n    flex-wrap: wrap;\n}\n\n.eti-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 6px 14px;\n    border-radius: 20px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.eti-badge.recent {\n    background: rgba(255, 71, 87, 0.2);\n    border-color: rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.eti-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n    gap: 20px;\n}\n\n.eti-panel {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 18px;\n    transition: transform 0.3s, box-shadow 0.3s;\n}\n\n.eti-panel:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);\n}\n\n.eti-panel h3 {\n    margin: 0 0 6px 0;\n    font-size: 1.1rem;\n    color: #e0e0e0;\n}\n\n.eti-panel h3 i {\n    color: #ffa502;\n    margin-right: 8px;\n}\n\n.eti-subtitle-small {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 14px;\n}\n\n.eti-list {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n}\n\n.eti-item {\n    display: flex;\n    gap: 12px;\n    background: rgba(255, 255, 255, 0.03);\n    border: 1px solid rgba(255, 255, 255, 0.08);\n    border-radius: 8px;\n    padding: 12px;\n    transition: all 0.3s;\n}\n\n.eti-item:hover {\n    background: rgba(255, 255, 255, 0.06);\n    border-color: rgba(255, 165, 2, 0.4);\n    transform: translateX(4px);\n}\n\n.eti-rank {\n    flex-shrink: 0;\n    width: 32px;\n    height: 32px;\n    background: linear-gradient(135deg, #ff6b6b, #ffa502);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: bold;\n    font-size: 1rem;\n    color: #fff;\n    box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);\n}\n\n.eti-item[data-rank=\"1\"] .eti-rank {\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    transform: scale(1.1);\n}\n\n.eti-content {\n    flex: 1;\n    min-width: 0;\n}\n\n.eti-name {\n    font-weight: 600;\n    color: #e0e0e0;\n    font-size: 0.95rem;\n    margin-bottom: 4px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-meta {\n    display: flex;\n    gap: 8px;\n    flex-wrap: wrap;\n    align-items: center;\n}\n\n.eti-count {\n    color: #888;\n    font-size: 0.8rem;\n}\n\n.eti-recent-badge {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-agent-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-details {\n    margin-top: 6px;\n    color: #999;\n    font-size: 0.75rem;\n    font-style: italic;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-empty {\n    text-align: center;\n    color: #666;\n    padding: 20px;\n    font-style: italic;\n}\n\n/* Threat Modeler */\n.modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.1) 0%, rgba(38, 222, 129, 0.1) 100%);\n    border: 2px solid rgba(90, 156, 248, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(90, 156, 248, 0.2);\n}\n\n.modeler-header {\n    margin-bottom: 24px;\n}\n\n.modeler-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #5a9cf8;\n}\n\n.modeler-header h2 i {\n    color: #26de81;\n    margin-right: 10px;\n}\n\n.modeler-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 0;\n}\n\n.modeler-grid {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 24px;\n}\n\n@media (max-width: 1024px) {\n    .modeler-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n.modeler-builder,\n.modeler-results {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 20px;\n}\n\n.modeler-builder h3,\n.modeler-results h3 {\n    margin: 0 0 20px 0;\n    font-size: 1.2rem;\n    color: #e0e0e0;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n    padding-bottom: 10px;\n}\n\n.modeler-builder h3 i {\n    color: #26de81;\n    margin-right: 8px;\n}\n\n.modeler-results h3 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.modeler-field {\n    margin-bottom: 20px;\n}\n\n.modeler-field label {\n    display: block;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n    margin-bottom: 6px;\n    font-weight: 600;\n}\n\n.modeler-select {\n    width: 100%;\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.2);\n    border-radius: 6px;\n    color: #e0e0e0;\n    padding: 10px;\n    font-size: 0.9rem;\n    font-family: inherit;\n    cursor: pointer;\n    transition: all 0.3s;\n}\n\n.modeler-select:focus {\n    outline: none;\n    border-color: #5a9cf8;\n    background: rgba(90, 156, 248, 0.1);\n}\n\n.modeler-select option {\n    background: #1a1a2e;\n    color: #e0e0e0;\n    padding: 8px;\n}\n\n.modeler-hint {\n    display: block;\n    color: #666;\n    font-size: 0.75rem;\n    margin-top: 4px;\n    font-style: italic;\n}\n\n.modeler-analyze-btn {\n    width: 100%;\n    background: linear-gradient(135deg, #26de81, #20bf6b);\n    border: none;\n    color: #fff;\n    padding: 14px 24px;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 700;\n    cursor: pointer;\n    transition: all 0.3s;\n    box-shadow: 0 4px 12px rgba(38, 222, 129, 0.3);\n}\n\n.modeler-analyze-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(38, 222, 129, 0.4);\n}\n\n.modeler-analyze-btn i {\n    margin-right: 8px;\n}\n\n.modeler-output {\n    min-height: 400px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.modeler-placeholder {\n    text-align: center;\n    color: #666;\n}\n\n.modeler-placeholder i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n    opacity: 0.5;\n}\n\n.modeler-placeholder p {\n    font-size: 0.95rem;\n}\n\n.modeler-loading {\n    text-align: center;\n    color: #5a9cf8;\n}\n\n.modeler-loading i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.modeler-error {\n    text-align: center;\n    color: #ff4757;\n}\n\n.modeler-error i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.prediction-result {\n    width: 100%;\n}\n\n.prediction-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 24px;\n    padding: 20px;\n    background: rgba(255, 255, 255, 0.05);\n    border-radius: 8px;\n}\n\n.prediction-badge {\n    padding: 12px 24px;\n    border-radius: 8px;\n    font-size: 1.3rem;\n    font-weight: 800;\n    color: #fff;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n\n.prediction-confidence {\n    text-align: right;\n}\n\n.confidence-label {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 4px;\n}\n\n.confidence-value {\n    color: #5a9cf8;\n    font-size: 2rem;\n    font-weight: 800;\n}\n\n.prediction-family {\n    padding: 16px;\n    background: rgba(255, 71, 87, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 6px;\n    margin-bottom: 20px;\n    color: #e0e0e0;\n}\n\n.family-name {\n    color: #ff6b6b;\n    font-weight: 700;\n    font-size: 1.1rem;\n    margin-left: 8px;\n}\n\n.prediction-section {\n    margin-bottom: 20px;\n}\n\n.prediction-section h4 {\n    color: #5a9cf8;\n    font-size: 1rem;\n    margin: 0 0 12px 0;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 6px;\n}\n\n.analysis-item {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    padding: 8px 0;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n}\n\n.analysis-item i {\n    color: #ffa502;\n    width: 20px;\n}\n\n.indicator-group {\n    margin-bottom: 16px;\n}\n\n.indicator-group strong {\n    display: block;\n    color: #e0e0e0;\n    margin-bottom: 8px;\n    font-size: 0.9rem;\n}\n\n.indicator-list {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 8px;\n}\n\n.indicator-tag {\n    padding: 6px 12px;\n    border-radius: 6px;\n    font-size: 0.8rem;\n    font-weight: 600;\n    font-family: 'Courier New', monospace;\n}\n\n.api-tag {\n    background: rgba(255, 165, 2, 0.2);\n    border: 1px solid rgba(255, 165, 2, 0.4);\n    color: #ffa502;\n}\n\n.string-tag {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.prediction-footer {\n    margin-top: 20px;\n    padding: 12px;\n    background: rgba(90, 156, 248, 0.1);\n    border-radius: 6px;\n    color: #5a9cf8;\n    font-size: 0.85rem;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.scans-container {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 2rem;\n    transition: all 0.3s ease;\n}\n\n.scans-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--shadow-color);\n}\n\n.scans-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.scans-header h2 {\n    color: #5a9cf8;\n}\n\n.refresh-btn {\n    background: #5a9cf8;\n    color: white;\n    border: none;\n    padding: 0.75rem 1.5rem;\n    border-radius: 8px;\n    cursor: pointer;\n    font-size: 1rem;\n    transition: background 0.2s;\n}\n\n.refresh-btn:hover {\n    background: #4a8ce8;\n}\n\n.scans-table {\n    width: 100%;\n    border-collapse: collapse;\n}\n\n.scans-table th {\n    text-align: left;\n    padding: 1rem;\n    background: rgba(255, 255, 255, 0.05);\n    color: #5a9cf8;\n    font-weight: 600;\n}\n\n.scans-table td {\n    padding: 1rem;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.scans-table tr:hover {\n    background: rgba(255, 255, 255, 0.03);\n}\n\n.badge {\n    display: inline-block;\n    padding: 0.3rem 0.8rem;\n    border-radius: 6px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.badge.malware { background: #ff4757; color: white; }\n.badge.suspicious { background: #ffa502; color: white; }\n.badge.benign { background: #26de81; color: white; }\n.badge.non-pe { background: #4b5563; color: #fff; }\n\n.hash {\n    font-family: 'Courier New', monospace;\n    font-size: 0.85rem;\n    color: #888;\n}\n\n.empty-state {\n    text-align: center;\n    padding: 3rem;\n    color: #666;\n}\n\n.empty-state i {\n    font-size: 4rem;\n    margin-bottom: 1rem;\n    opacity: 0.3;\n}\n\n/* NEW: Chart Container Styles */\n.chart-container {\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 12px;\n    padding: 2rem;\n    margin-top: 2rem;\n}\n\n.chart-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.chart-header h2 {\n    color: var(--accent-green);\n    margin: 0;\n}\n\n.chart-subtitle {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    margin: 0.5rem 0 0 0;\n    font-weight: normal;\n}\n\n.chart-controls {\n    display: flex;\n    gap: 0.5rem;\n}\n\n.chart-btn {\n    background: rgba(255, 255, 255, 0.05);\n    color: #888;\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    padding: 0.5rem 1rem;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.2s;\n}\n\n.chart-btn:hover {\n    background: rgba(255, 255, 255, 0.1);\n    color: #e0e0e0;\n}\n\n.chart-btn.active {\n    background: #5a9cf8;\n    color: white;\n    border-color: #5a9cf8;\n}\n\n#dailyScansChart {\n    max-height: 400px;\n}\n\n@media (max-width: 1024px) {\n    .analytics-grid {\n        grid-template-columns: 1fr;\n        gap: 1.5rem;\n    }\n    \n    .analytics-panel.panel-small,\n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n    \n    .graphs-preview {\n        width: 400px;\n    }\n}\n\n@media (max-width: 768px) {\n    .main-content {\n        margin-left: 0;\n        padding: 1rem;\n    }\n    \n    .side-panel {\n        width: 50px;\n    }\n    \n    .panel-logo-icon {\n        width: 40px;\n        height: 40px;\n        font-size: 1.5rem;\n    }\n    \n    .graphs-preview {\n        left: 50px;\n        width: calc(100vw - 50px);\n        border-radius: 0;\n    }\n    \n    .dashboard-header h1 {\n        font-size: 1.8rem;\n    }\n    \n    .stats-grid {\n        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n        gap: 1rem;\n    }\n    \n    .chart-header {\n        flex-direction: column;\n        gap: 1rem;\n        align-items: flex-start;\n    }\n    \n    .chart-controls {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .chart-btn {\n        flex: 1;\n    }\n    \n    .map-view-toggle {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .map-btn {\n        flex: 1;\n        font-size: 0.8rem;\n        padding: 0.4rem 0.6rem;\n    }\n    \n    .geo-context-panel {\n        flex-direction: column;\n    }\n    \n    .context-stat {\n        width: 100%;\n    }\n    \n    .map-timeline-control {\n        flex-direction: column;\n        gap: 0.5rem;\n    }\n    \n    .timeline-info {\n        text-align: center;\n    }\n    \n    .analytics-header {\n        flex-direction: column;\n        align-items: flex-start;\n    }\n}\n\n/* Map Container */\n.map-container {\n    background: var(--bg-card);\n    border-radius: 12px;\n    padding: 24px;\n    box-shadow: 0 4px 12px var(--shadow-color);\n    border: 2px solid var(--border-color);\n    transition: all 0.3s ease;\n    min-height: 600px;\n}\n\n.map-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 8px 24px var(--shadow-color), 0 0 20px var(--success-glow);\n}\n\n#worldMap {\n    width: 100%;\n    height: 500px;\n    border-radius: 8px;\n    margin-bottom: 15px;\n    background: var(--bg-secondary);\n    border: 1px solid var(--border-color);\n    z-index: 1;\n    position: relative;\n}\n\n.map-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 20px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.map-header h2 {\n    margin: 0;\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-header h2 i {\n    color: var(--accent-green);\n    margin-right: 8px;\n}\n\n.map-controls {\n    display: flex;\n    gap: 20px;\n    align-items: center;\n    flex-wrap: wrap;\n}\n\n.map-view-toggle {\n    display: flex;\n    gap: 8px;\n    background: var(--bg-secondary);\n    padding: 4px;\n    border-radius: 8px;\n    border: 1px solid var(--border-color);\n}\n\n.map-btn {\n    background: transparent;\n    border: none;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.map-btn:hover {\n    background: var(--bg-hover);\n    color: var(--text-primary);\n}\n\n.map-btn.active {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    box-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-btn i {\n    font-size: 1rem;\n}\n\n.map-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.legend-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n}\n\n.legend-dot {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    box-shadow: 0 0 6px currentColor;\n}\n\n.malware-dot {\n    background-color: var(--accent-red);\n}\n\n.suspicious-dot {\n    background-color: var(--accent-yellow);\n}\n\n.benign-dot {\n    background-color: var(--accent-green);\n}\n\n.geo-context-panel {\n    display: flex;\n    justify-content: space-around;\n    gap: 20px;\n    padding: 15px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-bottom: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.context-stat {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 5px;\n}\n\n.context-label {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.context-value {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.context-value.threat-count {\n    color: var(--accent-red);\n    text-shadow: 0 0 10px var(--danger-glow);\n}\n\n.map-timeline-control {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 12px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-top: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.timeline-btn {\n    background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-green-dim) 100%);\n    color: var(--bg-primary);\n    border: none;\n    padding: 10px 20px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.95rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    box-shadow: 0 4px 12px var(--success-glow);\n}\n\n.timeline-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px var(--success-glow);\n    filter: brightness(1.1);\n}\n\n.timeline-btn i {\n    font-size: 1rem;\n}\n\n.timeline-info {\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-style: italic;\n}\n\n#worldMap {\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n}\n\n/* Leaflet popup customization for theme */\n.leaflet-popup-content-wrapper {\n    background: var(--bg-card) !important;\n    color: var(--text-primary) !important;\n    border: 2px solid var(--accent-green) !important;\n    box-shadow: 0 4px 15px var(--shadow-color) !important;\n    border-radius: 8px !important;\n}\n\n.leaflet-popup-tip {\n    background: var(--bg-card) !important;\n}\n\n.leaflet-popup-content h3 {\n    color: var(--accent-green) !important;\n}\n\n.leaflet-popup-content button {\n    background: var(--accent-green) !important;\n    color: var(--bg-primary) !important;\n    border: none !important;\n    padding: 8px 16px !important;\n    border-radius: 6px !important;\n    cursor: pointer !important;\n    font-weight: 600 !important;\n    transition: all 0.2s ease !important;\n}\n\n.leaflet-popup-content button:hover {\n    transform: translateY(-2px) !important;\n    box-shadow: 0 4px 12px var(--success-glow) !important;\n}\n\n/* Correlation Graph */\n.correlation-container {\n    background: rgba(255, 255, 255, 0.03);\n    border-radius: 12px;\n    padding: 24px;\n    margin-top: 24px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.correlation-header {\n    margin-bottom: 20px;\n}\n\n.correlation-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.5rem;\n    color: #e0e0e0;\n}\n\n.correlation-header h2 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.correlation-subtitle {\n    color: #888;\n    font-size: 0.9rem;\n    margin: 0;\n}\n\n.graph-controls {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 16px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.graph-btn {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.3s;\n}\n\n.graph-btn:hover {\n    background: rgba(90, 156, 248, 0.3);\n    border-color: #5a9cf8;\n}\n\n.graph-btn i {\n    margin-right: 6px;\n}\n\n.graph-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.node-sample {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    border: 2px solid #fff;\n}\n\n.malware-node {\n    background-color: #ff4757;\n}\n\n.agent-node {\n    background-color: #5a9cf8;\n}\n\n.api-node {\n    background-color: #ffa502;\n}\n\n.string-node {\n    background-color: #26de81;\n}\n\n#correlationGraph {\n    width: 100%;\n    min-height: 600px;\n    position: relative;\n    border-radius: 8px;\n    overflow: hidden;\n}\n\n.node-details {\n    position: absolute;\n    right: 24px;\n    top: 120px;\n    background: rgba(30, 30, 30, 0.95);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    border-radius: 8px;\n    padding: 16px;\n    max-width: 300px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    z-index: 1000;\n}\n\n.node-details h3 {\n    margin: 0 0 12px 0;\n    color: #5a9cf8;\n    font-size: 1.1rem;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 8px;\n}\n\n.node-details p {\n    margin: 8px 0;\n    color: #e0e0e0;\n    font-size: 0.9rem;\n}\n\n.node-details ul {\n    color: #b0b0b0;\n    font-size: 0.85rem;\n}\n\n.node-details li {\n    margin: 4px 0;\n}\n\n/* ========================================\n   LIGHT THEME CONTRAST FIXES\n   ======================================== */\n\n/* Fix 1 & 2: Analytics preview backgrounds - lighter for better green contrast */\n[data-theme=\"light\"] .eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.05) 0%, rgba(255, 165, 2, 0.05) 100%);\n    border-color: rgba(255, 71, 87, 0.2);\n}\n\n[data-theme=\"light\"] .modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.05) 0%, rgba(38, 222, 129, 0.05) 100%);\n    border-color: rgba(90, 156, 248, 0.2);\n}\n\n/* Fix 3: Theme toggle button text - darker for contrast */\n[data-theme=\"light\"] .theme-toggle {\n    color: #1a1f2e;\n    background: rgba(255, 255, 255, 0.8);\n    border-color: rgba(46, 214, 15, 0.4);\n}\n\n/* Fix 4: Daily Analysis chart - darker labels and grid (handled in JS via CSS vars) */\n[data-theme=\"light\"] {\n    --chart-text-color: #374151;\n    --chart-grid-color: rgba(0, 0, 0, 0.12);\n}\n\n:root {\n    --chart-text-color: #9ca3af;\n    --chart-grid-color: rgba(255, 255, 255, 0.1);\n}\n\n/* Fix 5: Chart container labels - darker in light theme */\n[data-theme=\"light\"] .chart-header h2,\n[data-theme=\"light\"] .chart-header {\n    color: #1a1f2e;\n}\n\n/* Fix 6: Threat Vector Correlation header - darker */\n[data-theme=\"light\"] .correlation-header h2 {\n    color: #1a1f2e;\n}\n\n[data-theme=\"light\"] .correlation-subtitle {\n    color: #4a5568;\n}\n\n/* Fix 7: ETI subtitle and summary - darker for better contrast */\n[data-theme=\"light\"] .eti-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .eti-summary {\n    color: #374151;\n}\n\n/* Fix 8: Prediction labels in threat modeler - darker */\n[data-theme=\"light\"] .modeler-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .modeler-field label {\n    color: #374151;\n}\n\n[data-theme=\"light\"] .modeler-hint {\n    color: #6b7280;\n}\n\n/* Fix 9: Analytics preview backgrounds - much lighter for green text visibility */\n[data-theme=\"light\"] .preview-box {\n    background: rgba(255, 255, 255, 0.6);\n    border-color: rgba(46, 214, 15, 0.3);\n}\n\n/* Fix 10: ETI item text - lighter for better readability */\n[data-theme=\"light\"] .eti-count {\n    color: #6b7280;\n}\n\n[data-theme=\"light\"] .eti-details {\n    color: #9ca3af;\n}\n\n[data-theme=\"light\"] .eti-name {\n    color: #1f2937;\n}\n\n/* Fix 11: Make ETI details much more visible in light theme */\n[data-theme=\"light\"] .eti-details {\n    color: #5a9cf8;\n    font-weight: 500;\n}\n\n/* Fix 12: Threat ticker text visibility in light theme */\n[data-theme=\"light\"] .ticker-item {\n    color: #374151;\n    font-weight: 500;\n}\n\n/* Back to Top Button */\n.back-to-top {\n    position: fixed;\n    bottom: 30px;\n    right: 30px;\n    width: 50px;\n    height: 50px;\n    background: linear-gradient(135deg, var(--accent-green), var(--accent-green-dim));\n    border: 2px solid var(--accent-green);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    z-index: 9998;\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px var(--success-glow);\n    color: #000;\n    font-size: 1.2rem;\n}\n\n.back-to-top.visible {\n    opacity: 1;\n    visibility: visible;\n}\n\n.back-to-top:hover {\n    transform: translateY(-5px) scale(1.1);\n    box-shadow: 0 6px 30px var(--success-glow);\n}\n\n.back-to-top:active {\n    transform: translateY(-2px) scale(1.05);\n}\n\n[data-theme=\"light\"] .back-to-top {\n    background: linear-gradient(135deg, #2ed60f, #27b00c);\n    color: #fff;\n}\n","epoch":28,"telemetryInfo":{}}],["file:///home/trang/localnsv/mAIware-server/public/styles.css::request_fcbfa3b8-88ac-48bc-80d5-4ae65eb5dfdf",{"uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/styles.css","external":"file:///home/trang/localnsv/mAIware-server/public/styles.css","path":"/home/trang/localnsv/mAIware-server/public/styles.css","scheme":"file"},"requestId":"request_fcbfa3b8-88ac-48bc-80d5-4ae65eb5dfdf","content":":root {\n    --bg-primary: #000000;\n    --bg-secondary: #0a0a0a;\n    --bg-card: #0f0f0f;\n    --bg-hover: #151515;\n    --text-primary: #e8f0e8;\n    --text-secondary: #9ca3af;\n    --accent-green: #6bd122;\n    --accent-green-dim: #8be04e;\n    --accent-yellow: #ffd700;\n    --accent-red: #ff3b3b;\n    --accent-red-dim: #cc2f2f;\n    --border-color: #1a1a1a;\n    --shadow-color: rgba(0, 0, 0, 0.5);\n    --success-glow: rgba(57, 255, 20, 0.3);\n    --danger-glow: rgba(255, 59, 59, 0.3);\n    --warning-glow: rgba(255, 215, 0, 0.3);\n    /* Chart theming */\n    --chart-text-color: #9ca3af;\n    --chart-grid-color: rgba(255, 255, 255, 0.1);\n}\n\n[data-theme=\"light\"] {\n    --bg-primary: #f0f4f0;\n    --bg-secondary: #ffffff;\n    --bg-card: #fafafa;\n    --bg-hover: #e8f5e8;\n    --text-primary: #1a1f2e;\n    --text-secondary: #4a5568;\n    --accent-green: #5bb01d;\n    --accent-green-dim: #96d667;\n    --accent-yellow: #cc9a00;\n    --accent-red: #dc2626;\n    --accent-red-dim: #b91c1c;\n    --border-color: #d1d5db;\n    --shadow-color: rgba(0, 0, 0, 0.1);\n    --success-glow: rgba(46, 214, 15, 0.2);\n    --danger-glow: rgba(220, 38, 38, 0.2);\n    --warning-glow: rgba(204, 154, 0, 0.2);\n    /* Chart theming overrides for light mode */\n    --chart-text-color: #1f2937; /* gray-800 for maximum contrast */\n    --chart-grid-color: rgba(0, 0, 0, 0.12);\n}\n\n* { \n    margin: 0; \n    padding: 0; \n    box-sizing: border-box; \n}\n\nbody {\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    background: var(--bg-primary);\n    color: var(--text-primary);\n    min-height: 100vh;\n    margin: 0;\n    overflow-x: hidden;\n    position: relative;\n}\n\nbody::before {\n    content: '';\n    position: fixed;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: \n        radial-gradient(circle at 20% 50%, rgba(57, 255, 20, 0.08) 0%, transparent 50%),\n        radial-gradient(circle at 80% 80%, rgba(57, 255, 20, 0.06) 0%, transparent 50%),\n        radial-gradient(circle at 40% 20%, rgba(57, 255, 20, 0.05) 0%, transparent 50%);\n    animation: backgroundGlow 15s ease-in-out infinite;\n    pointer-events: none;\n    z-index: 0;\n}\n\n@keyframes backgroundGlow {\n    0%, 100% { \n        transform: translate(0, 0) scale(1);\n        opacity: 0.4;\n    }\n    33% { \n        transform: translate(10%, 10%) scale(1.1);\n        opacity: 0.6;\n    }\n    66% { \n        transform: translate(-10%, 5%) scale(0.95);\n        opacity: 0.5;\n    }\n}\n\nbody > * {\n    position: relative;\n    z-index: 1;\n}\n\n/* Side Panel Navigation */\n.side-panel {\n    position: fixed;\n    left: 0;\n    top: 0;\n    height: 100vh;\n    width: 70px;\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border-right: 1px solid rgba(57, 255, 20, 0.2);\n    box-shadow: 0 0 30px rgba(57, 255, 20, 0.1);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    z-index: 9999;\n    transition: all 0.3s ease;\n}\n\n.side-panel:hover {\n    background: rgba(15, 15, 15, 0.8);\n    box-shadow: 0 0 40px rgba(57, 255, 20, 0.2);\n}\n\n.panel-icon-strip {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 2rem 0;\n}\n\n.panel-logo-icon {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 50px;\n    height: 50px;\n    color: var(--accent-green);\n    font-size: 2rem;\n    animation: pulse-glow 3s ease-in-out infinite;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.panel-logo-icon:hover {\n    transform: scale(1.1);\n    filter: drop-shadow(0 0 20px var(--success-glow));\n}\n\n@keyframes pulse-glow {\n    0%, 100% { filter: drop-shadow(0 0 5px var(--success-glow)); }\n    50% { filter: drop-shadow(0 0 15px var(--success-glow)) drop-shadow(0 0 25px var(--success-glow)); }\n}\n\n/* Graphs Preview Grid */\n.graphs-preview {\n    position: fixed;\n    left: 70px;\n    top: 50%;\n    transform: translateY(-50%) translateX(-100%);\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-left: none;\n    border-radius: 0 12px 12px 0;\n    padding: 2rem;\n    width: 480px;\n    max-height: 90vh;\n    overflow-y: auto;\n    opacity: 0;\n    visibility: hidden;\n    pointer-events: none;\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease, visibility 0.3s;\n    box-shadow: 5px 0 40px rgba(57, 255, 20, 0.15);\n    z-index: 9998;\n    will-change: transform, opacity;\n}\n\n.graphs-preview::-webkit-scrollbar {\n    width: 6px;\n}\n\n.graphs-preview::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 3px;\n}\n\n.graphs-preview::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 3px;\n}\n\n.graphs-preview.show {\n    opacity: 1;\n    visibility: visible;\n    pointer-events: auto;\n    transform: translateY(-50%) translateX(0);\n}\n\n.preview-header {\n    margin-bottom: 1rem;\n    padding-bottom: 0.8rem;\n    border-bottom: 1px solid var(--border-color);\n}\n\n.preview-header h3 {\n    color: var(--accent-green);\n    font-size: 1.1rem;\n    margin-bottom: 0.3rem;\n}\n\n.preview-header p {\n    color: var(--text-secondary);\n    font-size: 0.85rem;\n}\n\n/* Analytics Miniview - Scaled down live view */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-content {\n    width: 100%;\n    height: 100%;\n    transform-origin: top left;\n    transform: scale(0.25);\n    width: 400%;\n    height: 400%;\n    pointer-events: none;\n    overflow: hidden;\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n.preview-home-nav {\n    margin-top: 1.5rem;\n    padding: 1rem;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 10px;\n    display: flex;\n    align-items: center;\n    gap: 0.8rem;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    opacity: 0;\n    visibility: hidden;\n    transform: translateY(10px);\n}\n\n.preview-home-nav.visible {\n    opacity: 1;\n    visibility: visible;\n    transform: translateY(0);\n}\n\n.preview-home-nav:hover {\n    background: var(--bg-hover);\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.preview-home-nav i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n}\n\n.preview-home-nav span {\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--text-primary);\n}\n\n.preview-label {\n    flex: 1;\n    font-size: 0.95rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    letter-spacing: 0.3px;\n}\n\n/* Analytics Miniview - Screenshot preview */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    padding: 1.5rem;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-preview {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    opacity: 0.7;\n}\n\n.preview-row {\n    display: flex;\n    gap: 1rem;\n    flex: 1;\n}\n\n.preview-box {\n    flex: 1;\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 6px;\n    position: relative;\n    overflow: hidden;\n    padding: 0.5rem;\n}\n\n.preview-box.large {\n    flex: 2;\n}\n\n.preview-box.wide {\n    flex: 1;\n    min-height: 150px;\n}\n\n.box-header {\n    font-size: 0.65rem;\n    color: var(--accent-green);\n    margin-bottom: 0.5rem;\n    opacity: 0.8;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.box-content {\n    height: calc(100% - 1.5rem);\n    position: relative;\n}\n\n.map-visual {\n    background: radial-gradient(circle at center, rgba(57, 255, 20, 0.05), transparent);\n    position: relative;\n}\n\n.map-dot {\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 10px var(--accent-green);\n    animation: map-pulse 2s ease-in-out infinite;\n}\n\n.map-dot:nth-child(2) { animation-delay: 0.5s; }\n.map-dot:nth-child(3) { animation-delay: 1s; }\n\n@keyframes map-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.6; }\n    50% { transform: scale(1.5); opacity: 1; }\n}\n\n.chart-visual {\n    display: flex;\n    align-items: flex-end;\n    justify-content: space-around;\n    height: 100%;\n    padding: 0.5rem;\n    gap: 0.3rem;\n}\n\n.chart-bar {\n    flex: 1;\n    background: linear-gradient(180deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    animation: bar-grow 2s ease-in-out infinite;\n    opacity: 0.7;\n}\n\n.chart-bar:nth-child(2) { animation-delay: 0.2s; }\n.chart-bar:nth-child(3) { animation-delay: 0.4s; }\n.chart-bar:nth-child(4) { animation-delay: 0.6s; }\n\n@keyframes bar-grow {\n    0%, 100% { transform: scaleY(0.8); }\n    50% { transform: scaleY(1); }\n}\n\n.list-visual {\n    display: flex;\n    flex-direction: column;\n    gap: 0.4rem;\n    padding: 0.3rem;\n}\n\n.list-item {\n    height: 0.4rem;\n    background: linear-gradient(90deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    opacity: 0.6;\n    animation: list-fade 3s ease-in-out infinite;\n}\n\n.list-item:nth-child(2) { animation-delay: 0.5s; width: 80%; }\n.list-item:nth-child(3) { animation-delay: 1s; width: 60%; }\n\n@keyframes list-fade {\n    0%, 100% { opacity: 0.4; }\n    50% { opacity: 0.8; }\n}\n\n.network-visual {\n    position: relative;\n    height: 100%;\n}\n\n.network-node {\n    position: absolute;\n    width: 6px;\n    height: 6px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 8px var(--accent-green);\n    animation: node-pulse 3s ease-in-out infinite;\n}\n\n.network-node:nth-child(2) { animation-delay: 0.7s; }\n.network-node:nth-child(3) { animation-delay: 1.4s; }\n\n@keyframes node-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.5; }\n    50% { transform: scale(1.3); opacity: 1; }\n}\n\n.heat-visual {\n    background: \n        radial-gradient(circle at 30% 30%, rgba(57, 255, 20, 0.3), transparent 40%),\n        radial-gradient(circle at 70% 60%, rgba(57, 255, 20, 0.2), transparent 40%),\n        radial-gradient(circle at 50% 80%, rgba(57, 255, 20, 0.25), transparent 40%);\n    animation: heat-shift 4s ease-in-out infinite;\n}\n\n@keyframes heat-shift {\n    0%, 100% { opacity: 0.5; }\n    50% { opacity: 0.8; }\n}\n\n.pie-visual {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n}\n\n.pie-chart {\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    background: conic-gradient(\n        var(--accent-green) 0deg 120deg,\n        var(--accent-yellow) 120deg 240deg,\n        var(--accent-red) 240deg 360deg\n    );\n    box-shadow: 0 0 15px rgba(57, 255, 20, 0.4);\n    animation: pie-spin 10s linear infinite;\n}\n\n@keyframes pie-spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n\n/* Main Content Area */\n.main-content {\n    margin-left: 70px;\n    min-height: 100vh;\n    padding: 2rem;\n    transition: margin-left 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    position: relative;\n}\n\n/* Backdrop overlay for preview panel */\n.preview-backdrop {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    background: rgba(0, 0, 0, 0.4);\n    backdrop-filter: blur(2px);\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    z-index: 9998;\n    pointer-events: none;\n}\n\n.preview-backdrop.show {\n    opacity: 1;\n    visibility: visible;\n}\n\n/* View Containers */\n.view-container {\n    display: none;\n    animation: fadeIn 0.4s ease-in-out;\n}\n\n.view-container.active {\n    display: block;\n}\n\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n        transform: translateY(10px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n/* Dashboard Header */\n.dashboard-header {\n    text-align: center;\n    margin-bottom: 2.5rem;\n}\n\n.header-content h1 {\n    font-size: 2.5rem;\n    margin-bottom: 0.5rem;\n    color: var(--accent-green);\n    font-weight: 700;\n    letter-spacing: 2px;\n}\n\n.header-content .subtitle {\n    font-size: 1.2rem;\n    color: var(--text-secondary);\n    font-weight: 500;\n}\n\n.pulse-icon {\n    display: inline-block;\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n@keyframes pulse-scale {\n    0%, 100% {\n        transform: scale(1);\n        filter: drop-shadow(0 0 5px var(--success-glow));\n    }\n    50% {\n        transform: scale(1.05);\n        filter: drop-shadow(0 0 15px var(--success-glow));\n    }\n}\n\n/* Animations */\n.animate-slide-in {\n    animation: slideIn 0.6s ease-out;\n}\n\n@keyframes slideIn {\n    from {\n        opacity: 0;\n        transform: translateX(-30px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n.animate-fade-in {\n    animation: fadeInUp 0.6s ease-out;\n}\n\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.container {\n    max-width: 1400px;\n    margin: 0 auto;\n}\n\n/* Theme Toggle Button */\n.theme-toggle {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    background: rgba(15, 15, 15, 0.85);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50px;\n    padding: 10px 20px;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    font-size: 1rem;\n    color: var(--text-primary);\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px rgba(57, 255, 20, 0.2);\n    font-weight: 600;\n}\n\n.theme-toggle:hover {\n    background: rgba(15, 15, 15, 0.8);\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.theme-toggle .icon {\n    font-size: 1.2rem;\n}\n\n/* Auto-scroll indicators */\n.scroll-indicator {\n    position: fixed;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 60px;\n    height: 60px;\n    background: rgba(57, 255, 20, 0.15);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 2px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    opacity: 0;\n    pointer-events: none;\n    transition: opacity 0.3s ease;\n    z-index: 10001;\n}\n\n.scroll-indicator.visible {\n    opacity: 1;\n    animation: scroll-pulse 1.5s ease-in-out infinite;\n}\n\n.scroll-indicator.scroll-up {\n    top: 20px;\n}\n\n.scroll-indicator.scroll-down {\n    bottom: 20px;\n}\n\n.scroll-indicator i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    animation: scroll-bounce 1s ease-in-out infinite;\n}\n\n.scroll-up i {\n    animation-name: scroll-bounce-up;\n}\n\n.scroll-down i {\n    animation-name: scroll-bounce-down;\n}\n\n@keyframes scroll-pulse {\n    0%, 100% {\n        box-shadow: 0 0 10px rgba(57, 255, 20, 0.3);\n    }\n    50% {\n        box-shadow: 0 0 25px rgba(57, 255, 20, 0.6);\n    }\n}\n\n@keyframes scroll-bounce-up {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(-5px);\n    }\n}\n\n@keyframes scroll-bounce-down {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(5px);\n    }\n}\n\n/* Threat Ticker */\n.threat-ticker-container {\n    background: var(--bg-secondary);\n    border: 2px solid var(--accent-green);\n    border-radius: 8px;\n    padding: 12px;\n    margin-bottom: 2rem;\n    display: flex;\n    align-items: center;\n    gap: 16px;\n    overflow: hidden;\n    box-shadow: 0 2px 8px var(--success-glow);\n}\n\n.ticker-label {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 8px 16px;\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    border-radius: 6px;\n    font-weight: 700;\n    font-size: 0.75rem;\n    color: #fff;\n    white-space: nowrap;\n    box-shadow: 0 2px 8px rgba(255, 71, 87, 0.4);\n}\n\n.ticker-label i {\n    animation: pulse-broadcast 2s infinite;\n}\n\n@keyframes pulse-broadcast {\n    0%, 100% { opacity: 1; transform: scale(1); }\n    50% { opacity: 0.6; transform: scale(0.9); }\n}\n\n.threat-ticker {\n    flex: 1;\n    overflow: hidden;\n    position: relative;\n}\n\n.ticker-content {\n    display: flex;\n    gap: 40px;\n    white-space: nowrap;\n    animation: scroll-ticker 30s linear infinite;\n}\n\n.ticker-content:hover {\n    animation-play-state: paused;\n}\n\n@keyframes scroll-ticker {\n    0% { transform: translateX(0); }\n    100% { transform: translateX(-50%); }\n}\n\n.ticker-item {\n    color: #e0e0e0;\n    font-size: 0.9rem;\n    display: inline-flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.ticker-item i {\n    font-size: 0.5rem;\n    animation: blink 1.5s infinite;\n}\n\n@keyframes blink {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.3; }\n}\n\n/* Notification System */\n.notification-container {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    max-width: 400px;\n}\n\n.threat-notification {\n    background: rgba(30, 30, 30, 0.98);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 8px;\n    padding: 16px;\n    display: flex;\n    gap: 12px;\n    align-items: flex-start;\n    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);\n    transform: translateX(450px);\n    opacity: 0;\n    transition: all 0.3s ease-out;\n}\n\n.threat-notification.show {\n    transform: translateX(0);\n    opacity: 1;\n}\n\n.notification-icon {\n    font-size: 1.5rem;\n    flex-shrink: 0;\n}\n\n.notification-content {\n    flex: 1;\n}\n\n.notification-title {\n    font-size: 0.95rem;\n    color: #e0e0e0;\n    margin-bottom: 4px;\n}\n\n.notification-title strong {\n    text-transform: uppercase;\n    font-weight: 800;\n}\n\n.notification-details {\n    font-size: 0.85rem;\n    color: #b0b0b0;\n    margin-bottom: 6px;\n}\n\n.notification-meta {\n    font-size: 0.75rem;\n    color: #888;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.notification-close {\n    cursor: pointer;\n    color: #666;\n    transition: color 0.2s;\n    font-size: 0.9rem;\n}\n\n.notification-close:hover {\n    color: #e0e0e0;\n}\n\n/* Stat Card Pulse Animation */\n.stat-pulse {\n    animation: stat-pulse-animation 0.6s ease-out;\n}\n\n@keyframes stat-pulse-animation {\n    0% { transform: scale(1); }\n    50% { transform: scale(1.05); box-shadow: 0 8px 24px rgba(90, 156, 248, 0.4); }\n    100% { transform: scale(1); }\n}\n\nh1 {\n    font-size: 2.5rem;\n    color: #5a9cf8;\n    margin-bottom: 0.5rem;\n}\n\n.subtitle {\n    color: #888;\n    font-size: 1.1rem;\n}\n\n.stats-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1.5rem;\n    margin-bottom: 3rem;\n}\n\n.stat-card {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 1.5rem;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.8rem;\n    position: relative;\n    overflow: hidden;\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.stat-card::before {\n    content: '';\n    position: absolute;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: radial-gradient(circle, var(--accent-green) 0%, transparent 70%);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover::before {\n    opacity: 0.05;\n}\n\n.stat-card:hover {\n    transform: translateY(-5px) scale(1.02);\n    border-color: var(--accent-green);\n    box-shadow: 0 10px 30px var(--success-glow);\n}\n\n.stat-card i {\n    font-size: 2.5rem;\n    opacity: 0.8;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover i {\n    transform: scale(1.1) rotateY(180deg);\n    opacity: 1;\n}\n\n.stat-number {\n    font-size: 2.5rem;\n    font-weight: 700;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover .stat-number {\n    transform: scale(1.1);\n    text-shadow: 0 0 20px currentColor;\n}\n\n.stat-label {\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n    font-weight: 600;\n}\n\n.stat-glow {\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    height: 3px;\n    background: linear-gradient(90deg, transparent, var(--accent-green), transparent);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover .stat-glow {\n    opacity: 1;\n    animation: glowSlide 2s ease-in-out infinite;\n}\n\n@keyframes glowSlide {\n    0%, 100% {\n        transform: translateX(-100%);\n    }\n    50% {\n        transform: translateX(100%);\n    }\n}\n\n.stat-card.malware {\n    border-color: rgba(255, 59, 59, 0.3);\n}\n\n.stat-card.malware i,\n.stat-card.malware .stat-number {\n    color: var(--accent-red);\n}\n\n.stat-card.malware:hover {\n    border-color: var(--accent-red);\n    box-shadow: 0 10px 30px var(--danger-glow);\n}\n\n.stat-card.suspicious {\n    border-color: rgba(255, 215, 0, 0.3);\n}\n\n.stat-card.suspicious i,\n.stat-card.suspicious .stat-number {\n    color: var(--accent-yellow);\n}\n\n.stat-card.suspicious:hover {\n    border-color: var(--accent-yellow);\n    box-shadow: 0 10px 30px var(--warning-glow);\n}\n\n.stat-card.benign i,\n.stat-card.benign .stat-number,\n.stat-card.info i,\n.stat-card.info .stat-number {\n    color: var(--accent-green);\n}\n\n/* Analytics View */\n.analytics-header {\n    display: flex;\n    align-items: center;\n    gap: 2rem;\n    margin-bottom: 2.5rem;\n}\n\n.back-btn {\n    background: var(--bg-card);\n    border: 2px solid var(--accent-green);\n    color: var(--accent-green);\n    padding: 0.8rem 1.5rem;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 600;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    transition: all 0.3s ease;\n}\n\n.back-btn:hover {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    transform: translateX(-5px);\n    box-shadow: 0 5px 20px var(--success-glow);\n}\n\n.analytics-header h1 {\n    font-size: 2rem;\n    color: var(--accent-green);\n    font-weight: 700;\n}\n\n.analytics-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));\n    gap: 2rem;\n    max-height: calc(100vh - 200px);\n    overflow-y: auto;\n    padding-right: 1rem;\n    grid-auto-flow: dense;\n}\n\n/* Panel size classes for flexible tiling */\n.analytics-panel.panel-small {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-medium {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-large {\n    grid-column: span 2;\n}\n\n@media (max-width: 1400px) {\n    .analytics-grid {\n        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));\n    }\n    \n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n}\n\n.analytics-grid::-webkit-scrollbar {\n    width: 8px;\n}\n\n.analytics-grid::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb:hover {\n    background: var(--accent-green-dim);\n}\n\n.analytics-panel {\n    animation: slideInPanel 0.5s ease-out;\n    animation-fill-mode: backwards;\n}\n\n.analytics-panel:nth-child(1) { animation-delay: 0.05s; }\n.analytics-panel:nth-child(2) { animation-delay: 0.1s; }\n.analytics-panel:nth-child(3) { animation-delay: 0.15s; }\n.analytics-panel:nth-child(4) { animation-delay: 0.2s; }\n.analytics-panel:nth-child(5) { animation-delay: 0.25s; }\n.analytics-panel:nth-child(6) { animation-delay: 0.3s; }\n\n@keyframes slideInPanel {\n    from {\n        opacity: 0;\n        transform: translateY(30px) scale(0.95);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n    }\n}\n\n/* Advanced Analytics Grid for Mini Charts */\n.advanced-analytics-grid {\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 12px;\n    padding: 1.5rem;\n}\n\n.mini-charts-grid {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 1.5rem;\n    margin-top: 1rem;\n}\n\n.mini-chart-container {\n    background: rgba(10, 10, 10, 0.6);\n    border: 1px solid rgba(57, 255, 20, 0.15);\n    border-radius: 8px;\n    padding: 1rem;\n}\n\n.mini-chart-container h3 {\n    color: var(--accent-green);\n    font-size: 0.95rem;\n    margin: 0 0 0.75rem 0;\n    font-weight: 600;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.mini-chart-container h3 i {\n    font-size: 0.9rem;\n}\n\n@media (max-width: 1200px) {\n    .mini-charts-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n/* Emerging Threat Intelligence Panel */\n.eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.1) 0%, rgba(255, 165, 2, 0.1) 100%);\n    border: 2px solid rgba(255, 71, 87, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(255, 71, 87, 0.2);\n}\n\n.eti-header {\n    margin-bottom: 24px;\n}\n\n.eti-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #ff6b6b;\n    text-shadow: 0 2px 4px rgba(255, 71, 87, 0.3);\n}\n\n.eti-header h2 i {\n    color: #ff4757;\n    margin-right: 10px;\n    animation: pulse 2s infinite;\n}\n\n@keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.6; }\n}\n\n.eti-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 8px 0 16px 0;\n}\n\n.eti-summary {\n    display: flex;\n    gap: 12px;\n    flex-wrap: wrap;\n}\n\n.eti-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 6px 14px;\n    border-radius: 20px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.eti-badge.recent {\n    background: rgba(255, 71, 87, 0.2);\n    border-color: rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.eti-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n    gap: 20px;\n}\n\n.eti-panel {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 18px;\n    transition: transform 0.3s, box-shadow 0.3s;\n}\n\n.eti-panel:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);\n}\n\n.eti-panel h3 {\n    margin: 0 0 6px 0;\n    font-size: 1.1rem;\n    color: #e0e0e0;\n}\n\n.eti-panel h3 i {\n    color: #ffa502;\n    margin-right: 8px;\n}\n\n.eti-subtitle-small {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 14px;\n}\n\n.eti-list {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n}\n\n.eti-item {\n    display: flex;\n    gap: 12px;\n    background: rgba(255, 255, 255, 0.03);\n    border: 1px solid rgba(255, 255, 255, 0.08);\n    border-radius: 8px;\n    padding: 12px;\n    transition: all 0.3s;\n}\n\n.eti-item:hover {\n    background: rgba(255, 255, 255, 0.06);\n    border-color: rgba(255, 165, 2, 0.4);\n    transform: translateX(4px);\n}\n\n.eti-rank {\n    flex-shrink: 0;\n    width: 32px;\n    height: 32px;\n    background: linear-gradient(135deg, #ff6b6b, #ffa502);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: bold;\n    font-size: 1rem;\n    color: #fff;\n    box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);\n}\n\n.eti-item[data-rank=\"1\"] .eti-rank {\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    transform: scale(1.1);\n}\n\n.eti-content {\n    flex: 1;\n    min-width: 0;\n}\n\n.eti-name {\n    font-weight: 600;\n    color: #e0e0e0;\n    font-size: 0.95rem;\n    margin-bottom: 4px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-meta {\n    display: flex;\n    gap: 8px;\n    flex-wrap: wrap;\n    align-items: center;\n}\n\n.eti-count {\n    color: #888;\n    font-size: 0.8rem;\n}\n\n.eti-recent-badge {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-agent-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-details {\n    margin-top: 6px;\n    color: #999;\n    font-size: 0.75rem;\n    font-style: italic;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-empty {\n    text-align: center;\n    color: #666;\n    padding: 20px;\n    font-style: italic;\n}\n\n/* Threat Modeler */\n.modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.1) 0%, rgba(38, 222, 129, 0.1) 100%);\n    border: 2px solid rgba(90, 156, 248, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(90, 156, 248, 0.2);\n}\n\n.modeler-header {\n    margin-bottom: 24px;\n}\n\n.modeler-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #5a9cf8;\n}\n\n.modeler-header h2 i {\n    color: #26de81;\n    margin-right: 10px;\n}\n\n.modeler-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 0;\n}\n\n.modeler-grid {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 24px;\n}\n\n@media (max-width: 1024px) {\n    .modeler-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n.modeler-builder,\n.modeler-results {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 20px;\n}\n\n.modeler-builder h3,\n.modeler-results h3 {\n    margin: 0 0 20px 0;\n    font-size: 1.2rem;\n    color: #e0e0e0;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n    padding-bottom: 10px;\n}\n\n.modeler-builder h3 i {\n    color: #26de81;\n    margin-right: 8px;\n}\n\n.modeler-results h3 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.modeler-field {\n    margin-bottom: 20px;\n}\n\n.modeler-field label {\n    display: block;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n    margin-bottom: 6px;\n    font-weight: 600;\n}\n\n.modeler-select {\n    width: 100%;\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.2);\n    border-radius: 6px;\n    color: #e0e0e0;\n    padding: 10px;\n    font-size: 0.9rem;\n    font-family: inherit;\n    cursor: pointer;\n    transition: all 0.3s;\n}\n\n.modeler-select:focus {\n    outline: none;\n    border-color: #5a9cf8;\n    background: rgba(90, 156, 248, 0.1);\n}\n\n.modeler-select option {\n    background: #1a1a2e;\n    color: #e0e0e0;\n    padding: 8px;\n}\n\n.modeler-hint {\n    display: block;\n    color: #666;\n    font-size: 0.75rem;\n    margin-top: 4px;\n    font-style: italic;\n}\n\n.modeler-analyze-btn {\n    width: 100%;\n    background: linear-gradient(135deg, #26de81, #20bf6b);\n    border: none;\n    color: #fff;\n    padding: 14px 24px;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 700;\n    cursor: pointer;\n    transition: all 0.3s;\n    box-shadow: 0 4px 12px rgba(38, 222, 129, 0.3);\n}\n\n.modeler-analyze-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(38, 222, 129, 0.4);\n}\n\n.modeler-analyze-btn i {\n    margin-right: 8px;\n}\n\n.modeler-output {\n    min-height: 400px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.modeler-placeholder {\n    text-align: center;\n    color: #666;\n}\n\n.modeler-placeholder i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n    opacity: 0.5;\n}\n\n.modeler-placeholder p {\n    font-size: 0.95rem;\n}\n\n.modeler-loading {\n    text-align: center;\n    color: #5a9cf8;\n}\n\n.modeler-loading i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.modeler-error {\n    text-align: center;\n    color: #ff4757;\n}\n\n.modeler-error i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.prediction-result {\n    width: 100%;\n}\n\n.prediction-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 24px;\n    padding: 20px;\n    background: rgba(255, 255, 255, 0.05);\n    border-radius: 8px;\n}\n\n.prediction-badge {\n    padding: 12px 24px;\n    border-radius: 8px;\n    font-size: 1.3rem;\n    font-weight: 800;\n    color: #fff;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n\n.prediction-confidence {\n    text-align: right;\n}\n\n.confidence-label {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 4px;\n}\n\n.confidence-value {\n    color: #5a9cf8;\n    font-size: 2rem;\n    font-weight: 800;\n}\n\n.prediction-family {\n    padding: 16px;\n    background: rgba(255, 71, 87, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 6px;\n    margin-bottom: 20px;\n    color: #e0e0e0;\n}\n\n.family-name {\n    color: #ff6b6b;\n    font-weight: 700;\n    font-size: 1.1rem;\n    margin-left: 8px;\n}\n\n.prediction-section {\n    margin-bottom: 20px;\n}\n\n.prediction-section h4 {\n    color: #5a9cf8;\n    font-size: 1rem;\n    margin: 0 0 12px 0;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 6px;\n}\n\n.analysis-item {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    padding: 8px 0;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n}\n\n.analysis-item i {\n    color: #ffa502;\n    width: 20px;\n}\n\n.indicator-group {\n    margin-bottom: 16px;\n}\n\n.indicator-group strong {\n    display: block;\n    color: #e0e0e0;\n    margin-bottom: 8px;\n    font-size: 0.9rem;\n}\n\n.indicator-list {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 8px;\n}\n\n.indicator-tag {\n    padding: 6px 12px;\n    border-radius: 6px;\n    font-size: 0.8rem;\n    font-weight: 600;\n    font-family: 'Courier New', monospace;\n}\n\n.api-tag {\n    background: rgba(255, 165, 2, 0.2);\n    border: 1px solid rgba(255, 165, 2, 0.4);\n    color: #ffa502;\n}\n\n.string-tag {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.prediction-footer {\n    margin-top: 20px;\n    padding: 12px;\n    background: rgba(90, 156, 248, 0.1);\n    border-radius: 6px;\n    color: #5a9cf8;\n    font-size: 0.85rem;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.scans-container {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 2rem;\n    transition: all 0.3s ease;\n}\n\n.scans-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--shadow-color);\n}\n\n.scans-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.scans-header h2 {\n    color: #24ae6b;\n}\n\n.refresh-btn {\n    background: #24ae6b;\n    color: white;\n    border: none;\n    padding: 0.75rem 1.5rem;\n    border-radius: 8px;\n    cursor: pointer;\n    font-size: 1rem;\n    transition: background 0.2s;\n}\n\n.refresh-btn:hover {\n    background: #1e9258;\n}\n\n.scans-table {\n    width: 100%;\n    border-collapse: collapse;\n}\n\n.scans-table th {\n    text-align: left;\n    padding: 1rem;\n    background: rgba(255, 255, 255, 0.05);\n    color: #5a9cf8;\n    font-weight: 600;\n}\n\n.scans-table td {\n    padding: 1rem;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.scans-table tr:hover {\n    background: rgba(255, 255, 255, 0.03);\n}\n\n.badge {\n    display: inline-block;\n    padding: 0.3rem 0.8rem;\n    border-radius: 6px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.badge.malware { background: #ff4757; color: white; }\n.badge.suspicious { background: #ffa502; color: white; }\n.badge.benign { background: #26de81; color: white; }\n.badge.non-pe { background: #4b5563; color: #fff; }\n\n.hash {\n    font-family: 'Courier New', monospace;\n    font-size: 0.85rem;\n    color: #888;\n}\n\n.empty-state {\n    text-align: center;\n    padding: 3rem;\n    color: #666;\n}\n\n.empty-state i {\n    font-size: 4rem;\n    margin-bottom: 1rem;\n    opacity: 0.3;\n}\n\n/* NEW: Chart Container Styles */\n.chart-container {\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 12px;\n    padding: 2rem;\n    margin-top: 2rem;\n}\n\n.chart-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.chart-header h2 {\n    color: var(--accent-green);\n    margin: 0;\n}\n\n.chart-subtitle {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    margin: 0.5rem 0 0 0;\n    font-weight: normal;\n}\n\n.chart-controls {\n    display: flex;\n    gap: 0.5rem;\n}\n\n.chart-btn {\n    background: rgba(255, 255, 255, 0.05);\n    color: #888;\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    padding: 0.5rem 1rem;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.2s;\n}\n\n.chart-btn:hover {\n    background: rgba(255, 255, 255, 0.1);\n    color: #e0e0e0;\n}\n\n.chart-btn.active {\n    background: #5a9cf8;\n    color: white;\n    border-color: #5a9cf8;\n}\n\n#dailyScansChart {\n    max-height: 400px;\n}\n\n@media (max-width: 1024px) {\n    .analytics-grid {\n        grid-template-columns: 1fr;\n        gap: 1.5rem;\n    }\n    \n    .analytics-panel.panel-small,\n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n    \n    .graphs-preview {\n        width: 400px;\n    }\n}\n\n@media (max-width: 768px) {\n    .main-content {\n        margin-left: 0;\n        padding: 1rem;\n    }\n    \n    .side-panel {\n        width: 50px;\n    }\n    \n    .panel-logo-icon {\n        width: 40px;\n        height: 40px;\n        font-size: 1.5rem;\n    }\n    \n    .graphs-preview {\n        left: 50px;\n        width: calc(100vw - 50px);\n        border-radius: 0;\n    }\n    \n    .dashboard-header h1 {\n        font-size: 1.8rem;\n    }\n    \n    .stats-grid {\n        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n        gap: 1rem;\n    }\n    \n    .chart-header {\n        flex-direction: column;\n        gap: 1rem;\n        align-items: flex-start;\n    }\n    \n    .chart-controls {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .chart-btn {\n        flex: 1;\n    }\n    \n    .map-view-toggle {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .map-btn {\n        flex: 1;\n        font-size: 0.8rem;\n        padding: 0.4rem 0.6rem;\n    }\n    \n    .geo-context-panel {\n        flex-direction: column;\n    }\n    \n    .context-stat {\n        width: 100%;\n    }\n    \n    .map-timeline-control {\n        flex-direction: column;\n        gap: 0.5rem;\n    }\n    \n    .timeline-info {\n        text-align: center;\n    }\n    \n    .analytics-header {\n        flex-direction: column;\n        align-items: flex-start;\n    }\n}\n\n/* Map Container */\n.map-container {\n    background: var(--bg-card);\n    border-radius: 12px;\n    padding: 24px;\n    box-shadow: 0 4px 12px var(--shadow-color);\n    border: 2px solid var(--border-color);\n    transition: all 0.3s ease;\n    min-height: 600px;\n}\n\n.map-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 8px 24px var(--shadow-color), 0 0 20px var(--success-glow);\n}\n\n#worldMap {\n    width: 100%;\n    height: 500px;\n    border-radius: 8px;\n    margin-bottom: 15px;\n    background: var(--bg-secondary);\n    border: 1px solid var(--border-color);\n    z-index: 1;\n    position: relative;\n}\n\n.map-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 20px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.map-header h2 {\n    margin: 0;\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-header h2 i {\n    color: var(--accent-green);\n    margin-right: 8px;\n}\n\n.map-controls {\n    display: flex;\n    gap: 20px;\n    align-items: center;\n    flex-wrap: wrap;\n}\n\n.map-view-toggle {\n    display: flex;\n    gap: 8px;\n    background: var(--bg-secondary);\n    padding: 4px;\n    border-radius: 8px;\n    border: 1px solid var(--border-color);\n}\n\n.map-btn {\n    background: transparent;\n    border: none;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.map-btn:hover {\n    background: var(--bg-hover);\n    color: var(--text-primary);\n}\n\n.map-btn.active {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    box-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-btn i {\n    font-size: 1rem;\n}\n\n.map-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.legend-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n}\n\n.legend-dot {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    box-shadow: 0 0 6px currentColor;\n}\n\n.malware-dot {\n    background-color: var(--accent-red);\n}\n\n.suspicious-dot {\n    background-color: var(--accent-yellow);\n}\n\n.benign-dot {\n    background-color: var(--accent-green);\n}\n\n.geo-context-panel {\n    display: flex;\n    justify-content: space-around;\n    gap: 20px;\n    padding: 15px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-bottom: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.context-stat {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 5px;\n}\n\n.context-label {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.context-value {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.context-value.threat-count {\n    color: var(--accent-red);\n    text-shadow: 0 0 10px var(--danger-glow);\n}\n\n.map-timeline-control {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 12px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-top: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.timeline-btn {\n    background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-green-dim) 100%);\n    color: var(--bg-primary);\n    border: none;\n    padding: 10px 20px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.95rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    box-shadow: 0 4px 12px var(--success-glow);\n}\n\n.timeline-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px var(--success-glow);\n    filter: brightness(1.1);\n}\n\n.timeline-btn i {\n    font-size: 1rem;\n}\n\n.timeline-info {\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-style: italic;\n}\n\n#worldMap {\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n}\n\n/* Leaflet popup customization for theme */\n.leaflet-popup-content-wrapper {\n    background: var(--bg-card) !important;\n    color: var(--text-primary) !important;\n    border: 2px solid var(--accent-green) !important;\n    box-shadow: 0 4px 15px var(--shadow-color) !important;\n    border-radius: 8px !important;\n}\n\n.leaflet-popup-tip {\n    background: var(--bg-card) !important;\n}\n\n.leaflet-popup-content h3 {\n    color: var(--accent-green) !important;\n}\n\n.leaflet-popup-content button {\n    background: var(--accent-green) !important;\n    color: var(--bg-primary) !important;\n    border: none !important;\n    padding: 8px 16px !important;\n    border-radius: 6px !important;\n    cursor: pointer !important;\n    font-weight: 600 !important;\n    transition: all 0.2s ease !important;\n}\n\n.leaflet-popup-content button:hover {\n    transform: translateY(-2px) !important;\n    box-shadow: 0 4px 12px var(--success-glow) !important;\n}\n\n/* Correlation Graph */\n.correlation-container {\n    background: rgba(255, 255, 255, 0.03);\n    border-radius: 12px;\n    padding: 24px;\n    margin-top: 24px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.correlation-header {\n    margin-bottom: 20px;\n}\n\n.correlation-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.5rem;\n    color: #e0e0e0;\n}\n\n.correlation-header h2 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.correlation-subtitle {\n    color: #888;\n    font-size: 0.9rem;\n    margin: 0;\n}\n\n.graph-controls {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 16px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.graph-btn {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.3s;\n}\n\n.graph-btn:hover {\n    background: rgba(90, 156, 248, 0.3);\n    border-color: #5a9cf8;\n}\n\n.graph-btn i {\n    margin-right: 6px;\n}\n\n.graph-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.node-sample {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    border: 2px solid #fff;\n}\n\n.malware-node {\n    background-color: #ff4757;\n}\n\n.agent-node {\n    background-color: #5a9cf8;\n}\n\n.api-node {\n    background-color: #ffa502;\n}\n\n.string-node {\n    background-color: #26de81;\n}\n\n#correlationGraph {\n    width: 100%;\n    min-height: 600px;\n    position: relative;\n    border-radius: 8px;\n    overflow: hidden;\n}\n\n.node-details {\n    position: absolute;\n    right: 24px;\n    top: 120px;\n    background: rgba(30, 30, 30, 0.95);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    border-radius: 8px;\n    padding: 16px;\n    max-width: 300px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    z-index: 1000;\n}\n\n.node-details h3 {\n    margin: 0 0 12px 0;\n    color: #5a9cf8;\n    font-size: 1.1rem;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 8px;\n}\n\n.node-details p {\n    margin: 8px 0;\n    color: #e0e0e0;\n    font-size: 0.9rem;\n}\n\n.node-details ul {\n    color: #b0b0b0;\n    font-size: 0.85rem;\n}\n\n.node-details li {\n    margin: 4px 0;\n}\n\n/* ========================================\n   LIGHT THEME CONTRAST FIXES\n   ======================================== */\n\n/* Fix 1 & 2: Analytics preview backgrounds - lighter for better green contrast */\n[data-theme=\"light\"] .eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.05) 0%, rgba(255, 165, 2, 0.05) 100%);\n    border-color: rgba(255, 71, 87, 0.2);\n}\n\n[data-theme=\"light\"] .modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.05) 0%, rgba(38, 222, 129, 0.05) 100%);\n    border-color: rgba(90, 156, 248, 0.2);\n}\n\n/* Fix 3: Theme toggle button text - darker for contrast */\n[data-theme=\"light\"] .theme-toggle {\n    color: #1a1f2e;\n    background: rgba(255, 255, 255, 0.8);\n    border-color: rgba(46, 214, 15, 0.4);\n}\n\n/* Fix 4: Daily Analysis chart - darker labels and grid (handled in JS via CSS vars) */\n[data-theme=\"light\"] {\n    --chart-text-color: #374151;\n    --chart-grid-color: rgba(0, 0, 0, 0.12);\n}\n\n:root {\n    --chart-text-color: #9ca3af;\n    --chart-grid-color: rgba(255, 255, 255, 0.1);\n}\n\n/* Fix 5: Chart container labels - darker in light theme */\n[data-theme=\"light\"] .chart-header h2,\n[data-theme=\"light\"] .chart-header {\n    color: #1a1f2e;\n}\n\n/* Fix 6: Threat Vector Correlation header - darker */\n[data-theme=\"light\"] .correlation-header h2 {\n    color: #1a1f2e;\n}\n\n[data-theme=\"light\"] .correlation-subtitle {\n    color: #4a5568;\n}\n\n/* Fix 7: ETI subtitle and summary - darker for better contrast */\n[data-theme=\"light\"] .eti-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .eti-summary {\n    color: #374151;\n}\n\n/* Fix 8: Prediction labels in threat modeler - darker */\n[data-theme=\"light\"] .modeler-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .modeler-field label {\n    color: #374151;\n}\n\n[data-theme=\"light\"] .modeler-hint {\n    color: #6b7280;\n}\n\n/* Fix 9: Analytics preview backgrounds - much lighter for green text visibility */\n[data-theme=\"light\"] .preview-box {\n    background: rgba(255, 255, 255, 0.6);\n    border-color: rgba(46, 214, 15, 0.3);\n}\n\n/* Fix 10: ETI item text - lighter for better readability */\n[data-theme=\"light\"] .eti-count {\n    color: #6b7280;\n}\n\n[data-theme=\"light\"] .eti-details {\n    color: #9ca3af;\n}\n\n[data-theme=\"light\"] .eti-name {\n    color: #1f2937;\n}\n\n/* Fix 11: Make ETI details much more visible in light theme */\n[data-theme=\"light\"] .eti-details {\n    color: #5a9cf8;\n    font-weight: 500;\n}\n\n/* Fix 12: Threat ticker text visibility in light theme */\n[data-theme=\"light\"] .ticker-item {\n    color: #374151;\n    font-weight: 500;\n}\n\n/* Back to Top Button */\n.back-to-top {\n    position: fixed;\n    bottom: 30px;\n    right: 30px;\n    width: 50px;\n    height: 50px;\n    background: linear-gradient(135deg, var(--accent-green), var(--accent-green-dim));\n    border: 2px solid var(--accent-green);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    z-index: 9998;\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px var(--success-glow);\n    color: #000;\n    font-size: 1.2rem;\n}\n\n.back-to-top.visible {\n    opacity: 1;\n    visibility: visible;\n}\n\n.back-to-top:hover {\n    transform: translateY(-5px) scale(1.1);\n    box-shadow: 0 6px 30px var(--success-glow);\n}\n\n.back-to-top:active {\n    transform: translateY(-2px) scale(1.05);\n}\n\n[data-theme=\"light\"] .back-to-top {\n    background: linear-gradient(135deg, #2ed60f, #27b00c);\n    color: #fff;\n}\n","epoch":33,"telemetryInfo":{}}],["file:///home/trang/localnsv/mAIware-server/public/dashboard.html::request_7d2258a4-51bc-4f20-ba08-270fe0c6db2a",{"uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/dashboard.html","external":"file:///home/trang/localnsv/mAIware-server/public/dashboard.html","path":"/home/trang/localnsv/mAIware-server/public/dashboard.html","scheme":"file"},"requestId":"request_7d2258a4-51bc-4f20-ba08-270fe0c6db2a","content":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>mAIware Server Dashboard</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n    <link rel=\"stylesheet\" href=\"styles.css?v=3.0\">\n    <!-- Add Chart.js -->\n    <script src=\"https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js\"></script>\n    <!-- Add Leaflet.js for maps -->\n    <link rel=\"stylesheet\" href=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css\" />\n    <script src=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js\"></script>\n    <!-- Add Leaflet Heatmap Plugin -->\n    <script src=\"https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js\"></script>\n    <!-- Add D3.js for force-directed graph -->\n    <script src=\"https://d3js.org/d3.v7.min.js\"></script>\n    <!-- Add html2canvas for screenshots -->\n    <script src=\"https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js\"></script>\n</head>\n<body>\n    <!-- Theme Toggle Button -->\n    <button class=\"theme-toggle\" id=\"themeToggle\" onclick=\"toggleTheme()\">\n        <span class=\"icon\" id=\"themeIcon\">üåô</span>\n        <span id=\"themeText\">Dark</span>\n    </button>\n\n    <!-- Back to Top Button -->\n    <button class=\"back-to-top\" id=\"backToTop\" onclick=\"scrollToTop()\">\n        <i class=\"fas fa-arrow-up\"></i>\n    </button>\n\n    <!-- Preview Backdrop -->\n    <div class=\"preview-backdrop\" id=\"previewBackdrop\"></div>\n\n    <!-- Side Navigation Panel -->\n    <div class=\"side-panel\" id=\"sidePanel\">\n        <!-- Logo Icon (always visible) -->\n        <div class=\"panel-icon-strip\">\n            <div class=\"panel-logo-icon\">\n                <i class=\"fas fa-shield-virus\"></i>\n            </div>\n        </div>\n        \n        <!-- Analytics Preview Panel (slides out on hover) -->\n        <div class=\"graphs-preview\" id=\"graphsPreview\">\n            <div class=\"preview-header\">\n                <h3><i class=\"fas fa-chart-line\"></i> Analytics Preview</h3>\n                <p>Click anywhere to view full analytics</p>\n            </div>\n            \n            <!-- Scaled-down live view of analytics -->\n            <div class=\"analytics-miniview\" id=\"analyticsMiniview\" onclick=\"switchView('analytics')\">\n                <div class=\"miniview-preview\">\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box large\">\n                            <div class=\"box-header\">Global Threat Map</div>\n                            <div class=\"box-content map-visual\">\n                                <div class=\"map-dot\" style=\"top: 30%; left: 40%;\"></div>\n                                <div class=\"map-dot\" style=\"top: 60%; left: 70%;\"></div>\n                                <div class=\"map-dot\" style=\"top: 45%; left: 25%;\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box large\">\n                            <div class=\"box-header\">Attack Timeline</div>\n                            <div class=\"box-content chart-visual\">\n                                <div class=\"chart-bar\" style=\"height: 40%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 70%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 55%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 85%;\"></div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Top Threats</div>\n                            <div class=\"box-content list-visual\">\n                                <div class=\"list-item\"></div>\n                                <div class=\"list-item\"></div>\n                                <div class=\"list-item\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Correlations</div>\n                            <div class=\"box-content network-visual\">\n                                <div class=\"network-node\" style=\"top: 30%; left: 30%;\"></div>\n                                <div class=\"network-node\" style=\"top: 60%; left: 50%;\"></div>\n                                <div class=\"network-node\" style=\"top: 45%; left: 70%;\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Heatmap</div>\n                            <div class=\"box-content heat-visual\"></div>\n                        </div>\n                    </div>\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box wide\">\n                            <div class=\"box-header\">File Analysis & Distribution</div>\n                            <div class=\"box-content pie-visual\">\n                                <div class=\"pie-chart\"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"miniview-overlay\">\n                    <i class=\"fas fa-expand-alt\"></i>\n                    <span>Click to view analytics</span>\n                </div>\n            </div>                <!-- Home Navigation Button -->\n                <div class=\"preview-home-nav\" id=\"homeNavBtn\" onclick=\"switchView('dashboard')\">\n                    <i class=\"fas fa-home\"></i>\n                    <span>Back to Dashboard</span>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"main-content\" id=\"mainContent\">\n        <!-- DASHBOARD VIEW -->\n        <div class=\"view-container active\" id=\"dashboardView\">\n            <header class=\"dashboard-header\">\n                <div class=\"header-content\">\n                    <h1><i class=\"fas fa-shield-virus pulse-icon\"></i> mAIware Server</h1>\n                    <p class=\"subtitle\">Real-time Malware Analysis Dashboard</p>\n                </div>\n            </header>\n            \n            <!-- Real-time Threat Ticker -->\n            <div class=\"threat-ticker-container animate-slide-in\">\n                <div class=\"ticker-label\">\n                    <i class=\"fas fa-broadcast-tower pulse-icon\"></i>\n                    <span>LIVE THREAT FEED</span>\n                </div>\n                <div class=\"threat-ticker\" id=\"threat-ticker\">\n                    <div class=\"ticker-content\" id=\"ticker-content\">\n                        <span class=\"ticker-item\">System ready - Monitoring for threats...</span>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Notification Toast Container -->\n            <div id=\"notification-container\" class=\"notification-container\"></div>\n            \n            <!-- Stats Grid -->\n            <div class=\"stats-grid animate-fade-in\" id=\"stats-grid\">\n                <div class=\"stat-card info\">\n                    <i class=\"fas fa-laptop\"></i>\n                    <span class=\"stat-number\" id=\"stat-clients\">0</span>\n                    <span class=\"stat-label\">Active Clients</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card info\">\n                    <i class=\"fas fa-chart-line\"></i>\n                    <span class=\"stat-number\" id=\"stat-total\">0</span>\n                    <span class=\"stat-label\">Total Scans</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card malware\">\n                    <i class=\"fas fa-bug\"></i>\n                    <span class=\"stat-number\" id=\"stat-malware\">0</span>\n                    <span class=\"stat-label\">Malware</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card suspicious\">\n                    <i class=\"fas fa-exclamation-triangle\"></i>\n                    <span class=\"stat-number\" id=\"stat-suspicious\">0</span>\n                    <span class=\"stat-label\">Suspicious</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card benign\">\n                    <i class=\"fas fa-check-circle\"></i>\n                    <span class=\"stat-number\" id=\"stat-benign\">0</span>\n                    <span class=\"stat-label\">Benign</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n            </div>\n            \n            <!-- Recent Scans -->\n            <div class=\"scans-container animate-fade-in\">\n                <div class=\"scans-header\">\n                    <h2><i class=\"fas fa-list\"></i> Recent Scans</h2>\n                    <button class=\"refresh-btn\" onclick=\"manualRefresh()\">\n                        <i class=\"fas fa-sync-alt\"></i> Refresh\n                    </button>\n                </div>\n                \n                <table class=\"scans-table\">\n                    <thead>\n                        <tr>\n                            <th>Timestamp</th>\n                            <th>Filename</th>\n                            <th>Classification</th>\n                            <th>Client IP</th>\n                            <th>Hash (SHA256)</th>\n                        </tr>\n                    </thead>\n                    <tbody id=\"scans-tbody\">\n                        <tr>\n                            <td colspan=\"5\" class=\"empty-state\">\n                                <i class=\"fas fa-inbox\"></i>\n                                <p>No scans yet. Waiting for clients...</p>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n\n        <!-- ANALYTICS VIEW -->\n        <div class=\"view-container\" id=\"analyticsView\">\n            <div class=\"analytics-header\">\n                <button class=\"back-btn\" onclick=\"switchView('dashboard')\">\n                    <i class=\"fas fa-arrow-left\"></i> Back to Dashboard\n                </button>\n                <h1><i class=\"fas fa-chart-line\"></i> Analytics & Intelligence</h1>\n            </div>\n            \n            <div class=\"analytics-grid\" id=\"analyticsGrid\">\n                \n                <!-- Daily Analysis Chart -->\n                <div class=\"chart-container analytics-panel panel-large\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-line\"></i> Daily Analysis Trends</h2>\n                        <div class=\"chart-controls\">\n                            <button class=\"chart-btn active\" onclick=\"setChartDays(7)\">7 Days</button>\n                            <button class=\"chart-btn\" onclick=\"setChartDays(14)\">14 Days</button>\n                            <button class=\"chart-btn\" onclick=\"setChartDays(30)\">30 Days</button>\n                        </div>\n                    </div>\n                    <canvas id=\"dailyScansChart\"></canvas>\n                </div>\n                    <canvas id=\"dailyScansChart\"></canvas>\n                </div>\n\n                <!-- Geographic Threat Intelligence Map -->\n                <div class=\"map-container analytics-panel panel-large\">\n                    <div class=\"map-header\">\n                        <h2><i class=\"fas fa-globe-americas\"></i> Global Threat Intelligence Map</h2>\n                        <div class=\"map-controls\">\n                            <div class=\"map-view-toggle\">\n                                <button class=\"map-btn active\" data-view=\"markers\" onclick=\"switchMapView('markers')\">\n                                    <i class=\"fas fa-map-marker-alt\"></i> Markers\n                                </button>\n                                <button class=\"map-btn\" data-view=\"heatmap\" onclick=\"switchMapView('heatmap')\">\n                                    <i class=\"fas fa-fire\"></i> Heatmap\n                                </button>\n                                <button class=\"map-btn\" data-view=\"choropleth\" onclick=\"switchMapView('choropleth')\">\n                                    <i class=\"fas fa-globe\"></i> Choropleth\n                                </button>\n                            </div>\n                            <div class=\"map-legend\">\n                                <span class=\"legend-item\"><span class=\"legend-dot malware-dot\"></span> Malware</span>\n                                <span class=\"legend-item\"><span class=\"legend-dot suspicious-dot\"></span> Suspicious</span>\n                                <span class=\"legend-item\"><span class=\"legend-dot benign-dot\"></span> Benign</span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Geographic Context Panel -->\n                    <div class=\"geo-context-panel\" id=\"geoContext\">\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Active Regions:</span>\n                            <span class=\"context-value\" id=\"activeRegions\">0</span>\n                        </div>\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Hotspot:</span>\n                            <span class=\"context-value\" id=\"topRegion\">None</span>\n                        </div>\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Total Threats:</span>\n                            <span class=\"context-value threat-count\" id=\"geoThreatCount\">0</span>\n                        </div>\n                    </div>\n                    \n                    <div id=\"worldMap\" style=\"height: 500px; border-radius: 8px; margin-bottom: 15px;\"></div>\n                    \n                    <!-- Timeline Control -->\n                    <div class=\"map-timeline-control\">\n                        <button class=\"timeline-btn\" onclick=\"replayThreats()\" id=\"replayBtn\">\n                            <i class=\"fas fa-play\"></i> Replay Last 24h\n                        </button>\n                        <div class=\"timeline-info\" id=\"timelineInfo\">\n                            Click replay to see threat propagation over time\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Malware Source Distribution -->\n                <div class=\"chart-container analytics-panel panel-small\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-pie\"></i> Malware Source Distribution</h2>\n                    </div>\n                    <div style=\"max-width: 500px; margin: 0 auto;\">\n                        <canvas id=\"malwareSourceChart\"></canvas>\n                    </div>\n                </div>\n\n                <!-- Graph 2: \"Noisiest\" Agents Over Time -->\n                <div class=\"chart-container analytics-panel panel-large\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-desktop\"></i> \"Noisiest\" Agents Over Time</h2>\n                        <p class=\"chart-subtitle\">Threat detection trends for top 5 high-risk agents</p>\n                    </div>\n                    <div style=\"height: 300px;\">\n                        <canvas id=\"noisyAgentsChart\"></canvas>\n                    </div>\n                </div>\n\n                <!-- Advanced Analytics Grid -->\n                <div class=\"analytics-panel panel-large advanced-analytics-grid\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-area\"></i> Advanced Statistical Analysis</h2>\n                        <p class=\"chart-subtitle\">Deep dive into signature verification, packer usage, AI confidence, and entropy patterns</p>\n                    </div>\n                    \n                    <div class=\"mini-charts-grid\">\n                        <!-- Graph 3: Signature Status vs. Classification -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-certificate\"></i> Signature vs. Classification</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"signatureClassChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 4: Packer Usage vs. Classification -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-box\"></i> Packer vs. Classification</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"packerClassChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 5: Confidence Score Distribution -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-brain\"></i> AI Confidence Distribution</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"confidenceHistChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 6: File Entropy Distribution -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-chart-bar\"></i> Entropy Distribution</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"entropyBoxChart\"></canvas>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Threat Vector Correlation Explorer -->\n                <div class=\"correlation-container analytics-panel panel-large\">\n                    <div class=\"correlation-header\">\n                        <h2><i class=\"fas fa-project-diagram\"></i> Threat Vector Correlation Explorer</h2>\n                        <p class=\"correlation-subtitle\">Interactive intelligence map showing relationships between malware families, agents, APIs, and indicators</p>\n                    </div>\n                    <div class=\"graph-controls\">\n                        <button class=\"graph-btn\" onclick=\"resetGraph()\"><i class=\"fas fa-sync\"></i> Reset View</button>\n                        <button class=\"graph-btn\" onclick=\"centerGraph()\"><i class=\"fas fa-compress\"></i> Center</button>\n                        <div class=\"graph-legend\">\n                            <span class=\"legend-item\"><span class=\"node-sample malware-node\"></span> Malware Family</span>\n                            <span class=\"legend-item\"><span class=\"node-sample agent-node\"></span> Agent/System</span>\n                            <span class=\"legend-item\"><span class=\"node-sample api-node\"></span> API Call</span>\n                            <span class=\"legend-item\"><span class=\"node-sample string-node\"></span> Suspicious String</span>\n                        </div>\n                    </div>\n                    <div id=\"correlationGraph\"></div>\n                    <div id=\"nodeDetails\" class=\"node-details\" style=\"display: none;\">\n                        <h3 id=\"detailsTitle\"></h3>\n                        <div id=\"detailsContent\"></div>\n                    </div>\n                </div>\n\n                <!-- Emerging Threat Intelligence Panel -->\n                <div class=\"eti-container analytics-panel panel-large\">\n                    <div class=\"eti-header\">\n                        <h2><i class=\"fas fa-exclamation-triangle\"></i> Emerging Threat Intelligence (ETI)</h2>\n                        <p class=\"eti-subtitle\">Real-time actionable intelligence on active threats and indicators of compromise</p>\n                        <div class=\"eti-summary\">\n                            <span class=\"eti-badge\" id=\"eti-total\">0 Total Threats</span>\n                            <span class=\"eti-badge recent\" id=\"eti-recent\">0 Last 24h</span>\n                        </div>\n                    </div>\n                    \n                    <div class=\"eti-grid\">\n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-virus\"></i> Top Malware Families</h3>\n                            <div class=\"eti-subtitle-small\">Most active malware families detected</div>\n                            <div id=\"eti-malware\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-code\"></i> Top Suspicious APIs</h3>\n                            <div class=\"eti-subtitle-small\">Most frequently called malicious APIs</div>\n                            <div id=\"eti-apis\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-terminal\"></i> Top Malicious Strings</h3>\n                            <div class=\"eti-subtitle-small\">Most common IOC strings and commands</div>\n                            <div id=\"eti-strings\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-shield-alt\"></i> Top Packers/Obfuscators</h3>\n                            <div class=\"eti-subtitle-small\">Most used evasion techniques</div>\n                            <div id=\"eti-packers\" class=\"eti-list\"></div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Predictive Threat Modeler -->\n                <div class=\"modeler-container analytics-panel panel-large\">\n                    <div class=\"modeler-header\">\n                        <h2><i class=\"fas fa-flask\"></i> Predictive Threat Modeler</h2>\n                        <p class=\"modeler-subtitle\">Build hypothetical malware and predict how mAIware would classify it</p>\n                    </div>\n                    \n                    <div class=\"modeler-grid\">\n                <div class=\"modeler-builder\">\n                    <h3><i class=\"fas fa-cogs\"></i> Threat Configuration</h3>\n                    \n                    <div class=\"modeler-field\">\n                        <label>File Type</label>\n                        <select id=\"model-filetype\" class=\"modeler-select\">\n                            <option>PE32+ (GUI) x86-64</option>\n                            <option>PE32 (Console) Intel 80386</option>\n                            <option>PE32+ DLL x86-64</option>\n                            <option>MSI Installer</option>\n                            <option>PDF Document</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Packer/Obfuscator</label>\n                        <select id=\"model-packer\" class=\"modeler-select\">\n                            <option>None</option>\n                            <option>UPX</option>\n                            <option>VMProtect</option>\n                            <option>Themida</option>\n                            <option>ASPack</option>\n                            <option>Unknown (High Entropy)</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Digital Signature</label>\n                        <select id=\"model-signature\" class=\"modeler-select\">\n                            <option>Verified (Microsoft Corporation)</option>\n                            <option>Verified (Google LLC)</option>\n                            <option>Verified (Unknown Publisher)</option>\n                            <option>Not Signed</option>\n                            <option>Expired Certificate</option>\n                            <option>Self-Signed (Untrusted)</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>API Imports (select multiple)</label>\n                        <select id=\"model-apis\" class=\"modeler-select\" multiple size=\"6\">\n                            <option>CreateRemoteThread</option>\n                            <option>WriteProcessMemory</option>\n                            <option>VirtualAllocEx</option>\n                            <option>SetWindowsHookExW</option>\n                            <option>URLDownloadToFileW</option>\n                            <option>WinExec</option>\n                            <option>RegSetValueExW</option>\n                            <option>CryptEncrypt</option>\n                            <option>Socket</option>\n                            <option>ReadFile</option>\n                        </select>\n                        <small class=\"modeler-hint\">Hold Ctrl/Cmd to select multiple</small>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Suspicious Strings (select multiple)</label>\n                        <select id=\"model-strings\" class=\"modeler-select\" multiple size=\"6\">\n                            <option>http://bad-c2-server.com/payload.dat</option>\n                            <option>keylog.txt</option>\n                            <option>steal_passwords</option>\n                            <option>powershell -enc</option>\n                            <option>vssadmin.exe delete shadows</option>\n                            <option>HOW_TO_DECRYPT.txt</option>\n                            <option>crack</option>\n                            <option>patch</option>\n                            <option>disable_antivirus</option>\n                        </select>\n                        <small class=\"modeler-hint\">Hold Ctrl/Cmd to select multiple</small>\n                    </div>\n                    \n                    <button class=\"modeler-analyze-btn\" onclick=\"analyzeThreatModel()\">\n                        <i class=\"fas fa-brain\"></i> ANALYZE THREAT\n                    </button>\n                </div>\n                \n                <div class=\"modeler-results\">\n                    <h3><i class=\"fas fa-chart-line\"></i> Prediction Results</h3>\n                    <div id=\"modeler-output\" class=\"modeler-output\">\n                        <div class=\"modeler-placeholder\">\n                            <i class=\"fas fa-arrow-left\"></i>\n                            <p>Configure a threat profile and click ANALYZE to see predictions</p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n            </div>\n        </div>\n    </div>\n    \n    <script>\n        // Helper function to get CSS variable values dynamically for theming\n        function getCSSVar(varName) {\n            return getComputedStyle(document.documentElement).getPropertyValue(varName).trim();\n        }\n\n        // Back to Top Button\n        const backToTopBtn = document.getElementById('backToTop');\n        \n        window.addEventListener('scroll', () => {\n            if (window.pageYOffset > 300) {\n                backToTopBtn.classList.add('visible');\n            } else {\n                backToTopBtn.classList.remove('visible');\n            }\n        });\n\n        function scrollToTop() {\n            window.scrollTo({\n                top: 0,\n                behavior: 'smooth'\n            });\n        }\n\n        // View Switching System\n        function switchView(viewName) {\n            const views = document.querySelectorAll('.view-container');\n            \n            views.forEach(view => {\n                view.classList.remove('active');\n                if (view.id === `${viewName}View`) {\n                    view.classList.add('active');\n                }\n            });\n            \n            currentView = viewName;\n            \n            // Fix map display when switching to analytics view\n            if (viewName === 'analytics') {\n                loadAnalytics(); // Lazy load analytics components\n                setTimeout(() => {\n                    if (worldMap) {\n                        worldMap.invalidateSize();\n                    }\n                    // Capture screenshot for preview after charts has rendered\n                    setTimeout(() => {\n                        createAnalyticsMiniview();\n                    }, 1500);\n                }, 100);\n            }\n            \n            // Close graphs preview when switching views\n            document.getElementById('graphsPreview').classList.remove('show');\n            document.getElementById('previewBackdrop').classList.remove('show');\n        }\n        \n        // Side Panel Hover System\n        const sidePanel = document.getElementById('sidePanel');\n        const graphsPreview = document.getElementById('graphsPreview');\n        const previewBackdrop = document.getElementById('previewBackdrop');\n        const homeNavBtn = document.getElementById('homeNavBtn');\n        let previewTimeout;\n        let previewsRendered = false;\n        let currentView = 'dashboard';\n        \n        // Show preview panel on sidebar hover\n        sidePanel.addEventListener('mouseenter', () => {\n            clearTimeout(previewTimeout);\n            previewTimeout = setTimeout(() => {\n                graphsPreview.classList.add('show');\n                previewBackdrop.classList.add('show');\n                \n                // Show/hide home button based on current view\n                if (currentView === 'analytics') {\n                    homeNavBtn.classList.add('visible');\n                } else {\n                    homeNavBtn.classList.remove('visible');\n                }\n            }, 200);\n        });\n        \n        sidePanel.addEventListener('mouseleave', () => {\n            clearTimeout(previewTimeout);\n            setTimeout(() => {\n                if (!graphsPreview.matches(':hover')) {\n                    graphsPreview.classList.remove('show');\n                    previewBackdrop.classList.remove('show');\n                }\n            }, 100);\n        });\n        \n        // Keep preview open when hovering over it\n        graphsPreview.addEventListener('mouseleave', () => {\n            graphsPreview.classList.remove('show');\n            previewBackdrop.classList.remove('show');\n        });\n        \n        // Close preview when clicking backdrop\n        previewBackdrop.addEventListener('click', () => {\n            graphsPreview.classList.remove('show');\n            previewBackdrop.classList.remove('show');\n        });\n        \n        // Create analytics miniview by taking a screenshot\n        let isCapturingSnapshot = false;\n        let hasInitialSnapshot = false;\n        \n        async function createAnalyticsMiniview() {\n            // Simplified - no actual screenshot, just a visual preview\n            hasInitialSnapshot = true;\n        }\n        \n        // Auto-scroll on hover down in analytics view\n        let scrollInterval;\n        const analyticsGrid = document.getElementById('analyticsGrid');\n        \n        if (analyticsGrid) {\n            analyticsGrid.addEventListener('mousemove', (e) => {\n                const rect = analyticsGrid.getBoundingClientRect();\n                const mouseY = e.clientY - rect.top;\n                const triggerZone = 100; // pixels from bottom\n                \n                if (rect.height - mouseY < triggerZone) {\n                    if (!scrollInterval) {\n                        scrollInterval = setInterval(() => {\n                            analyticsGrid.scrollBy({ top: 2, behavior: 'smooth' });\n                        }, 16);\n                    }\n                } else {\n                    if (scrollInterval) {\n                        clearInterval(scrollInterval);\n                        scrollInterval = null;\n                    }\n                }\n            });\n            \n            analyticsGrid.addEventListener('mouseleave', () => {\n                if (scrollInterval) {\n                    clearInterval(scrollInterval);\n                    scrollInterval = null;\n                }\n            });\n        }\n        \n        // Theme Toggle\n        window.toggleTheme = function() {\n            const html = document.documentElement;\n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            const currentTheme = html.getAttribute('data-theme');\n            \n            if (currentTheme === 'light') {\n                html.setAttribute('data-theme', '');\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n                localStorage.setItem('theme', 'dark');\n            } else {\n                html.setAttribute('data-theme', 'light');\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n                localStorage.setItem('theme', 'light');\n            }\n        };\n        \n        // Load saved theme\n        const savedTheme = localStorage.getItem('theme');\n        if (savedTheme === 'light') {\n            document.documentElement.setAttribute('data-theme', 'light');\n            document.getElementById('themeIcon').textContent = '‚òÄÔ∏è';\n            document.getElementById('themeText').textContent = 'Light';\n        }\n        \n        let dailyChart = null;\n        let currentChartDays = 30;\n        \n        // Notification and Animation System\n        const notificationQueue = [];\n        let isShowingNotification = false;\n        \n        function showThreatNotification(scan) {\n            const container = document.getElementById('notification-container');\n            \n            const classColor = \n                scan.classification === 'Malware' ? '#ff4757' :\n                scan.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n            \n            const icon = \n                scan.classification === 'Malware' ? 'fa-skull-crossbones' :\n                scan.classification === 'Suspicious' ? 'fa-exclamation-triangle' : 'fa-check-circle';\n            \n            const notification = document.createElement('div');\n            notification.className = 'threat-notification';\n            notification.style.borderLeftColor = classColor;\n            notification.innerHTML = `\n                <div class=\"notification-icon\" style=\"color: ${classColor};\">\n                    <i class=\"fas ${icon}\"></i>\n                </div>\n                <div class=\"notification-content\">\n                    <div class=\"notification-title\">\n                        <strong>${scan.classification}</strong> detected\n                    </div>\n                    <div class=\"notification-details\">\n                        ${scan.detected_filename}\n                        ${scan.malware_family ? ` - ${scan.malware_family}` : ''}\n                    </div>\n                    <div class=\"notification-meta\">\n                        <i class=\"fas fa-desktop\"></i> ${scan.systemInfo?.hostname || scan.clientIp || 'Unknown'}\n                    </div>\n                </div>\n                <div class=\"notification-close\" onclick=\"this.parentElement.remove()\">\n                    <i class=\"fas fa-times\"></i>\n                </div>\n            `;\n            \n            container.appendChild(notification);\n            \n            // Animate in\n            setTimeout(() => notification.classList.add('show'), 10);\n            \n            // Auto-remove after 8 seconds\n            setTimeout(() => {\n                notification.classList.remove('show');\n                setTimeout(() => notification.remove(), 300);\n            }, 8000);\n        }\n        \n        function addToThreatTicker(scan) {\n            const ticker = document.getElementById('ticker-content');\n            const timestamp = new Date(scan.serverTimestamp).toLocaleTimeString();\n            \n            const classColor = \n                scan.classification === 'Malware' ? '#ff4757' :\n                scan.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n            \n            const tickerItem = document.createElement('span');\n            tickerItem.className = 'ticker-item';\n            tickerItem.style.color = classColor;\n            tickerItem.innerHTML = `\n                <i class=\"fas fa-circle\"></i>\n                [${timestamp}] ${scan.classification}: ${scan.detected_filename}\n                ${scan.malware_family ? `(${scan.malware_family})` : ''}\n                on ${scan.systemInfo?.hostname || scan.clientIp || 'Unknown'}\n            `;\n            \n            ticker.appendChild(tickerItem);\n            \n            // Keep only last 10 items\n            while (ticker.children.length > 10) {\n                ticker.removeChild(ticker.firstChild);\n            }\n        }\n        \n        function animateStatCard(elementId, newValue) {\n            const element = document.getElementById(elementId);\n            if (!element) return;\n            \n            const currentValue = parseInt(element.textContent) || 0;\n            if (newValue > currentValue) {\n                // Pulse animation\n                element.parentElement.classList.add('stat-pulse');\n                setTimeout(() => element.parentElement.classList.remove('stat-pulse'), 600);\n                \n                // Animate number increment\n                const duration = 500;\n                const steps = 20;\n                const increment = (newValue - currentValue) / steps;\n                let current = currentValue;\n                let step = 0;\n                \n                const interval = setInterval(() => {\n                    step++;\n                    current += increment;\n                    element.textContent = Math.round(current);\n                    \n                    if (step >= steps) {\n                        element.textContent = newValue;\n                        clearInterval(interval);\n                    }\n                }, duration / steps);\n            } else {\n                element.textContent = newValue;\n            }\n        }\n        \n        async function loadStats() {\n            try {\n                const response = await fetch('/api/stats');\n                const stats = await response.json();\n                \n                animateStatCard('stat-clients', stats.activeClients);\n                animateStatCard('stat-total', stats.totalScans);\n                animateStatCard('stat-malware', stats.malwareCount);\n                animateStatCard('stat-suspicious', stats.suspiciousCount);\n                animateStatCard('stat-benign', stats.benignCount);\n            } catch (error) {\n                console.error('Failed to load stats:', error);\n            }\n        }\n        \n        async function loadScans() {\n            try {\n                const response = await fetch('/api/scans?limit=50');\n                const data = await response.json();\n                \n                const tbody = document.getElementById('scans-tbody');\n                \n                if (data.scans.length === 0) {\n                    tbody.innerHTML = `\n                        <tr>\n                            <td colspan=\"5\" class=\"empty-state\">\n                                <i class=\"fas fa-inbox\"></i>\n                                <p>No scans yet. Waiting for clients...</p>\n                            </td>\n                        </tr>\n                    `;\n                    return;\n                }\n                \n                tbody.innerHTML = data.scans.map(scan => {\n                    const timestamp = new Date(scan.serverTimestamp).toLocaleString();\n                    const hash = scan.file_hashes?.sha256 || 'N/A';\n                    const hashShort = hash.length > 16 ? (hash.substring(0, 16) + '...') : hash;\n                    const isNonPe = scan.is_pe === false;\n                    const classification = isNonPe ? 'Non-PE' : (scan.classification || 'Unknown');\n                    const badgeClass = isNonPe ? 'non-pe' : classification.toLowerCase();\n                    const nonPeTag = isNonPe ? '<span class=\"badge non-pe\" title=\"Non-PE file\">Non-PE</span>' : '';\n                    return `\n                        <tr>\n                            <td>${timestamp}</td>\n                            <td>${scan.detected_filename} ${nonPeTag}</td>\n                            <td><span class=\"badge ${badgeClass}\">${classification}</span></td>\n                            <td>${scan.systemInfo?.ip || scan.clientIp || 'Unknown'}</td>\n                            <td class=\"hash\" title=\"${hash}\">${hashShort}</td>\n                        </tr>\n                    `;\n                }).join('');\n                \n            } catch (error) {\n                console.error('Failed to load scans:', error);\n            }\n        }\n        \n        async function loadDailyChart() {\n            try {\n                const response = await fetch(`/api/daily-scans?days=${currentChartDays}`);\n                const data = await response.json();\n                \n                const ctx = document.getElementById('dailyScansChart');\n                \n                // Format dates for display (MM/DD)\n                const labels = data.days.map(day => {\n                    const date = new Date(day.date);\n                    return `${date.getMonth() + 1}/${date.getDate()}`;\n                });\n                \n                // Reuse existing chart if it exists\n                if (dailyChart) {\n                    dailyChart.data.labels = labels;\n                    dailyChart.data.datasets[0].data = data.days.map(d => d.total);\n                    dailyChart.data.datasets[1].data = data.days.map(d => d.malware);\n                    dailyChart.data.datasets[2].data = data.days.map(d => d.suspicious);\n                    dailyChart.data.datasets[3].data = data.days.map(d => d.benign);\n                    dailyChart.update('none'); // Update without animation\n                    return;\n                }\n                \n                dailyChart = new Chart(ctx, {\n                    type: 'line',\n                    data: {\n                        labels: labels,\n                        datasets: [\n                            {\n                                label: 'Total Scans',\n                                data: data.days.map(d => d.total),\n                                borderColor: '#5a9cf8',\n                                backgroundColor: 'rgba(90, 156, 248, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Malware',\n                                data: data.days.map(d => d.malware),\n                                borderColor: '#ff4757',\n                                backgroundColor: 'rgba(255, 71, 87, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Suspicious',\n                                data: data.days.map(d => d.suspicious),\n                                borderColor: '#ffa502',\n                                backgroundColor: 'rgba(255, 165, 2, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Benign',\n                                data: data.days.map(d => d.benign),\n                                borderColor: '#26de81',\n                                backgroundColor: 'rgba(38, 222, 129, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        interaction: {\n                            mode: 'index',\n                            intersect: false,\n                        },\n                        plugins: {\n                            legend: {\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 12 }\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0',\n                                borderColor: 'rgba(255, 255, 255, 0.1)',\n                                borderWidth: 1\n                            }\n                        },\n                        scales: {\n                            x: {\n                                ticks: { \n                                    color: getCSSVar('--chart-text-color') || '#888',\n                                    maxRotation: 45,\n                                    minRotation: 45\n                                },\n                                grid: { \n                                    color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' \n                                }\n                            },\n                            y: {\n                                beginAtZero: true,\n                                ticks: { \n                                    color: getCSSVar('--chart-text-color') || '#888',\n                                    stepSize: 1\n                                },\n                                grid: { \n                                    color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' \n                                }\n                            }\n                        }\n                    }\n                });\n                \n            } catch (error) {\n                console.error('Failed to load daily chart:', error);\n            }\n        }\n        \n        let worldMap = null;\n        let markerLayer = null;\n        let heatmapLayer = null;\n        let choroplethLayer = null;\n        let mapInitialized = false;\n        let lastGeoDataHash = '';\n        let sourceChart = null;\n        let currentMapView = 'markers';\n        let geoDataCache = null;\n        let replayInterval = null;\n        \n        // Country boundaries for choropleth (simplified)\n        const countryCoordinates = {\n            'United States': { center: [37.0902, -95.7129], weight: 0 },\n            'China': { center: [35.8617, 104.1954], weight: 0 },\n            'United Kingdom': { center: [55.3781, -3.4360], weight: 0 },\n            'Germany': { center: [51.1657, 10.4515], weight: 0 },\n            'France': { center: [46.2276, 2.2137], weight: 0 },\n            'Russia': { center: [61.5240, 105.3188], weight: 0 },\n            'Japan': { center: [36.2048, 138.2529], weight: 0 },\n            'India': { center: [20.5937, 78.9629], weight: 0 },\n            'Brazil': { center: [-14.2350, -51.9253], weight: 0 },\n            'Australia': { center: [-25.2744, 133.7751], weight: 0 }\n        };\n        \n        function initializeMap() {\n            if (mapInitialized) return;\n            \n            try {\n                worldMap = L.map('worldMap', {\n                    zoomControl: true,\n                    scrollWheelZoom: true,\n                    preferCanvas: false,\n                    worldCopyJump: true\n                }).setView([20, 0], 2);\n                \n                // Use dark theme tiles\n                L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {\n                    attribution: '&copy; OpenStreetMap contributors',\n                    subdomains: 'abcd',\n                    maxZoom: 18,\n                    minZoom: 1,\n                    noWrap: false,\n                    bounds: [[-90, -180], [90, 180]]\n                }).addTo(worldMap);\n                \n                markerLayer = L.layerGroup().addTo(worldMap);\n                mapInitialized = true;\n                \n                // Fix map display after initialization\n                setTimeout(() => {\n                    if (worldMap) worldMap.invalidateSize();\n                }, 100);\n            } catch (error) {\n                console.error('Failed to initialize map:', error);\n            }\n        }\n        \n        // Switch between map visualization modes\n        window.switchMapView = function(view) {\n            currentMapView = view;\n            \n            // Update button states\n            document.querySelectorAll('.map-btn').forEach(btn => {\n                btn.classList.remove('active');\n            });\n            document.querySelector(`[data-view=\"${view}\"]`).classList.add('active');\n            \n            // Reload map with new view\n            if (geoDataCache) {\n                renderMapView(geoDataCache);\n            }\n        };\n        \n        // Render different map views\n        function renderMapView(data) {\n            if (!worldMap) return;\n            \n            // Clear all layers\n            if (markerLayer) markerLayer.clearLayers();\n            if (heatmapLayer) {\n                worldMap.removeLayer(heatmapLayer);\n                heatmapLayer = null;\n            }\n            if (choroplethLayer) {\n                worldMap.removeLayer(choroplethLayer);\n                choroplethLayer = null;\n            }\n            \n            switch (currentMapView) {\n                case 'markers':\n                    renderMarkers(data);\n                    break;\n                case 'heatmap':\n                    renderHeatmap(data);\n                    break;\n                case 'choropleth':\n                    renderChoropleth(data);\n                    break;\n            }\n            \n            updateGeoContext(data);\n        }\n        \n        // Render traditional markers\n        function renderMarkers(data) {\n            data.locations.forEach(location => {\n                const { lat, lng, city, country } = location.location;\n                \n                let markerColor = '#26de81'; // benign\n                if (location.malwareCount > 0) {\n                    markerColor = '#ff3b3b'; // malware\n                } else if (location.suspiciousCount > 0) {\n                    markerColor = '#ffd700'; // suspicious\n                }\n                \n                const markerSize = Math.min(24, Math.max(8, 8 + location.totalScans * 2));\n                \n                const marker = L.circleMarker([lat, lng], {\n                    radius: markerSize / 2,\n                    fillColor: markerColor,\n                    color: '#fff',\n                    weight: 2,\n                    opacity: 0.8,\n                    fillOpacity: 0.6\n                });\n                \n                const popupContent = `\n                    <div style=\"color: var(--text-primary); min-width: 200px;\">\n                        <h3 style=\"margin: 0 0 10px 0; color: var(--accent-green); font-size: 1.1rem;\">\n                            <i class=\"fas fa-map-marker-alt\" style=\"color: ${markerColor};\"></i>\n                            ${city}, ${country}\n                        </h3>\n                        <p style=\"margin: 5px 0;\"><strong>IP:</strong> ${location.ip}</p>\n                        <p style=\"margin: 5px 0;\"><strong>Total Scans:</strong> ${location.totalScans}</p>\n                        <div style=\"margin-top: 10px;\">\n                            <div><span style=\"color: #ff3b3b;\">‚óè</span> Malware: ${location.malwareCount}</div>\n                            <div><span style=\"color: #ffd700;\">‚óè</span> Suspicious: ${location.suspiciousCount}</div>\n                            <div><span style=\"color: #39ff14;\">‚óè</span> Benign: ${location.benignCount}</div>\n                        </div>\n                        <button onclick=\"filterByLocation('${country}')\" \n                                style=\"margin-top: 10px; padding: 5px 10px; background: var(--accent-green); \n                                       color: var(--bg-primary); border: none; border-radius: 5px; cursor: pointer;\">\n                            Filter by ${country}\n                        </button>\n                    </div>\n                `;\n                \n                marker.bindPopup(popupContent);\n                marker.addTo(markerLayer);\n                \n                marker.on('mouseover', function() {\n                    this.setStyle({ fillOpacity: 0.9, opacity: 1 });\n                });\n                marker.on('mouseout', function() {\n                    this.setStyle({ fillOpacity: 0.6, opacity: 0.8 });\n                });\n            });\n        }\n        \n        // Render heatmap overlay\n        function renderHeatmap(data) {\n            const heatData = [];\n            \n            data.locations.forEach(location => {\n                const { lat, lng } = location.location;\n                // Weight by threat severity: malware = 1.0, suspicious = 0.5, benign = 0.2\n                const weight = (location.malwareCount * 1.0 + \n                               location.suspiciousCount * 0.5 + \n                               location.benignCount * 0.2) / location.totalScans;\n                \n                // Add multiple points for higher intensity\n                const intensity = Math.ceil(location.totalScans * weight);\n                for (let i = 0; i < intensity; i++) {\n                    heatData.push([lat, lng, weight]);\n                }\n            });\n            \n            heatmapLayer = L.heatLayer(heatData, {\n                radius: 35,\n                blur: 25,\n                maxZoom: 10,\n                max: 1.0,\n                gradient: {\n                    0.0: '#39ff14',  // Green (low threat)\n                    0.3: '#ffd700',  // Yellow\n                    0.6: '#ffa502',  // Orange\n                    0.8: '#ff6348',  // Red\n                    1.0: '#ff3b3b'   // Bright red (high threat)\n                }\n            }).addTo(worldMap);\n        }\n        \n        // Render choropleth (country-level threat shading)\n        function renderChoropleth(data) {\n            // Aggregate threats by country\n            const countryStats = {};\n            data.locations.forEach(location => {\n                const country = location.location.country;\n                if (!countryStats[country]) {\n                    countryStats[country] = { total: 0, malware: 0, suspicious: 0 };\n                }\n                countryStats[country].total += location.totalScans;\n                countryStats[country].malware += location.malwareCount;\n                countryStats[country].suspicious += location.suspiciousCount;\n            });\n            \n            // Find max for normalization\n            const maxThreats = Math.max(...Object.values(countryStats).map(s => \n                s.malware + s.suspicious * 0.5\n            ));\n            \n            // Draw circles for countries with threat data\n            choroplethLayer = L.layerGroup();\n            \n            Object.entries(countryStats).forEach(([country, stats]) => {\n                if (countryCoordinates[country]) {\n                    const threatScore = (stats.malware + stats.suspicious * 0.5) / maxThreats;\n                    \n                    // Color gradient from green to red\n                    let color;\n                    if (threatScore < 0.2) color = '#39ff14';\n                    else if (threatScore < 0.4) color = '#ffd700';\n                    else if (threatScore < 0.6) color = '#ffa502';\n                    else if (threatScore < 0.8) color = '#ff6348';\n                    else color = '#ff3b3b';\n                    \n                    const circle = L.circle(countryCoordinates[country].center, {\n                        color: color,\n                        fillColor: color,\n                        fillOpacity: 0.4,\n                        radius: 500000 * (1 + threatScore * 2),\n                        weight: 2\n                    });\n                    \n                    circle.bindPopup(`\n                        <div style=\"color: var(--text-primary);\">\n                            <h3 style=\"color: var(--accent-green);\">${country}</h3>\n                            <p><strong>Total Threats:</strong> ${stats.total}</p>\n                            <p><strong>Malware:</strong> ${stats.malware}</p>\n                            <p><strong>Suspicious:</strong> ${stats.suspicious}</p>\n                            <p><strong>Threat Level:</strong> ${(threatScore * 100).toFixed(0)}%</p>\n                        </div>\n                    `);\n                    \n                    circle.addTo(choroplethLayer);\n                }\n            });\n            \n            choroplethLayer.addTo(worldMap);\n        }\n        \n        // Update geographic context panel\n        function updateGeoContext(data) {\n            const countries = new Set(data.locations.map(l => l.location.country));\n            document.getElementById('activeRegions').textContent = countries.size;\n            \n            // Find hotspot (country with most threats)\n            const countryThreats = {};\n            data.locations.forEach(loc => {\n                const country = loc.location.country;\n                countryThreats[country] = (countryThreats[country] || 0) + \n                    loc.malwareCount + loc.suspiciousCount;\n            });\n            \n            const hotspot = Object.entries(countryThreats)\n                .sort((a, b) => b[1] - a[1])[0];\n            \n            if (hotspot) {\n                const percentage = ((hotspot[1] / data.locations.reduce((sum, l) => \n                    sum + l.malwareCount + l.suspiciousCount, 0)) * 100).toFixed(0);\n                document.getElementById('topRegion').textContent = \n                    `${hotspot[0]} (${percentage}% of threats)`;\n            }\n            \n            const totalThreats = data.locations.reduce((sum, l) => \n                sum + l.malwareCount + l.suspiciousCount, 0);\n            document.getElementById('geoThreatCount').textContent = totalThreats;\n        }\n        \n        // Filter dashboard by geographic location\n        window.filterByLocation = function(country) {\n            console.log(`Filtering by country: ${country}`);\n            // This would filter the tables and charts - simplified for demo\n            alert(`Geographic filtering activated for ${country}.\\nIn full implementation, this would filter all dashboard data.`);\n        };\n        \n        // Replay threats over last 24 hours\n        window.replayThreats = async function() {\n            const btn = document.getElementById('replayBtn');\n            const info = document.getElementById('timelineInfo');\n            \n            if (replayInterval) {\n                clearInterval(replayInterval);\n                replayInterval = null;\n                btn.innerHTML = '<i class=\"fas fa-play\"></i> Replay Last 24h';\n                info.textContent = 'Replay stopped';\n                if (geoDataCache) renderMapView(geoDataCache);\n                return;\n            }\n            \n            if (!geoDataCache || geoDataCache.locations.length === 0) {\n                info.textContent = 'No data available for replay';\n                return;\n            }\n            \n            btn.innerHTML = '<i class=\"fas fa-stop\"></i> Stop Replay';\n            info.textContent = 'Replaying threat detection timeline...';\n            \n            // Sort locations by timestamp\n            const sortedLocations = [...geoDataCache.locations].sort((a, b) => {\n                const timeA = a.scans[0]?.timestamp || 0;\n                const timeB = b.scans[0]?.timestamp || 0;\n                return new Date(timeA) - new Date(timeB);\n            });\n            \n            if (markerLayer) markerLayer.clearLayers();\n            let index = 0;\n            \n            replayInterval = setInterval(() => {\n                if (index >= sortedLocations.length) {\n                    clearInterval(replayInterval);\n                    replayInterval = null;\n                    btn.innerHTML = '<i class=\"fas fa-play\"></i> Replay Last 24h';\n                    info.textContent = 'Replay complete';\n                    return;\n                }\n                \n                const location = sortedLocations[index];\n                const { lat, lng, city, country } = location.location;\n                \n                let markerColor = location.malwareCount > 0 ? '#ff3b3b' : \n                                 location.suspiciousCount > 0 ? '#ffd700' : '#39ff14';\n                \n                // Animated marker appearance\n                const marker = L.circleMarker([lat, lng], {\n                    radius: 0,\n                    fillColor: markerColor,\n                    color: '#fff',\n                    weight: 2,\n                    opacity: 1,\n                    fillOpacity: 0.8\n                }).addTo(markerLayer);\n                \n                // Animate marker growth\n                let size = 0;\n                const growInterval = setInterval(() => {\n                    size += 2;\n                    if (size >= 12) {\n                        clearInterval(growInterval);\n                        marker.setStyle({ opacity: 0.8, fillOpacity: 0.6 });\n                    }\n                    marker.setRadius(size / 2);\n                }, 50);\n                \n                marker.bindPopup(`\n                    <div style=\"color: var(--text-primary);\">\n                        <strong>${city}, ${country}</strong><br>\n                        ${location.scans[0]?.filename || 'Unknown file'}\n                    </div>\n                `);\n                \n                info.textContent = `Replaying: ${index + 1}/${sortedLocations.length} - ${city}, ${country}`;\n                index++;\n            }, 800); // Show new threat every 800ms\n        };\n        \n        async function loadGeoMap() {\n            try {\n                // Initialize map only once\n                if (!mapInitialized) {\n                    initializeMap();\n                }\n                \n                if (!worldMap) return;\n                \n                const response = await fetch('/api/geo-data');\n                const data = await response.json();\n                \n                // Generate hash of current data to detect changes\n                const currentHash = JSON.stringify(data.locations.map(l => \n                    `${l.ip}-${l.totalScans}-${l.malwareCount}-${l.suspiciousCount}`\n                )).substring(0, 100);\n                \n                // Skip update if data hasn't changed\n                if (currentHash === lastGeoDataHash && markerLayer && markerLayer.getLayers().length > 0) {\n                    return;\n                }\n                lastGeoDataHash = currentHash;\n                \n                // Cache data for replay and other features\n                geoDataCache = data;\n                \n                // Render current view\n                renderMapView(data);\n                \n                console.log(`Map updated with ${data.locations.length} locations in ${currentMapView} mode`);\n                \n            } catch (error) {\n                console.error('Failed to load geo map:', error);\n            }\n        }\n        \n        async function loadMalwareSources() {\n            try {\n                const response = await fetch('/api/malware-sources');\n                const data = await response.json();\n                \n                const ctx = document.getElementById('malwareSourceChart');\n                \n                const labels = data.sources.map(s => s.source);\n                const counts = data.sources.map(s => s.count);\n                \n                // Color scheme for different sources\n                const colors = [\n                    '#ff6b6b', // Email Attachment - red\n                    '#4ecdc4', // Web Download - teal\n                    '#ffe66d', // USB/External Drive - yellow\n                    '#a8dadc', // Internal Network - light blue\n                    '#95a5a6'  // Unknown - gray\n                ];\n                \n                // Reuse existing chart if it exists\n                if (sourceChart) {\n                    sourceChart.data.labels = labels;\n                    sourceChart.data.datasets[0].data = counts;\n                    sourceChart.update('none');\n                    return;\n                }\n                \n                sourceChart = new Chart(ctx, {\n                    type: 'pie',\n                    data: {\n                        labels: labels,\n                        datasets: [{\n                            data: counts,\n                            backgroundColor: colors,\n                            borderColor: '#1a1a2e',\n                            borderWidth: 2\n                        }]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: true,\n                        plugins: {\n                            legend: {\n                                position: 'bottom',\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 12 },\n                                    padding: 15\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0',\n                                borderColor: 'rgba(255, 255, 255, 0.1)',\n                                borderWidth: 1,\n                                callbacks: {\n                                    label: function(context) {\n                                        const label = context.label || '';\n                                        const value = context.parsed || 0;\n                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);\n                                        const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : 0;\n                                        return `${label}: ${value} (${percentage}%)`;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                });\n                \n            } catch (error) {\n                console.error('Failed to load malware sources:', error);\n            }\n        }\n        \n        // Graph 2: \"Noisiest\" Agents Over Time\n        let noisyAgentsChart = null;\n        async function loadNoisyAgentsChart() {\n            try {\n                const response = await fetch('/api/noisy-agents');\n                const data = await response.json();\n                \n                console.log('Noisy agents data:', data);\n                \n                const ctx = document.getElementById('noisyAgentsChart');\n                if (!ctx) return;\n                \n                // Show message if no data\n                if (!data.agents || data.agents.length === 0) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 2rem; text-align: center; color: var(--text-secondary);\">No agent data available yet. Start scanning files to see trends.</div>';\n                    return;\n                }\n                \n                const colors = [\n                    '#ff3b3b', '#39ff14', '#ffd700', '#1e90ff', '#ff1493'\n                ];\n                \n                // Reuse existing chart if it exists\n                if (noisyAgentsChart) {\n                    noisyAgentsChart.data.labels = data.dates;\n                    noisyAgentsChart.data.datasets = data.agents.map((agent, idx) => ({\n                        label: agent.agentId,\n                        data: agent.counts,\n                        borderColor: colors[idx],\n                        backgroundColor: colors[idx] + '20',\n                        tension: 0.4,\n                        borderWidth: 2,\n                        fill: false\n                    }));\n                    noisyAgentsChart.update('none');\n                    return;\n                }\n                \n                noisyAgentsChart = new Chart(ctx, {\n                    type: 'line',\n                    data: {\n                        labels: data.dates,\n                        datasets: data.agents.map((agent, idx) => ({\n                            label: agent.agentId,\n                            data: agent.counts,\n                            borderColor: colors[idx],\n                            backgroundColor: colors[idx] + '20',\n                            tension: 0.4,\n                            borderWidth: 2,\n                            fill: false\n                        }))\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 11 }\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: getCSSVar('--chart-text-color') || '#888' },\n                                grid: { color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                ticks: { color: getCSSVar('--chart-text-color') || '#888' },\n                                grid: { color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load noisy agents chart:', error);\n                const ctx = document.getElementById('noisyAgentsChart');\n                if (ctx) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 2rem; text-align: center; color: var(--accent-red);\">Error loading chart data</div>';\n                }\n            }\n        }\n        \n        // Graph 3: Signature Status vs. Classification\n        let signatureClassChart = null;\n        async function loadSignatureClassChart() {\n            try {\n                const response = await fetch('/api/signature-classification');\n                const data = await response.json();\n                \n                console.log('Signature classification data:', data);\n                \n                const ctx = document.getElementById('signatureClassChart');\n                if (!ctx) {\n                    console.warn('signatureClassChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (signatureClassChart) {\n                    signatureClassChart.data.datasets[0].data = [data.benign.verified, data.suspicious.verified, data.malware.verified];\n                    signatureClassChart.data.datasets[1].data = [data.benign.unknown, data.suspicious.unknown, data.malware.unknown];\n                    signatureClassChart.data.datasets[2].data = [data.benign.untrusted, data.suspicious.untrusted, data.malware.untrusted];\n                    signatureClassChart.update('none');\n                    return;\n                }\n                \n                signatureClassChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: ['Benign', 'Suspicious', 'Malware'],\n                        datasets: [\n                            {\n                                label: 'Verified',\n                                data: [data.benign.verified, data.suspicious.verified, data.malware.verified],\n                                backgroundColor: '#39ff14',\n                                stack: 'stack0'\n                            },\n                            {\n                                label: 'Unknown',\n                                data: [data.benign.unknown, data.suspicious.unknown, data.malware.unknown],\n                                backgroundColor: '#ffd700',\n                                stack: 'stack0'\n                            },\n                            {\n                                label: 'Untrusted',\n                                data: [data.benign.untrusted, data.suspicious.untrusted, data.malware.untrusted],\n                                backgroundColor: '#ff3b3b',\n                                stack: 'stack0'\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                callbacks: {\n                                    label: function(context) {\n                                        const total = context.chart.data.datasets\n                                            .reduce((sum, ds) => sum + ds.data[context.dataIndex], 0);\n                                        const percentage = ((context.parsed.y / total) * 100).toFixed(1);\n                                        return `${context.dataset.label}: ${context.parsed.y} (${percentage}%)`;\n                                    }\n                                }\n                            }\n                        },\n                        scales: {\n                            y: {\n                                stacked: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                stacked: true,\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load signature classification chart:', error);\n                const ctx = document.getElementById('signatureClassChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 4: Packer Usage vs. Classification\n        let packerClassChart = null;\n        async function loadPackerClassChart() {\n            try {\n                const response = await fetch('/api/packer-classification');\n                const data = await response.json();\n                \n                console.log('Packer classification data:', data);\n                \n                const ctx = document.getElementById('packerClassChart');\n                if (!ctx) {\n                    console.warn('packerClassChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (packerClassChart) {\n                    packerClassChart.data.labels = data.packers;\n                    packerClassChart.data.datasets[0].data = data.benignCounts;\n                    packerClassChart.data.datasets[1].data = data.malwareCounts;\n                    packerClassChart.update('none');\n                    return;\n                }\n                \n                packerClassChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: data.packers,\n                        datasets: [\n                            {\n                                label: 'Benign Files',\n                                data: data.benignCounts,\n                                backgroundColor: '#39ff14'\n                            },\n                            {\n                                label: 'Malware Files',\n                                data: data.malwareCounts,\n                                backgroundColor: '#ff3b3b'\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load packer classification chart:', error);\n                const ctx = document.getElementById('packerClassChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 5: Confidence Score Histogram\n        let confidenceHistChart = null;\n        async function loadConfidenceHistChart() {\n            try {\n                const response = await fetch('/api/confidence-distribution');\n                const data = await response.json();\n                \n                console.log('Confidence distribution data:', data);\n                \n                const ctx = document.getElementById('confidenceHistChart');\n                if (!ctx) {\n                    console.warn('confidenceHistChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (confidenceHistChart) {\n                    confidenceHistChart.data.labels = data.bins;\n                    confidenceHistChart.data.datasets[0].data = data.counts;\n                    confidenceHistChart.update('none');\n                    return;\n                }\n                \n                confidenceHistChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: data.bins,\n                        datasets: [{\n                            label: 'Scan Count',\n                            data: data.counts,\n                            backgroundColor: '#39ff14',\n                            borderColor: '#2ed60f',\n                            borderWidth: 1\n                        }]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' },\n                                title: {\n                                    display: true,\n                                    text: 'Number of Scans',\n                                    color: '#888'\n                                }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false },\n                                title: {\n                                    display: true,\n                                    text: 'Confidence Score Range',\n                                    color: '#888'\n                                }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load confidence histogram:', error);\n                const ctx = document.getElementById('confidenceHistChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 6: File Entropy Distribution (Box Plot simulation)\n        let entropyBoxChart = null;\n        async function loadEntropyBoxChart() {\n            try {\n                const response = await fetch('/api/entropy-distribution');\n                const data = await response.json();\n                \n                console.log('Entropy distribution data:', data);\n                \n                const ctx = document.getElementById('entropyBoxChart');\n                if (!ctx) {\n                    console.warn('entropyBoxChart canvas not found');\n                    return;\n                }\n                \n                // Create violin/box plot effect with multiple bars\n                const benignData = [\n                    data.benign.min,\n                    data.benign.q1,\n                    data.benign.median,\n                    data.benign.q3,\n                    data.benign.max\n                ];\n                \n                const malwareData = [\n                    data.malware.min,\n                    data.malware.q1,\n                    data.malware.median,\n                    data.malware.q3,\n                    data.malware.max\n                ];\n                \n                // Reuse existing chart if it exists\n                if (entropyBoxChart) {\n                    entropyBoxChart.data.datasets[0].data = benignData;\n                    entropyBoxChart.data.datasets[1].data = malwareData;\n                    entropyBoxChart.update('none');\n                    return;\n                }\n                \n                entropyBoxChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: ['Min', 'Q1', 'Median', 'Q3', 'Max'],\n                        datasets: [\n                            {\n                                label: 'Benign Files',\n                                data: benignData,\n                                backgroundColor: '#39ff14',\n                                borderColor: '#2ed60f',\n                                borderWidth: 1\n                            },\n                            {\n                                label: 'Malware Files',\n                                data: malwareData,\n                                backgroundColor: '#ff3b3b',\n                                borderColor: '#cc2f2f',\n                                borderWidth: 1\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                callbacks: {\n                                    label: function(context) {\n                                        return `${context.dataset.label}: ${context.parsed.y.toFixed(3)}`;\n                                    }\n                                }\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                max: 8.0,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' },\n                                title: {\n                                    display: true,\n                                    text: 'Entropy Value',\n                                    color: '#888'\n                                }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load entropy distribution chart:', error);\n                const ctx = document.getElementById('entropyBoxChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        async function loadEmergingThreats() {\n            try {\n                const response = await fetch('/api/emerging-threats');\n                const data = await response.json();\n                \n                // Update summary badges\n                document.getElementById('eti-total').textContent = \n                    `${data.summary.totalThreats} Total Threats`;\n                document.getElementById('eti-recent').textContent = \n                    `${data.summary.recentThreats} Last 24h`;\n                \n                // Helper to render IOC list\n                const renderIOCList = (items, container) => {\n                    if (items.length === 0) {\n                        container.innerHTML = '<div class=\"eti-empty\">No threats detected</div>';\n                        return;\n                    }\n                    \n                    container.innerHTML = items.map((item, index) => {\n                        const rank = index + 1;\n                        const recentBadge = item.recent > 0 ? \n                            `<span class=\"eti-recent-badge\">${item.recent} recent</span>` : '';\n                        const agentBadge = item.agents > 0 ? \n                            `<span class=\"eti-agent-badge\">${item.agents} agents</span>` : '';\n                        \n                        return `\n                            <div class=\"eti-item\" data-rank=\"${rank}\">\n                                <div class=\"eti-rank\">${rank}</div>\n                                <div class=\"eti-content\">\n                                    <div class=\"eti-name\">${item.name}</div>\n                                    <div class=\"eti-meta\">\n                                        <span class=\"eti-count\">${item.count} occurrences</span>\n                                        ${recentBadge}\n                                        ${agentBadge}\n                                    </div>\n                                    ${item.details && item.details.length > 0 ? `\n                                        <div class=\"eti-details\">\n                                            ${item.details.slice(0, 2).join(', ')}\n                                            ${item.details.length > 2 ? '...' : ''}\n                                        </div>\n                                    ` : ''}\n                                </div>\n                            </div>\n                        `;\n                    }).join('');\n                };\n                \n                // Render each section\n                renderIOCList(data.topMalwareFamilies, document.getElementById('eti-malware'));\n                renderIOCList(data.topSuspiciousAPIs, document.getElementById('eti-apis'));\n                renderIOCList(data.topMaliciousStrings, document.getElementById('eti-strings'));\n                renderIOCList(data.topPackers, document.getElementById('eti-packers'));\n                \n            } catch (error) {\n                console.error('Failed to load emerging threats:', error);\n            }\n        }\n        \n        async function analyzeThreatModel() {\n            try {\n                // Get selected values\n                const fileType = document.getElementById('model-filetype').value;\n                const packer = document.getElementById('model-packer').value;\n                const signature = document.getElementById('model-signature').value;\n                \n                // Get multiple selections\n                const apisSelect = document.getElementById('model-apis');\n                const apiImports = Array.from(apisSelect.selectedOptions).map(opt => opt.value);\n                \n                const stringsSelect = document.getElementById('model-strings');\n                const keyStrings = Array.from(stringsSelect.selectedOptions).map(opt => opt.value);\n                \n                // Validate\n                if (apiImports.length === 0) {\n                    alert('Please select at least one API import');\n                    return;\n                }\n                if (keyStrings.length === 0) {\n                    alert('Please select at least one suspicious string');\n                    return;\n                }\n                \n                // Show loading state\n                const outputDiv = document.getElementById('modeler-output');\n                outputDiv.innerHTML = `\n                    <div class=\"modeler-loading\">\n                        <i class=\"fas fa-spinner fa-spin\"></i>\n                        <p>Analyzing threat profile...</p>\n                    </div>\n                `;\n                \n                // Send to server\n                const response = await fetch('/api/threat-model', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                        fileType,\n                        packer,\n                        signature,\n                        apiImports,\n                        keyStrings\n                    })\n                });\n                \n                const data = await response.json();\n                \n                if (data.success) {\n                    const result = data.result;\n                    const classColor = \n                        result.classification === 'Malware' ? '#ff4757' :\n                        result.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n                    \n                    outputDiv.innerHTML = `\n                        <div class=\"prediction-result\">\n                            <div class=\"prediction-header\">\n                                <div class=\"prediction-badge\" style=\"background: ${classColor};\">\n                                    ${result.classification.toUpperCase()}\n                                </div>\n                                <div class=\"prediction-confidence\">\n                                    <div class=\"confidence-label\">Confidence Score</div>\n                                    <div class=\"confidence-value\">${(parseFloat(result.confidence_score) * 100).toFixed(1)}%</div>\n                                </div>\n                            </div>\n                            \n                            ${result.malware_family ? `\n                                <div class=\"prediction-family\">\n                                    <strong>Predicted Malware Family:</strong>\n                                    <span class=\"family-name\">${result.malware_family}</span>\n                                </div>\n                            ` : ''}\n                            \n                            <div class=\"prediction-section\">\n                                <h4>Threat Analysis</h4>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-file\"></i>\n                                    <span><strong>File Type:</strong> ${result.key_findings.file_type}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-box\"></i>\n                                    <span><strong>Packer:</strong> ${result.key_findings.packer_detected}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-certificate\"></i>\n                                    <span><strong>Signature:</strong> ${result.key_findings.signature.name}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-tachometer-alt\"></i>\n                                    <span><strong>Threat Score:</strong> ${result.key_findings.threat_score}/100</span>\n                                </div>\n                            </div>\n                            \n                            <div class=\"prediction-section\">\n                                <h4>Detected Indicators</h4>\n                                <div class=\"indicator-group\">\n                                    <strong>API Imports:</strong>\n                                    <div class=\"indicator-list\">\n                                        ${result.key_findings.api_imports.map(api => \n                                            `<span class=\"indicator-tag api-tag\">${api}</span>`\n                                        ).join('')}\n                                    </div>\n                                </div>\n                                <div class=\"indicator-group\">\n                                    <strong>Suspicious Strings:</strong>\n                                    <div class=\"indicator-list\">\n                                        ${result.key_findings.key_strings.map(str => \n                                            `<span class=\"indicator-tag string-tag\">${str}</span>`\n                                        ).join('')}\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"prediction-footer\">\n                                <i class=\"fas fa-info-circle\"></i>\n                                This analysis has been added to the scan results and will appear in all visualizations.\n                            </div>\n                        </div>\n                    `;\n                } else {\n                    outputDiv.innerHTML = `\n                        <div class=\"modeler-error\">\n                            <i class=\"fas fa-exclamation-circle\"></i>\n                            <p>Analysis failed: ${data.error}</p>\n                        </div>\n                    `;\n                }\n                \n            } catch (error) {\n                console.error('Failed to analyze threat model:', error);\n                document.getElementById('modeler-output').innerHTML = `\n                    <div class=\"modeler-error\">\n                        <i class=\"fas fa-exclamation-circle\"></i>\n                        <p>Analysis failed. Please try again.</p>\n                    </div>\n                `;\n            }\n        }\n        \n        let graphSimulation = null;\n        let graphSvg = null;\n        \n        async function loadCorrelationGraph() {\n            try {\n                const response = await fetch('/api/threat-correlations');\n                const data = await response.json();\n                \n                // Clear existing graph\n                d3.select('#correlationGraph').selectAll('*').remove();\n                \n                const container = document.getElementById('correlationGraph');\n                const width = container.clientWidth;\n                const height = 600;\n                \n                // Create SVG\n                graphSvg = d3.select('#correlationGraph')\n                    .append('svg')\n                    .attr('width', width)\n                    .attr('height', height)\n                    .style('background', '#0a0a0a')\n                    .style('border-radius', '8px');\n                \n                const g = graphSvg.append('g');\n                \n                // Add zoom behavior\n                const zoom = d3.zoom()\n                    .scaleExtent([0.1, 4])\n                    .on('zoom', (event) => {\n                        g.attr('transform', event.transform);\n                    });\n                \n                graphSvg.call(zoom);\n                \n                // Color schemes for different node types\n                const colorMap = {\n                    malware: '#ff4757',\n                    agent: '#5a9cf8',\n                    api: '#ffa502',\n                    string: '#26de81'\n                };\n                \n                // Create force simulation\n                graphSimulation = d3.forceSimulation(data.nodes)\n                    .force('link', d3.forceLink(data.links)\n                        .id(d => d.id)\n                        .distance(d => d.type === 'correlated_with' ? 200 : 100)\n                        .strength(d => d.strength * 0.3))\n                    .force('charge', d3.forceManyBody().strength(-300))\n                    .force('center', d3.forceCenter(width / 2, height / 2))\n                    .force('collision', d3.forceCollide().radius(30));\n                \n                // Draw links\n                const link = g.append('g')\n                    .selectAll('line')\n                    .data(data.links)\n                    .enter()\n                    .append('line')\n                    .attr('stroke', d => {\n                        if (d.type === 'correlated_with') return '#ff6b6b';\n                        if (d.type === 'detected_by') return '#5a9cf8';\n                        if (d.type === 'uses_api') return '#ffa502';\n                        return '#26de81';\n                    })\n                    .attr('stroke-width', d => Math.sqrt(d.strength) + 1)\n                    .attr('stroke-opacity', 0.6);\n                \n                // Draw nodes\n                const node = g.append('g')\n                    .selectAll('circle')\n                    .data(data.nodes)\n                    .enter()\n                    .append('circle')\n                    .attr('r', d => {\n                        if (d.type === 'malware') return 15 + Math.min(d.count * 2, 15);\n                        if (d.type === 'agent') return 12 + Math.min(d.count, 10);\n                        return 8 + Math.min(d.count, 8);\n                    })\n                    .attr('fill', d => colorMap[d.type])\n                    .attr('stroke', '#fff')\n                    .attr('stroke-width', 2)\n                    .style('cursor', 'pointer')\n                    .call(d3.drag()\n                        .on('start', dragstarted)\n                        .on('drag', dragged)\n                        .on('end', dragended))\n                    .on('click', (event, d) => showNodeDetails(d, data))\n                    .on('mouseover', function(event, d) {\n                        d3.select(this)\n                            .transition()\n                            .duration(200)\n                            .attr('stroke-width', 4)\n                            .attr('r', function() {\n                                const currentR = parseFloat(d3.select(this).attr('r'));\n                                return currentR * 1.3;\n                            });\n                    })\n                    .on('mouseout', function(event, d) {\n                        d3.select(this)\n                            .transition()\n                            .duration(200)\n                            .attr('stroke-width', 2)\n                            .attr('r', function() {\n                                if (d.type === 'malware') return 15 + Math.min(d.count * 2, 15);\n                                if (d.type === 'agent') return 12 + Math.min(d.count, 10);\n                                return 8 + Math.min(d.count, 8);\n                            });\n                    });\n                \n                // Add labels\n                const label = g.append('g')\n                    .selectAll('text')\n                    .data(data.nodes)\n                    .enter()\n                    .append('text')\n                    .text(d => d.label.length > 20 ? d.label.substring(0, 20) + '...' : d.label)\n                    .attr('font-size', d => d.type === 'malware' ? '12px' : '10px')\n                    .attr('fill', '#e0e0e0')\n                    .attr('text-anchor', 'middle')\n                    .attr('dy', d => {\n                        if (d.type === 'malware') return 35;\n                        if (d.type === 'agent') return 25;\n                        return 20;\n                    })\n                    .style('pointer-events', 'none')\n                    .style('font-weight', d => d.type === 'malware' ? 'bold' : 'normal');\n                \n                // Update positions on simulation tick\n                graphSimulation.on('tick', () => {\n                    link\n                        .attr('x1', d => d.source.x)\n                        .attr('y1', d => d.source.y)\n                        .attr('x2', d => d.target.x)\n                        .attr('y2', d => d.target.y);\n                    \n                    node\n                        .attr('cx', d => d.x)\n                        .attr('cy', d => d.y);\n                    \n                    label\n                        .attr('x', d => d.x)\n                        .attr('y', d => d.y);\n                });\n                \n                // Drag functions\n                function dragstarted(event, d) {\n                    if (!event.active) graphSimulation.alphaTarget(0.3).restart();\n                    d.fx = d.x;\n                    d.fy = d.y;\n                }\n                \n                function dragged(event, d) {\n                    d.fx = event.x;\n                    d.fy = event.y;\n                }\n                \n                function dragended(event, d) {\n                    if (!event.active) graphSimulation.alphaTarget(0);\n                    d.fx = null;\n                    d.fy = null;\n                }\n                \n                console.log(`Correlation graph loaded: ${data.nodes.length} nodes, ${data.links.length} links`);\n                \n            } catch (error) {\n                console.error('Failed to load correlation graph:', error);\n            }\n        }\n        \n        function showNodeDetails(node, graphData) {\n            const detailsPanel = document.getElementById('nodeDetails');\n            const detailsTitle = document.getElementById('detailsTitle');\n            const detailsContent = document.getElementById('detailsContent');\n            \n            detailsTitle.textContent = node.label;\n            \n            let html = `<p><strong>Type:</strong> ${node.type.toUpperCase()}</p>`;\n            html += `<p><strong>Occurrences:</strong> ${node.count}</p>`;\n            \n            // Find connections\n            const connections = graphData.links.filter(l => \n                l.source.id === node.id || l.target.id === node.id\n            );\n            \n            if (connections.length > 0) {\n                html += `<p><strong>Connections:</strong> ${connections.length}</p>`;\n                html += '<ul style=\"margin: 10px 0; padding-left: 20px;\">';\n                connections.slice(0, 10).forEach(link => {\n                    const otherNode = link.source.id === node.id ? link.target : link.source;\n                    html += `<li>${link.type.replace(/_/g, ' ')}: ${otherNode.label}</li>`;\n                });\n                if (connections.length > 10) {\n                    html += `<li>...and ${connections.length - 10} more</li>`;\n                }\n                html += '</ul>';\n            }\n            \n            if (node.details && node.details.length > 0) {\n                html += '<p><strong>Associated Files:</strong></p>';\n                html += '<ul style=\"margin: 10px 0; padding-left: 20px; max-height: 150px; overflow-y: auto;\">';\n                node.details.slice(0, 10).forEach(file => {\n                    html += `<li>${file}</li>`;\n                });\n                if (node.details.length > 10) {\n                    html += `<li>...and ${node.details.length - 10} more</li>`;\n                }\n                html += '</ul>';\n            }\n            \n            detailsContent.innerHTML = html;\n            detailsPanel.style.display = 'block';\n        }\n        \n        function resetGraph() {\n            if (graphSimulation) {\n                graphSimulation.alpha(1).restart();\n            }\n        }\n        \n        function centerGraph() {\n            if (graphSvg) {\n                graphSvg.transition().duration(750).call(\n                    d3.zoom().transform,\n                    d3.zoomIdentity\n                );\n            }\n        }\n        \n        function setChartDays(days) {\n            currentChartDays = days;\n            \n            // Update button states\n            document.querySelectorAll('.chart-btn').forEach(btn => {\n                btn.classList.remove('active');\n            });\n            event.target.classList.add('active');\n            \n            loadDailyChart();\n        }\n        \n        function loadData() {\n            loadStats();\n            loadScans();\n            // Heavy components loaded lazily - see switchView()\n        }\n        \n        function loadDataWithoutMap() {\n            loadStats();\n            loadScans();\n        }\n        \n        // Track which analytics have been loaded\n        let analyticsLoaded = false;\n        \n        function loadAnalytics() {\n            console.log('Loading analytics view...');\n            loadDailyChart();\n            loadMalwareSources();\n            loadNoisyAgentsChart();\n            loadSignatureClassChart();\n            loadPackerClassChart();\n            loadConfidenceHistChart();\n            loadEntropyBoxChart();\n            loadEmergingThreats();\n            loadCorrelationGraph();\n            loadGeoMap();\n            \n            analyticsLoaded = true;\n        }\n        \n        // Initial load - only dashboard essentials\n        loadData();\n        \n        // Auto-scroll functionality with visual indicators\n        const scrollIndicatorUp = document.createElement('div');\n        scrollIndicatorUp.className = 'scroll-indicator scroll-up';\n        scrollIndicatorUp.innerHTML = '<i class=\"fas fa-chevron-up\"></i>';\n        document.body.appendChild(scrollIndicatorUp);\n        \n        const scrollIndicatorDown = document.createElement('div');\n        scrollIndicatorDown.className = 'scroll-indicator scroll-down';\n        scrollIndicatorDown.innerHTML = '<i class=\"fas fa-chevron-down\"></i>';\n        document.body.appendChild(scrollIndicatorDown);\n        \n        let pageScrollInterval = null;\n        const scrollSpeed = 3;\n        const triggerZone = 80; // pixels from top/bottom\n        \n        function handleAutoScroll(event) {\n            // Don't auto-scroll if page is hidden\n            if (document.hidden) return;\n            \n            const mouseY = event.clientY;\n            const windowHeight = window.innerHeight;\n            \n            // Check if near top\n            if (mouseY < triggerZone) {\n                scrollIndicatorUp.classList.add('visible');\n                scrollIndicatorDown.classList.remove('visible');\n                \n                if (!pageScrollInterval) {\n                    pageScrollInterval = setInterval(() => {\n                        if (document.hidden) {\n                            stopAutoScroll();\n                            return;\n                        }\n                        window.scrollBy({\n                            top: -scrollSpeed,\n                            behavior: 'auto'\n                        });\n                    }, 16); // ~60fps\n                }\n            }\n            // Check if near bottom\n            else if (mouseY > windowHeight - triggerZone) {\n                scrollIndicatorDown.classList.add('visible');\n                scrollIndicatorUp.classList.remove('visible');\n                \n                if (!pageScrollInterval) {\n                    pageScrollInterval = setInterval(() => {\n                        if (document.hidden) {\n                            stopAutoScroll();\n                            return;\n                        }\n                        window.scrollBy({\n                            top: scrollSpeed,\n                            behavior: 'auto'\n                        });\n                    }, 16);\n                }\n            }\n            // In neutral zone\n            else {\n                scrollIndicatorUp.classList.remove('visible');\n                scrollIndicatorDown.classList.remove('visible');\n                \n                if (pageScrollInterval) {\n                    clearInterval(pageScrollInterval);\n                    pageScrollInterval = null;\n                }\n            }\n        }\n        \n        function stopAutoScroll() {\n            scrollIndicatorUp.classList.remove('visible');\n            scrollIndicatorDown.classList.remove('visible');\n            \n            if (pageScrollInterval) {\n                clearInterval(pageScrollInterval);\n                pageScrollInterval = null;\n            }\n        }\n        \n        // Attach event listeners\n        document.addEventListener('mousemove', handleAutoScroll);\n        document.addEventListener('mouseleave', stopAutoScroll);\n        \n        // Stop scrolling when reaching top or bottom\n        let lastScrollTop = 0;\n        window.addEventListener('scroll', () => {\n            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n            const scrollHeight = document.documentElement.scrollHeight;\n            const clientHeight = document.documentElement.clientHeight;\n            \n            // At top\n            if (scrollTop === 0 && lastScrollTop > 0) {\n                stopAutoScroll();\n            }\n            // At bottom\n            if (scrollTop + clientHeight >= scrollHeight - 5) {\n                stopAutoScroll();\n            }\n            \n            lastScrollTop = scrollTop;\n        });\n        \n        // Set up Server-Sent Events for real-time updates\n        const eventSource = new EventSource('/api/events');\n        let updateDebounceTimer = null;\n        let pollingInterval = null;\n        let pendingUpdates = false;\n        \n        eventSource.onmessage = function(event) {\n            const data = JSON.parse(event.data);\n            \n            if (data.type === 'connected') {\n                console.log('Connected to server for real-time updates');\n            } else if (data.type === 'new-scan') {\n                console.log('New scan received:', data.scan.detected_filename);\n                \n                // Show notification toast\n                showThreatNotification(data.scan);\n                \n                // Add to threat ticker\n                addToThreatTicker(data.scan);\n                \n                // Debounce: batch multiple rapid scans into single update\n                pendingUpdates = true;\n                clearTimeout(updateDebounceTimer);\n                updateDebounceTimer = setTimeout(() => {\n                    if (pendingUpdates) {\n                        // Only reload lightweight data (stats + scan list)\n                        loadStats();\n                        loadScans();\n                        \n                        // If analytics view is open, refresh analytics too\n                        if (currentView === 'analytics' && analyticsLoaded) {\n                            loadAnalytics();\n                        }\n                        \n                        pendingUpdates = false;\n                        \n                        // Throttle map updates to once per 15 seconds\n                        if (!window.lastMapUpdate || Date.now() - window.lastMapUpdate > 15000) {\n                            loadGeoMap();\n                            window.lastMapUpdate = Date.now();\n                        }\n                    }\n                }, 1000); // Wait 1 second after last scan\n            }\n        };\n        \n        eventSource.onerror = function(error) {\n            console.error('SSE Error:', error);\n            // Fallback: reload data every 30 seconds if SSE connection fails (only once!)\n            if (eventSource.readyState === EventSource.CLOSED && !pollingInterval) {\n                console.log('SSE connection closed, falling back to polling...');\n                pollingInterval = setInterval(() => {\n                    loadStats();\n                    loadScans();\n                }, 30000);\n            }\n        };\n        \n        // Manual refresh button functionality\n        window.manualRefresh = function() {\n            loadData();\n        };\n    </script>\n    \n    <!-- Theme Toggle Script -->\n    <script>\n        // Theme Toggle Functionality\n        window.toggleTheme = function() {\n            const html = document.documentElement;\n            const currentTheme = html.getAttribute('data-theme');\n            const newTheme = currentTheme === 'light' ? '' : 'light';\n            \n            if (newTheme) {\n                html.setAttribute('data-theme', newTheme);\n            } else {\n                html.removeAttribute('data-theme');\n            }\n            localStorage.setItem('theme', newTheme || 'dark');\n            \n            // Update button icon and text\n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            if (newTheme === 'light') {\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n            } else {\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n            }\n        };\n        \n        // Load saved theme on page load\n        (function() {\n            const savedTheme = localStorage.getItem('theme') || 'dark';\n            if (savedTheme === 'light') {\n                document.documentElement.setAttribute('data-theme', 'light');\n            }\n            \n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            if (savedTheme === 'light') {\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n            } else {\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n            }\n        })();\n    </script>\n</body>\n</html>","epoch":37,"telemetryInfo":{}}],["file:///home/trang/localnsv/mAIware-server/public/dashboard.html::request_5ed1c503-e959-41d2-adbb-12b539ea050b",{"uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/dashboard.html","external":"file:///home/trang/localnsv/mAIware-server/public/dashboard.html","path":"/home/trang/localnsv/mAIware-server/public/dashboard.html","scheme":"file"},"requestId":"request_5ed1c503-e959-41d2-adbb-12b539ea050b","content":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>mAIware Server Dashboard</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n    <link rel=\"stylesheet\" href=\"styles.css?v=3.0\">\n    <!-- Add Chart.js -->\n    <script src=\"https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js\"></script>\n    <!-- Add Leaflet.js for maps -->\n    <link rel=\"stylesheet\" href=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css\" />\n    <script src=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js\"></script>\n    <!-- Add Leaflet Heatmap Plugin -->\n    <script src=\"https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js\"></script>\n    <!-- Add D3.js for force-directed graph -->\n    <script src=\"https://d3js.org/d3.v7.min.js\"></script>\n    <!-- Add html2canvas for screenshots -->\n    <script src=\"https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js\"></script>\n</head>\n<body>\n    <!-- Theme Toggle Button -->\n    <button class=\"theme-toggle\" id=\"themeToggle\" onclick=\"toggleTheme()\">\n        <span class=\"icon\" id=\"themeIcon\">üåô</span>\n        <span id=\"themeText\">Dark</span>\n    </button>\n\n    <!-- Back to Top Button -->\n    <button class=\"back-to-top\" id=\"backToTop\" onclick=\"scrollToTop()\">\n        <i class=\"fas fa-arrow-up\"></i>\n    </button>\n\n    <!-- Preview Backdrop -->\n    <div class=\"preview-backdrop\" id=\"previewBackdrop\"></div>\n\n    <!-- Side Navigation Panel -->\n    <div class=\"side-panel\" id=\"sidePanel\">\n        <!-- Logo Icon (always visible) -->\n        <div class=\"panel-icon-strip\">\n            <div class=\"panel-logo-icon\">\n                <i class=\"fas fa-shield-virus\"></i>\n            </div>\n        </div>\n        \n        <!-- Analytics Preview Panel (slides out on hover) -->\n        <div class=\"graphs-preview\" id=\"graphsPreview\">\n            <div class=\"preview-header\">\n                <h3><i class=\"fas fa-chart-line\"></i> Analytics Preview</h3>\n                <p>Click anywhere to view full analytics</p>\n            </div>\n            \n            <!-- Scaled-down live view of analytics -->\n            <div class=\"analytics-miniview\" id=\"analyticsMiniview\" onclick=\"switchView('analytics')\">\n                <div class=\"miniview-preview\">\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box large\">\n                            <div class=\"box-header\">Global Threat Map</div>\n                            <div class=\"box-content map-visual\">\n                                <div class=\"map-dot\" style=\"top: 30%; left: 40%;\"></div>\n                                <div class=\"map-dot\" style=\"top: 60%; left: 70%;\"></div>\n                                <div class=\"map-dot\" style=\"top: 45%; left: 25%;\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box large\">\n                            <div class=\"box-header\">Attack Timeline</div>\n                            <div class=\"box-content chart-visual\">\n                                <div class=\"chart-bar\" style=\"height: 40%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 70%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 55%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 85%;\"></div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Top Threats</div>\n                            <div class=\"box-content list-visual\">\n                                <div class=\"list-item\"></div>\n                                <div class=\"list-item\"></div>\n                                <div class=\"list-item\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Correlations</div>\n                            <div class=\"box-content network-visual\">\n                                <div class=\"network-node\" style=\"top: 30%; left: 30%;\"></div>\n                                <div class=\"network-node\" style=\"top: 60%; left: 50%;\"></div>\n                                <div class=\"network-node\" style=\"top: 45%; left: 70%;\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Heatmap</div>\n                            <div class=\"box-content heat-visual\"></div>\n                        </div>\n                    </div>\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box wide\">\n                            <div class=\"box-header\">File Analysis & Distribution</div>\n                            <div class=\"box-content pie-visual\">\n                                <div class=\"pie-chart\"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"miniview-overlay\">\n                    <i class=\"fas fa-expand-alt\"></i>\n                    <span>Click to view analytics</span>\n                </div>\n            </div>                <!-- Home Navigation Button -->\n                <div class=\"preview-home-nav\" id=\"homeNavBtn\" onclick=\"switchView('dashboard')\">\n                    <i class=\"fas fa-home\"></i>\n                    <span>Back to Dashboard</span>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"main-content\" id=\"mainContent\">\n        <!-- DASHBOARD VIEW -->\n        <div class=\"view-container active\" id=\"dashboardView\">\n            <header class=\"dashboard-header\">\n                <div class=\"header-content\">\n                    <h1><i class=\"fas fa-shield-virus pulse-icon\"></i> mAIware Server</h1>\n                    <p class=\"subtitle\">Real-time Malware Analysis Dashboard</p>\n                </div>\n            </header>\n            \n            <!-- Real-time Threat Ticker -->\n            <div class=\"threat-ticker-container animate-slide-in\">\n                <div class=\"ticker-label\">\n                    <i class=\"fas fa-broadcast-tower pulse-icon\"></i>\n                    <span>LIVE THREAT FEED</span>\n                </div>\n                <div class=\"threat-ticker\" id=\"threat-ticker\">\n                    <div class=\"ticker-content\" id=\"ticker-content\">\n                        <span class=\"ticker-item\">System ready - Monitoring for threats...</span>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Notification Toast Container -->\n            <div id=\"notification-container\" class=\"notification-container\"></div>\n            \n            <!-- Stats Grid -->\n            <div class=\"stats-grid animate-fade-in\" id=\"stats-grid\">\n                <div class=\"stat-card info\">\n                    <i class=\"fas fa-laptop\"></i>\n                    <span class=\"stat-number\" id=\"stat-clients\">0</span>\n                    <span class=\"stat-label\">Active Clients</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card info\">\n                    <i class=\"fas fa-chart-line\"></i>\n                    <span class=\"stat-number\" id=\"stat-total\">0</span>\n                    <span class=\"stat-label\">Total Scans</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card malware\">\n                    <i class=\"fas fa-bug\"></i>\n                    <span class=\"stat-number\" id=\"stat-malware\">0</span>\n                    <span class=\"stat-label\">Malware</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card suspicious\">\n                    <i class=\"fas fa-exclamation-triangle\"></i>\n                    <span class=\"stat-number\" id=\"stat-suspicious\">0</span>\n                    <span class=\"stat-label\">Suspicious</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card benign\">\n                    <i class=\"fas fa-check-circle\"></i>\n                    <span class=\"stat-number\" id=\"stat-benign\">0</span>\n                    <span class=\"stat-label\">Benign</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n            </div>\n            \n            <!-- Recent Scans -->\n            <div class=\"scans-container animate-fade-in\">\n                <div class=\"scans-header\">\n                    <h2><i class=\"fas fa-list\"></i> Recent Scans</h2>\n                    <button class=\"refresh-btn\" onclick=\"manualRefresh()\">\n                        <i class=\"fas fa-sync-alt\"></i> Refresh\n                    </button>\n                </div>\n                \n                <table class=\"scans-table\">\n                    <thead>\n                        <tr>\n                            <th>Timestamp</th>\n                            <th>Filename</th>\n                            <th>Classification</th>\n                            <th>Client IP</th>\n                            <th>Hash (SHA256)</th>\n                        </tr>\n                    </thead>\n                    <tbody id=\"scans-tbody\">\n                        <tr>\n                            <td colspan=\"5\" class=\"empty-state\">\n                                <i class=\"fas fa-inbox\"></i>\n                                <p>No scans yet. Waiting for clients...</p>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n\n        <!-- ANALYTICS VIEW -->\n        <div class=\"view-container\" id=\"analyticsView\">\n            <div class=\"analytics-header\">\n                <button class=\"back-btn\" onclick=\"switchView('dashboard')\">\n                    <i class=\"fas fa-arrow-left\"></i> Back to Dashboard\n                </button>\n                <h1><i class=\"fas fa-chart-line\"></i> Analytics & Intelligence</h1>\n            </div>\n            \n            <div class=\"analytics-grid\" id=\"analyticsGrid\">\n                \n                <!-- Daily Analysis Chart -->\n                <div class=\"chart-container analytics-panel panel-large\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-line\"></i> Daily Analysis Trends</h2>\n                        <div class=\"chart-controls\">\n                            <button class=\"chart-btn active\" onclick=\"setChartDays(7)\">7 Days</button>\n                            <button class=\"chart-btn\" onclick=\"setChartDays(14)\">14 Days</button>\n                            <button class=\"chart-btn\" onclick=\"setChartDays(30)\">30 Days</button>\n                        </div>\n                    </div>\n                    <canvas id=\"dailyScansChart\"></canvas>\n                </div>\n                    <canvas id=\"dailyScansChart\"></canvas>\n                </div>\n\n                <!-- Geographic Threat Intelligence Map -->\n                <div class=\"map-container analytics-panel panel-large\">\n                    <div class=\"map-header\">\n                        <h2><i class=\"fas fa-globe-americas\"></i> Global Threat Intelligence Map</h2>\n                        <div class=\"map-controls\">\n                            <div class=\"map-view-toggle\">\n                                <button class=\"map-btn active\" data-view=\"markers\" onclick=\"switchMapView('markers')\">\n                                    <i class=\"fas fa-map-marker-alt\"></i> Markers\n                                </button>\n                                <button class=\"map-btn\" data-view=\"heatmap\" onclick=\"switchMapView('heatmap')\">\n                                    <i class=\"fas fa-fire\"></i> Heatmap\n                                </button>\n                                <button class=\"map-btn\" data-view=\"choropleth\" onclick=\"switchMapView('choropleth')\">\n                                    <i class=\"fas fa-globe\"></i> Choropleth\n                                </button>\n                            </div>\n                            <div class=\"map-legend\">\n                                <span class=\"legend-item\"><span class=\"legend-dot malware-dot\"></span> Malware</span>\n                                <span class=\"legend-item\"><span class=\"legend-dot suspicious-dot\"></span> Suspicious</span>\n                                <span class=\"legend-item\"><span class=\"legend-dot benign-dot\"></span> Benign</span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Geographic Context Panel -->\n                    <div class=\"geo-context-panel\" id=\"geoContext\">\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Active Regions:</span>\n                            <span class=\"context-value\" id=\"activeRegions\">0</span>\n                        </div>\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Hotspot:</span>\n                            <span class=\"context-value\" id=\"topRegion\">None</span>\n                        </div>\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Total Threats:</span>\n                            <span class=\"context-value threat-count\" id=\"geoThreatCount\">0</span>\n                        </div>\n                    </div>\n                    \n                    <div id=\"worldMap\" style=\"height: 500px; border-radius: 8px; margin-bottom: 15px;\"></div>\n                    \n                    <!-- Timeline Control -->\n                    <div class=\"map-timeline-control\">\n                        <button class=\"timeline-btn\" onclick=\"replayThreats()\" id=\"replayBtn\">\n                            <i class=\"fas fa-play\"></i> Replay Last 24h\n                        </button>\n                        <div class=\"timeline-info\" id=\"timelineInfo\">\n                            Click replay to see threat propagation over time\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Malware Source Distribution -->\n                <div class=\"chart-container analytics-panel panel-small\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-pie\"></i> Malware Source Distribution</h2>\n                    </div>\n                    <div style=\"max-width: 500px; margin: 0 auto;\">\n                        <canvas id=\"malwareSourceChart\"></canvas>\n                    </div>\n                </div>\n\n                <!-- Graph 2: \"Noisiest\" Agents Over Time -->\n                <div class=\"chart-container analytics-panel panel-large\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-desktop\"></i> \"Noisiest\" Agents Over Time</h2>\n                        <p class=\"chart-subtitle\">Threat detection trends for top 5 high-risk agents</p>\n                    </div>\n                    <div style=\"height: 300px;\">\n                        <canvas id=\"noisyAgentsChart\"></canvas>\n                    </div>\n                </div>\n\n                <!-- Advanced Analytics Grid -->\n                <div class=\"analytics-panel panel-large advanced-analytics-grid\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-area\"></i> Advanced Statistical Analysis</h2>\n                        <p class=\"chart-subtitle\">Deep dive into signature verification, packer usage, AI confidence, and entropy patterns</p>\n                    </div>\n                    \n                    <div class=\"mini-charts-grid\">\n                        <!-- Graph 3: Signature Status vs. Classification -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-certificate\"></i> Signature vs. Classification</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"signatureClassChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 4: Packer Usage vs. Classification -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-box\"></i> Packer vs. Classification</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"packerClassChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 5: Confidence Score Distribution -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-brain\"></i> AI Confidence Distribution</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"confidenceHistChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 6: File Entropy Distribution -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-chart-bar\"></i> Entropy Distribution</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"entropyBoxChart\"></canvas>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Threat Vector Correlation Explorer -->\n                <div class=\"correlation-container analytics-panel panel-large\">\n                    <div class=\"correlation-header\">\n                        <h2><i class=\"fas fa-project-diagram\"></i> Threat Vector Correlation Explorer</h2>\n                        <p class=\"correlation-subtitle\">Interactive intelligence map showing relationships between malware families, agents, APIs, and indicators</p>\n                    </div>\n                    <div class=\"graph-controls\">\n                        <button class=\"graph-btn\" onclick=\"resetGraph()\"><i class=\"fas fa-sync\"></i> Reset View</button>\n                        <button class=\"graph-btn\" onclick=\"centerGraph()\"><i class=\"fas fa-compress\"></i> Center</button>\n                        <div class=\"graph-legend\">\n                            <span class=\"legend-item\"><span class=\"node-sample malware-node\"></span> Malware Family</span>\n                            <span class=\"legend-item\"><span class=\"node-sample agent-node\"></span> Agent/System</span>\n                            <span class=\"legend-item\"><span class=\"node-sample api-node\"></span> API Call</span>\n                            <span class=\"legend-item\"><span class=\"node-sample string-node\"></span> Suspicious String</span>\n                        </div>\n                    </div>\n                    <div id=\"correlationGraph\"></div>\n                    <div id=\"nodeDetails\" class=\"node-details\" style=\"display: none;\">\n                        <h3 id=\"detailsTitle\"></h3>\n                        <div id=\"detailsContent\"></div>\n                    </div>\n                </div>\n\n                <!-- Emerging Threat Intelligence Panel -->\n                <div class=\"eti-container analytics-panel panel-large\">\n                    <div class=\"eti-header\">\n                        <h2><i class=\"fas fa-exclamation-triangle\"></i> Emerging Threat Intelligence (ETI)</h2>\n                        <p class=\"eti-subtitle\">Real-time actionable intelligence on active threats and indicators of compromise</p>\n                        <div class=\"eti-summary\">\n                            <span class=\"eti-badge\" id=\"eti-total\">0 Total Threats</span>\n                            <span class=\"eti-badge recent\" id=\"eti-recent\">0 Last 24h</span>\n                        </div>\n                    </div>\n                    \n                    <div class=\"eti-grid\">\n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-virus\"></i> Top Malware Families</h3>\n                            <div class=\"eti-subtitle-small\">Most active malware families detected</div>\n                            <div id=\"eti-malware\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-code\"></i> Top Suspicious APIs</h3>\n                            <div class=\"eti-subtitle-small\">Most frequently called malicious APIs</div>\n                            <div id=\"eti-apis\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-terminal\"></i> Top Malicious Strings</h3>\n                            <div class=\"eti-subtitle-small\">Most common IOC strings and commands</div>\n                            <div id=\"eti-strings\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-shield-alt\"></i> Top Packers/Obfuscators</h3>\n                            <div class=\"eti-subtitle-small\">Most used evasion techniques</div>\n                            <div id=\"eti-packers\" class=\"eti-list\"></div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Predictive Threat Modeler -->\n                <div class=\"modeler-container analytics-panel panel-large\">\n                    <div class=\"modeler-header\">\n                        <h2><i class=\"fas fa-flask\"></i> Predictive Threat Modeler</h2>\n                        <p class=\"modeler-subtitle\">Build hypothetical malware and predict how mAIware would classify it</p>\n                    </div>\n                    \n                    <div class=\"modeler-grid\">\n                <div class=\"modeler-builder\">\n                    <h3><i class=\"fas fa-cogs\"></i> Threat Configuration</h3>\n                    \n                    <div class=\"modeler-field\">\n                        <label>File Type</label>\n                        <select id=\"model-filetype\" class=\"modeler-select\">\n                            <option>PE32+ (GUI) x86-64</option>\n                            <option>PE32 (Console) Intel 80386</option>\n                            <option>PE32+ DLL x86-64</option>\n                            <option>MSI Installer</option>\n                            <option>PDF Document</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Packer/Obfuscator</label>\n                        <select id=\"model-packer\" class=\"modeler-select\">\n                            <option>None</option>\n                            <option>UPX</option>\n                            <option>VMProtect</option>\n                            <option>Themida</option>\n                            <option>ASPack</option>\n                            <option>Unknown (High Entropy)</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Digital Signature</label>\n                        <select id=\"model-signature\" class=\"modeler-select\">\n                            <option>Verified (Microsoft Corporation)</option>\n                            <option>Verified (Google LLC)</option>\n                            <option>Verified (Unknown Publisher)</option>\n                            <option>Not Signed</option>\n                            <option>Expired Certificate</option>\n                            <option>Self-Signed (Untrusted)</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>API Imports (select multiple)</label>\n                        <select id=\"model-apis\" class=\"modeler-select\" multiple size=\"6\">\n                            <option>CreateRemoteThread</option>\n                            <option>WriteProcessMemory</option>\n                            <option>VirtualAllocEx</option>\n                            <option>SetWindowsHookExW</option>\n                            <option>URLDownloadToFileW</option>\n                            <option>WinExec</option>\n                            <option>RegSetValueExW</option>\n                            <option>CryptEncrypt</option>\n                            <option>Socket</option>\n                            <option>ReadFile</option>\n                        </select>\n                        <small class=\"modeler-hint\">Hold Ctrl/Cmd to select multiple</small>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Suspicious Strings (select multiple)</label>\n                        <select id=\"model-strings\" class=\"modeler-select\" multiple size=\"6\">\n                            <option>http://bad-c2-server.com/payload.dat</option>\n                            <option>keylog.txt</option>\n                            <option>steal_passwords</option>\n                            <option>powershell -enc</option>\n                            <option>vssadmin.exe delete shadows</option>\n                            <option>HOW_TO_DECRYPT.txt</option>\n                            <option>crack</option>\n                            <option>patch</option>\n                            <option>disable_antivirus</option>\n                        </select>\n                        <small class=\"modeler-hint\">Hold Ctrl/Cmd to select multiple</small>\n                    </div>\n                    \n                    <button class=\"modeler-analyze-btn\" onclick=\"analyzeThreatModel()\">\n                        <i class=\"fas fa-brain\"></i> ANALYZE THREAT\n                    </button>\n                </div>\n                \n                <div class=\"modeler-results\">\n                    <h3><i class=\"fas fa-chart-line\"></i> Prediction Results</h3>\n                    <div id=\"modeler-output\" class=\"modeler-output\">\n                        <div class=\"modeler-placeholder\">\n                            <i class=\"fas fa-arrow-left\"></i>\n                            <p>Configure a threat profile and click ANALYZE to see predictions</p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n            </div>\n        </div>\n    </div>\n    \n    <script>\n        // Helper function to get CSS variable values dynamically for theming\n        function getCSSVar(varName) {\n            return getComputedStyle(document.documentElement).getPropertyValue(varName).trim();\n        }\n\n        // Back to Top Button\n        const backToTopBtn = document.getElementById('backToTop');\n        \n        window.addEventListener('scroll', () => {\n            if (window.pageYOffset > 300) {\n                backToTopBtn.classList.add('visible');\n            } else {\n                backToTopBtn.classList.remove('visible');\n            }\n        });\n\n        function scrollToTop() {\n            window.scrollTo({\n                top: 0,\n                behavior: 'smooth'\n            });\n        }\n\n        // View Switching System\n        function switchView(viewName) {\n            const views = document.querySelectorAll('.view-container');\n            \n            views.forEach(view => {\n                view.classList.remove('active');\n                if (view.id === `${viewName}View`) {\n                    view.classList.add('active');\n                }\n            });\n            \n            currentView = viewName;\n            \n            // Fix map display when switching to analytics view\n            if (viewName === 'analytics') {\n                loadAnalytics(); // Lazy load analytics components\n                setTimeout(() => {\n                    if (worldMap) {\n                        worldMap.invalidateSize();\n                    }\n                    // Capture screenshot for preview after charts has rendered\n                    setTimeout(() => {\n                        createAnalyticsMiniview();\n                    }, 1500);\n                }, 100);\n            }\n            \n            // Close graphs preview when switching views\n            document.getElementById('graphsPreview').classList.remove('show');\n            document.getElementById('previewBackdrop').classList.remove('show');\n        }\n        \n        // Side Panel Hover System\n        const sidePanel = document.getElementById('sidePanel');\n        const graphsPreview = document.getElementById('graphsPreview');\n        const previewBackdrop = document.getElementById('previewBackdrop');\n        const homeNavBtn = document.getElementById('homeNavBtn');\n        let previewTimeout;\n        let previewsRendered = false;\n        let currentView = 'dashboard';\n        \n        // Show preview panel on sidebar hover\n        sidePanel.addEventListener('mouseenter', () => {\n            clearTimeout(previewTimeout);\n            previewTimeout = setTimeout(() => {\n                graphsPreview.classList.add('show');\n                previewBackdrop.classList.add('show');\n                \n                // Show/hide home button based on current view\n                if (currentView === 'analytics') {\n                    homeNavBtn.classList.add('visible');\n                } else {\n                    homeNavBtn.classList.remove('visible');\n                }\n            }, 200);\n        });\n        \n        sidePanel.addEventListener('mouseleave', () => {\n            clearTimeout(previewTimeout);\n            setTimeout(() => {\n                if (!graphsPreview.matches(':hover')) {\n                    graphsPreview.classList.remove('show');\n                    previewBackdrop.classList.remove('show');\n                }\n            }, 100);\n        });\n        \n        // Keep preview open when hovering over it\n        graphsPreview.addEventListener('mouseleave', () => {\n            graphsPreview.classList.remove('show');\n            previewBackdrop.classList.remove('show');\n        });\n        \n        // Close preview when clicking backdrop\n        previewBackdrop.addEventListener('click', () => {\n            graphsPreview.classList.remove('show');\n            previewBackdrop.classList.remove('show');\n        });\n        \n        // Create analytics miniview by taking a screenshot\n        let isCapturingSnapshot = false;\n        let hasInitialSnapshot = false;\n        \n        async function createAnalyticsMiniview() {\n            // Simplified - no actual screenshot, just a visual preview\n            hasInitialSnapshot = true;\n        }\n        \n        // Auto-scroll on hover down in analytics view\n        let scrollInterval;\n        const analyticsGrid = document.getElementById('analyticsGrid');\n        \n        if (analyticsGrid) {\n            analyticsGrid.addEventListener('mousemove', (e) => {\n                const rect = analyticsGrid.getBoundingClientRect();\n                const mouseY = e.clientY - rect.top;\n                const triggerZone = 100; // pixels from bottom\n                \n                if (rect.height - mouseY < triggerZone) {\n                    if (!scrollInterval) {\n                        scrollInterval = setInterval(() => {\n                            analyticsGrid.scrollBy({ top: 2, behavior: 'smooth' });\n                        }, 16);\n                    }\n                } else {\n                    if (scrollInterval) {\n                        clearInterval(scrollInterval);\n                        scrollInterval = null;\n                    }\n                }\n            });\n            \n            analyticsGrid.addEventListener('mouseleave', () => {\n                if (scrollInterval) {\n                    clearInterval(scrollInterval);\n                    scrollInterval = null;\n                }\n            });\n        }\n        \n        // Theme Toggle\n        window.toggleTheme = function() {\n            const html = document.documentElement;\n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            const currentTheme = html.getAttribute('data-theme');\n            \n            if (currentTheme === 'light') {\n                html.setAttribute('data-theme', '');\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n                localStorage.setItem('theme', 'dark');\n            } else {\n                html.setAttribute('data-theme', 'light');\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n                localStorage.setItem('theme', 'light');\n            }\n        };\n        \n        // Load saved theme\n        const savedTheme = localStorage.getItem('theme');\n        if (savedTheme === 'light') {\n            document.documentElement.setAttribute('data-theme', 'light');\n            document.getElementById('themeIcon').textContent = '‚òÄÔ∏è';\n            document.getElementById('themeText').textContent = 'Light';\n        }\n        \n        let dailyChart = null;\n        let currentChartDays = 30;\n        \n        // Notification and Animation System\n        const notificationQueue = [];\n        let isShowingNotification = false;\n        \n        function showThreatNotification(scan) {\n            const container = document.getElementById('notification-container');\n            \n            const classColor = \n                scan.classification === 'Malware' ? '#ff4757' :\n                scan.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n            \n            const icon = \n                scan.classification === 'Malware' ? 'fa-skull-crossbones' :\n                scan.classification === 'Suspicious' ? 'fa-exclamation-triangle' : 'fa-check-circle';\n            \n            const notification = document.createElement('div');\n            notification.className = 'threat-notification';\n            notification.style.borderLeftColor = classColor;\n            notification.innerHTML = `\n                <div class=\"notification-icon\" style=\"color: ${classColor};\">\n                    <i class=\"fas ${icon}\"></i>\n                </div>\n                <div class=\"notification-content\">\n                    <div class=\"notification-title\">\n                        <strong>${scan.classification}</strong> detected\n                    </div>\n                    <div class=\"notification-details\">\n                        ${scan.detected_filename}\n                        ${scan.malware_family ? ` - ${scan.malware_family}` : ''}\n                    </div>\n                    <div class=\"notification-meta\">\n                        <i class=\"fas fa-desktop\"></i> ${scan.systemInfo?.hostname || scan.clientIp || 'Unknown'}\n                    </div>\n                </div>\n                <div class=\"notification-close\" onclick=\"this.parentElement.remove()\">\n                    <i class=\"fas fa-times\"></i>\n                </div>\n            `;\n            \n            container.appendChild(notification);\n            \n            // Animate in\n            setTimeout(() => notification.classList.add('show'), 10);\n            \n            // Auto-remove after 8 seconds\n            setTimeout(() => {\n                notification.classList.remove('show');\n                setTimeout(() => notification.remove(), 300);\n            }, 8000);\n        }\n        \n        function addToThreatTicker(scan) {\n            const ticker = document.getElementById('ticker-content');\n            const timestamp = new Date(scan.serverTimestamp).toLocaleTimeString();\n            \n            const classColor = \n                scan.classification === 'Malware' ? '#ff4757' :\n                scan.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n            \n            const tickerItem = document.createElement('span');\n            tickerItem.className = 'ticker-item';\n            tickerItem.style.color = classColor;\n            tickerItem.innerHTML = `\n                <i class=\"fas fa-circle\"></i>\n                [${timestamp}] ${scan.classification}: ${scan.detected_filename}\n                ${scan.malware_family ? `(${scan.malware_family})` : ''}\n                on ${scan.systemInfo?.hostname || scan.clientIp || 'Unknown'}\n            `;\n            \n            ticker.appendChild(tickerItem);\n            \n            // Keep only last 10 items\n            while (ticker.children.length > 10) {\n                ticker.removeChild(ticker.firstChild);\n            }\n        }\n        \n        function animateStatCard(elementId, newValue) {\n            const element = document.getElementById(elementId);\n            if (!element) return;\n            \n            const currentValue = parseInt(element.textContent) || 0;\n            if (newValue > currentValue) {\n                // Pulse animation\n                element.parentElement.classList.add('stat-pulse');\n                setTimeout(() => element.parentElement.classList.remove('stat-pulse'), 600);\n                \n                // Animate number increment\n                const duration = 500;\n                const steps = 20;\n                const increment = (newValue - currentValue) / steps;\n                let current = currentValue;\n                let step = 0;\n                \n                const interval = setInterval(() => {\n                    step++;\n                    current += increment;\n                    element.textContent = Math.round(current);\n                    \n                    if (step >= steps) {\n                        element.textContent = newValue;\n                        clearInterval(interval);\n                    }\n                }, duration / steps);\n            } else {\n                element.textContent = newValue;\n            }\n        }\n        \n        async function loadStats() {\n            try {\n                const response = await fetch('/api/stats');\n                const stats = await response.json();\n                \n                animateStatCard('stat-clients', stats.activeClients);\n                animateStatCard('stat-total', stats.totalScans);\n                animateStatCard('stat-malware', stats.malwareCount);\n                animateStatCard('stat-suspicious', stats.suspiciousCount);\n                animateStatCard('stat-benign', stats.benignCount);\n            } catch (error) {\n                console.error('Failed to load stats:', error);\n            }\n        }\n        \n        async function loadScans() {\n            try {\n                const response = await fetch('/api/scans?limit=50');\n                const data = await response.json();\n                \n                const tbody = document.getElementById('scans-tbody');\n                \n                if (data.scans.length === 0) {\n                    tbody.innerHTML = `\n                        <tr>\n                            <td colspan=\"5\" class=\"empty-state\">\n                                <i class=\"fas fa-inbox\"></i>\n                                <p>No scans yet. Waiting for clients...</p>\n                            </td>\n                        </tr>\n                    `;\n                    return;\n                }\n                \n                tbody.innerHTML = data.scans.map(scan => {\n                    const timestamp = new Date(scan.serverTimestamp).toLocaleString();\n                    const hash = scan.file_hashes?.sha256 || 'N/A';\n                    const hashShort = hash.length > 16 ? (hash.substring(0, 16) + '...') : hash;\n                    const isNonPe = scan.is_pe === false;\n                    const classification = isNonPe ? 'Non-PE' : (scan.classification || 'Unknown');\n                    const badgeClass = isNonPe ? 'non-pe' : classification.toLowerCase();\n                    const nonPeTag = isNonPe ? '<span class=\"badge non-pe\" title=\"Non-PE file\">Non-PE</span>' : '';\n                    return `\n                        <tr>\n                            <td>${timestamp}</td>\n                            <td>${scan.detected_filename} ${nonPeTag}</td>\n                            <td><span class=\"badge ${badgeClass}\">${classification}</span></td>\n                            <td>${scan.systemInfo?.ip || scan.clientIp || 'Unknown'}</td>\n                            <td class=\"hash\" title=\"${hash}\">${hashShort}</td>\n                        </tr>\n                    `;\n                }).join('');\n                \n            } catch (error) {\n                console.error('Failed to load scans:', error);\n            }\n        }\n        \n        async function loadDailyChart() {\n            try {\n                const response = await fetch(`/api/daily-scans?days=${currentChartDays}`);\n                const data = await response.json();\n                \n                const ctx = document.getElementById('dailyScansChart');\n                \n                // Format dates for display (MM/DD)\n                const labels = data.days.map(day => {\n                    const date = new Date(day.date);\n                    return `${date.getMonth() + 1}/${date.getDate()}`;\n                });\n                \n                // Reuse existing chart if it exists\n                if (dailyChart) {\n                    dailyChart.data.labels = labels;\n                    dailyChart.data.datasets[0].data = data.days.map(d => d.total);\n                    dailyChart.data.datasets[1].data = data.days.map(d => d.malware);\n                    dailyChart.data.datasets[2].data = data.days.map(d => d.suspicious);\n                    dailyChart.data.datasets[3].data = data.days.map(d => d.benign);\n                    dailyChart.update('none'); // Update without animation\n                    return;\n                }\n                \n                dailyChart = new Chart(ctx, {\n                    type: 'line',\n                    data: {\n                        labels: labels,\n                        datasets: [\n                            {\n                                label: 'Total Scans',\n                                data: data.days.map(d => d.total),\n                                borderColor: '#5a9cf8',\n                                backgroundColor: 'rgba(90, 156, 248, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Malware',\n                                data: data.days.map(d => d.malware),\n                                borderColor: '#ff4757',\n                                backgroundColor: 'rgba(255, 71, 87, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Suspicious',\n                                data: data.days.map(d => d.suspicious),\n                                borderColor: '#ffa502',\n                                backgroundColor: 'rgba(255, 165, 2, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Benign',\n                                data: data.days.map(d => d.benign),\n                                borderColor: '#26de81',\n                                backgroundColor: 'rgba(38, 222, 129, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        interaction: {\n                            mode: 'index',\n                            intersect: false,\n                        },\n                        plugins: {\n                            legend: {\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 12 }\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0',\n                                borderColor: 'rgba(255, 255, 255, 0.1)',\n                                borderWidth: 1\n                            }\n                        },\n                        scales: {\n                            x: {\n                                ticks: { \n                                    color: getCSSVar('--chart-text-color') || '#888',\n                                    maxRotation: 45,\n                                    minRotation: 45\n                                },\n                                grid: { \n                                    color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' \n                                }\n                            },\n                            y: {\n                                beginAtZero: true,\n                                ticks: { \n                                    color: getCSSVar('--chart-text-color') || '#888',\n                                    stepSize: 1\n                                },\n                                grid: { \n                                    color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' \n                                }\n                            }\n                        }\n                    }\n                });\n                \n            } catch (error) {\n                console.error('Failed to load daily chart:', error);\n            }\n        }\n        \n        let worldMap = null;\n        let markerLayer = null;\n        let heatmapLayer = null;\n        let choroplethLayer = null;\n        let mapInitialized = false;\n        let lastGeoDataHash = '';\n        let sourceChart = null;\n        let currentMapView = 'markers';\n        let geoDataCache = null;\n        let replayInterval = null;\n        \n        // Country boundaries for choropleth (simplified)\n        const countryCoordinates = {\n            'United States': { center: [37.0902, -95.7129], weight: 0 },\n            'China': { center: [35.8617, 104.1954], weight: 0 },\n            'United Kingdom': { center: [55.3781, -3.4360], weight: 0 },\n            'Germany': { center: [51.1657, 10.4515], weight: 0 },\n            'France': { center: [46.2276, 2.2137], weight: 0 },\n            'Russia': { center: [61.5240, 105.3188], weight: 0 },\n            'Japan': { center: [36.2048, 138.2529], weight: 0 },\n            'India': { center: [20.5937, 78.9629], weight: 0 },\n            'Brazil': { center: [-14.2350, -51.9253], weight: 0 },\n            'Australia': { center: [-25.2744, 133.7751], weight: 0 }\n        };\n        \n        function initializeMap() {\n            if (mapInitialized) return;\n            \n            try {\n                worldMap = L.map('worldMap', {\n                    zoomControl: true,\n                    scrollWheelZoom: true,\n                    preferCanvas: false,\n                    worldCopyJump: true\n                }).setView([20, 0], 2);\n                \n                // Use dark theme tiles\n                L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {\n                    attribution: '&copy; OpenStreetMap contributors',\n                    subdomains: 'abcd',\n                    maxZoom: 18,\n                    minZoom: 1,\n                    noWrap: false,\n                    bounds: [[-90, -180], [90, 180]]\n                }).addTo(worldMap);\n                \n                markerLayer = L.layerGroup().addTo(worldMap);\n                mapInitialized = true;\n                \n                // Fix map display after initialization\n                setTimeout(() => {\n                    if (worldMap) worldMap.invalidateSize();\n                }, 100);\n            } catch (error) {\n                console.error('Failed to initialize map:', error);\n            }\n        }\n        \n        // Switch between map visualization modes\n        window.switchMapView = function(view) {\n            currentMapView = view;\n            \n            // Update button states\n            document.querySelectorAll('.map-btn').forEach(btn => {\n                btn.classList.remove('active');\n            });\n            document.querySelector(`[data-view=\"${view}\"]`).classList.add('active');\n            \n            // Reload map with new view\n            if (geoDataCache) {\n                renderMapView(geoDataCache);\n            }\n        };\n        \n        // Render different map views\n        function renderMapView(data) {\n            if (!worldMap) return;\n            \n            // Clear all layers\n            if (markerLayer) markerLayer.clearLayers();\n            if (heatmapLayer) {\n                worldMap.removeLayer(heatmapLayer);\n                heatmapLayer = null;\n            }\n            if (choroplethLayer) {\n                worldMap.removeLayer(choroplethLayer);\n                choroplethLayer = null;\n            }\n            \n            switch (currentMapView) {\n                case 'markers':\n                    renderMarkers(data);\n                    break;\n                case 'heatmap':\n                    renderHeatmap(data);\n                    break;\n                case 'choropleth':\n                    renderChoropleth(data);\n                    break;\n            }\n            \n            updateGeoContext(data);\n        }\n        \n        // Render traditional markers\n        function renderMarkers(data) {\n            data.locations.forEach(location => {\n                const { lat, lng, city, country } = location.location;\n                \n                let markerColor = '#26de81'; // benign\n                if (location.malwareCount > 0) {\n                    markerColor = '#ff3b3b'; // malware\n                } else if (location.suspiciousCount > 0) {\n                    markerColor = '#ffd700'; // suspicious\n                }\n                \n                const markerSize = Math.min(24, Math.max(8, 8 + location.totalScans * 2));\n                \n                const marker = L.circleMarker([lat, lng], {\n                    radius: markerSize / 2,\n                    fillColor: markerColor,\n                    color: '#fff',\n                    weight: 2,\n                    opacity: 0.8,\n                    fillOpacity: 0.6\n                });\n                \n                const popupContent = `\n                    <div style=\"color: var(--text-primary); min-width: 200px;\">\n                        <h3 style=\"margin: 0 0 10px 0; color: var(--accent-green); font-size: 1.1rem;\">\n                            <i class=\"fas fa-map-marker-alt\" style=\"color: ${markerColor};\"></i>\n                            ${city}, ${country}\n                        </h3>\n                        <p style=\"margin: 5px 0;\"><strong>IP:</strong> ${location.ip}</p>\n                        <p style=\"margin: 5px 0;\"><strong>Total Scans:</strong> ${location.totalScans}</p>\n                        <div style=\"margin-top: 10px;\">\n                            <div><span style=\"color: #ff3b3b;\">‚óè</span> Malware: ${location.malwareCount}</div>\n                            <div><span style=\"color: #ffd700;\">‚óè</span> Suspicious: ${location.suspiciousCount}</div>\n                            <div><span style=\"color: #34d118;\">‚óè</span> Benign: ${location.benignCount}</div>\n                        </div>\n                        <button onclick=\"filterByLocation('${country}')\" \n                                style=\"margin-top: 10px; padding: 5px 10px; background: var(--accent-green); \n                                       color: var(--bg-primary); border: none; border-radius: 5px; cursor: pointer;\">\n                            Filter by ${country}\n                        </button>\n                    </div>\n                `;\n                \n                marker.bindPopup(popupContent);\n                marker.addTo(markerLayer);\n                \n                marker.on('mouseover', function() {\n                    this.setStyle({ fillOpacity: 0.9, opacity: 1 });\n                });\n                marker.on('mouseout', function() {\n                    this.setStyle({ fillOpacity: 0.6, opacity: 0.8 });\n                });\n            });\n        }\n        \n        // Render heatmap overlay\n        function renderHeatmap(data) {\n            const heatData = [];\n            \n            data.locations.forEach(location => {\n                const { lat, lng } = location.location;\n                // Weight by threat severity: malware = 1.0, suspicious = 0.5, benign = 0.2\n                const weight = (location.malwareCount * 1.0 + \n                               location.suspiciousCount * 0.5 + \n                               location.benignCount * 0.2) / location.totalScans;\n                \n                // Add multiple points for higher intensity\n                const intensity = Math.ceil(location.totalScans * weight);\n                for (let i = 0; i < intensity; i++) {\n                    heatData.push([lat, lng, weight]);\n                }\n            });\n            \n            heatmapLayer = L.heatLayer(heatData, {\n                radius: 35,\n                blur: 25,\n                maxZoom: 10,\n                max: 1.0,\n                gradient: {\n                    0.0: '#34d118',  // Green (low threat)\n                    0.3: '#ffd700',  // Yellow\n                    0.6: '#ffa502',  // Orange\n                    0.8: '#ff6348',  // Red\n                    1.0: '#ff3b3b'   // Bright red (high threat)\n                }\n            }).addTo(worldMap);\n        }\n        \n        // Render choropleth (country-level threat shading)\n        function renderChoropleth(data) {\n            // Aggregate threats by country\n            const countryStats = {};\n            data.locations.forEach(location => {\n                const country = location.location.country;\n                if (!countryStats[country]) {\n                    countryStats[country] = { total: 0, malware: 0, suspicious: 0 };\n                }\n                countryStats[country].total += location.totalScans;\n                countryStats[country].malware += location.malwareCount;\n                countryStats[country].suspicious += location.suspiciousCount;\n            });\n            \n            // Find max for normalization\n            const maxThreats = Math.max(...Object.values(countryStats).map(s => \n                s.malware + s.suspicious * 0.5\n            ));\n            \n            // Draw circles for countries with threat data\n            choroplethLayer = L.layerGroup();\n            \n            Object.entries(countryStats).forEach(([country, stats]) => {\n                if (countryCoordinates[country]) {\n                    const threatScore = (stats.malware + stats.suspicious * 0.5) / maxThreats;\n                    \n                    // Color gradient from green to red\n                    let color;\n                    if (threatScore < 0.2) color = '#34d118';\n                    else if (threatScore < 0.4) color = '#ffd700';\n                    else if (threatScore < 0.6) color = '#ffa502';\n                    else if (threatScore < 0.8) color = '#ff6348';\n                    else color = '#ff3b3b';\n                    \n                    const circle = L.circle(countryCoordinates[country].center, {\n                        color: color,\n                        fillColor: color,\n                        fillOpacity: 0.4,\n                        radius: 500000 * (1 + threatScore * 2),\n                        weight: 2\n                    });\n                    \n                    circle.bindPopup(`\n                        <div style=\"color: var(--text-primary);\">\n                            <h3 style=\"color: var(--accent-green);\">${country}</h3>\n                            <p><strong>Total Threats:</strong> ${stats.total}</p>\n                            <p><strong>Malware:</strong> ${stats.malware}</p>\n                            <p><strong>Suspicious:</strong> ${stats.suspicious}</p>\n                            <p><strong>Threat Level:</strong> ${(threatScore * 100).toFixed(0)}%</p>\n                        </div>\n                    `);\n                    \n                    circle.addTo(choroplethLayer);\n                }\n            });\n            \n            choroplethLayer.addTo(worldMap);\n        }\n        \n        // Update geographic context panel\n        function updateGeoContext(data) {\n            const countries = new Set(data.locations.map(l => l.location.country));\n            document.getElementById('activeRegions').textContent = countries.size;\n            \n            // Find hotspot (country with most threats)\n            const countryThreats = {};\n            data.locations.forEach(loc => {\n                const country = loc.location.country;\n                countryThreats[country] = (countryThreats[country] || 0) + \n                    loc.malwareCount + loc.suspiciousCount;\n            });\n            \n            const hotspot = Object.entries(countryThreats)\n                .sort((a, b) => b[1] - a[1])[0];\n            \n            if (hotspot) {\n                const percentage = ((hotspot[1] / data.locations.reduce((sum, l) => \n                    sum + l.malwareCount + l.suspiciousCount, 0)) * 100).toFixed(0);\n                document.getElementById('topRegion').textContent = \n                    `${hotspot[0]} (${percentage}% of threats)`;\n            }\n            \n            const totalThreats = data.locations.reduce((sum, l) => \n                sum + l.malwareCount + l.suspiciousCount, 0);\n            document.getElementById('geoThreatCount').textContent = totalThreats;\n        }\n        \n        // Filter dashboard by geographic location\n        window.filterByLocation = function(country) {\n            console.log(`Filtering by country: ${country}`);\n            // This would filter the tables and charts - simplified for demo\n            alert(`Geographic filtering activated for ${country}.\\nIn full implementation, this would filter all dashboard data.`);\n        };\n        \n        // Replay threats over last 24 hours\n        window.replayThreats = async function() {\n            const btn = document.getElementById('replayBtn');\n            const info = document.getElementById('timelineInfo');\n            \n            if (replayInterval) {\n                clearInterval(replayInterval);\n                replayInterval = null;\n                btn.innerHTML = '<i class=\"fas fa-play\"></i> Replay Last 24h';\n                info.textContent = 'Replay stopped';\n                if (geoDataCache) renderMapView(geoDataCache);\n                return;\n            }\n            \n            if (!geoDataCache || geoDataCache.locations.length === 0) {\n                info.textContent = 'No data available for replay';\n                return;\n            }\n            \n            btn.innerHTML = '<i class=\"fas fa-stop\"></i> Stop Replay';\n            info.textContent = 'Replaying threat detection timeline...';\n            \n            // Sort locations by timestamp\n            const sortedLocations = [...geoDataCache.locations].sort((a, b) => {\n                const timeA = a.scans[0]?.timestamp || 0;\n                const timeB = b.scans[0]?.timestamp || 0;\n                return new Date(timeA) - new Date(timeB);\n            });\n            \n            if (markerLayer) markerLayer.clearLayers();\n            let index = 0;\n            \n            replayInterval = setInterval(() => {\n                if (index >= sortedLocations.length) {\n                    clearInterval(replayInterval);\n                    replayInterval = null;\n                    btn.innerHTML = '<i class=\"fas fa-play\"></i> Replay Last 24h';\n                    info.textContent = 'Replay complete';\n                    return;\n                }\n                \n                const location = sortedLocations[index];\n                const { lat, lng, city, country } = location.location;\n                \n                let markerColor = location.malwareCount > 0 ? '#ff3b3b' : \n                                 location.suspiciousCount > 0 ? '#ffd700' : '#34d118';\n                \n                // Animated marker appearance\n                const marker = L.circleMarker([lat, lng], {\n                    radius: 0,\n                    fillColor: markerColor,\n                    color: '#fff',\n                    weight: 2,\n                    opacity: 1,\n                    fillOpacity: 0.8\n                }).addTo(markerLayer);\n                \n                // Animate marker growth\n                let size = 0;\n                const growInterval = setInterval(() => {\n                    size += 2;\n                    if (size >= 12) {\n                        clearInterval(growInterval);\n                        marker.setStyle({ opacity: 0.8, fillOpacity: 0.6 });\n                    }\n                    marker.setRadius(size / 2);\n                }, 50);\n                \n                marker.bindPopup(`\n                    <div style=\"color: var(--text-primary);\">\n                        <strong>${city}, ${country}</strong><br>\n                        ${location.scans[0]?.filename || 'Unknown file'}\n                    </div>\n                `);\n                \n                info.textContent = `Replaying: ${index + 1}/${sortedLocations.length} - ${city}, ${country}`;\n                index++;\n            }, 800); // Show new threat every 800ms\n        };\n        \n        async function loadGeoMap() {\n            try {\n                // Initialize map only once\n                if (!mapInitialized) {\n                    initializeMap();\n                }\n                \n                if (!worldMap) return;\n                \n                const response = await fetch('/api/geo-data');\n                const data = await response.json();\n                \n                // Generate hash of current data to detect changes\n                const currentHash = JSON.stringify(data.locations.map(l => \n                    `${l.ip}-${l.totalScans}-${l.malwareCount}-${l.suspiciousCount}`\n                )).substring(0, 100);\n                \n                // Skip update if data hasn't changed\n                if (currentHash === lastGeoDataHash && markerLayer && markerLayer.getLayers().length > 0) {\n                    return;\n                }\n                lastGeoDataHash = currentHash;\n                \n                // Cache data for replay and other features\n                geoDataCache = data;\n                \n                // Render current view\n                renderMapView(data);\n                \n                console.log(`Map updated with ${data.locations.length} locations in ${currentMapView} mode`);\n                \n            } catch (error) {\n                console.error('Failed to load geo map:', error);\n            }\n        }\n        \n        async function loadMalwareSources() {\n            try {\n                const response = await fetch('/api/malware-sources');\n                const data = await response.json();\n                \n                const ctx = document.getElementById('malwareSourceChart');\n                \n                const labels = data.sources.map(s => s.source);\n                const counts = data.sources.map(s => s.count);\n                \n                // Color scheme for different sources\n                const colors = [\n                    '#ff6b6b', // Email Attachment - red\n                    '#4ecdc4', // Web Download - teal\n                    '#ffe66d', // USB/External Drive - yellow\n                    '#a8dadc', // Internal Network - light blue\n                    '#95a5a6'  // Unknown - gray\n                ];\n                \n                // Reuse existing chart if it exists\n                if (sourceChart) {\n                    sourceChart.data.labels = labels;\n                    sourceChart.data.datasets[0].data = counts;\n                    sourceChart.update('none');\n                    return;\n                }\n                \n                sourceChart = new Chart(ctx, {\n                    type: 'pie',\n                    data: {\n                        labels: labels,\n                        datasets: [{\n                            data: counts,\n                            backgroundColor: colors,\n                            borderColor: '#1a1a2e',\n                            borderWidth: 2\n                        }]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: true,\n                        plugins: {\n                            legend: {\n                                position: 'bottom',\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 12 },\n                                    padding: 15\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0',\n                                borderColor: 'rgba(255, 255, 255, 0.1)',\n                                borderWidth: 1,\n                                callbacks: {\n                                    label: function(context) {\n                                        const label = context.label || '';\n                                        const value = context.parsed || 0;\n                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);\n                                        const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : 0;\n                                        return `${label}: ${value} (${percentage}%)`;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                });\n                \n            } catch (error) {\n                console.error('Failed to load malware sources:', error);\n            }\n        }\n        \n        // Graph 2: \"Noisiest\" Agents Over Time\n        let noisyAgentsChart = null;\n        async function loadNoisyAgentsChart() {\n            try {\n                const response = await fetch('/api/noisy-agents');\n                const data = await response.json();\n                \n                console.log('Noisy agents data:', data);\n                \n                const ctx = document.getElementById('noisyAgentsChart');\n                if (!ctx) return;\n                \n                // Show message if no data\n                if (!data.agents || data.agents.length === 0) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 2rem; text-align: center; color: var(--text-secondary);\">No agent data available yet. Start scanning files to see trends.</div>';\n                    return;\n                }\n                \n                const colors = [\n                    '#ff3b3b', '#34d118', '#ffd700', '#1e90ff', '#ff1493'\n                ];\n                \n                // Reuse existing chart if it exists\n                if (noisyAgentsChart) {\n                    noisyAgentsChart.data.labels = data.dates;\n                    noisyAgentsChart.data.datasets = data.agents.map((agent, idx) => ({\n                        label: agent.agentId,\n                        data: agent.counts,\n                        borderColor: colors[idx],\n                        backgroundColor: colors[idx] + '20',\n                        tension: 0.4,\n                        borderWidth: 2,\n                        fill: false\n                    }));\n                    noisyAgentsChart.update('none');\n                    return;\n                }\n                \n                noisyAgentsChart = new Chart(ctx, {\n                    type: 'line',\n                    data: {\n                        labels: data.dates,\n                        datasets: data.agents.map((agent, idx) => ({\n                            label: agent.agentId,\n                            data: agent.counts,\n                            borderColor: colors[idx],\n                            backgroundColor: colors[idx] + '20',\n                            tension: 0.4,\n                            borderWidth: 2,\n                            fill: false\n                        }))\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 11 }\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: getCSSVar('--chart-text-color') || '#888' },\n                                grid: { color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                ticks: { color: getCSSVar('--chart-text-color') || '#888' },\n                                grid: { color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load noisy agents chart:', error);\n                const ctx = document.getElementById('noisyAgentsChart');\n                if (ctx) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 2rem; text-align: center; color: var(--accent-red);\">Error loading chart data</div>';\n                }\n            }\n        }\n        \n        // Graph 3: Signature Status vs. Classification\n        let signatureClassChart = null;\n        async function loadSignatureClassChart() {\n            try {\n                const response = await fetch('/api/signature-classification');\n                const data = await response.json();\n                \n                console.log('Signature classification data:', data);\n                \n                const ctx = document.getElementById('signatureClassChart');\n                if (!ctx) {\n                    console.warn('signatureClassChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (signatureClassChart) {\n                    signatureClassChart.data.datasets[0].data = [data.benign.verified, data.suspicious.verified, data.malware.verified];\n                    signatureClassChart.data.datasets[1].data = [data.benign.unknown, data.suspicious.unknown, data.malware.unknown];\n                    signatureClassChart.data.datasets[2].data = [data.benign.untrusted, data.suspicious.untrusted, data.malware.untrusted];\n                    signatureClassChart.update('none');\n                    return;\n                }\n                \n                signatureClassChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: ['Benign', 'Suspicious', 'Malware'],\n                        datasets: [\n                            {\n                                label: 'Verified',\n                                data: [data.benign.verified, data.suspicious.verified, data.malware.verified],\n                                backgroundColor: '#34d118',\n                                stack: 'stack0'\n                            },\n                            {\n                                label: 'Unknown',\n                                data: [data.benign.unknown, data.suspicious.unknown, data.malware.unknown],\n                                backgroundColor: '#ffd700',\n                                stack: 'stack0'\n                            },\n                            {\n                                label: 'Untrusted',\n                                data: [data.benign.untrusted, data.suspicious.untrusted, data.malware.untrusted],\n                                backgroundColor: '#ff3b3b',\n                                stack: 'stack0'\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                callbacks: {\n                                    label: function(context) {\n                                        const total = context.chart.data.datasets\n                                            .reduce((sum, ds) => sum + ds.data[context.dataIndex], 0);\n                                        const percentage = ((context.parsed.y / total) * 100).toFixed(1);\n                                        return `${context.dataset.label}: ${context.parsed.y} (${percentage}%)`;\n                                    }\n                                }\n                            }\n                        },\n                        scales: {\n                            y: {\n                                stacked: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                stacked: true,\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load signature classification chart:', error);\n                const ctx = document.getElementById('signatureClassChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 4: Packer Usage vs. Classification\n        let packerClassChart = null;\n        async function loadPackerClassChart() {\n            try {\n                const response = await fetch('/api/packer-classification');\n                const data = await response.json();\n                \n                console.log('Packer classification data:', data);\n                \n                const ctx = document.getElementById('packerClassChart');\n                if (!ctx) {\n                    console.warn('packerClassChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (packerClassChart) {\n                    packerClassChart.data.labels = data.packers;\n                    packerClassChart.data.datasets[0].data = data.benignCounts;\n                    packerClassChart.data.datasets[1].data = data.malwareCounts;\n                    packerClassChart.update('none');\n                    return;\n                }\n                \n                packerClassChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: data.packers,\n                        datasets: [\n                            {\n                                label: 'Benign Files',\n                                data: data.benignCounts,\n                                backgroundColor: '#34d118'\n                            },\n                            {\n                                label: 'Malware Files',\n                                data: data.malwareCounts,\n                                backgroundColor: '#ff3b3b'\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load packer classification chart:', error);\n                const ctx = document.getElementById('packerClassChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 5: Confidence Score Histogram\n        let confidenceHistChart = null;\n        async function loadConfidenceHistChart() {\n            try {\n                const response = await fetch('/api/confidence-distribution');\n                const data = await response.json();\n                \n                console.log('Confidence distribution data:', data);\n                \n                const ctx = document.getElementById('confidenceHistChart');\n                if (!ctx) {\n                    console.warn('confidenceHistChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (confidenceHistChart) {\n                    confidenceHistChart.data.labels = data.bins;\n                    confidenceHistChart.data.datasets[0].data = data.counts;\n                    confidenceHistChart.update('none');\n                    return;\n                }\n                \n                confidenceHistChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: data.bins,\n                        datasets: [{\n                            label: 'Scan Count',\n                            data: data.counts,\n                            backgroundColor: '#34d118',\n                            borderColor: '#2ed60f',\n                            borderWidth: 1\n                        }]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' },\n                                title: {\n                                    display: true,\n                                    text: 'Number of Scans',\n                                    color: '#888'\n                                }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false },\n                                title: {\n                                    display: true,\n                                    text: 'Confidence Score Range',\n                                    color: '#888'\n                                }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load confidence histogram:', error);\n                const ctx = document.getElementById('confidenceHistChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 6: File Entropy Distribution (Box Plot simulation)\n        let entropyBoxChart = null;\n        async function loadEntropyBoxChart() {\n            try {\n                const response = await fetch('/api/entropy-distribution');\n                const data = await response.json();\n                \n                console.log('Entropy distribution data:', data);\n                \n                const ctx = document.getElementById('entropyBoxChart');\n                if (!ctx) {\n                    console.warn('entropyBoxChart canvas not found');\n                    return;\n                }\n                \n                // Create violin/box plot effect with multiple bars\n                const benignData = [\n                    data.benign.min,\n                    data.benign.q1,\n                    data.benign.median,\n                    data.benign.q3,\n                    data.benign.max\n                ];\n                \n                const malwareData = [\n                    data.malware.min,\n                    data.malware.q1,\n                    data.malware.median,\n                    data.malware.q3,\n                    data.malware.max\n                ];\n                \n                // Reuse existing chart if it exists\n                if (entropyBoxChart) {\n                    entropyBoxChart.data.datasets[0].data = benignData;\n                    entropyBoxChart.data.datasets[1].data = malwareData;\n                    entropyBoxChart.update('none');\n                    return;\n                }\n                \n                entropyBoxChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: ['Min', 'Q1', 'Median', 'Q3', 'Max'],\n                        datasets: [\n                            {\n                                label: 'Benign Files',\n                                data: benignData,\n                                backgroundColor: '#34d118',\n                                borderColor: '#2ed60f',\n                                borderWidth: 1\n                            },\n                            {\n                                label: 'Malware Files',\n                                data: malwareData,\n                                backgroundColor: '#ff3b3b',\n                                borderColor: '#cc2f2f',\n                                borderWidth: 1\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                callbacks: {\n                                    label: function(context) {\n                                        return `${context.dataset.label}: ${context.parsed.y.toFixed(3)}`;\n                                    }\n                                }\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                max: 8.0,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' },\n                                title: {\n                                    display: true,\n                                    text: 'Entropy Value',\n                                    color: '#888'\n                                }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load entropy distribution chart:', error);\n                const ctx = document.getElementById('entropyBoxChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        async function loadEmergingThreats() {\n            try {\n                const response = await fetch('/api/emerging-threats');\n                const data = await response.json();\n                \n                // Update summary badges\n                document.getElementById('eti-total').textContent = \n                    `${data.summary.totalThreats} Total Threats`;\n                document.getElementById('eti-recent').textContent = \n                    `${data.summary.recentThreats} Last 24h`;\n                \n                // Helper to render IOC list\n                const renderIOCList = (items, container) => {\n                    if (items.length === 0) {\n                        container.innerHTML = '<div class=\"eti-empty\">No threats detected</div>';\n                        return;\n                    }\n                    \n                    container.innerHTML = items.map((item, index) => {\n                        const rank = index + 1;\n                        const recentBadge = item.recent > 0 ? \n                            `<span class=\"eti-recent-badge\">${item.recent} recent</span>` : '';\n                        const agentBadge = item.agents > 0 ? \n                            `<span class=\"eti-agent-badge\">${item.agents} agents</span>` : '';\n                        \n                        return `\n                            <div class=\"eti-item\" data-rank=\"${rank}\">\n                                <div class=\"eti-rank\">${rank}</div>\n                                <div class=\"eti-content\">\n                                    <div class=\"eti-name\">${item.name}</div>\n                                    <div class=\"eti-meta\">\n                                        <span class=\"eti-count\">${item.count} occurrences</span>\n                                        ${recentBadge}\n                                        ${agentBadge}\n                                    </div>\n                                    ${item.details && item.details.length > 0 ? `\n                                        <div class=\"eti-details\">\n                                            ${item.details.slice(0, 2).join(', ')}\n                                            ${item.details.length > 2 ? '...' : ''}\n                                        </div>\n                                    ` : ''}\n                                </div>\n                            </div>\n                        `;\n                    }).join('');\n                };\n                \n                // Render each section\n                renderIOCList(data.topMalwareFamilies, document.getElementById('eti-malware'));\n                renderIOCList(data.topSuspiciousAPIs, document.getElementById('eti-apis'));\n                renderIOCList(data.topMaliciousStrings, document.getElementById('eti-strings'));\n                renderIOCList(data.topPackers, document.getElementById('eti-packers'));\n                \n            } catch (error) {\n                console.error('Failed to load emerging threats:', error);\n            }\n        }\n        \n        async function analyzeThreatModel() {\n            try {\n                // Get selected values\n                const fileType = document.getElementById('model-filetype').value;\n                const packer = document.getElementById('model-packer').value;\n                const signature = document.getElementById('model-signature').value;\n                \n                // Get multiple selections\n                const apisSelect = document.getElementById('model-apis');\n                const apiImports = Array.from(apisSelect.selectedOptions).map(opt => opt.value);\n                \n                const stringsSelect = document.getElementById('model-strings');\n                const keyStrings = Array.from(stringsSelect.selectedOptions).map(opt => opt.value);\n                \n                // Validate\n                if (apiImports.length === 0) {\n                    alert('Please select at least one API import');\n                    return;\n                }\n                if (keyStrings.length === 0) {\n                    alert('Please select at least one suspicious string');\n                    return;\n                }\n                \n                // Show loading state\n                const outputDiv = document.getElementById('modeler-output');\n                outputDiv.innerHTML = `\n                    <div class=\"modeler-loading\">\n                        <i class=\"fas fa-spinner fa-spin\"></i>\n                        <p>Analyzing threat profile...</p>\n                    </div>\n                `;\n                \n                // Send to server\n                const response = await fetch('/api/threat-model', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                        fileType,\n                        packer,\n                        signature,\n                        apiImports,\n                        keyStrings\n                    })\n                });\n                \n                const data = await response.json();\n                \n                if (data.success) {\n                    const result = data.result;\n                    const classColor = \n                        result.classification === 'Malware' ? '#ff4757' :\n                        result.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n                    \n                    outputDiv.innerHTML = `\n                        <div class=\"prediction-result\">\n                            <div class=\"prediction-header\">\n                                <div class=\"prediction-badge\" style=\"background: ${classColor};\">\n                                    ${result.classification.toUpperCase()}\n                                </div>\n                                <div class=\"prediction-confidence\">\n                                    <div class=\"confidence-label\">Confidence Score</div>\n                                    <div class=\"confidence-value\">${(parseFloat(result.confidence_score) * 100).toFixed(1)}%</div>\n                                </div>\n                            </div>\n                            \n                            ${result.malware_family ? `\n                                <div class=\"prediction-family\">\n                                    <strong>Predicted Malware Family:</strong>\n                                    <span class=\"family-name\">${result.malware_family}</span>\n                                </div>\n                            ` : ''}\n                            \n                            <div class=\"prediction-section\">\n                                <h4>Threat Analysis</h4>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-file\"></i>\n                                    <span><strong>File Type:</strong> ${result.key_findings.file_type}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-box\"></i>\n                                    <span><strong>Packer:</strong> ${result.key_findings.packer_detected}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-certificate\"></i>\n                                    <span><strong>Signature:</strong> ${result.key_findings.signature.name}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-tachometer-alt\"></i>\n                                    <span><strong>Threat Score:</strong> ${result.key_findings.threat_score}/100</span>\n                                </div>\n                            </div>\n                            \n                            <div class=\"prediction-section\">\n                                <h4>Detected Indicators</h4>\n                                <div class=\"indicator-group\">\n                                    <strong>API Imports:</strong>\n                                    <div class=\"indicator-list\">\n                                        ${result.key_findings.api_imports.map(api => \n                                            `<span class=\"indicator-tag api-tag\">${api}</span>`\n                                        ).join('')}\n                                    </div>\n                                </div>\n                                <div class=\"indicator-group\">\n                                    <strong>Suspicious Strings:</strong>\n                                    <div class=\"indicator-list\">\n                                        ${result.key_findings.key_strings.map(str => \n                                            `<span class=\"indicator-tag string-tag\">${str}</span>`\n                                        ).join('')}\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"prediction-footer\">\n                                <i class=\"fas fa-info-circle\"></i>\n                                This analysis has been added to the scan results and will appear in all visualizations.\n                            </div>\n                        </div>\n                    `;\n                } else {\n                    outputDiv.innerHTML = `\n                        <div class=\"modeler-error\">\n                            <i class=\"fas fa-exclamation-circle\"></i>\n                            <p>Analysis failed: ${data.error}</p>\n                        </div>\n                    `;\n                }\n                \n            } catch (error) {\n                console.error('Failed to analyze threat model:', error);\n                document.getElementById('modeler-output').innerHTML = `\n                    <div class=\"modeler-error\">\n                        <i class=\"fas fa-exclamation-circle\"></i>\n                        <p>Analysis failed. Please try again.</p>\n                    </div>\n                `;\n            }\n        }\n        \n        let graphSimulation = null;\n        let graphSvg = null;\n        \n        async function loadCorrelationGraph() {\n            try {\n                const response = await fetch('/api/threat-correlations');\n                const data = await response.json();\n                \n                // Clear existing graph\n                d3.select('#correlationGraph').selectAll('*').remove();\n                \n                const container = document.getElementById('correlationGraph');\n                const width = container.clientWidth;\n                const height = 600;\n                \n                // Create SVG\n                graphSvg = d3.select('#correlationGraph')\n                    .append('svg')\n                    .attr('width', width)\n                    .attr('height', height)\n                    .style('background', '#0a0a0a')\n                    .style('border-radius', '8px');\n                \n                const g = graphSvg.append('g');\n                \n                // Add zoom behavior\n                const zoom = d3.zoom()\n                    .scaleExtent([0.1, 4])\n                    .on('zoom', (event) => {\n                        g.attr('transform', event.transform);\n                    });\n                \n                graphSvg.call(zoom);\n                \n                // Color schemes for different node types\n                const colorMap = {\n                    malware: '#ff4757',\n                    agent: '#5a9cf8',\n                    api: '#ffa502',\n                    string: '#26de81'\n                };\n                \n                // Create force simulation\n                graphSimulation = d3.forceSimulation(data.nodes)\n                    .force('link', d3.forceLink(data.links)\n                        .id(d => d.id)\n                        .distance(d => d.type === 'correlated_with' ? 200 : 100)\n                        .strength(d => d.strength * 0.3))\n                    .force('charge', d3.forceManyBody().strength(-300))\n                    .force('center', d3.forceCenter(width / 2, height / 2))\n                    .force('collision', d3.forceCollide().radius(30));\n                \n                // Draw links\n                const link = g.append('g')\n                    .selectAll('line')\n                    .data(data.links)\n                    .enter()\n                    .append('line')\n                    .attr('stroke', d => {\n                        if (d.type === 'correlated_with') return '#ff6b6b';\n                        if (d.type === 'detected_by') return '#5a9cf8';\n                        if (d.type === 'uses_api') return '#ffa502';\n                        return '#26de81';\n                    })\n                    .attr('stroke-width', d => Math.sqrt(d.strength) + 1)\n                    .attr('stroke-opacity', 0.6);\n                \n                // Draw nodes\n                const node = g.append('g')\n                    .selectAll('circle')\n                    .data(data.nodes)\n                    .enter()\n                    .append('circle')\n                    .attr('r', d => {\n                        if (d.type === 'malware') return 15 + Math.min(d.count * 2, 15);\n                        if (d.type === 'agent') return 12 + Math.min(d.count, 10);\n                        return 8 + Math.min(d.count, 8);\n                    })\n                    .attr('fill', d => colorMap[d.type])\n                    .attr('stroke', '#fff')\n                    .attr('stroke-width', 2)\n                    .style('cursor', 'pointer')\n                    .call(d3.drag()\n                        .on('start', dragstarted)\n                        .on('drag', dragged)\n                        .on('end', dragended))\n                    .on('click', (event, d) => showNodeDetails(d, data))\n                    .on('mouseover', function(event, d) {\n                        d3.select(this)\n                            .transition()\n                            .duration(200)\n                            .attr('stroke-width', 4)\n                            .attr('r', function() {\n                                const currentR = parseFloat(d3.select(this).attr('r'));\n                                return currentR * 1.3;\n                            });\n                    })\n                    .on('mouseout', function(event, d) {\n                        d3.select(this)\n                            .transition()\n                            .duration(200)\n                            .attr('stroke-width', 2)\n                            .attr('r', function() {\n                                if (d.type === 'malware') return 15 + Math.min(d.count * 2, 15);\n                                if (d.type === 'agent') return 12 + Math.min(d.count, 10);\n                                return 8 + Math.min(d.count, 8);\n                            });\n                    });\n                \n                // Add labels\n                const label = g.append('g')\n                    .selectAll('text')\n                    .data(data.nodes)\n                    .enter()\n                    .append('text')\n                    .text(d => d.label.length > 20 ? d.label.substring(0, 20) + '...' : d.label)\n                    .attr('font-size', d => d.type === 'malware' ? '12px' : '10px')\n                    .attr('fill', '#e0e0e0')\n                    .attr('text-anchor', 'middle')\n                    .attr('dy', d => {\n                        if (d.type === 'malware') return 35;\n                        if (d.type === 'agent') return 25;\n                        return 20;\n                    })\n                    .style('pointer-events', 'none')\n                    .style('font-weight', d => d.type === 'malware' ? 'bold' : 'normal');\n                \n                // Update positions on simulation tick\n                graphSimulation.on('tick', () => {\n                    link\n                        .attr('x1', d => d.source.x)\n                        .attr('y1', d => d.source.y)\n                        .attr('x2', d => d.target.x)\n                        .attr('y2', d => d.target.y);\n                    \n                    node\n                        .attr('cx', d => d.x)\n                        .attr('cy', d => d.y);\n                    \n                    label\n                        .attr('x', d => d.x)\n                        .attr('y', d => d.y);\n                });\n                \n                // Drag functions\n                function dragstarted(event, d) {\n                    if (!event.active) graphSimulation.alphaTarget(0.3).restart();\n                    d.fx = d.x;\n                    d.fy = d.y;\n                }\n                \n                function dragged(event, d) {\n                    d.fx = event.x;\n                    d.fy = event.y;\n                }\n                \n                function dragended(event, d) {\n                    if (!event.active) graphSimulation.alphaTarget(0);\n                    d.fx = null;\n                    d.fy = null;\n                }\n                \n                console.log(`Correlation graph loaded: ${data.nodes.length} nodes, ${data.links.length} links`);\n                \n            } catch (error) {\n                console.error('Failed to load correlation graph:', error);\n            }\n        }\n        \n        function showNodeDetails(node, graphData) {\n            const detailsPanel = document.getElementById('nodeDetails');\n            const detailsTitle = document.getElementById('detailsTitle');\n            const detailsContent = document.getElementById('detailsContent');\n            \n            detailsTitle.textContent = node.label;\n            \n            let html = `<p><strong>Type:</strong> ${node.type.toUpperCase()}</p>`;\n            html += `<p><strong>Occurrences:</strong> ${node.count}</p>`;\n            \n            // Find connections\n            const connections = graphData.links.filter(l => \n                l.source.id === node.id || l.target.id === node.id\n            );\n            \n            if (connections.length > 0) {\n                html += `<p><strong>Connections:</strong> ${connections.length}</p>`;\n                html += '<ul style=\"margin: 10px 0; padding-left: 20px;\">';\n                connections.slice(0, 10).forEach(link => {\n                    const otherNode = link.source.id === node.id ? link.target : link.source;\n                    html += `<li>${link.type.replace(/_/g, ' ')}: ${otherNode.label}</li>`;\n                });\n                if (connections.length > 10) {\n                    html += `<li>...and ${connections.length - 10} more</li>`;\n                }\n                html += '</ul>';\n            }\n            \n            if (node.details && node.details.length > 0) {\n                html += '<p><strong>Associated Files:</strong></p>';\n                html += '<ul style=\"margin: 10px 0; padding-left: 20px; max-height: 150px; overflow-y: auto;\">';\n                node.details.slice(0, 10).forEach(file => {\n                    html += `<li>${file}</li>`;\n                });\n                if (node.details.length > 10) {\n                    html += `<li>...and ${node.details.length - 10} more</li>`;\n                }\n                html += '</ul>';\n            }\n            \n            detailsContent.innerHTML = html;\n            detailsPanel.style.display = 'block';\n        }\n        \n        function resetGraph() {\n            if (graphSimulation) {\n                graphSimulation.alpha(1).restart();\n            }\n        }\n        \n        function centerGraph() {\n            if (graphSvg) {\n                graphSvg.transition().duration(750).call(\n                    d3.zoom().transform,\n                    d3.zoomIdentity\n                );\n            }\n        }\n        \n        function setChartDays(days) {\n            currentChartDays = days;\n            \n            // Update button states\n            document.querySelectorAll('.chart-btn').forEach(btn => {\n                btn.classList.remove('active');\n            });\n            event.target.classList.add('active');\n            \n            loadDailyChart();\n        }\n        \n        function loadData() {\n            loadStats();\n            loadScans();\n            // Heavy components loaded lazily - see switchView()\n        }\n        \n        function loadDataWithoutMap() {\n            loadStats();\n            loadScans();\n        }\n        \n        // Track which analytics have been loaded\n        let analyticsLoaded = false;\n        \n        function loadAnalytics() {\n            console.log('Loading analytics view...');\n            loadDailyChart();\n            loadMalwareSources();\n            loadNoisyAgentsChart();\n            loadSignatureClassChart();\n            loadPackerClassChart();\n            loadConfidenceHistChart();\n            loadEntropyBoxChart();\n            loadEmergingThreats();\n            loadCorrelationGraph();\n            loadGeoMap();\n            \n            analyticsLoaded = true;\n        }\n        \n        // Initial load - only dashboard essentials\n        loadData();\n        \n        // Auto-scroll functionality with visual indicators\n        const scrollIndicatorUp = document.createElement('div');\n        scrollIndicatorUp.className = 'scroll-indicator scroll-up';\n        scrollIndicatorUp.innerHTML = '<i class=\"fas fa-chevron-up\"></i>';\n        document.body.appendChild(scrollIndicatorUp);\n        \n        const scrollIndicatorDown = document.createElement('div');\n        scrollIndicatorDown.className = 'scroll-indicator scroll-down';\n        scrollIndicatorDown.innerHTML = '<i class=\"fas fa-chevron-down\"></i>';\n        document.body.appendChild(scrollIndicatorDown);\n        \n        let pageScrollInterval = null;\n        const scrollSpeed = 3;\n        const triggerZone = 80; // pixels from top/bottom\n        \n        function handleAutoScroll(event) {\n            // Don't auto-scroll if page is hidden\n            if (document.hidden) return;\n            \n            const mouseY = event.clientY;\n            const windowHeight = window.innerHeight;\n            \n            // Check if near top\n            if (mouseY < triggerZone) {\n                scrollIndicatorUp.classList.add('visible');\n                scrollIndicatorDown.classList.remove('visible');\n                \n                if (!pageScrollInterval) {\n                    pageScrollInterval = setInterval(() => {\n                        if (document.hidden) {\n                            stopAutoScroll();\n                            return;\n                        }\n                        window.scrollBy({\n                            top: -scrollSpeed,\n                            behavior: 'auto'\n                        });\n                    }, 16); // ~60fps\n                }\n            }\n            // Check if near bottom\n            else if (mouseY > windowHeight - triggerZone) {\n                scrollIndicatorDown.classList.add('visible');\n                scrollIndicatorUp.classList.remove('visible');\n                \n                if (!pageScrollInterval) {\n                    pageScrollInterval = setInterval(() => {\n                        if (document.hidden) {\n                            stopAutoScroll();\n                            return;\n                        }\n                        window.scrollBy({\n                            top: scrollSpeed,\n                            behavior: 'auto'\n                        });\n                    }, 16);\n                }\n            }\n            // In neutral zone\n            else {\n                scrollIndicatorUp.classList.remove('visible');\n                scrollIndicatorDown.classList.remove('visible');\n                \n                if (pageScrollInterval) {\n                    clearInterval(pageScrollInterval);\n                    pageScrollInterval = null;\n                }\n            }\n        }\n        \n        function stopAutoScroll() {\n            scrollIndicatorUp.classList.remove('visible');\n            scrollIndicatorDown.classList.remove('visible');\n            \n            if (pageScrollInterval) {\n                clearInterval(pageScrollInterval);\n                pageScrollInterval = null;\n            }\n        }\n        \n        // Attach event listeners\n        document.addEventListener('mousemove', handleAutoScroll);\n        document.addEventListener('mouseleave', stopAutoScroll);\n        \n        // Stop scrolling when reaching top or bottom\n        let lastScrollTop = 0;\n        window.addEventListener('scroll', () => {\n            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n            const scrollHeight = document.documentElement.scrollHeight;\n            const clientHeight = document.documentElement.clientHeight;\n            \n            // At top\n            if (scrollTop === 0 && lastScrollTop > 0) {\n                stopAutoScroll();\n            }\n            // At bottom\n            if (scrollTop + clientHeight >= scrollHeight - 5) {\n                stopAutoScroll();\n            }\n            \n            lastScrollTop = scrollTop;\n        });\n        \n        // Set up Server-Sent Events for real-time updates\n        const eventSource = new EventSource('/api/events');\n        let updateDebounceTimer = null;\n        let pollingInterval = null;\n        let pendingUpdates = false;\n        \n        eventSource.onmessage = function(event) {\n            const data = JSON.parse(event.data);\n            \n            if (data.type === 'connected') {\n                console.log('Connected to server for real-time updates');\n            } else if (data.type === 'new-scan') {\n                console.log('New scan received:', data.scan.detected_filename);\n                \n                // Show notification toast\n                showThreatNotification(data.scan);\n                \n                // Add to threat ticker\n                addToThreatTicker(data.scan);\n                \n                // Debounce: batch multiple rapid scans into single update\n                pendingUpdates = true;\n                clearTimeout(updateDebounceTimer);\n                updateDebounceTimer = setTimeout(() => {\n                    if (pendingUpdates) {\n                        // Only reload lightweight data (stats + scan list)\n                        loadStats();\n                        loadScans();\n                        \n                        // If analytics view is open, refresh analytics too\n                        if (currentView === 'analytics' && analyticsLoaded) {\n                            loadAnalytics();\n                        }\n                        \n                        pendingUpdates = false;\n                        \n                        // Throttle map updates to once per 15 seconds\n                        if (!window.lastMapUpdate || Date.now() - window.lastMapUpdate > 15000) {\n                            loadGeoMap();\n                            window.lastMapUpdate = Date.now();\n                        }\n                    }\n                }, 1000); // Wait 1 second after last scan\n            }\n        };\n        \n        eventSource.onerror = function(error) {\n            console.error('SSE Error:', error);\n            // Fallback: reload data every 30 seconds if SSE connection fails (only once!)\n            if (eventSource.readyState === EventSource.CLOSED && !pollingInterval) {\n                console.log('SSE connection closed, falling back to polling...');\n                pollingInterval = setInterval(() => {\n                    loadStats();\n                    loadScans();\n                }, 30000);\n            }\n        };\n        \n        // Manual refresh button functionality\n        window.manualRefresh = function() {\n            loadData();\n        };\n    </script>\n    \n    <!-- Theme Toggle Script -->\n    <script>\n        // Theme Toggle Functionality\n        window.toggleTheme = function() {\n            const html = document.documentElement;\n            const currentTheme = html.getAttribute('data-theme');\n            const newTheme = currentTheme === 'light' ? '' : 'light';\n            \n            if (newTheme) {\n                html.setAttribute('data-theme', newTheme);\n            } else {\n                html.removeAttribute('data-theme');\n            }\n            localStorage.setItem('theme', newTheme || 'dark');\n            \n            // Update button icon and text\n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            if (newTheme === 'light') {\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n            } else {\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n            }\n        };\n        \n        // Load saved theme on page load\n        (function() {\n            const savedTheme = localStorage.getItem('theme') || 'dark';\n            if (savedTheme === 'light') {\n                document.documentElement.setAttribute('data-theme', 'light');\n            }\n            \n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            if (savedTheme === 'light') {\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n            } else {\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n            }\n        })();\n    </script>\n</body>\n</html>","epoch":43,"telemetryInfo":{}}],["file:///home/trang/localnsv/mAIware-server/public/dashboard.html::request_d6846186-7601-45b3-9fc2-c861c84e6ee9",{"uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/dashboard.html","external":"file:///home/trang/localnsv/mAIware-server/public/dashboard.html","path":"/home/trang/localnsv/mAIware-server/public/dashboard.html","scheme":"file"},"requestId":"request_d6846186-7601-45b3-9fc2-c861c84e6ee9","content":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>mAIware Server Dashboard</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n    <link rel=\"stylesheet\" href=\"styles.css?v=3.0\">\n    <!-- Add Chart.js -->\n    <script src=\"https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js\"></script>\n    <!-- Add Leaflet.js for maps -->\n    <link rel=\"stylesheet\" href=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css\" />\n    <script src=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js\"></script>\n    <!-- Add Leaflet Heatmap Plugin -->\n    <script src=\"https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js\"></script>\n    <!-- Add D3.js for force-directed graph -->\n    <script src=\"https://d3js.org/d3.v7.min.js\"></script>\n    <!-- Add html2canvas for screenshots -->\n    <script src=\"https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js\"></script>\n</head>\n<body>\n    <!-- Theme Toggle Button -->\n    <button class=\"theme-toggle\" id=\"themeToggle\" onclick=\"toggleTheme()\">\n        <span class=\"icon\" id=\"themeIcon\">üåô</span>\n        <span id=\"themeText\">Dark</span>\n    </button>\n\n    <!-- Back to Top Button -->\n    <button class=\"back-to-top\" id=\"backToTop\" onclick=\"scrollToTop()\">\n        <i class=\"fas fa-arrow-up\"></i>\n    </button>\n\n    <!-- Preview Backdrop -->\n    <div class=\"preview-backdrop\" id=\"previewBackdrop\"></div>\n\n    <!-- Side Navigation Panel -->\n    <div class=\"side-panel\" id=\"sidePanel\">\n        <!-- Logo Icon (always visible) -->\n        <div class=\"panel-icon-strip\">\n            <div class=\"panel-logo-icon\">\n                <i class=\"fas fa-shield-virus\"></i>\n            </div>\n        </div>\n        \n        <!-- Analytics Preview Panel (slides out on hover) -->\n        <div class=\"graphs-preview\" id=\"graphsPreview\">\n            <div class=\"preview-header\">\n                <h3><i class=\"fas fa-chart-line\"></i> Analytics Preview</h3>\n                <p>Click anywhere to view full analytics</p>\n            </div>\n            \n            <!-- Scaled-down live view of analytics -->\n            <div class=\"analytics-miniview\" id=\"analyticsMiniview\" onclick=\"switchView('analytics')\">\n                <div class=\"miniview-preview\">\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box large\">\n                            <div class=\"box-header\">Global Threat Map</div>\n                            <div class=\"box-content map-visual\">\n                                <div class=\"map-dot\" style=\"top: 30%; left: 40%;\"></div>\n                                <div class=\"map-dot\" style=\"top: 60%; left: 70%;\"></div>\n                                <div class=\"map-dot\" style=\"top: 45%; left: 25%;\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box large\">\n                            <div class=\"box-header\">Attack Timeline</div>\n                            <div class=\"box-content chart-visual\">\n                                <div class=\"chart-bar\" style=\"height: 40%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 70%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 55%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 85%;\"></div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Top Threats</div>\n                            <div class=\"box-content list-visual\">\n                                <div class=\"list-item\"></div>\n                                <div class=\"list-item\"></div>\n                                <div class=\"list-item\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Correlations</div>\n                            <div class=\"box-content network-visual\">\n                                <div class=\"network-node\" style=\"top: 30%; left: 30%;\"></div>\n                                <div class=\"network-node\" style=\"top: 60%; left: 50%;\"></div>\n                                <div class=\"network-node\" style=\"top: 45%; left: 70%;\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Heatmap</div>\n                            <div class=\"box-content heat-visual\"></div>\n                        </div>\n                    </div>\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box wide\">\n                            <div class=\"box-header\">File Analysis & Distribution</div>\n                            <div class=\"box-content pie-visual\">\n                                <div class=\"pie-chart\"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"miniview-overlay\">\n                    <i class=\"fas fa-expand-alt\"></i>\n                    <span>Click to view analytics</span>\n                </div>\n            </div>                <!-- Home Navigation Button -->\n                <div class=\"preview-home-nav\" id=\"homeNavBtn\" onclick=\"switchView('dashboard')\">\n                    <i class=\"fas fa-home\"></i>\n                    <span>Back to Dashboard</span>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"main-content\" id=\"mainContent\">\n        <!-- DASHBOARD VIEW -->\n        <div class=\"view-container active\" id=\"dashboardView\">\n            <header class=\"dashboard-header\">\n                <div class=\"header-content\">\n                    <h1><i class=\"fas fa-shield-virus pulse-icon\"></i> mAIware Server</h1>\n                    <p class=\"subtitle\">Real-time Malware Analysis Dashboard</p>\n                </div>\n            </header>\n            \n            <!-- Real-time Threat Ticker -->\n            <div class=\"threat-ticker-container animate-slide-in\">\n                <div class=\"ticker-label\">\n                    <i class=\"fas fa-broadcast-tower pulse-icon\"></i>\n                    <span>LIVE THREAT FEED</span>\n                </div>\n                <div class=\"threat-ticker\" id=\"threat-ticker\">\n                    <div class=\"ticker-content\" id=\"ticker-content\">\n                        <span class=\"ticker-item\">System ready - Monitoring for threats...</span>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Notification Toast Container -->\n            <div id=\"notification-container\" class=\"notification-container\"></div>\n            \n            <!-- Stats Grid -->\n            <div class=\"stats-grid animate-fade-in\" id=\"stats-grid\">\n                <div class=\"stat-card info\">\n                    <i class=\"fas fa-laptop\"></i>\n                    <span class=\"stat-number\" id=\"stat-clients\">0</span>\n                    <span class=\"stat-label\">Active Clients</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card info\">\n                    <i class=\"fas fa-chart-line\"></i>\n                    <span class=\"stat-number\" id=\"stat-total\">0</span>\n                    <span class=\"stat-label\">Total Scans</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card malware\">\n                    <i class=\"fas fa-bug\"></i>\n                    <span class=\"stat-number\" id=\"stat-malware\">0</span>\n                    <span class=\"stat-label\">Malware</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card suspicious\">\n                    <i class=\"fas fa-exclamation-triangle\"></i>\n                    <span class=\"stat-number\" id=\"stat-suspicious\">0</span>\n                    <span class=\"stat-label\">Suspicious</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card benign\">\n                    <i class=\"fas fa-check-circle\"></i>\n                    <span class=\"stat-number\" id=\"stat-benign\">0</span>\n                    <span class=\"stat-label\">Benign</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n            </div>\n            \n            <!-- Recent Scans -->\n            <div class=\"scans-container animate-fade-in\">\n                <div class=\"scans-header\">\n                    <h2><i class=\"fas fa-list\"></i> Recent Scans</h2>\n                    <button class=\"refresh-btn\" onclick=\"manualRefresh()\">\n                        <i class=\"fas fa-sync-alt\"></i> Refresh\n                    </button>\n                </div>\n                \n                <table class=\"scans-table\">\n                    <thead>\n                        <tr>\n                            <th>Timestamp</th>\n                            <th>Filename</th>\n                            <th>Classification</th>\n                            <th>Client IP</th>\n                            <th>Hash (SHA256)</th>\n                        </tr>\n                    </thead>\n                    <tbody id=\"scans-tbody\">\n                        <tr>\n                            <td colspan=\"5\" class=\"empty-state\">\n                                <i class=\"fas fa-inbox\"></i>\n                                <p>No scans yet. Waiting for clients...</p>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n\n        <!-- ANALYTICS VIEW -->\n        <div class=\"view-container\" id=\"analyticsView\">\n            <div class=\"analytics-header\">\n                <button class=\"back-btn\" onclick=\"switchView('dashboard')\">\n                    <i class=\"fas fa-arrow-left\"></i> Back to Dashboard\n                </button>\n                <h1><i class=\"fas fa-chart-line\"></i> Analytics & Intelligence</h1>\n            </div>\n            \n            <div class=\"analytics-grid\" id=\"analyticsGrid\">\n                \n                <!-- Daily Analysis Chart -->\n                <div class=\"chart-container analytics-panel panel-large\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-line\"></i> Daily Analysis Trends</h2>\n                        <div class=\"chart-controls\">\n                            <button class=\"chart-btn active\" onclick=\"setChartDays(7)\">7 Days</button>\n                            <button class=\"chart-btn\" onclick=\"setChartDays(14)\">14 Days</button>\n                            <button class=\"chart-btn\" onclick=\"setChartDays(30)\">30 Days</button>\n                        </div>\n                    </div>\n                    <canvas id=\"dailyScansChart\"></canvas>\n                </div>\n                    <canvas id=\"dailyScansChart\"></canvas>\n                </div>\n\n                <!-- Geographic Threat Intelligence Map -->\n                <div class=\"map-container analytics-panel panel-large\">\n                    <div class=\"map-header\">\n                        <h2><i class=\"fas fa-globe-americas\"></i> Global Threat Intelligence Map</h2>\n                        <div class=\"map-controls\">\n                            <div class=\"map-view-toggle\">\n                                <button class=\"map-btn active\" data-view=\"markers\" onclick=\"switchMapView('markers')\">\n                                    <i class=\"fas fa-map-marker-alt\"></i> Markers\n                                </button>\n                                <button class=\"map-btn\" data-view=\"heatmap\" onclick=\"switchMapView('heatmap')\">\n                                    <i class=\"fas fa-fire\"></i> Heatmap\n                                </button>\n                                <button class=\"map-btn\" data-view=\"choropleth\" onclick=\"switchMapView('choropleth')\">\n                                    <i class=\"fas fa-globe\"></i> Choropleth\n                                </button>\n                            </div>\n                            <div class=\"map-legend\">\n                                <span class=\"legend-item\"><span class=\"legend-dot malware-dot\"></span> Malware</span>\n                                <span class=\"legend-item\"><span class=\"legend-dot suspicious-dot\"></span> Suspicious</span>\n                                <span class=\"legend-item\"><span class=\"legend-dot benign-dot\"></span> Benign</span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Geographic Context Panel -->\n                    <div class=\"geo-context-panel\" id=\"geoContext\">\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Active Regions:</span>\n                            <span class=\"context-value\" id=\"activeRegions\">0</span>\n                        </div>\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Hotspot:</span>\n                            <span class=\"context-value\" id=\"topRegion\">None</span>\n                        </div>\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Total Threats:</span>\n                            <span class=\"context-value threat-count\" id=\"geoThreatCount\">0</span>\n                        </div>\n                    </div>\n                    \n                    <div id=\"worldMap\" style=\"height: 500px; border-radius: 8px; margin-bottom: 15px;\"></div>\n                    \n                    <!-- Timeline Control -->\n                    <div class=\"map-timeline-control\">\n                        <button class=\"timeline-btn\" onclick=\"replayThreats()\" id=\"replayBtn\">\n                            <i class=\"fas fa-play\"></i> Replay Last 24h\n                        </button>\n                        <div class=\"timeline-info\" id=\"timelineInfo\">\n                            Click replay to see threat propagation over time\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Malware Source Distribution -->\n                <div class=\"chart-container analytics-panel panel-small\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-pie\"></i> Malware Source Distribution</h2>\n                    </div>\n                    <div style=\"max-width: 500px; margin: 0 auto;\">\n                        <canvas id=\"malwareSourceChart\"></canvas>\n                    </div>\n                </div>\n\n                <!-- Graph 2: \"Noisiest\" Agents Over Time -->\n                <div class=\"chart-container analytics-panel panel-large\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-desktop\"></i> \"Noisiest\" Agents Over Time</h2>\n                        <p class=\"chart-subtitle\">Threat detection trends for top 5 high-risk agents</p>\n                    </div>\n                    <div style=\"height: 300px;\">\n                        <canvas id=\"noisyAgentsChart\"></canvas>\n                    </div>\n                </div>\n\n                <!-- Advanced Analytics Grid -->\n                <div class=\"analytics-panel panel-large advanced-analytics-grid\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-area\"></i> Advanced Statistical Analysis</h2>\n                        <p class=\"chart-subtitle\">Deep dive into signature verification, packer usage, AI confidence, and entropy patterns</p>\n                    </div>\n                    \n                    <div class=\"mini-charts-grid\">\n                        <!-- Graph 3: Signature Status vs. Classification -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-certificate\"></i> Signature vs. Classification</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"signatureClassChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 4: Packer Usage vs. Classification -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-box\"></i> Packer vs. Classification</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"packerClassChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 5: Confidence Score Distribution -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-brain\"></i> AI Confidence Distribution</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"confidenceHistChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 6: File Entropy Distribution -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-chart-bar\"></i> Entropy Distribution</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"entropyBoxChart\"></canvas>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Threat Vector Correlation Explorer -->\n                <div class=\"correlation-container analytics-panel panel-large\">\n                    <div class=\"correlation-header\">\n                        <h2><i class=\"fas fa-project-diagram\"></i> Threat Vector Correlation Explorer</h2>\n                        <p class=\"correlation-subtitle\">Interactive intelligence map showing relationships between malware families, agents, APIs, and indicators</p>\n                    </div>\n                    <div class=\"graph-controls\">\n                        <button class=\"graph-btn\" onclick=\"resetGraph()\"><i class=\"fas fa-sync\"></i> Reset View</button>\n                        <button class=\"graph-btn\" onclick=\"centerGraph()\"><i class=\"fas fa-compress\"></i> Center</button>\n                        <div class=\"graph-legend\">\n                            <span class=\"legend-item\"><span class=\"node-sample malware-node\"></span> Malware Family</span>\n                            <span class=\"legend-item\"><span class=\"node-sample agent-node\"></span> Agent/System</span>\n                            <span class=\"legend-item\"><span class=\"node-sample api-node\"></span> API Call</span>\n                            <span class=\"legend-item\"><span class=\"node-sample string-node\"></span> Suspicious String</span>\n                        </div>\n                    </div>\n                    <div id=\"correlationGraph\"></div>\n                    <div id=\"nodeDetails\" class=\"node-details\" style=\"display: none;\">\n                        <h3 id=\"detailsTitle\"></h3>\n                        <div id=\"detailsContent\"></div>\n                    </div>\n                </div>\n\n                <!-- Emerging Threat Intelligence Panel -->\n                <div class=\"eti-container analytics-panel panel-large\">\n                    <div class=\"eti-header\">\n                        <h2><i class=\"fas fa-exclamation-triangle\"></i> Emerging Threat Intelligence (ETI)</h2>\n                        <p class=\"eti-subtitle\">Real-time actionable intelligence on active threats and indicators of compromise</p>\n                        <div class=\"eti-summary\">\n                            <span class=\"eti-badge\" id=\"eti-total\">0 Total Threats</span>\n                            <span class=\"eti-badge recent\" id=\"eti-recent\">0 Last 24h</span>\n                        </div>\n                    </div>\n                    \n                    <div class=\"eti-grid\">\n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-virus\"></i> Top Malware Families</h3>\n                            <div class=\"eti-subtitle-small\">Most active malware families detected</div>\n                            <div id=\"eti-malware\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-code\"></i> Top Suspicious APIs</h3>\n                            <div class=\"eti-subtitle-small\">Most frequently called malicious APIs</div>\n                            <div id=\"eti-apis\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-terminal\"></i> Top Malicious Strings</h3>\n                            <div class=\"eti-subtitle-small\">Most common IOC strings and commands</div>\n                            <div id=\"eti-strings\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-shield-alt\"></i> Top Packers/Obfuscators</h3>\n                            <div class=\"eti-subtitle-small\">Most used evasion techniques</div>\n                            <div id=\"eti-packers\" class=\"eti-list\"></div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Predictive Threat Modeler -->\n                <div class=\"modeler-container analytics-panel panel-large\">\n                    <div class=\"modeler-header\">\n                        <h2><i class=\"fas fa-flask\"></i> Predictive Threat Modeler</h2>\n                        <p class=\"modeler-subtitle\">Build hypothetical malware and predict how mAIware would classify it</p>\n                    </div>\n                    \n                    <div class=\"modeler-grid\">\n                <div class=\"modeler-builder\">\n                    <h3><i class=\"fas fa-cogs\"></i> Threat Configuration</h3>\n                    \n                    <div class=\"modeler-field\">\n                        <label>File Type</label>\n                        <select id=\"model-filetype\" class=\"modeler-select\">\n                            <option>PE32+ (GUI) x86-64</option>\n                            <option>PE32 (Console) Intel 80386</option>\n                            <option>PE32+ DLL x86-64</option>\n                            <option>MSI Installer</option>\n                            <option>PDF Document</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Packer/Obfuscator</label>\n                        <select id=\"model-packer\" class=\"modeler-select\">\n                            <option>None</option>\n                            <option>UPX</option>\n                            <option>VMProtect</option>\n                            <option>Themida</option>\n                            <option>ASPack</option>\n                            <option>Unknown (High Entropy)</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Digital Signature</label>\n                        <select id=\"model-signature\" class=\"modeler-select\">\n                            <option>Verified (Microsoft Corporation)</option>\n                            <option>Verified (Google LLC)</option>\n                            <option>Verified (Unknown Publisher)</option>\n                            <option>Not Signed</option>\n                            <option>Expired Certificate</option>\n                            <option>Self-Signed (Untrusted)</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>API Imports (select multiple)</label>\n                        <select id=\"model-apis\" class=\"modeler-select\" multiple size=\"6\">\n                            <option>CreateRemoteThread</option>\n                            <option>WriteProcessMemory</option>\n                            <option>VirtualAllocEx</option>\n                            <option>SetWindowsHookExW</option>\n                            <option>URLDownloadToFileW</option>\n                            <option>WinExec</option>\n                            <option>RegSetValueExW</option>\n                            <option>CryptEncrypt</option>\n                            <option>Socket</option>\n                            <option>ReadFile</option>\n                        </select>\n                        <small class=\"modeler-hint\">Hold Ctrl/Cmd to select multiple</small>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Suspicious Strings (select multiple)</label>\n                        <select id=\"model-strings\" class=\"modeler-select\" multiple size=\"6\">\n                            <option>http://bad-c2-server.com/payload.dat</option>\n                            <option>keylog.txt</option>\n                            <option>steal_passwords</option>\n                            <option>powershell -enc</option>\n                            <option>vssadmin.exe delete shadows</option>\n                            <option>HOW_TO_DECRYPT.txt</option>\n                            <option>crack</option>\n                            <option>patch</option>\n                            <option>disable_antivirus</option>\n                        </select>\n                        <small class=\"modeler-hint\">Hold Ctrl/Cmd to select multiple</small>\n                    </div>\n                    \n                    <button class=\"modeler-analyze-btn\" onclick=\"analyzeThreatModel()\">\n                        <i class=\"fas fa-brain\"></i> ANALYZE THREAT\n                    </button>\n                </div>\n                \n                <div class=\"modeler-results\">\n                    <h3><i class=\"fas fa-chart-line\"></i> Prediction Results</h3>\n                    <div id=\"modeler-output\" class=\"modeler-output\">\n                        <div class=\"modeler-placeholder\">\n                            <i class=\"fas fa-arrow-left\"></i>\n                            <p>Configure a threat profile and click ANALYZE to see predictions</p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n            </div>\n        </div>\n    </div>\n    \n    <script>\n        // Helper function to get CSS variable values dynamically for theming\n        function getCSSVar(varName) {\n            return getComputedStyle(document.documentElement).getPropertyValue(varName).trim();\n        }\n\n        // Back to Top Button\n        const backToTopBtn = document.getElementById('backToTop');\n        \n        window.addEventListener('scroll', () => {\n            if (window.pageYOffset > 300) {\n                backToTopBtn.classList.add('visible');\n            } else {\n                backToTopBtn.classList.remove('visible');\n            }\n        });\n\n        function scrollToTop() {\n            window.scrollTo({\n                top: 0,\n                behavior: 'smooth'\n            });\n        }\n\n        // View Switching System\n        function switchView(viewName) {\n            const views = document.querySelectorAll('.view-container');\n            \n            views.forEach(view => {\n                view.classList.remove('active');\n                if (view.id === `${viewName}View`) {\n                    view.classList.add('active');\n                }\n            });\n            \n            currentView = viewName;\n            \n            // Fix map display when switching to analytics view\n            if (viewName === 'analytics') {\n                loadAnalytics(); // Lazy load analytics components\n                setTimeout(() => {\n                    if (worldMap) {\n                        worldMap.invalidateSize();\n                    }\n                    // Capture screenshot for preview after charts has rendered\n                    setTimeout(() => {\n                        createAnalyticsMiniview();\n                    }, 1500);\n                }, 100);\n            }\n            \n            // Close graphs preview when switching views\n            document.getElementById('graphsPreview').classList.remove('show');\n            document.getElementById('previewBackdrop').classList.remove('show');\n        }\n        \n        // Side Panel Hover System\n        const sidePanel = document.getElementById('sidePanel');\n        const graphsPreview = document.getElementById('graphsPreview');\n        const previewBackdrop = document.getElementById('previewBackdrop');\n        const homeNavBtn = document.getElementById('homeNavBtn');\n        let previewTimeout;\n        let previewsRendered = false;\n        let currentView = 'dashboard';\n        \n        // Show preview panel on sidebar hover\n        sidePanel.addEventListener('mouseenter', () => {\n            clearTimeout(previewTimeout);\n            previewTimeout = setTimeout(() => {\n                graphsPreview.classList.add('show');\n                previewBackdrop.classList.add('show');\n                \n                // Show/hide home button based on current view\n                if (currentView === 'analytics') {\n                    homeNavBtn.classList.add('visible');\n                } else {\n                    homeNavBtn.classList.remove('visible');\n                }\n            }, 200);\n        });\n        \n        sidePanel.addEventListener('mouseleave', () => {\n            clearTimeout(previewTimeout);\n            setTimeout(() => {\n                if (!graphsPreview.matches(':hover')) {\n                    graphsPreview.classList.remove('show');\n                    previewBackdrop.classList.remove('show');\n                }\n            }, 100);\n        });\n        \n        // Keep preview open when hovering over it\n        graphsPreview.addEventListener('mouseleave', () => {\n            graphsPreview.classList.remove('show');\n            previewBackdrop.classList.remove('show');\n        });\n        \n        // Close preview when clicking backdrop\n        previewBackdrop.addEventListener('click', () => {\n            graphsPreview.classList.remove('show');\n            previewBackdrop.classList.remove('show');\n        });\n        \n        // Create analytics miniview by taking a screenshot\n        let isCapturingSnapshot = false;\n        let hasInitialSnapshot = false;\n        \n        async function createAnalyticsMiniview() {\n            // Simplified - no actual screenshot, just a visual preview\n            hasInitialSnapshot = true;\n        }\n        \n        // Auto-scroll on hover down in analytics view\n        let scrollInterval;\n        const analyticsGrid = document.getElementById('analyticsGrid');\n        \n        if (analyticsGrid) {\n            analyticsGrid.addEventListener('mousemove', (e) => {\n                const rect = analyticsGrid.getBoundingClientRect();\n                const mouseY = e.clientY - rect.top;\n                const triggerZone = 100; // pixels from bottom\n                \n                if (rect.height - mouseY < triggerZone) {\n                    if (!scrollInterval) {\n                        scrollInterval = setInterval(() => {\n                            analyticsGrid.scrollBy({ top: 2, behavior: 'smooth' });\n                        }, 16);\n                    }\n                } else {\n                    if (scrollInterval) {\n                        clearInterval(scrollInterval);\n                        scrollInterval = null;\n                    }\n                }\n            });\n            \n            analyticsGrid.addEventListener('mouseleave', () => {\n                if (scrollInterval) {\n                    clearInterval(scrollInterval);\n                    scrollInterval = null;\n                }\n            });\n        }\n        \n        // Theme Toggle\n        window.toggleTheme = function() {\n            const html = document.documentElement;\n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            const currentTheme = html.getAttribute('data-theme');\n            \n            if (currentTheme === 'light') {\n                html.setAttribute('data-theme', '');\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n                localStorage.setItem('theme', 'dark');\n            } else {\n                html.setAttribute('data-theme', 'light');\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n                localStorage.setItem('theme', 'light');\n            }\n        };\n        \n        // Load saved theme\n        const savedTheme = localStorage.getItem('theme');\n        if (savedTheme === 'light') {\n            document.documentElement.setAttribute('data-theme', 'light');\n            document.getElementById('themeIcon').textContent = '‚òÄÔ∏è';\n            document.getElementById('themeText').textContent = 'Light';\n        }\n        \n        let dailyChart = null;\n        let currentChartDays = 30;\n        \n        // Notification and Animation System\n        const notificationQueue = [];\n        let isShowingNotification = false;\n        \n        function showThreatNotification(scan) {\n            const container = document.getElementById('notification-container');\n            \n            const classColor = \n                scan.classification === 'Malware' ? '#ff4757' :\n                scan.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n            \n            const icon = \n                scan.classification === 'Malware' ? 'fa-skull-crossbones' :\n                scan.classification === 'Suspicious' ? 'fa-exclamation-triangle' : 'fa-check-circle';\n            \n            const notification = document.createElement('div');\n            notification.className = 'threat-notification';\n            notification.style.borderLeftColor = classColor;\n            notification.innerHTML = `\n                <div class=\"notification-icon\" style=\"color: ${classColor};\">\n                    <i class=\"fas ${icon}\"></i>\n                </div>\n                <div class=\"notification-content\">\n                    <div class=\"notification-title\">\n                        <strong>${scan.classification}</strong> detected\n                    </div>\n                    <div class=\"notification-details\">\n                        ${scan.detected_filename}\n                        ${scan.malware_family ? ` - ${scan.malware_family}` : ''}\n                    </div>\n                    <div class=\"notification-meta\">\n                        <i class=\"fas fa-desktop\"></i> ${scan.systemInfo?.hostname || scan.clientIp || 'Unknown'}\n                    </div>\n                </div>\n                <div class=\"notification-close\" onclick=\"this.parentElement.remove()\">\n                    <i class=\"fas fa-times\"></i>\n                </div>\n            `;\n            \n            container.appendChild(notification);\n            \n            // Animate in\n            setTimeout(() => notification.classList.add('show'), 10);\n            \n            // Auto-remove after 8 seconds\n            setTimeout(() => {\n                notification.classList.remove('show');\n                setTimeout(() => notification.remove(), 300);\n            }, 8000);\n        }\n        \n        function addToThreatTicker(scan) {\n            const ticker = document.getElementById('ticker-content');\n            const timestamp = new Date(scan.serverTimestamp).toLocaleTimeString();\n            \n            const classColor = \n                scan.classification === 'Malware' ? '#ff4757' :\n                scan.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n            \n            const tickerItem = document.createElement('span');\n            tickerItem.className = 'ticker-item';\n            tickerItem.style.color = classColor;\n            tickerItem.innerHTML = `\n                <i class=\"fas fa-circle\"></i>\n                [${timestamp}] ${scan.classification}: ${scan.detected_filename}\n                ${scan.malware_family ? `(${scan.malware_family})` : ''}\n                on ${scan.systemInfo?.hostname || scan.clientIp || 'Unknown'}\n            `;\n            \n            ticker.appendChild(tickerItem);\n            \n            // Keep only last 10 items\n            while (ticker.children.length > 10) {\n                ticker.removeChild(ticker.firstChild);\n            }\n        }\n        \n        function animateStatCard(elementId, newValue) {\n            const element = document.getElementById(elementId);\n            if (!element) return;\n            \n            const currentValue = parseInt(element.textContent) || 0;\n            if (newValue > currentValue) {\n                // Pulse animation\n                element.parentElement.classList.add('stat-pulse');\n                setTimeout(() => element.parentElement.classList.remove('stat-pulse'), 600);\n                \n                // Animate number increment\n                const duration = 500;\n                const steps = 20;\n                const increment = (newValue - currentValue) / steps;\n                let current = currentValue;\n                let step = 0;\n                \n                const interval = setInterval(() => {\n                    step++;\n                    current += increment;\n                    element.textContent = Math.round(current);\n                    \n                    if (step >= steps) {\n                        element.textContent = newValue;\n                        clearInterval(interval);\n                    }\n                }, duration / steps);\n            } else {\n                element.textContent = newValue;\n            }\n        }\n        \n        async function loadStats() {\n            try {\n                const response = await fetch('/api/stats');\n                const stats = await response.json();\n                \n                animateStatCard('stat-clients', stats.activeClients);\n                animateStatCard('stat-total', stats.totalScans);\n                animateStatCard('stat-malware', stats.malwareCount);\n                animateStatCard('stat-suspicious', stats.suspiciousCount);\n                animateStatCard('stat-benign', stats.benignCount);\n            } catch (error) {\n                console.error('Failed to load stats:', error);\n            }\n        }\n        \n        async function loadScans() {\n            try {\n                const response = await fetch('/api/scans?limit=50');\n                const data = await response.json();\n                \n                const tbody = document.getElementById('scans-tbody');\n                \n                if (data.scans.length === 0) {\n                    tbody.innerHTML = `\n                        <tr>\n                            <td colspan=\"5\" class=\"empty-state\">\n                                <i class=\"fas fa-inbox\"></i>\n                                <p>No scans yet. Waiting for clients...</p>\n                            </td>\n                        </tr>\n                    `;\n                    return;\n                }\n                \n                tbody.innerHTML = data.scans.map(scan => {\n                    const timestamp = new Date(scan.serverTimestamp).toLocaleString();\n                    const hash = scan.file_hashes?.sha256 || 'N/A';\n                    const hashShort = hash.length > 16 ? (hash.substring(0, 16) + '...') : hash;\n                    const isNonPe = scan.is_pe === false;\n                    const classification = isNonPe ? 'Non-PE' : (scan.classification || 'Unknown');\n                    const badgeClass = isNonPe ? 'non-pe' : classification.toLowerCase();\n                    const nonPeTag = isNonPe ? '<span class=\"badge non-pe\" title=\"Non-PE file\">Non-PE</span>' : '';\n                    return `\n                        <tr>\n                            <td>${timestamp}</td>\n                            <td>${scan.detected_filename} ${nonPeTag}</td>\n                            <td><span class=\"badge ${badgeClass}\">${classification}</span></td>\n                            <td>${scan.systemInfo?.ip || scan.clientIp || 'Unknown'}</td>\n                            <td class=\"hash\" title=\"${hash}\">${hashShort}</td>\n                        </tr>\n                    `;\n                }).join('');\n                \n            } catch (error) {\n                console.error('Failed to load scans:', error);\n            }\n        }\n        \n        async function loadDailyChart() {\n            try {\n                const response = await fetch(`/api/daily-scans?days=${currentChartDays}`);\n                const data = await response.json();\n                \n                const ctx = document.getElementById('dailyScansChart');\n                \n                // Format dates for display (MM/DD)\n                const labels = data.days.map(day => {\n                    const date = new Date(day.date);\n                    return `${date.getMonth() + 1}/${date.getDate()}`;\n                });\n                \n                // Reuse existing chart if it exists\n                if (dailyChart) {\n                    dailyChart.data.labels = labels;\n                    dailyChart.data.datasets[0].data = data.days.map(d => d.total);\n                    dailyChart.data.datasets[1].data = data.days.map(d => d.malware);\n                    dailyChart.data.datasets[2].data = data.days.map(d => d.suspicious);\n                    dailyChart.data.datasets[3].data = data.days.map(d => d.benign);\n                    dailyChart.update('none'); // Update without animation\n                    return;\n                }\n                \n                dailyChart = new Chart(ctx, {\n                    type: 'line',\n                    data: {\n                        labels: labels,\n                        datasets: [\n                            {\n                                label: 'Total Scans',\n                                data: data.days.map(d => d.total),\n                                borderColor: '#5a9cf8',\n                                backgroundColor: 'rgba(90, 156, 248, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Malware',\n                                data: data.days.map(d => d.malware),\n                                borderColor: '#ff4757',\n                                backgroundColor: 'rgba(255, 71, 87, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Suspicious',\n                                data: data.days.map(d => d.suspicious),\n                                borderColor: '#ffa502',\n                                backgroundColor: 'rgba(255, 165, 2, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Benign',\n                                data: data.days.map(d => d.benign),\n                                borderColor: '#26de81',\n                                backgroundColor: 'rgba(38, 222, 129, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        interaction: {\n                            mode: 'index',\n                            intersect: false,\n                        },\n                        plugins: {\n                            legend: {\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 12 }\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0',\n                                borderColor: 'rgba(255, 255, 255, 0.1)',\n                                borderWidth: 1\n                            }\n                        },\n                        scales: {\n                            x: {\n                                ticks: { \n                                    color: getCSSVar('--chart-text-color') || '#888',\n                                    maxRotation: 45,\n                                    minRotation: 45\n                                },\n                                grid: { \n                                    color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' \n                                }\n                            },\n                            y: {\n                                beginAtZero: true,\n                                ticks: { \n                                    color: getCSSVar('--chart-text-color') || '#888',\n                                    stepSize: 1\n                                },\n                                grid: { \n                                    color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' \n                                }\n                            }\n                        }\n                    }\n                });\n                \n            } catch (error) {\n                console.error('Failed to load daily chart:', error);\n            }\n        }\n        \n        let worldMap = null;\n        let markerLayer = null;\n        let heatmapLayer = null;\n        let choroplethLayer = null;\n        let mapInitialized = false;\n        let lastGeoDataHash = '';\n        let sourceChart = null;\n        let currentMapView = 'markers';\n        let geoDataCache = null;\n        let replayInterval = null;\n        \n        // Country boundaries for choropleth (simplified)\n        const countryCoordinates = {\n            'United States': { center: [37.0902, -95.7129], weight: 0 },\n            'China': { center: [35.8617, 104.1954], weight: 0 },\n            'United Kingdom': { center: [55.3781, -3.4360], weight: 0 },\n            'Germany': { center: [51.1657, 10.4515], weight: 0 },\n            'France': { center: [46.2276, 2.2137], weight: 0 },\n            'Russia': { center: [61.5240, 105.3188], weight: 0 },\n            'Japan': { center: [36.2048, 138.2529], weight: 0 },\n            'India': { center: [20.5937, 78.9629], weight: 0 },\n            'Brazil': { center: [-14.2350, -51.9253], weight: 0 },\n            'Australia': { center: [-25.2744, 133.7751], weight: 0 }\n        };\n        \n        function initializeMap() {\n            if (mapInitialized) return;\n            \n            try {\n                worldMap = L.map('worldMap', {\n                    zoomControl: true,\n                    scrollWheelZoom: true,\n                    preferCanvas: false,\n                    worldCopyJump: true\n                }).setView([20, 0], 2);\n                \n                // Use dark theme tiles\n                L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {\n                    attribution: '&copy; OpenStreetMap contributors',\n                    subdomains: 'abcd',\n                    maxZoom: 18,\n                    minZoom: 1,\n                    noWrap: false,\n                    bounds: [[-90, -180], [90, 180]]\n                }).addTo(worldMap);\n                \n                markerLayer = L.layerGroup().addTo(worldMap);\n                mapInitialized = true;\n                \n                // Fix map display after initialization\n                setTimeout(() => {\n                    if (worldMap) worldMap.invalidateSize();\n                }, 100);\n            } catch (error) {\n                console.error('Failed to initialize map:', error);\n            }\n        }\n        \n        // Switch between map visualization modes\n        window.switchMapView = function(view) {\n            currentMapView = view;\n            \n            // Update button states\n            document.querySelectorAll('.map-btn').forEach(btn => {\n                btn.classList.remove('active');\n            });\n            document.querySelector(`[data-view=\"${view}\"]`).classList.add('active');\n            \n            // Reload map with new view\n            if (geoDataCache) {\n                renderMapView(geoDataCache);\n            }\n        };\n        \n        // Render different map views\n        function renderMapView(data) {\n            if (!worldMap) return;\n            \n            // Clear all layers\n            if (markerLayer) markerLayer.clearLayers();\n            if (heatmapLayer) {\n                worldMap.removeLayer(heatmapLayer);\n                heatmapLayer = null;\n            }\n            if (choroplethLayer) {\n                worldMap.removeLayer(choroplethLayer);\n                choroplethLayer = null;\n            }\n            \n            switch (currentMapView) {\n                case 'markers':\n                    renderMarkers(data);\n                    break;\n                case 'heatmap':\n                    renderHeatmap(data);\n                    break;\n                case 'choropleth':\n                    renderChoropleth(data);\n                    break;\n            }\n            \n            updateGeoContext(data);\n        }\n        \n        // Render traditional markers\n        function renderMarkers(data) {\n            data.locations.forEach(location => {\n                const { lat, lng, city, country } = location.location;\n                \n                let markerColor = '#26de81'; // benign\n                if (location.malwareCount > 0) {\n                    markerColor = '#ff3b3b'; // malware\n                } else if (location.suspiciousCount > 0) {\n                    markerColor = '#ffd700'; // suspicious\n                }\n                \n                const markerSize = Math.min(24, Math.max(8, 8 + location.totalScans * 2));\n                \n                const marker = L.circleMarker([lat, lng], {\n                    radius: markerSize / 2,\n                    fillColor: markerColor,\n                    color: '#fff',\n                    weight: 2,\n                    opacity: 0.8,\n                    fillOpacity: 0.6\n                });\n                \n                const popupContent = `\n                    <div style=\"color: var(--text-primary); min-width: 200px;\">\n                        <h3 style=\"margin: 0 0 10px 0; color: var(--accent-green); font-size: 1.1rem;\">\n                            <i class=\"fas fa-map-marker-alt\" style=\"color: ${markerColor};\"></i>\n                            ${city}, ${country}\n                        </h3>\n                        <p style=\"margin: 5px 0;\"><strong>IP:</strong> ${location.ip}</p>\n                        <p style=\"margin: 5px 0;\"><strong>Total Scans:</strong> ${location.totalScans}</p>\n                        <div style=\"margin-top: 10px;\">\n                            <div><span style=\"color: #ff3b3b;\">‚óè</span> Malware: ${location.malwareCount}</div>\n                            <div><span style=\"color: #ffd700;\">‚óè</span> Suspicious: ${location.suspiciousCount}</div>\n                            <div><span style=\"color: #34d118;\">‚óè</span> Benign: ${location.benignCount}</div>\n                        </div>\n                        <button onclick=\"filterByLocation('${country}')\" \n                                style=\"margin-top: 10px; padding: 5px 10px; background: var(--accent-green); \n                                       color: var(--bg-primary); border: none; border-radius: 5px; cursor: pointer;\">\n                            Filter by ${country}\n                        </button>\n                    </div>\n                `;\n                \n                marker.bindPopup(popupContent);\n                marker.addTo(markerLayer);\n                \n                marker.on('mouseover', function() {\n                    this.setStyle({ fillOpacity: 0.9, opacity: 1 });\n                });\n                marker.on('mouseout', function() {\n                    this.setStyle({ fillOpacity: 0.6, opacity: 0.8 });\n                });\n            });\n        }\n        \n        // Render heatmap overlay\n        function renderHeatmap(data) {\n            const heatData = [];\n            \n            data.locations.forEach(location => {\n                const { lat, lng } = location.location;\n                // Weight by threat severity: malware = 1.0, suspicious = 0.5, benign = 0.2\n                const weight = (location.malwareCount * 1.0 + \n                               location.suspiciousCount * 0.5 + \n                               location.benignCount * 0.2) / location.totalScans;\n                \n                // Add multiple points for higher intensity\n                const intensity = Math.ceil(location.totalScans * weight);\n                for (let i = 0; i < intensity; i++) {\n                    heatData.push([lat, lng, weight]);\n                }\n            });\n            \n            heatmapLayer = L.heatLayer(heatData, {\n                radius: 35,\n                blur: 25,\n                maxZoom: 10,\n                max: 1.0,\n                gradient: {\n                    0.0: '#34d118',  // Green (low threat)\n                    0.3: '#ffd700',  // Yellow\n                    0.6: '#ffa502',  // Orange\n                    0.8: '#ff6348',  // Red\n                    1.0: '#ff3b3b'   // Bright red (high threat)\n                }\n            }).addTo(worldMap);\n        }\n        \n        // Render choropleth (country-level threat shading)\n        function renderChoropleth(data) {\n            // Aggregate threats by country\n            const countryStats = {};\n            data.locations.forEach(location => {\n                const country = location.location.country;\n                if (!countryStats[country]) {\n                    countryStats[country] = { total: 0, malware: 0, suspicious: 0 };\n                }\n                countryStats[country].total += location.totalScans;\n                countryStats[country].malware += location.malwareCount;\n                countryStats[country].suspicious += location.suspiciousCount;\n            });\n            \n            // Find max for normalization\n            const maxThreats = Math.max(...Object.values(countryStats).map(s => \n                s.malware + s.suspicious * 0.5\n            ));\n            \n            // Draw circles for countries with threat data\n            choroplethLayer = L.layerGroup();\n            \n            Object.entries(countryStats).forEach(([country, stats]) => {\n                if (countryCoordinates[country]) {\n                    const threatScore = (stats.malware + stats.suspicious * 0.5) / maxThreats;\n                    \n                    // Color gradient from green to red\n                    let color;\n                    if (threatScore < 0.2) color = '#34d118';\n                    else if (threatScore < 0.4) color = '#ffd700';\n                    else if (threatScore < 0.6) color = '#ffa502';\n                    else if (threatScore < 0.8) color = '#ff6348';\n                    else color = '#ff3b3b';\n                    \n                    const circle = L.circle(countryCoordinates[country].center, {\n                        color: color,\n                        fillColor: color,\n                        fillOpacity: 0.4,\n                        radius: 500000 * (1 + threatScore * 2),\n                        weight: 2\n                    });\n                    \n                    circle.bindPopup(`\n                        <div style=\"color: var(--text-primary);\">\n                            <h3 style=\"color: var(--accent-green);\">${country}</h3>\n                            <p><strong>Total Threats:</strong> ${stats.total}</p>\n                            <p><strong>Malware:</strong> ${stats.malware}</p>\n                            <p><strong>Suspicious:</strong> ${stats.suspicious}</p>\n                            <p><strong>Threat Level:</strong> ${(threatScore * 100).toFixed(0)}%</p>\n                        </div>\n                    `);\n                    \n                    circle.addTo(choroplethLayer);\n                }\n            });\n            \n            choroplethLayer.addTo(worldMap);\n        }\n        \n        // Update geographic context panel\n        function updateGeoContext(data) {\n            const countries = new Set(data.locations.map(l => l.location.country));\n            document.getElementById('activeRegions').textContent = countries.size;\n            \n            // Find hotspot (country with most threats)\n            const countryThreats = {};\n            data.locations.forEach(loc => {\n                const country = loc.location.country;\n                countryThreats[country] = (countryThreats[country] || 0) + \n                    loc.malwareCount + loc.suspiciousCount;\n            });\n            \n            const hotspot = Object.entries(countryThreats)\n                .sort((a, b) => b[1] - a[1])[0];\n            \n            if (hotspot) {\n                const percentage = ((hotspot[1] / data.locations.reduce((sum, l) => \n                    sum + l.malwareCount + l.suspiciousCount, 0)) * 100).toFixed(0);\n                document.getElementById('topRegion').textContent = \n                    `${hotspot[0]} (${percentage}% of threats)`;\n            }\n            \n            const totalThreats = data.locations.reduce((sum, l) => \n                sum + l.malwareCount + l.suspiciousCount, 0);\n            document.getElementById('geoThreatCount').textContent = totalThreats;\n        }\n        \n        // Filter dashboard by geographic location\n        window.filterByLocation = function(country) {\n            console.log(`Filtering by country: ${country}`);\n            // This would filter the tables and charts - simplified for demo\n            alert(`Geographic filtering activated for ${country}.\\nIn full implementation, this would filter all dashboard data.`);\n        };\n        \n        // Replay threats over last 24 hours\n        window.replayThreats = async function() {\n            const btn = document.getElementById('replayBtn');\n            const info = document.getElementById('timelineInfo');\n            \n            if (replayInterval) {\n                clearInterval(replayInterval);\n                replayInterval = null;\n                btn.innerHTML = '<i class=\"fas fa-play\"></i> Replay Last 24h';\n                info.textContent = 'Replay stopped';\n                if (geoDataCache) renderMapView(geoDataCache);\n                return;\n            }\n            \n            if (!geoDataCache || geoDataCache.locations.length === 0) {\n                info.textContent = 'No data available for replay';\n                return;\n            }\n            \n            btn.innerHTML = '<i class=\"fas fa-stop\"></i> Stop Replay';\n            info.textContent = 'Replaying threat detection timeline...';\n            \n            // Sort locations by timestamp\n            const sortedLocations = [...geoDataCache.locations].sort((a, b) => {\n                const timeA = a.scans[0]?.timestamp || 0;\n                const timeB = b.scans[0]?.timestamp || 0;\n                return new Date(timeA) - new Date(timeB);\n            });\n            \n            if (markerLayer) markerLayer.clearLayers();\n            let index = 0;\n            \n            replayInterval = setInterval(() => {\n                if (index >= sortedLocations.length) {\n                    clearInterval(replayInterval);\n                    replayInterval = null;\n                    btn.innerHTML = '<i class=\"fas fa-play\"></i> Replay Last 24h';\n                    info.textContent = 'Replay complete';\n                    return;\n                }\n                \n                const location = sortedLocations[index];\n                const { lat, lng, city, country } = location.location;\n                \n                let markerColor = location.malwareCount > 0 ? '#ff3b3b' : \n                                 location.suspiciousCount > 0 ? '#ffd700' : '#34d118';\n                \n                // Animated marker appearance\n                const marker = L.circleMarker([lat, lng], {\n                    radius: 0,\n                    fillColor: markerColor,\n                    color: '#fff',\n                    weight: 2,\n                    opacity: 1,\n                    fillOpacity: 0.8\n                }).addTo(markerLayer);\n                \n                // Animate marker growth\n                let size = 0;\n                const growInterval = setInterval(() => {\n                    size += 2;\n                    if (size >= 12) {\n                        clearInterval(growInterval);\n                        marker.setStyle({ opacity: 0.8, fillOpacity: 0.6 });\n                    }\n                    marker.setRadius(size / 2);\n                }, 50);\n                \n                marker.bindPopup(`\n                    <div style=\"color: var(--text-primary);\">\n                        <strong>${city}, ${country}</strong><br>\n                        ${location.scans[0]?.filename || 'Unknown file'}\n                    </div>\n                `);\n                \n                info.textContent = `Replaying: ${index + 1}/${sortedLocations.length} - ${city}, ${country}`;\n                index++;\n            }, 800); // Show new threat every 800ms\n        };\n        \n        async function loadGeoMap() {\n            try {\n                // Initialize map only once\n                if (!mapInitialized) {\n                    initializeMap();\n                }\n                \n                if (!worldMap) return;\n                \n                const response = await fetch('/api/geo-data');\n                const data = await response.json();\n                \n                // Generate hash of current data to detect changes\n                const currentHash = JSON.stringify(data.locations.map(l => \n                    `${l.ip}-${l.totalScans}-${l.malwareCount}-${l.suspiciousCount}`\n                )).substring(0, 100);\n                \n                // Skip update if data hasn't changed\n                if (currentHash === lastGeoDataHash && markerLayer && markerLayer.getLayers().length > 0) {\n                    return;\n                }\n                lastGeoDataHash = currentHash;\n                \n                // Cache data for replay and other features\n                geoDataCache = data;\n                \n                // Render current view\n                renderMapView(data);\n                \n                console.log(`Map updated with ${data.locations.length} locations in ${currentMapView} mode`);\n                \n            } catch (error) {\n                console.error('Failed to load geo map:', error);\n            }\n        }\n        \n        async function loadMalwareSources() {\n            try {\n                const response = await fetch('/api/malware-sources');\n                const data = await response.json();\n                \n                const ctx = document.getElementById('malwareSourceChart');\n                \n                const labels = data.sources.map(s => s.source);\n                const counts = data.sources.map(s => s.count);\n                \n                // Color scheme for different sources\n                const colors = [\n                    '#ff6b6b', // Email Attachment - red\n                    '#4ecdc4', // Web Download - teal\n                    '#ffe66d', // USB/External Drive - yellow\n                    '#a8dadc', // Internal Network - light blue\n                    '#95a5a6'  // Unknown - gray\n                ];\n                \n                // Reuse existing chart if it exists\n                if (sourceChart) {\n                    sourceChart.data.labels = labels;\n                    sourceChart.data.datasets[0].data = counts;\n                    sourceChart.update('none');\n                    return;\n                }\n                \n                sourceChart = new Chart(ctx, {\n                    type: 'pie',\n                    data: {\n                        labels: labels,\n                        datasets: [{\n                            data: counts,\n                            backgroundColor: colors,\n                            borderColor: '#1a1a2e',\n                            borderWidth: 2\n                        }]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: true,\n                        plugins: {\n                            legend: {\n                                position: 'bottom',\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 12 },\n                                    padding: 15\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0',\n                                borderColor: 'rgba(255, 255, 255, 0.1)',\n                                borderWidth: 1,\n                                callbacks: {\n                                    label: function(context) {\n                                        const label = context.label || '';\n                                        const value = context.parsed || 0;\n                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);\n                                        const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : 0;\n                                        return `${label}: ${value} (${percentage}%)`;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                });\n                \n            } catch (error) {\n                console.error('Failed to load malware sources:', error);\n            }\n        }\n        \n        // Graph 2: \"Noisiest\" Agents Over Time\n        let noisyAgentsChart = null;\n        async function loadNoisyAgentsChart() {\n            try {\n                const response = await fetch('/api/noisy-agents');\n                const data = await response.json();\n                \n                console.log('Noisy agents data:', data);\n                \n                const ctx = document.getElementById('noisyAgentsChart');\n                if (!ctx) return;\n                \n                // Show message if no data\n                if (!data.agents || data.agents.length === 0) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 2rem; text-align: center; color: var(--text-secondary);\">No agent data available yet. Start scanning files to see trends.</div>';\n                    return;\n                }\n                \n                const colors = [\n                    '#ff3b3b', '#34d118', '#ffd700', '#1e90ff', '#ff1493'\n                ];\n                \n                // Reuse existing chart if it exists\n                if (noisyAgentsChart) {\n                    noisyAgentsChart.data.labels = data.dates;\n                    noisyAgentsChart.data.datasets = data.agents.map((agent, idx) => ({\n                        label: agent.agentId,\n                        data: agent.counts,\n                        borderColor: colors[idx],\n                        backgroundColor: colors[idx] + '20',\n                        tension: 0.4,\n                        borderWidth: 2,\n                        fill: false\n                    }));\n                    noisyAgentsChart.update('none');\n                    return;\n                }\n                \n                noisyAgentsChart = new Chart(ctx, {\n                    type: 'line',\n                    data: {\n                        labels: data.dates,\n                        datasets: data.agents.map((agent, idx) => ({\n                            label: agent.agentId,\n                            data: agent.counts,\n                            borderColor: colors[idx],\n                            backgroundColor: colors[idx] + '20',\n                            tension: 0.4,\n                            borderWidth: 2,\n                            fill: false\n                        }))\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 11 }\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: getCSSVar('--chart-text-color') || '#888' },\n                                grid: { color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                ticks: { color: getCSSVar('--chart-text-color') || '#888' },\n                                grid: { color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load noisy agents chart:', error);\n                const ctx = document.getElementById('noisyAgentsChart');\n                if (ctx) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 2rem; text-align: center; color: var(--accent-red);\">Error loading chart data</div>';\n                }\n            }\n        }\n        \n        // Graph 3: Signature Status vs. Classification\n        let signatureClassChart = null;\n        async function loadSignatureClassChart() {\n            try {\n                const response = await fetch('/api/signature-classification');\n                const data = await response.json();\n                \n                console.log('Signature classification data:', data);\n                \n                const ctx = document.getElementById('signatureClassChart');\n                if (!ctx) {\n                    console.warn('signatureClassChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (signatureClassChart) {\n                    signatureClassChart.data.datasets[0].data = [data.benign.verified, data.suspicious.verified, data.malware.verified];\n                    signatureClassChart.data.datasets[1].data = [data.benign.unknown, data.suspicious.unknown, data.malware.unknown];\n                    signatureClassChart.data.datasets[2].data = [data.benign.untrusted, data.suspicious.untrusted, data.malware.untrusted];\n                    signatureClassChart.update('none');\n                    return;\n                }\n                \n                signatureClassChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: ['Benign', 'Suspicious', 'Malware'],\n                        datasets: [\n                            {\n                                label: 'Verified',\n                                data: [data.benign.verified, data.suspicious.verified, data.malware.verified],\n                                backgroundColor: '#34d118',\n                                stack: 'stack0'\n                            },\n                            {\n                                label: 'Unknown',\n                                data: [data.benign.unknown, data.suspicious.unknown, data.malware.unknown],\n                                backgroundColor: '#ffd700',\n                                stack: 'stack0'\n                            },\n                            {\n                                label: 'Untrusted',\n                                data: [data.benign.untrusted, data.suspicious.untrusted, data.malware.untrusted],\n                                backgroundColor: '#ff3b3b',\n                                stack: 'stack0'\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                callbacks: {\n                                    label: function(context) {\n                                        const total = context.chart.data.datasets\n                                            .reduce((sum, ds) => sum + ds.data[context.dataIndex], 0);\n                                        const percentage = ((context.parsed.y / total) * 100).toFixed(1);\n                                        return `${context.dataset.label}: ${context.parsed.y} (${percentage}%)`;\n                                    }\n                                }\n                            }\n                        },\n                        scales: {\n                            y: {\n                                stacked: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                stacked: true,\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load signature classification chart:', error);\n                const ctx = document.getElementById('signatureClassChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 4: Packer Usage vs. Classification\n        let packerClassChart = null;\n        async function loadPackerClassChart() {\n            try {\n                const response = await fetch('/api/packer-classification');\n                const data = await response.json();\n                \n                console.log('Packer classification data:', data);\n                \n                const ctx = document.getElementById('packerClassChart');\n                if (!ctx) {\n                    console.warn('packerClassChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (packerClassChart) {\n                    packerClassChart.data.labels = data.packers;\n                    packerClassChart.data.datasets[0].data = data.benignCounts;\n                    packerClassChart.data.datasets[1].data = data.malwareCounts;\n                    packerClassChart.update('none');\n                    return;\n                }\n                \n                packerClassChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: data.packers,\n                        datasets: [\n                            {\n                                label: 'Benign Files',\n                                data: data.benignCounts,\n                                backgroundColor: '#34d118'\n                            },\n                            {\n                                label: 'Malware Files',\n                                data: data.malwareCounts,\n                                backgroundColor: '#ff3b3b'\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load packer classification chart:', error);\n                const ctx = document.getElementById('packerClassChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 5: Confidence Score Histogram\n        let confidenceHistChart = null;\n        async function loadConfidenceHistChart() {\n            try {\n                const response = await fetch('/api/confidence-distribution');\n                const data = await response.json();\n                \n                console.log('Confidence distribution data:', data);\n                \n                const ctx = document.getElementById('confidenceHistChart');\n                if (!ctx) {\n                    console.warn('confidenceHistChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (confidenceHistChart) {\n                    confidenceHistChart.data.labels = data.bins;\n                    confidenceHistChart.data.datasets[0].data = data.counts;\n                    confidenceHistChart.update('none');\n                    return;\n                }\n                \n                confidenceHistChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: data.bins,\n                        datasets: [{\n                            label: 'Scan Count',\n                            data: data.counts,\n                            backgroundColor: '#5a9cf8',\n                            borderColor: '#4a8ce8',\n                            borderWidth: 1\n                        }]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' },\n                                title: {\n                                    display: true,\n                                    text: 'Number of Scans',\n                                    color: '#888'\n                                }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false },\n                                title: {\n                                    display: true,\n                                    text: 'Confidence Score Range',\n                                    color: '#888'\n                                }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load confidence histogram:', error);\n                const ctx = document.getElementById('confidenceHistChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 6: File Entropy Distribution (Box Plot simulation)\n        let entropyBoxChart = null;\n        async function loadEntropyBoxChart() {\n            try {\n                const response = await fetch('/api/entropy-distribution');\n                const data = await response.json();\n                \n                console.log('Entropy distribution data:', data);\n                \n                const ctx = document.getElementById('entropyBoxChart');\n                if (!ctx) {\n                    console.warn('entropyBoxChart canvas not found');\n                    return;\n                }\n                \n                // Create violin/box plot effect with multiple bars\n                const benignData = [\n                    data.benign.min,\n                    data.benign.q1,\n                    data.benign.median,\n                    data.benign.q3,\n                    data.benign.max\n                ];\n                \n                const malwareData = [\n                    data.malware.min,\n                    data.malware.q1,\n                    data.malware.median,\n                    data.malware.q3,\n                    data.malware.max\n                ];\n                \n                // Reuse existing chart if it exists\n                if (entropyBoxChart) {\n                    entropyBoxChart.data.datasets[0].data = benignData;\n                    entropyBoxChart.data.datasets[1].data = malwareData;\n                    entropyBoxChart.update('none');\n                    return;\n                }\n                \n                entropyBoxChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: ['Min', 'Q1', 'Median', 'Q3', 'Max'],\n                        datasets: [\n                            {\n                                label: 'Benign Files',\n                                data: benignData,\n                                backgroundColor: '#34d118',\n                                borderColor: '#2ed60f',\n                                borderWidth: 1\n                            },\n                            {\n                                label: 'Malware Files',\n                                data: malwareData,\n                                backgroundColor: '#ff3b3b',\n                                borderColor: '#cc2f2f',\n                                borderWidth: 1\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                callbacks: {\n                                    label: function(context) {\n                                        return `${context.dataset.label}: ${context.parsed.y.toFixed(3)}`;\n                                    }\n                                }\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                max: 8.0,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' },\n                                title: {\n                                    display: true,\n                                    text: 'Entropy Value',\n                                    color: '#888'\n                                }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load entropy distribution chart:', error);\n                const ctx = document.getElementById('entropyBoxChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        async function loadEmergingThreats() {\n            try {\n                const response = await fetch('/api/emerging-threats');\n                const data = await response.json();\n                \n                // Update summary badges\n                document.getElementById('eti-total').textContent = \n                    `${data.summary.totalThreats} Total Threats`;\n                document.getElementById('eti-recent').textContent = \n                    `${data.summary.recentThreats} Last 24h`;\n                \n                // Helper to render IOC list\n                const renderIOCList = (items, container) => {\n                    if (items.length === 0) {\n                        container.innerHTML = '<div class=\"eti-empty\">No threats detected</div>';\n                        return;\n                    }\n                    \n                    container.innerHTML = items.map((item, index) => {\n                        const rank = index + 1;\n                        const recentBadge = item.recent > 0 ? \n                            `<span class=\"eti-recent-badge\">${item.recent} recent</span>` : '';\n                        const agentBadge = item.agents > 0 ? \n                            `<span class=\"eti-agent-badge\">${item.agents} agents</span>` : '';\n                        \n                        return `\n                            <div class=\"eti-item\" data-rank=\"${rank}\">\n                                <div class=\"eti-rank\">${rank}</div>\n                                <div class=\"eti-content\">\n                                    <div class=\"eti-name\">${item.name}</div>\n                                    <div class=\"eti-meta\">\n                                        <span class=\"eti-count\">${item.count} occurrences</span>\n                                        ${recentBadge}\n                                        ${agentBadge}\n                                    </div>\n                                    ${item.details && item.details.length > 0 ? `\n                                        <div class=\"eti-details\">\n                                            ${item.details.slice(0, 2).join(', ')}\n                                            ${item.details.length > 2 ? '...' : ''}\n                                        </div>\n                                    ` : ''}\n                                </div>\n                            </div>\n                        `;\n                    }).join('');\n                };\n                \n                // Render each section\n                renderIOCList(data.topMalwareFamilies, document.getElementById('eti-malware'));\n                renderIOCList(data.topSuspiciousAPIs, document.getElementById('eti-apis'));\n                renderIOCList(data.topMaliciousStrings, document.getElementById('eti-strings'));\n                renderIOCList(data.topPackers, document.getElementById('eti-packers'));\n                \n            } catch (error) {\n                console.error('Failed to load emerging threats:', error);\n            }\n        }\n        \n        async function analyzeThreatModel() {\n            try {\n                // Get selected values\n                const fileType = document.getElementById('model-filetype').value;\n                const packer = document.getElementById('model-packer').value;\n                const signature = document.getElementById('model-signature').value;\n                \n                // Get multiple selections\n                const apisSelect = document.getElementById('model-apis');\n                const apiImports = Array.from(apisSelect.selectedOptions).map(opt => opt.value);\n                \n                const stringsSelect = document.getElementById('model-strings');\n                const keyStrings = Array.from(stringsSelect.selectedOptions).map(opt => opt.value);\n                \n                // Validate\n                if (apiImports.length === 0) {\n                    alert('Please select at least one API import');\n                    return;\n                }\n                if (keyStrings.length === 0) {\n                    alert('Please select at least one suspicious string');\n                    return;\n                }\n                \n                // Show loading state\n                const outputDiv = document.getElementById('modeler-output');\n                outputDiv.innerHTML = `\n                    <div class=\"modeler-loading\">\n                        <i class=\"fas fa-spinner fa-spin\"></i>\n                        <p>Analyzing threat profile...</p>\n                    </div>\n                `;\n                \n                // Send to server\n                const response = await fetch('/api/threat-model', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                        fileType,\n                        packer,\n                        signature,\n                        apiImports,\n                        keyStrings\n                    })\n                });\n                \n                const data = await response.json();\n                \n                if (data.success) {\n                    const result = data.result;\n                    const classColor = \n                        result.classification === 'Malware' ? '#ff4757' :\n                        result.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n                    \n                    outputDiv.innerHTML = `\n                        <div class=\"prediction-result\">\n                            <div class=\"prediction-header\">\n                                <div class=\"prediction-badge\" style=\"background: ${classColor};\">\n                                    ${result.classification.toUpperCase()}\n                                </div>\n                                <div class=\"prediction-confidence\">\n                                    <div class=\"confidence-label\">Confidence Score</div>\n                                    <div class=\"confidence-value\">${(parseFloat(result.confidence_score) * 100).toFixed(1)}%</div>\n                                </div>\n                            </div>\n                            \n                            ${result.malware_family ? `\n                                <div class=\"prediction-family\">\n                                    <strong>Predicted Malware Family:</strong>\n                                    <span class=\"family-name\">${result.malware_family}</span>\n                                </div>\n                            ` : ''}\n                            \n                            <div class=\"prediction-section\">\n                                <h4>Threat Analysis</h4>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-file\"></i>\n                                    <span><strong>File Type:</strong> ${result.key_findings.file_type}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-box\"></i>\n                                    <span><strong>Packer:</strong> ${result.key_findings.packer_detected}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-certificate\"></i>\n                                    <span><strong>Signature:</strong> ${result.key_findings.signature.name}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-tachometer-alt\"></i>\n                                    <span><strong>Threat Score:</strong> ${result.key_findings.threat_score}/100</span>\n                                </div>\n                            </div>\n                            \n                            <div class=\"prediction-section\">\n                                <h4>Detected Indicators</h4>\n                                <div class=\"indicator-group\">\n                                    <strong>API Imports:</strong>\n                                    <div class=\"indicator-list\">\n                                        ${result.key_findings.api_imports.map(api => \n                                            `<span class=\"indicator-tag api-tag\">${api}</span>`\n                                        ).join('')}\n                                    </div>\n                                </div>\n                                <div class=\"indicator-group\">\n                                    <strong>Suspicious Strings:</strong>\n                                    <div class=\"indicator-list\">\n                                        ${result.key_findings.key_strings.map(str => \n                                            `<span class=\"indicator-tag string-tag\">${str}</span>`\n                                        ).join('')}\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"prediction-footer\">\n                                <i class=\"fas fa-info-circle\"></i>\n                                This analysis has been added to the scan results and will appear in all visualizations.\n                            </div>\n                        </div>\n                    `;\n                } else {\n                    outputDiv.innerHTML = `\n                        <div class=\"modeler-error\">\n                            <i class=\"fas fa-exclamation-circle\"></i>\n                            <p>Analysis failed: ${data.error}</p>\n                        </div>\n                    `;\n                }\n                \n            } catch (error) {\n                console.error('Failed to analyze threat model:', error);\n                document.getElementById('modeler-output').innerHTML = `\n                    <div class=\"modeler-error\">\n                        <i class=\"fas fa-exclamation-circle\"></i>\n                        <p>Analysis failed. Please try again.</p>\n                    </div>\n                `;\n            }\n        }\n        \n        let graphSimulation = null;\n        let graphSvg = null;\n        \n        async function loadCorrelationGraph() {\n            try {\n                const response = await fetch('/api/threat-correlations');\n                const data = await response.json();\n                \n                // Clear existing graph\n                d3.select('#correlationGraph').selectAll('*').remove();\n                \n                const container = document.getElementById('correlationGraph');\n                const width = container.clientWidth;\n                const height = 600;\n                \n                // Create SVG\n                graphSvg = d3.select('#correlationGraph')\n                    .append('svg')\n                    .attr('width', width)\n                    .attr('height', height)\n                    .style('background', '#0a0a0a')\n                    .style('border-radius', '8px');\n                \n                const g = graphSvg.append('g');\n                \n                // Add zoom behavior\n                const zoom = d3.zoom()\n                    .scaleExtent([0.1, 4])\n                    .on('zoom', (event) => {\n                        g.attr('transform', event.transform);\n                    });\n                \n                graphSvg.call(zoom);\n                \n                // Color schemes for different node types\n                const colorMap = {\n                    malware: '#ff4757',\n                    agent: '#5a9cf8',\n                    api: '#ffa502',\n                    string: '#26de81'\n                };\n                \n                // Create force simulation\n                graphSimulation = d3.forceSimulation(data.nodes)\n                    .force('link', d3.forceLink(data.links)\n                        .id(d => d.id)\n                        .distance(d => d.type === 'correlated_with' ? 200 : 100)\n                        .strength(d => d.strength * 0.3))\n                    .force('charge', d3.forceManyBody().strength(-300))\n                    .force('center', d3.forceCenter(width / 2, height / 2))\n                    .force('collision', d3.forceCollide().radius(30));\n                \n                // Draw links\n                const link = g.append('g')\n                    .selectAll('line')\n                    .data(data.links)\n                    .enter()\n                    .append('line')\n                    .attr('stroke', d => {\n                        if (d.type === 'correlated_with') return '#ff6b6b';\n                        if (d.type === 'detected_by') return '#5a9cf8';\n                        if (d.type === 'uses_api') return '#ffa502';\n                        return '#26de81';\n                    })\n                    .attr('stroke-width', d => Math.sqrt(d.strength) + 1)\n                    .attr('stroke-opacity', 0.6);\n                \n                // Draw nodes\n                const node = g.append('g')\n                    .selectAll('circle')\n                    .data(data.nodes)\n                    .enter()\n                    .append('circle')\n                    .attr('r', d => {\n                        if (d.type === 'malware') return 15 + Math.min(d.count * 2, 15);\n                        if (d.type === 'agent') return 12 + Math.min(d.count, 10);\n                        return 8 + Math.min(d.count, 8);\n                    })\n                    .attr('fill', d => colorMap[d.type])\n                    .attr('stroke', '#fff')\n                    .attr('stroke-width', 2)\n                    .style('cursor', 'pointer')\n                    .call(d3.drag()\n                        .on('start', dragstarted)\n                        .on('drag', dragged)\n                        .on('end', dragended))\n                    .on('click', (event, d) => showNodeDetails(d, data))\n                    .on('mouseover', function(event, d) {\n                        d3.select(this)\n                            .transition()\n                            .duration(200)\n                            .attr('stroke-width', 4)\n                            .attr('r', function() {\n                                const currentR = parseFloat(d3.select(this).attr('r'));\n                                return currentR * 1.3;\n                            });\n                    })\n                    .on('mouseout', function(event, d) {\n                        d3.select(this)\n                            .transition()\n                            .duration(200)\n                            .attr('stroke-width', 2)\n                            .attr('r', function() {\n                                if (d.type === 'malware') return 15 + Math.min(d.count * 2, 15);\n                                if (d.type === 'agent') return 12 + Math.min(d.count, 10);\n                                return 8 + Math.min(d.count, 8);\n                            });\n                    });\n                \n                // Add labels\n                const label = g.append('g')\n                    .selectAll('text')\n                    .data(data.nodes)\n                    .enter()\n                    .append('text')\n                    .text(d => d.label.length > 20 ? d.label.substring(0, 20) + '...' : d.label)\n                    .attr('font-size', d => d.type === 'malware' ? '12px' : '10px')\n                    .attr('fill', '#e0e0e0')\n                    .attr('text-anchor', 'middle')\n                    .attr('dy', d => {\n                        if (d.type === 'malware') return 35;\n                        if (d.type === 'agent') return 25;\n                        return 20;\n                    })\n                    .style('pointer-events', 'none')\n                    .style('font-weight', d => d.type === 'malware' ? 'bold' : 'normal');\n                \n                // Update positions on simulation tick\n                graphSimulation.on('tick', () => {\n                    link\n                        .attr('x1', d => d.source.x)\n                        .attr('y1', d => d.source.y)\n                        .attr('x2', d => d.target.x)\n                        .attr('y2', d => d.target.y);\n                    \n                    node\n                        .attr('cx', d => d.x)\n                        .attr('cy', d => d.y);\n                    \n                    label\n                        .attr('x', d => d.x)\n                        .attr('y', d => d.y);\n                });\n                \n                // Drag functions\n                function dragstarted(event, d) {\n                    if (!event.active) graphSimulation.alphaTarget(0.3).restart();\n                    d.fx = d.x;\n                    d.fy = d.y;\n                }\n                \n                function dragged(event, d) {\n                    d.fx = event.x;\n                    d.fy = event.y;\n                }\n                \n                function dragended(event, d) {\n                    if (!event.active) graphSimulation.alphaTarget(0);\n                    d.fx = null;\n                    d.fy = null;\n                }\n                \n                console.log(`Correlation graph loaded: ${data.nodes.length} nodes, ${data.links.length} links`);\n                \n            } catch (error) {\n                console.error('Failed to load correlation graph:', error);\n            }\n        }\n        \n        function showNodeDetails(node, graphData) {\n            const detailsPanel = document.getElementById('nodeDetails');\n            const detailsTitle = document.getElementById('detailsTitle');\n            const detailsContent = document.getElementById('detailsContent');\n            \n            detailsTitle.textContent = node.label;\n            \n            let html = `<p><strong>Type:</strong> ${node.type.toUpperCase()}</p>`;\n            html += `<p><strong>Occurrences:</strong> ${node.count}</p>`;\n            \n            // Find connections\n            const connections = graphData.links.filter(l => \n                l.source.id === node.id || l.target.id === node.id\n            );\n            \n            if (connections.length > 0) {\n                html += `<p><strong>Connections:</strong> ${connections.length}</p>`;\n                html += '<ul style=\"margin: 10px 0; padding-left: 20px;\">';\n                connections.slice(0, 10).forEach(link => {\n                    const otherNode = link.source.id === node.id ? link.target : link.source;\n                    html += `<li>${link.type.replace(/_/g, ' ')}: ${otherNode.label}</li>`;\n                });\n                if (connections.length > 10) {\n                    html += `<li>...and ${connections.length - 10} more</li>`;\n                }\n                html += '</ul>';\n            }\n            \n            if (node.details && node.details.length > 0) {\n                html += '<p><strong>Associated Files:</strong></p>';\n                html += '<ul style=\"margin: 10px 0; padding-left: 20px; max-height: 150px; overflow-y: auto;\">';\n                node.details.slice(0, 10).forEach(file => {\n                    html += `<li>${file}</li>`;\n                });\n                if (node.details.length > 10) {\n                    html += `<li>...and ${node.details.length - 10} more</li>`;\n                }\n                html += '</ul>';\n            }\n            \n            detailsContent.innerHTML = html;\n            detailsPanel.style.display = 'block';\n        }\n        \n        function resetGraph() {\n            if (graphSimulation) {\n                graphSimulation.alpha(1).restart();\n            }\n        }\n        \n        function centerGraph() {\n            if (graphSvg) {\n                graphSvg.transition().duration(750).call(\n                    d3.zoom().transform,\n                    d3.zoomIdentity\n                );\n            }\n        }\n        \n        function setChartDays(days) {\n            currentChartDays = days;\n            \n            // Update button states\n            document.querySelectorAll('.chart-btn').forEach(btn => {\n                btn.classList.remove('active');\n            });\n            event.target.classList.add('active');\n            \n            loadDailyChart();\n        }\n        \n        function loadData() {\n            loadStats();\n            loadScans();\n            // Heavy components loaded lazily - see switchView()\n        }\n        \n        function loadDataWithoutMap() {\n            loadStats();\n            loadScans();\n        }\n        \n        // Track which analytics have been loaded\n        let analyticsLoaded = false;\n        \n        function loadAnalytics() {\n            console.log('Loading analytics view...');\n            loadDailyChart();\n            loadMalwareSources();\n            loadNoisyAgentsChart();\n            loadSignatureClassChart();\n            loadPackerClassChart();\n            loadConfidenceHistChart();\n            loadEntropyBoxChart();\n            loadEmergingThreats();\n            loadCorrelationGraph();\n            loadGeoMap();\n            \n            analyticsLoaded = true;\n        }\n        \n        // Initial load - only dashboard essentials\n        loadData();\n        \n        // Auto-scroll functionality with visual indicators\n        const scrollIndicatorUp = document.createElement('div');\n        scrollIndicatorUp.className = 'scroll-indicator scroll-up';\n        scrollIndicatorUp.innerHTML = '<i class=\"fas fa-chevron-up\"></i>';\n        document.body.appendChild(scrollIndicatorUp);\n        \n        const scrollIndicatorDown = document.createElement('div');\n        scrollIndicatorDown.className = 'scroll-indicator scroll-down';\n        scrollIndicatorDown.innerHTML = '<i class=\"fas fa-chevron-down\"></i>';\n        document.body.appendChild(scrollIndicatorDown);\n        \n        let pageScrollInterval = null;\n        const scrollSpeed = 3;\n        const triggerZone = 80; // pixels from top/bottom\n        \n        function handleAutoScroll(event) {\n            // Don't auto-scroll if page is hidden\n            if (document.hidden) return;\n            \n            const mouseY = event.clientY;\n            const windowHeight = window.innerHeight;\n            \n            // Check if near top\n            if (mouseY < triggerZone) {\n                scrollIndicatorUp.classList.add('visible');\n                scrollIndicatorDown.classList.remove('visible');\n                \n                if (!pageScrollInterval) {\n                    pageScrollInterval = setInterval(() => {\n                        if (document.hidden) {\n                            stopAutoScroll();\n                            return;\n                        }\n                        window.scrollBy({\n                            top: -scrollSpeed,\n                            behavior: 'auto'\n                        });\n                    }, 16); // ~60fps\n                }\n            }\n            // Check if near bottom\n            else if (mouseY > windowHeight - triggerZone) {\n                scrollIndicatorDown.classList.add('visible');\n                scrollIndicatorUp.classList.remove('visible');\n                \n                if (!pageScrollInterval) {\n                    pageScrollInterval = setInterval(() => {\n                        if (document.hidden) {\n                            stopAutoScroll();\n                            return;\n                        }\n                        window.scrollBy({\n                            top: scrollSpeed,\n                            behavior: 'auto'\n                        });\n                    }, 16);\n                }\n            }\n            // In neutral zone\n            else {\n                scrollIndicatorUp.classList.remove('visible');\n                scrollIndicatorDown.classList.remove('visible');\n                \n                if (pageScrollInterval) {\n                    clearInterval(pageScrollInterval);\n                    pageScrollInterval = null;\n                }\n            }\n        }\n        \n        function stopAutoScroll() {\n            scrollIndicatorUp.classList.remove('visible');\n            scrollIndicatorDown.classList.remove('visible');\n            \n            if (pageScrollInterval) {\n                clearInterval(pageScrollInterval);\n                pageScrollInterval = null;\n            }\n        }\n        \n        // Attach event listeners\n        document.addEventListener('mousemove', handleAutoScroll);\n        document.addEventListener('mouseleave', stopAutoScroll);\n        \n        // Stop scrolling when reaching top or bottom\n        let lastScrollTop = 0;\n        window.addEventListener('scroll', () => {\n            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n            const scrollHeight = document.documentElement.scrollHeight;\n            const clientHeight = document.documentElement.clientHeight;\n            \n            // At top\n            if (scrollTop === 0 && lastScrollTop > 0) {\n                stopAutoScroll();\n            }\n            // At bottom\n            if (scrollTop + clientHeight >= scrollHeight - 5) {\n                stopAutoScroll();\n            }\n            \n            lastScrollTop = scrollTop;\n        });\n        \n        // Set up Server-Sent Events for real-time updates\n        const eventSource = new EventSource('/api/events');\n        let updateDebounceTimer = null;\n        let pollingInterval = null;\n        let pendingUpdates = false;\n        \n        eventSource.onmessage = function(event) {\n            const data = JSON.parse(event.data);\n            \n            if (data.type === 'connected') {\n                console.log('Connected to server for real-time updates');\n            } else if (data.type === 'new-scan') {\n                console.log('New scan received:', data.scan.detected_filename);\n                \n                // Show notification toast\n                showThreatNotification(data.scan);\n                \n                // Add to threat ticker\n                addToThreatTicker(data.scan);\n                \n                // Debounce: batch multiple rapid scans into single update\n                pendingUpdates = true;\n                clearTimeout(updateDebounceTimer);\n                updateDebounceTimer = setTimeout(() => {\n                    if (pendingUpdates) {\n                        // Only reload lightweight data (stats + scan list)\n                        loadStats();\n                        loadScans();\n                        \n                        // If analytics view is open, refresh analytics too\n                        if (currentView === 'analytics' && analyticsLoaded) {\n                            loadAnalytics();\n                        }\n                        \n                        pendingUpdates = false;\n                        \n                        // Throttle map updates to once per 15 seconds\n                        if (!window.lastMapUpdate || Date.now() - window.lastMapUpdate > 15000) {\n                            loadGeoMap();\n                            window.lastMapUpdate = Date.now();\n                        }\n                    }\n                }, 1000); // Wait 1 second after last scan\n            }\n        };\n        \n        eventSource.onerror = function(error) {\n            console.error('SSE Error:', error);\n            // Fallback: reload data every 30 seconds if SSE connection fails (only once!)\n            if (eventSource.readyState === EventSource.CLOSED && !pollingInterval) {\n                console.log('SSE connection closed, falling back to polling...');\n                pollingInterval = setInterval(() => {\n                    loadStats();\n                    loadScans();\n                }, 30000);\n            }\n        };\n        \n        // Manual refresh button functionality\n        window.manualRefresh = function() {\n            loadData();\n        };\n    </script>\n    \n    <!-- Theme Toggle Script -->\n    <script>\n        // Theme Toggle Functionality\n        window.toggleTheme = function() {\n            const html = document.documentElement;\n            const currentTheme = html.getAttribute('data-theme');\n            const newTheme = currentTheme === 'light' ? '' : 'light';\n            \n            if (newTheme) {\n                html.setAttribute('data-theme', newTheme);\n            } else {\n                html.removeAttribute('data-theme');\n            }\n            localStorage.setItem('theme', newTheme || 'dark');\n            \n            // Update button icon and text\n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            if (newTheme === 'light') {\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n            } else {\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n            }\n        };\n        \n        // Load saved theme on page load\n        (function() {\n            const savedTheme = localStorage.getItem('theme') || 'dark';\n            if (savedTheme === 'light') {\n                document.documentElement.setAttribute('data-theme', 'light');\n            }\n            \n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            if (savedTheme === 'light') {\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n            } else {\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n            }\n        })();\n    </script>\n</body>\n</html>","epoch":47,"telemetryInfo":{}}],["file:///home/trang/localnsv/mAIware-server/public/styles.css::request_9b6d6ff6-0134-45c8-b199-39ef27e3027c",{"uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/styles.css","external":"file:///home/trang/localnsv/mAIware-server/public/styles.css","path":"/home/trang/localnsv/mAIware-server/public/styles.css","scheme":"file"},"requestId":"request_9b6d6ff6-0134-45c8-b199-39ef27e3027c","content":":root {\n    --bg-primary: #000000;\n    --bg-secondary: #0a0a0a;\n    --bg-card: #0f0f0f;\n    --bg-hover: #151515;\n    --text-primary: #e8f0e8;\n    --text-secondary: #9ca3af;\n    --accent-green: #20be65;\n    --accent-green-dim: #3ea874;\n    --accent-yellow: #ffd700;\n    --accent-red: #ff3b3b;\n    --accent-red-dim: #cc2f2f;\n    --border-color: #1a1a1a;\n    --shadow-color: rgba(0, 0, 0, 0.5);\n    --success-glow: rgba(57, 255, 20, 0.3);\n    --danger-glow: rgba(255, 59, 59, 0.3);\n    --warning-glow: rgba(255, 215, 0, 0.3);\n    /* Chart theming */\n    --chart-text-color: #9ca3af;\n    --chart-grid-color: rgba(255, 255, 255, 0.1);\n}\n\n[data-theme=\"light\"] {\n    --bg-primary: #f0f4f0;\n    --bg-secondary: #ffffff;\n    --bg-card: #fafafa;\n    --bg-hover: #e8f5e8;\n    --text-primary: #1a1f2e;\n    --text-secondary: #4a5568;\n    --accent-green: #20be65;\n    --accent-green-dim: #3ea874;\n    --accent-yellow: #cc9a00;\n    --accent-red: #dc2626;\n    --accent-red-dim: #b91c1c;\n    --border-color: #d1d5db;\n    --shadow-color: rgba(0, 0, 0, 0.1);\n    --success-glow: rgba(46, 214, 15, 0.2);\n    --danger-glow: rgba(220, 38, 38, 0.2);\n    --warning-glow: rgba(204, 154, 0, 0.2);\n    /* Chart theming overrides for light mode */\n    --chart-text-color: #1f2937; /* gray-800 for maximum contrast */\n    --chart-grid-color: rgba(0, 0, 0, 0.12);\n}\n\n* { \n    margin: 0; \n    padding: 0; \n    box-sizing: border-box; \n}\n\nbody {\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    background: var(--bg-primary);\n    color: var(--text-primary);\n    min-height: 100vh;\n    margin: 0;\n    overflow-x: hidden;\n    position: relative;\n}\n\nbody::before {\n    content: '';\n    position: fixed;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: \n        radial-gradient(circle at 20% 50%, rgba(57, 255, 20, 0.08) 0%, transparent 50%),\n        radial-gradient(circle at 80% 80%, rgba(57, 255, 20, 0.06) 0%, transparent 50%),\n        radial-gradient(circle at 40% 20%, rgba(57, 255, 20, 0.05) 0%, transparent 50%);\n    animation: backgroundGlow 15s ease-in-out infinite;\n    pointer-events: none;\n    z-index: 0;\n}\n\n@keyframes backgroundGlow {\n    0%, 100% { \n        transform: translate(0, 0) scale(1);\n        opacity: 0.4;\n    }\n    33% { \n        transform: translate(10%, 10%) scale(1.1);\n        opacity: 0.6;\n    }\n    66% { \n        transform: translate(-10%, 5%) scale(0.95);\n        opacity: 0.5;\n    }\n}\n\nbody > * {\n    position: relative;\n    z-index: 1;\n}\n\n/* Side Panel Navigation */\n.side-panel {\n    position: fixed;\n    left: 0;\n    top: 0;\n    height: 100vh;\n    width: 70px;\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border-right: 1px solid rgba(57, 255, 20, 0.2);\n    box-shadow: 0 0 30px rgba(57, 255, 20, 0.1);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    z-index: 9999;\n    transition: all 0.3s ease;\n}\n\n.side-panel:hover {\n    background: rgba(15, 15, 15, 0.8);\n    box-shadow: 0 0 40px rgba(57, 255, 20, 0.2);\n}\n\n.panel-icon-strip {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 2rem 0;\n}\n\n.panel-logo-icon {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 50px;\n    height: 50px;\n    color: var(--accent-green);\n    font-size: 2rem;\n    animation: pulse-glow 3s ease-in-out infinite;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.panel-logo-icon:hover {\n    transform: scale(1.1);\n    filter: drop-shadow(0 0 20px var(--success-glow));\n}\n\n@keyframes pulse-glow {\n    0%, 100% { filter: drop-shadow(0 0 5px var(--success-glow)); }\n    50% { filter: drop-shadow(0 0 15px var(--success-glow)) drop-shadow(0 0 25px var(--success-glow)); }\n}\n\n/* Graphs Preview Grid */\n.graphs-preview {\n    position: fixed;\n    left: 70px;\n    top: 50%;\n    transform: translateY(-50%) translateX(-100%);\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-left: none;\n    border-radius: 0 12px 12px 0;\n    padding: 2rem;\n    width: 480px;\n    max-height: 90vh;\n    overflow-y: auto;\n    opacity: 0;\n    visibility: hidden;\n    pointer-events: none;\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease, visibility 0.3s;\n    box-shadow: 5px 0 40px rgba(57, 255, 20, 0.15);\n    z-index: 9998;\n    will-change: transform, opacity;\n}\n\n.graphs-preview::-webkit-scrollbar {\n    width: 6px;\n}\n\n.graphs-preview::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 3px;\n}\n\n.graphs-preview::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 3px;\n}\n\n.graphs-preview.show {\n    opacity: 1;\n    visibility: visible;\n    pointer-events: auto;\n    transform: translateY(-50%) translateX(0);\n}\n\n.preview-header {\n    margin-bottom: 1rem;\n    padding-bottom: 0.8rem;\n    border-bottom: 1px solid var(--border-color);\n}\n\n.preview-header h3 {\n    color: var(--accent-green);\n    font-size: 1.1rem;\n    margin-bottom: 0.3rem;\n}\n\n.preview-header p {\n    color: var(--text-secondary);\n    font-size: 0.85rem;\n}\n\n/* Analytics Miniview - Scaled down live view */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-content {\n    width: 100%;\n    height: 100%;\n    transform-origin: top left;\n    transform: scale(0.25);\n    width: 400%;\n    height: 400%;\n    pointer-events: none;\n    overflow: hidden;\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n.preview-home-nav {\n    margin-top: 1.5rem;\n    padding: 1rem;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 10px;\n    display: flex;\n    align-items: center;\n    gap: 0.8rem;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    opacity: 0;\n    visibility: hidden;\n    transform: translateY(10px);\n}\n\n.preview-home-nav.visible {\n    opacity: 1;\n    visibility: visible;\n    transform: translateY(0);\n}\n\n.preview-home-nav:hover {\n    background: var(--bg-hover);\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.preview-home-nav i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n}\n\n.preview-home-nav span {\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--text-primary);\n}\n\n.preview-label {\n    flex: 1;\n    font-size: 0.95rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    letter-spacing: 0.3px;\n}\n\n/* Analytics Miniview - Screenshot preview */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    padding: 1.5rem;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-preview {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    opacity: 0.7;\n}\n\n.preview-row {\n    display: flex;\n    gap: 1rem;\n    flex: 1;\n}\n\n.preview-box {\n    flex: 1;\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 6px;\n    position: relative;\n    overflow: hidden;\n    padding: 0.5rem;\n}\n\n.preview-box.large {\n    flex: 2;\n}\n\n.preview-box.wide {\n    flex: 1;\n    min-height: 150px;\n}\n\n.box-header {\n    font-size: 0.65rem;\n    color: var(--accent-green);\n    margin-bottom: 0.5rem;\n    opacity: 0.8;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.box-content {\n    height: calc(100% - 1.5rem);\n    position: relative;\n}\n\n.map-visual {\n    background: radial-gradient(circle at center, rgba(57, 255, 20, 0.05), transparent);\n    position: relative;\n}\n\n.map-dot {\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 10px var(--accent-green);\n    animation: map-pulse 2s ease-in-out infinite;\n}\n\n.map-dot:nth-child(2) { animation-delay: 0.5s; }\n.map-dot:nth-child(3) { animation-delay: 1s; }\n\n@keyframes map-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.6; }\n    50% { transform: scale(1.5); opacity: 1; }\n}\n\n.chart-visual {\n    display: flex;\n    align-items: flex-end;\n    justify-content: space-around;\n    height: 100%;\n    padding: 0.5rem;\n    gap: 0.3rem;\n}\n\n.chart-bar {\n    flex: 1;\n    background: linear-gradient(180deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    animation: bar-grow 2s ease-in-out infinite;\n    opacity: 0.7;\n}\n\n.chart-bar:nth-child(2) { animation-delay: 0.2s; }\n.chart-bar:nth-child(3) { animation-delay: 0.4s; }\n.chart-bar:nth-child(4) { animation-delay: 0.6s; }\n\n@keyframes bar-grow {\n    0%, 100% { transform: scaleY(0.8); }\n    50% { transform: scaleY(1); }\n}\n\n.list-visual {\n    display: flex;\n    flex-direction: column;\n    gap: 0.4rem;\n    padding: 0.3rem;\n}\n\n.list-item {\n    height: 0.4rem;\n    background: linear-gradient(90deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    opacity: 0.6;\n    animation: list-fade 3s ease-in-out infinite;\n}\n\n.list-item:nth-child(2) { animation-delay: 0.5s; width: 80%; }\n.list-item:nth-child(3) { animation-delay: 1s; width: 60%; }\n\n@keyframes list-fade {\n    0%, 100% { opacity: 0.4; }\n    50% { opacity: 0.8; }\n}\n\n.network-visual {\n    position: relative;\n    height: 100%;\n}\n\n.network-node {\n    position: absolute;\n    width: 6px;\n    height: 6px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 8px var(--accent-green);\n    animation: node-pulse 3s ease-in-out infinite;\n}\n\n.network-node:nth-child(2) { animation-delay: 0.7s; }\n.network-node:nth-child(3) { animation-delay: 1.4s; }\n\n@keyframes node-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.5; }\n    50% { transform: scale(1.3); opacity: 1; }\n}\n\n.heat-visual {\n    background: \n        radial-gradient(circle at 30% 30%, rgba(57, 255, 20, 0.3), transparent 40%),\n        radial-gradient(circle at 70% 60%, rgba(57, 255, 20, 0.2), transparent 40%),\n        radial-gradient(circle at 50% 80%, rgba(57, 255, 20, 0.25), transparent 40%);\n    animation: heat-shift 4s ease-in-out infinite;\n}\n\n@keyframes heat-shift {\n    0%, 100% { opacity: 0.5; }\n    50% { opacity: 0.8; }\n}\n\n.pie-visual {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n}\n\n.pie-chart {\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    background: conic-gradient(\n        var(--accent-green) 0deg 120deg,\n        var(--accent-yellow) 120deg 240deg,\n        var(--accent-red) 240deg 360deg\n    );\n    box-shadow: 0 0 15px rgba(57, 255, 20, 0.4);\n    animation: pie-spin 10s linear infinite;\n}\n\n@keyframes pie-spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n\n/* Main Content Area */\n.main-content {\n    margin-left: 70px;\n    min-height: 100vh;\n    padding: 2rem;\n    transition: margin-left 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    position: relative;\n}\n\n/* Backdrop overlay for preview panel */\n.preview-backdrop {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    background: rgba(0, 0, 0, 0.4);\n    backdrop-filter: blur(2px);\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    z-index: 9998;\n    pointer-events: none;\n}\n\n.preview-backdrop.show {\n    opacity: 1;\n    visibility: visible;\n}\n\n/* View Containers */\n.view-container {\n    display: none;\n    animation: fadeIn 0.4s ease-in-out;\n}\n\n.view-container.active {\n    display: block;\n}\n\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n        transform: translateY(10px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n/* Dashboard Header */\n.dashboard-header {\n    text-align: center;\n    margin-bottom: 2.5rem;\n}\n\n.header-content h1 {\n    font-size: 2.5rem;\n    margin-bottom: 0.5rem;\n    color: var(--accent-green);\n    font-weight: 700;\n    letter-spacing: 2px;\n}\n\n.header-content .subtitle {\n    font-size: 1.2rem;\n    color: var(--text-secondary);\n    font-weight: 500;\n}\n\n.pulse-icon {\n    display: inline-block;\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n@keyframes pulse-scale {\n    0%, 100% {\n        transform: scale(1);\n        filter: drop-shadow(0 0 5px var(--success-glow));\n    }\n    50% {\n        transform: scale(1.05);\n        filter: drop-shadow(0 0 15px var(--success-glow));\n    }\n}\n\n/* Animations */\n.animate-slide-in {\n    animation: slideIn 0.6s ease-out;\n}\n\n@keyframes slideIn {\n    from {\n        opacity: 0;\n        transform: translateX(-30px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n.animate-fade-in {\n    animation: fadeInUp 0.6s ease-out;\n}\n\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.container {\n    max-width: 1400px;\n    margin: 0 auto;\n}\n\n/* Theme Toggle Button */\n.theme-toggle {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    background: rgba(15, 15, 15, 0.85);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50px;\n    padding: 10px 20px;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    font-size: 1rem;\n    color: var(--text-primary);\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px rgba(57, 255, 20, 0.2);\n    font-weight: 600;\n}\n\n.theme-toggle:hover {\n    background: rgba(15, 15, 15, 0.8);\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.theme-toggle .icon {\n    font-size: 1.2rem;\n}\n\n/* Auto-scroll indicators */\n.scroll-indicator {\n    position: fixed;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 60px;\n    height: 60px;\n    background: rgba(57, 255, 20, 0.15);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 2px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    opacity: 0;\n    pointer-events: none;\n    transition: opacity 0.3s ease;\n    z-index: 10001;\n}\n\n.scroll-indicator.visible {\n    opacity: 1;\n    animation: scroll-pulse 1.5s ease-in-out infinite;\n}\n\n.scroll-indicator.scroll-up {\n    top: 20px;\n}\n\n.scroll-indicator.scroll-down {\n    bottom: 20px;\n}\n\n.scroll-indicator i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    animation: scroll-bounce 1s ease-in-out infinite;\n}\n\n.scroll-up i {\n    animation-name: scroll-bounce-up;\n}\n\n.scroll-down i {\n    animation-name: scroll-bounce-down;\n}\n\n@keyframes scroll-pulse {\n    0%, 100% {\n        box-shadow: 0 0 10px rgba(57, 255, 20, 0.3);\n    }\n    50% {\n        box-shadow: 0 0 25px rgba(57, 255, 20, 0.6);\n    }\n}\n\n@keyframes scroll-bounce-up {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(-5px);\n    }\n}\n\n@keyframes scroll-bounce-down {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(5px);\n    }\n}\n\n/* Threat Ticker */\n.threat-ticker-container {\n    background: var(--bg-secondary);\n    border: 2px solid var(--accent-green);\n    border-radius: 8px;\n    padding: 12px;\n    margin-bottom: 2rem;\n    display: flex;\n    align-items: center;\n    gap: 16px;\n    overflow: hidden;\n    box-shadow: 0 2px 8px var(--success-glow);\n}\n\n.ticker-label {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 8px 16px;\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    border-radius: 6px;\n    font-weight: 700;\n    font-size: 0.75rem;\n    color: #fff;\n    white-space: nowrap;\n    box-shadow: 0 2px 8px rgba(255, 71, 87, 0.4);\n}\n\n.ticker-label i {\n    animation: pulse-broadcast 2s infinite;\n}\n\n@keyframes pulse-broadcast {\n    0%, 100% { opacity: 1; transform: scale(1); }\n    50% { opacity: 0.6; transform: scale(0.9); }\n}\n\n.threat-ticker {\n    flex: 1;\n    overflow: hidden;\n    position: relative;\n}\n\n.ticker-content {\n    display: flex;\n    gap: 40px;\n    white-space: nowrap;\n    animation: scroll-ticker 30s linear infinite;\n}\n\n.ticker-content:hover {\n    animation-play-state: paused;\n}\n\n@keyframes scroll-ticker {\n    0% { transform: translateX(0); }\n    100% { transform: translateX(-50%); }\n}\n\n.ticker-item {\n    color: #e0e0e0;\n    font-size: 0.9rem;\n    display: inline-flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.ticker-item i {\n    font-size: 0.5rem;\n    animation: blink 1.5s infinite;\n}\n\n@keyframes blink {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.3; }\n}\n\n/* Notification System */\n.notification-container {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    max-width: 400px;\n}\n\n.threat-notification {\n    background: rgba(30, 30, 30, 0.98);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 8px;\n    padding: 16px;\n    display: flex;\n    gap: 12px;\n    align-items: flex-start;\n    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);\n    transform: translateX(450px);\n    opacity: 0;\n    transition: all 0.3s ease-out;\n}\n\n.threat-notification.show {\n    transform: translateX(0);\n    opacity: 1;\n}\n\n.notification-icon {\n    font-size: 1.5rem;\n    flex-shrink: 0;\n}\n\n.notification-content {\n    flex: 1;\n}\n\n.notification-title {\n    font-size: 0.95rem;\n    color: #e0e0e0;\n    margin-bottom: 4px;\n}\n\n.notification-title strong {\n    text-transform: uppercase;\n    font-weight: 800;\n}\n\n.notification-details {\n    font-size: 0.85rem;\n    color: #b0b0b0;\n    margin-bottom: 6px;\n}\n\n.notification-meta {\n    font-size: 0.75rem;\n    color: #888;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.notification-close {\n    cursor: pointer;\n    color: #666;\n    transition: color 0.2s;\n    font-size: 0.9rem;\n}\n\n.notification-close:hover {\n    color: #e0e0e0;\n}\n\n/* Stat Card Pulse Animation */\n.stat-pulse {\n    animation: stat-pulse-animation 0.6s ease-out;\n}\n\n@keyframes stat-pulse-animation {\n    0% { transform: scale(1); }\n    50% { transform: scale(1.05); box-shadow: 0 8px 24px rgba(90, 156, 248, 0.4); }\n    100% { transform: scale(1); }\n}\n\nh1 {\n    font-size: 2.5rem;\n    color: #5a9cf8;\n    margin-bottom: 0.5rem;\n}\n\n.subtitle {\n    color: #888;\n    font-size: 1.1rem;\n}\n\n.stats-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1.5rem;\n    margin-bottom: 3rem;\n}\n\n.stat-card {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 1.5rem;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.8rem;\n    position: relative;\n    overflow: hidden;\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.stat-card::before {\n    content: '';\n    position: absolute;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: radial-gradient(circle, var(--accent-green) 0%, transparent 70%);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover::before {\n    opacity: 0.05;\n}\n\n.stat-card:hover {\n    transform: translateY(-5px) scale(1.02);\n    border-color: var(--accent-green);\n    box-shadow: 0 10px 30px var(--success-glow);\n}\n\n.stat-card i {\n    font-size: 2.5rem;\n    opacity: 0.8;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover i {\n    transform: scale(1.1) rotateY(180deg);\n    opacity: 1;\n}\n\n.stat-number {\n    font-size: 2.5rem;\n    font-weight: 700;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover .stat-number {\n    transform: scale(1.1);\n    text-shadow: 0 0 20px currentColor;\n}\n\n.stat-label {\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n    font-weight: 600;\n}\n\n.stat-glow {\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    height: 3px;\n    background: linear-gradient(90deg, transparent, var(--accent-green), transparent);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover .stat-glow {\n    opacity: 1;\n    animation: glowSlide 2s ease-in-out infinite;\n}\n\n@keyframes glowSlide {\n    0%, 100% {\n        transform: translateX(-100%);\n    }\n    50% {\n        transform: translateX(100%);\n    }\n}\n\n.stat-card.malware {\n    border-color: rgba(255, 59, 59, 0.3);\n}\n\n.stat-card.malware i,\n.stat-card.malware .stat-number {\n    color: var(--accent-red);\n}\n\n.stat-card.malware:hover {\n    border-color: var(--accent-red);\n    box-shadow: 0 10px 30px var(--danger-glow);\n}\n\n.stat-card.suspicious {\n    border-color: rgba(255, 215, 0, 0.3);\n}\n\n.stat-card.suspicious i,\n.stat-card.suspicious .stat-number {\n    color: var(--accent-yellow);\n}\n\n.stat-card.suspicious:hover {\n    border-color: var(--accent-yellow);\n    box-shadow: 0 10px 30px var(--warning-glow);\n}\n\n.stat-card.benign i,\n.stat-card.benign .stat-number,\n.stat-card.info i,\n.stat-card.info .stat-number {\n    color: var(--accent-green);\n}\n\n/* Analytics View */\n.analytics-header {\n    display: flex;\n    align-items: center;\n    gap: 2rem;\n    margin-bottom: 2.5rem;\n}\n\n.back-btn {\n    background: var(--bg-card);\n    border: 2px solid var(--accent-green);\n    color: var(--accent-green);\n    padding: 0.8rem 1.5rem;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 600;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    transition: all 0.3s ease;\n}\n\n.back-btn:hover {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    transform: translateX(-5px);\n    box-shadow: 0 5px 20px var(--success-glow);\n}\n\n.analytics-header h1 {\n    font-size: 2rem;\n    color: var(--accent-green);\n    font-weight: 700;\n}\n\n.analytics-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));\n    gap: 2rem;\n    max-height: calc(100vh - 200px);\n    overflow-y: auto;\n    padding-right: 1rem;\n    grid-auto-flow: dense;\n}\n\n/* Panel size classes for flexible tiling */\n.analytics-panel.panel-small {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-medium {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-large {\n    grid-column: span 2;\n}\n\n@media (max-width: 1400px) {\n    .analytics-grid {\n        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));\n    }\n    \n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n}\n\n.analytics-grid::-webkit-scrollbar {\n    width: 8px;\n}\n\n.analytics-grid::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb:hover {\n    background: var(--accent-green-dim);\n}\n\n.analytics-panel {\n    animation: slideInPanel 0.5s ease-out;\n    animation-fill-mode: backwards;\n}\n\n.analytics-panel:nth-child(1) { animation-delay: 0.05s; }\n.analytics-panel:nth-child(2) { animation-delay: 0.1s; }\n.analytics-panel:nth-child(3) { animation-delay: 0.15s; }\n.analytics-panel:nth-child(4) { animation-delay: 0.2s; }\n.analytics-panel:nth-child(5) { animation-delay: 0.25s; }\n.analytics-panel:nth-child(6) { animation-delay: 0.3s; }\n\n@keyframes slideInPanel {\n    from {\n        opacity: 0;\n        transform: translateY(30px) scale(0.95);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n    }\n}\n\n/* Advanced Analytics Grid for Mini Charts */\n.advanced-analytics-grid {\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 12px;\n    padding: 1.5rem;\n}\n\n.mini-charts-grid {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 1.5rem;\n    margin-top: 1rem;\n}\n\n.mini-chart-container {\n    background: rgba(10, 10, 10, 0.6);\n    border: 1px solid rgba(57, 255, 20, 0.15);\n    border-radius: 8px;\n    padding: 1rem;\n}\n\n.mini-chart-container h3 {\n    color: var(--accent-green);\n    font-size: 0.95rem;\n    margin: 0 0 0.75rem 0;\n    font-weight: 600;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.mini-chart-container h3 i {\n    font-size: 0.9rem;\n}\n\n@media (max-width: 1200px) {\n    .mini-charts-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n/* Emerging Threat Intelligence Panel */\n.eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.1) 0%, rgba(255, 165, 2, 0.1) 100%);\n    border: 2px solid rgba(255, 71, 87, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(255, 71, 87, 0.2);\n}\n\n.eti-header {\n    margin-bottom: 24px;\n}\n\n.eti-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #ff6b6b;\n    text-shadow: 0 2px 4px rgba(255, 71, 87, 0.3);\n}\n\n.eti-header h2 i {\n    color: #ff4757;\n    margin-right: 10px;\n    animation: pulse 2s infinite;\n}\n\n@keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.6; }\n}\n\n.eti-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 8px 0 16px 0;\n}\n\n.eti-summary {\n    display: flex;\n    gap: 12px;\n    flex-wrap: wrap;\n}\n\n.eti-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 6px 14px;\n    border-radius: 20px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.eti-badge.recent {\n    background: rgba(255, 71, 87, 0.2);\n    border-color: rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.eti-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n    gap: 20px;\n}\n\n.eti-panel {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 18px;\n    transition: transform 0.3s, box-shadow 0.3s;\n}\n\n.eti-panel:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);\n}\n\n.eti-panel h3 {\n    margin: 0 0 6px 0;\n    font-size: 1.1rem;\n    color: #e0e0e0;\n}\n\n.eti-panel h3 i {\n    color: #ffa502;\n    margin-right: 8px;\n}\n\n.eti-subtitle-small {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 14px;\n}\n\n.eti-list {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n}\n\n.eti-item {\n    display: flex;\n    gap: 12px;\n    background: rgba(255, 255, 255, 0.03);\n    border: 1px solid rgba(255, 255, 255, 0.08);\n    border-radius: 8px;\n    padding: 12px;\n    transition: all 0.3s;\n}\n\n.eti-item:hover {\n    background: rgba(255, 255, 255, 0.06);\n    border-color: rgba(255, 165, 2, 0.4);\n    transform: translateX(4px);\n}\n\n.eti-rank {\n    flex-shrink: 0;\n    width: 32px;\n    height: 32px;\n    background: linear-gradient(135deg, #ff6b6b, #ffa502);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: bold;\n    font-size: 1rem;\n    color: #fff;\n    box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);\n}\n\n.eti-item[data-rank=\"1\"] .eti-rank {\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    transform: scale(1.1);\n}\n\n.eti-content {\n    flex: 1;\n    min-width: 0;\n}\n\n.eti-name {\n    font-weight: 600;\n    color: #e0e0e0;\n    font-size: 0.95rem;\n    margin-bottom: 4px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-meta {\n    display: flex;\n    gap: 8px;\n    flex-wrap: wrap;\n    align-items: center;\n}\n\n.eti-count {\n    color: #888;\n    font-size: 0.8rem;\n}\n\n.eti-recent-badge {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-agent-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-details {\n    margin-top: 6px;\n    color: #999;\n    font-size: 0.75rem;\n    font-style: italic;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-empty {\n    text-align: center;\n    color: #666;\n    padding: 20px;\n    font-style: italic;\n}\n\n/* Threat Modeler */\n.modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.1) 0%, rgba(38, 222, 129, 0.1) 100%);\n    border: 2px solid rgba(90, 156, 248, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(90, 156, 248, 0.2);\n}\n\n.modeler-header {\n    margin-bottom: 24px;\n}\n\n.modeler-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #5a9cf8;\n}\n\n.modeler-header h2 i {\n    color: #26de81;\n    margin-right: 10px;\n}\n\n.modeler-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 0;\n}\n\n.modeler-grid {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 24px;\n}\n\n@media (max-width: 1024px) {\n    .modeler-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n.modeler-builder,\n.modeler-results {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 20px;\n}\n\n.modeler-builder h3,\n.modeler-results h3 {\n    margin: 0 0 20px 0;\n    font-size: 1.2rem;\n    color: #e0e0e0;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n    padding-bottom: 10px;\n}\n\n.modeler-builder h3 i {\n    color: #26de81;\n    margin-right: 8px;\n}\n\n.modeler-results h3 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.modeler-field {\n    margin-bottom: 20px;\n}\n\n.modeler-field label {\n    display: block;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n    margin-bottom: 6px;\n    font-weight: 600;\n}\n\n.modeler-select {\n    width: 100%;\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.2);\n    border-radius: 6px;\n    color: #e0e0e0;\n    padding: 10px;\n    font-size: 0.9rem;\n    font-family: inherit;\n    cursor: pointer;\n    transition: all 0.3s;\n}\n\n.modeler-select:focus {\n    outline: none;\n    border-color: #5a9cf8;\n    background: rgba(90, 156, 248, 0.1);\n}\n\n.modeler-select option {\n    background: #1a1a2e;\n    color: #e0e0e0;\n    padding: 8px;\n}\n\n.modeler-hint {\n    display: block;\n    color: #666;\n    font-size: 0.75rem;\n    margin-top: 4px;\n    font-style: italic;\n}\n\n.modeler-analyze-btn {\n    width: 100%;\n    background: linear-gradient(135deg, #26de81, #20bf6b);\n    border: none;\n    color: #fff;\n    padding: 14px 24px;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 700;\n    cursor: pointer;\n    transition: all 0.3s;\n    box-shadow: 0 4px 12px rgba(38, 222, 129, 0.3);\n}\n\n.modeler-analyze-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(38, 222, 129, 0.4);\n}\n\n.modeler-analyze-btn i {\n    margin-right: 8px;\n}\n\n.modeler-output {\n    min-height: 400px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.modeler-placeholder {\n    text-align: center;\n    color: #666;\n}\n\n.modeler-placeholder i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n    opacity: 0.5;\n}\n\n.modeler-placeholder p {\n    font-size: 0.95rem;\n}\n\n.modeler-loading {\n    text-align: center;\n    color: #5a9cf8;\n}\n\n.modeler-loading i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.modeler-error {\n    text-align: center;\n    color: #ff4757;\n}\n\n.modeler-error i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.prediction-result {\n    width: 100%;\n}\n\n.prediction-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 24px;\n    padding: 20px;\n    background: rgba(255, 255, 255, 0.05);\n    border-radius: 8px;\n}\n\n.prediction-badge {\n    padding: 12px 24px;\n    border-radius: 8px;\n    font-size: 1.3rem;\n    font-weight: 800;\n    color: #fff;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n\n.prediction-confidence {\n    text-align: right;\n}\n\n.confidence-label {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 4px;\n}\n\n.confidence-value {\n    color: #5a9cf8;\n    font-size: 2rem;\n    font-weight: 800;\n}\n\n.prediction-family {\n    padding: 16px;\n    background: rgba(255, 71, 87, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 6px;\n    margin-bottom: 20px;\n    color: #e0e0e0;\n}\n\n.family-name {\n    color: #ff6b6b;\n    font-weight: 700;\n    font-size: 1.1rem;\n    margin-left: 8px;\n}\n\n.prediction-section {\n    margin-bottom: 20px;\n}\n\n.prediction-section h4 {\n    color: #5a9cf8;\n    font-size: 1rem;\n    margin: 0 0 12px 0;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 6px;\n}\n\n.analysis-item {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    padding: 8px 0;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n}\n\n.analysis-item i {\n    color: #ffa502;\n    width: 20px;\n}\n\n.indicator-group {\n    margin-bottom: 16px;\n}\n\n.indicator-group strong {\n    display: block;\n    color: #e0e0e0;\n    margin-bottom: 8px;\n    font-size: 0.9rem;\n}\n\n.indicator-list {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 8px;\n}\n\n.indicator-tag {\n    padding: 6px 12px;\n    border-radius: 6px;\n    font-size: 0.8rem;\n    font-weight: 600;\n    font-family: 'Courier New', monospace;\n}\n\n.api-tag {\n    background: rgba(255, 165, 2, 0.2);\n    border: 1px solid rgba(255, 165, 2, 0.4);\n    color: #ffa502;\n}\n\n.string-tag {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.prediction-footer {\n    margin-top: 20px;\n    padding: 12px;\n    background: rgba(90, 156, 248, 0.1);\n    border-radius: 6px;\n    color: #5a9cf8;\n    font-size: 0.85rem;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.scans-container {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 2rem;\n    transition: all 0.3s ease;\n}\n\n.scans-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--shadow-color);\n}\n\n.scans-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.scans-header h2 {\n    color: #2bcfae;\n}\n\n.refresh-btn {\n    background: #2bcfae;\n    color: white;\n    border: none;\n    padding: 0.75rem 1.5rem;\n    border-radius: 8px;\n    cursor: pointer;\n    font-size: 1rem;\n    transition: background 0.2s;\n}\n\n.refresh-btn:hover {\n    background: #1db084;\n}\n\n.scans-table {\n    width: 100%;\n    border-collapse: collapse;\n}\n\n.scans-table th {\n    text-align: left;\n    padding: 1rem;\n    background: rgba(255, 255, 255, 0.05);\n    color: #2bcfae;\n    font-weight: 600;\n}\n\n.scans-table td {\n    padding: 1rem;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.scans-table tr:hover {\n    background: rgba(255, 255, 255, 0.03);\n}\n\n.badge {\n    display: inline-block;\n    padding: 0.3rem 0.8rem;\n    border-radius: 6px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.badge.malware { background: #ff4757; color: white; }\n.badge.suspicious { background: #ffa502; color: white; }\n.badge.benign { background: #34d118; color: white; }\n.badge.non-pe { background: #4b5563; color: #fff; }\n\n.hash {\n    font-family: 'Courier New', monospace;\n    font-size: 0.85rem;\n    color: #888;\n}\n\n.empty-state {\n    text-align: center;\n    padding: 3rem;\n    color: #666;\n}\n\n.empty-state i {\n    font-size: 4rem;\n    margin-bottom: 1rem;\n    opacity: 0.3;\n}\n\n/* NEW: Chart Container Styles */\n.chart-container {\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 12px;\n    padding: 2rem;\n    margin-top: 2rem;\n}\n\n.chart-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.chart-header h2 {\n    color: var(--accent-green);\n    margin: 0;\n}\n\n.chart-subtitle {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    margin: 0.5rem 0 0 0;\n    font-weight: normal;\n}\n\n.chart-controls {\n    display: flex;\n    gap: 0.5rem;\n}\n\n.chart-btn {\n    background: rgba(255, 255, 255, 0.05);\n    color: #888;\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    padding: 0.5rem 1rem;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.2s;\n}\n\n.chart-btn:hover {\n    background: rgba(255, 255, 255, 0.1);\n    color: #e0e0e0;\n}\n\n.chart-btn.active {\n    background: #5a9cf8;\n    color: white;\n    border-color: #5a9cf8;\n}\n\n#dailyScansChart {\n    max-height: 400px;\n}\n\n@media (max-width: 1024px) {\n    .analytics-grid {\n        grid-template-columns: 1fr;\n        gap: 1.5rem;\n    }\n    \n    .analytics-panel.panel-small,\n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n    \n    .graphs-preview {\n        width: 400px;\n    }\n}\n\n@media (max-width: 768px) {\n    .main-content {\n        margin-left: 0;\n        padding: 1rem;\n    }\n    \n    .side-panel {\n        width: 50px;\n    }\n    \n    .panel-logo-icon {\n        width: 40px;\n        height: 40px;\n        font-size: 1.5rem;\n    }\n    \n    .graphs-preview {\n        left: 50px;\n        width: calc(100vw - 50px);\n        border-radius: 0;\n    }\n    \n    .dashboard-header h1 {\n        font-size: 1.8rem;\n    }\n    \n    .stats-grid {\n        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n        gap: 1rem;\n    }\n    \n    .chart-header {\n        flex-direction: column;\n        gap: 1rem;\n        align-items: flex-start;\n    }\n    \n    .chart-controls {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .chart-btn {\n        flex: 1;\n    }\n    \n    .map-view-toggle {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .map-btn {\n        flex: 1;\n        font-size: 0.8rem;\n        padding: 0.4rem 0.6rem;\n    }\n    \n    .geo-context-panel {\n        flex-direction: column;\n    }\n    \n    .context-stat {\n        width: 100%;\n    }\n    \n    .map-timeline-control {\n        flex-direction: column;\n        gap: 0.5rem;\n    }\n    \n    .timeline-info {\n        text-align: center;\n    }\n    \n    .analytics-header {\n        flex-direction: column;\n        align-items: flex-start;\n    }\n}\n\n/* Map Container */\n.map-container {\n    background: var(--bg-card);\n    border-radius: 12px;\n    padding: 24px;\n    box-shadow: 0 4px 12px var(--shadow-color);\n    border: 2px solid var(--border-color);\n    transition: all 0.3s ease;\n    min-height: 600px;\n}\n\n.map-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 8px 24px var(--shadow-color), 0 0 20px var(--success-glow);\n}\n\n#worldMap {\n    width: 100%;\n    height: 500px;\n    border-radius: 8px;\n    margin-bottom: 15px;\n    background: var(--bg-secondary);\n    border: 1px solid var(--border-color);\n    z-index: 1;\n    position: relative;\n}\n\n.map-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 20px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.map-header h2 {\n    margin: 0;\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-header h2 i {\n    color: var(--accent-green);\n    margin-right: 8px;\n}\n\n.map-controls {\n    display: flex;\n    gap: 20px;\n    align-items: center;\n    flex-wrap: wrap;\n}\n\n.map-view-toggle {\n    display: flex;\n    gap: 8px;\n    background: var(--bg-secondary);\n    padding: 4px;\n    border-radius: 8px;\n    border: 1px solid var(--border-color);\n}\n\n.map-btn {\n    background: transparent;\n    border: none;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.map-btn:hover {\n    background: var(--bg-hover);\n    color: var(--text-primary);\n}\n\n.map-btn.active {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    box-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-btn i {\n    font-size: 1rem;\n}\n\n.map-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.legend-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n}\n\n.legend-dot {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    box-shadow: 0 0 6px currentColor;\n}\n\n.malware-dot {\n    background-color: var(--accent-red);\n}\n\n.suspicious-dot {\n    background-color: var(--accent-yellow);\n}\n\n.benign-dot {\n    background-color: var(--accent-green);\n}\n\n.geo-context-panel {\n    display: flex;\n    justify-content: space-around;\n    gap: 20px;\n    padding: 15px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-bottom: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.context-stat {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 5px;\n}\n\n.context-label {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.context-value {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.context-value.threat-count {\n    color: var(--accent-red);\n    text-shadow: 0 0 10px var(--danger-glow);\n}\n\n.map-timeline-control {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 12px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-top: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.timeline-btn {\n    background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-green-dim) 100%);\n    color: var(--bg-primary);\n    border: none;\n    padding: 10px 20px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.95rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    box-shadow: 0 4px 12px var(--success-glow);\n}\n\n.timeline-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px var(--success-glow);\n    filter: brightness(1.1);\n}\n\n.timeline-btn i {\n    font-size: 1rem;\n}\n\n.timeline-info {\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-style: italic;\n}\n\n#worldMap {\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n}\n\n/* Leaflet popup customization for theme */\n.leaflet-popup-content-wrapper {\n    background: var(--bg-card) !important;\n    color: var(--text-primary) !important;\n    border: 2px solid var(--accent-green) !important;\n    box-shadow: 0 4px 15px var(--shadow-color) !important;\n    border-radius: 8px !important;\n}\n\n.leaflet-popup-tip {\n    background: var(--bg-card) !important;\n}\n\n.leaflet-popup-content h3 {\n    color: var(--accent-green) !important;\n}\n\n.leaflet-popup-content button {\n    background: var(--accent-green) !important;\n    color: var(--bg-primary) !important;\n    border: none !important;\n    padding: 8px 16px !important;\n    border-radius: 6px !important;\n    cursor: pointer !important;\n    font-weight: 600 !important;\n    transition: all 0.2s ease !important;\n}\n\n.leaflet-popup-content button:hover {\n    transform: translateY(-2px) !important;\n    box-shadow: 0 4px 12px var(--success-glow) !important;\n}\n\n/* Correlation Graph */\n.correlation-container {\n    background: rgba(255, 255, 255, 0.03);\n    border-radius: 12px;\n    padding: 24px;\n    margin-top: 24px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.correlation-header {\n    margin-bottom: 20px;\n}\n\n.correlation-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.5rem;\n    color: #e0e0e0;\n}\n\n.correlation-header h2 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.correlation-subtitle {\n    color: #888;\n    font-size: 0.9rem;\n    margin: 0;\n}\n\n.graph-controls {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 16px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.graph-btn {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.3s;\n}\n\n.graph-btn:hover {\n    background: rgba(90, 156, 248, 0.3);\n    border-color: #5a9cf8;\n}\n\n.graph-btn i {\n    margin-right: 6px;\n}\n\n.graph-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.node-sample {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    border: 2px solid #fff;\n}\n\n.malware-node {\n    background-color: #ff4757;\n}\n\n.agent-node {\n    background-color: #5a9cf8;\n}\n\n.api-node {\n    background-color: #ffa502;\n}\n\n.string-node {\n    background-color: #26de81;\n}\n\n#correlationGraph {\n    width: 100%;\n    min-height: 600px;\n    position: relative;\n    border-radius: 8px;\n    overflow: hidden;\n}\n\n.node-details {\n    position: absolute;\n    right: 24px;\n    top: 120px;\n    background: rgba(30, 30, 30, 0.95);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    border-radius: 8px;\n    padding: 16px;\n    max-width: 300px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    z-index: 1000;\n}\n\n.node-details h3 {\n    margin: 0 0 12px 0;\n    color: #5a9cf8;\n    font-size: 1.1rem;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 8px;\n}\n\n.node-details p {\n    margin: 8px 0;\n    color: #e0e0e0;\n    font-size: 0.9rem;\n}\n\n.node-details ul {\n    color: #b0b0b0;\n    font-size: 0.85rem;\n}\n\n.node-details li {\n    margin: 4px 0;\n}\n\n/* ========================================\n   LIGHT THEME CONTRAST FIXES\n   ======================================== */\n\n/* Fix 1 & 2: Analytics preview backgrounds - lighter for better green contrast */\n[data-theme=\"light\"] .eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.05) 0%, rgba(255, 165, 2, 0.05) 100%);\n    border-color: rgba(255, 71, 87, 0.2);\n}\n\n[data-theme=\"light\"] .modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.05) 0%, rgba(38, 222, 129, 0.05) 100%);\n    border-color: rgba(90, 156, 248, 0.2);\n}\n\n/* Fix 3: Theme toggle button text - darker for contrast */\n[data-theme=\"light\"] .theme-toggle {\n    color: #1a1f2e;\n    background: rgba(255, 255, 255, 0.8);\n    border-color: rgba(46, 214, 15, 0.4);\n}\n\n/* Fix 4: Daily Analysis chart - darker labels and grid (handled in JS via CSS vars) */\n[data-theme=\"light\"] {\n    --chart-text-color: #374151;\n    --chart-grid-color: rgba(0, 0, 0, 0.12);\n}\n\n:root {\n    --chart-text-color: #9ca3af;\n    --chart-grid-color: rgba(255, 255, 255, 0.1);\n}\n\n/* Fix 5: Chart container labels - darker in light theme */\n[data-theme=\"light\"] .chart-header h2,\n[data-theme=\"light\"] .chart-header {\n    color: #1a1f2e;\n}\n\n/* Fix 6: Threat Vector Correlation header - darker */\n[data-theme=\"light\"] .correlation-header h2 {\n    color: #1a1f2e;\n}\n\n[data-theme=\"light\"] .correlation-subtitle {\n    color: #4a5568;\n}\n\n/* Fix 7: ETI subtitle and summary - darker for better contrast */\n[data-theme=\"light\"] .eti-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .eti-summary {\n    color: #374151;\n}\n\n/* Fix 8: Prediction labels in threat modeler - darker */\n[data-theme=\"light\"] .modeler-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .modeler-field label {\n    color: #374151;\n}\n\n[data-theme=\"light\"] .modeler-hint {\n    color: #6b7280;\n}\n\n/* Fix 9: Analytics preview backgrounds - much lighter for green text visibility */\n[data-theme=\"light\"] .preview-box {\n    background: rgba(255, 255, 255, 0.6);\n    border-color: rgba(46, 214, 15, 0.3);\n}\n\n/* Fix 10: ETI item text - lighter for better readability */\n[data-theme=\"light\"] .eti-count {\n    color: #6b7280;\n}\n\n[data-theme=\"light\"] .eti-details {\n    color: #9ca3af;\n}\n\n[data-theme=\"light\"] .eti-name {\n    color: #1f2937;\n}\n\n/* Fix 11: Make ETI details much more visible in light theme */\n[data-theme=\"light\"] .eti-details {\n    color: #5a9cf8;\n    font-weight: 500;\n}\n\n/* Fix 12: Threat ticker text visibility in light theme */\n[data-theme=\"light\"] .ticker-item {\n    color: #374151;\n    font-weight: 500;\n}\n\n/* Back to Top Button */\n.back-to-top {\n    position: fixed;\n    bottom: 30px;\n    right: 30px;\n    width: 50px;\n    height: 50px;\n    background: linear-gradient(135deg, var(--accent-green), var(--accent-green-dim));\n    border: 2px solid var(--accent-green);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    z-index: 9998;\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px var(--success-glow);\n    color: #000;\n    font-size: 1.2rem;\n}\n\n.back-to-top.visible {\n    opacity: 1;\n    visibility: visible;\n}\n\n.back-to-top:hover {\n    transform: translateY(-5px) scale(1.1);\n    box-shadow: 0 6px 30px var(--success-glow);\n}\n\n.back-to-top:active {\n    transform: translateY(-2px) scale(1.05);\n}\n\n[data-theme=\"light\"] .back-to-top {\n    background: linear-gradient(135deg, #2ed60f, #27b00c);\n    color: #fff;\n}\n","epoch":51,"telemetryInfo":{}}],["file:///home/trang/localnsv/mAIware-server/public/styles.css::request_319f88cc-c105-40bf-9ccf-2a83e597e944",{"uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/styles.css","external":"file:///home/trang/localnsv/mAIware-server/public/styles.css","path":"/home/trang/localnsv/mAIware-server/public/styles.css","scheme":"file"},"requestId":"request_319f88cc-c105-40bf-9ccf-2a83e597e944","content":":root {\n    --bg-primary: #000000;\n    --bg-secondary: #0a0a0a;\n    --bg-card: #0f0f0f;\n    --bg-hover: #151515;\n    --text-primary: #e8f0e8;\n    --text-secondary: #9ca3af;\n    --accent-green: #20be65;\n    --accent-green-dim: #3ea874;\n    --accent-yellow: #ffd700;\n    --accent-red: #ff3b3b;\n    --accent-red-dim: #cc2f2f;\n    --border-color: #1a1a1a;\n    --shadow-color: rgba(0, 0, 0, 0.5);\n    --success-glow: rgba(57, 255, 20, 0.3);\n    --danger-glow: rgba(255, 59, 59, 0.3);\n    --warning-glow: rgba(255, 215, 0, 0.3);\n    /* Chart theming */\n    --chart-text-color: #9ca3af;\n    --chart-grid-color: rgba(255, 255, 255, 0.1);\n}\n\n[data-theme=\"light\"] {\n    --bg-primary: #f0f4f0;\n    --bg-secondary: #ffffff;\n    --bg-card: #fafafa;\n    --bg-hover: #e8f5e8;\n    --text-primary: #1a1f2e;\n    --text-secondary: #4a5568;\n    --accent-green: #20be65;\n    --accent-green-dim: #3ea874;\n    --accent-yellow: #cc9a00;\n    --accent-red: #dc2626;\n    --accent-red-dim: #b91c1c;\n    --border-color: #d1d5db;\n    --shadow-color: rgba(0, 0, 0, 0.1);\n    --success-glow: rgba(46, 214, 15, 0.2);\n    --danger-glow: rgba(220, 38, 38, 0.2);\n    --warning-glow: rgba(204, 154, 0, 0.2);\n    /* Chart theming overrides for light mode */\n    --chart-text-color: #1f2937; /* gray-800 for maximum contrast */\n    --chart-grid-color: rgba(0, 0, 0, 0.12);\n}\n\n* { \n    margin: 0; \n    padding: 0; \n    box-sizing: border-box; \n}\n\nbody {\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    background: var(--bg-primary);\n    color: var(--text-primary);\n    min-height: 100vh;\n    margin: 0;\n    overflow-x: hidden;\n    position: relative;\n}\n\nbody::before {\n    content: '';\n    position: fixed;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: \n        radial-gradient(circle at 20% 50%, rgba(57, 255, 20, 0.08) 0%, transparent 50%),\n        radial-gradient(circle at 80% 80%, rgba(57, 255, 20, 0.06) 0%, transparent 50%),\n        radial-gradient(circle at 40% 20%, rgba(57, 255, 20, 0.05) 0%, transparent 50%);\n    animation: backgroundGlow 15s ease-in-out infinite;\n    pointer-events: none;\n    z-index: 0;\n}\n\n@keyframes backgroundGlow {\n    0%, 100% { \n        transform: translate(0, 0) scale(1);\n        opacity: 0.4;\n    }\n    33% { \n        transform: translate(10%, 10%) scale(1.1);\n        opacity: 0.6;\n    }\n    66% { \n        transform: translate(-10%, 5%) scale(0.95);\n        opacity: 0.5;\n    }\n}\n\nbody > * {\n    position: relative;\n    z-index: 1;\n}\n\n/* Side Panel Navigation */\n.side-panel {\n    position: fixed;\n    left: 0;\n    top: 0;\n    height: 100vh;\n    width: 70px;\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border-right: 1px solid rgba(57, 255, 20, 0.2);\n    box-shadow: 0 0 30px rgba(57, 255, 20, 0.1);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    z-index: 9999;\n    transition: all 0.3s ease;\n}\n\n.side-panel:hover {\n    background: rgba(15, 15, 15, 0.8);\n    box-shadow: 0 0 40px rgba(57, 255, 20, 0.2);\n}\n\n.panel-icon-strip {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 2rem 0;\n}\n\n.panel-logo-icon {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 50px;\n    height: 50px;\n    color: var(--accent-green);\n    font-size: 2rem;\n    animation: pulse-glow 3s ease-in-out infinite;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.panel-logo-icon:hover {\n    transform: scale(1.1);\n    filter: drop-shadow(0 0 20px var(--success-glow));\n}\n\n@keyframes pulse-glow {\n    0%, 100% { filter: drop-shadow(0 0 5px var(--success-glow)); }\n    50% { filter: drop-shadow(0 0 15px var(--success-glow)) drop-shadow(0 0 25px var(--success-glow)); }\n}\n\n/* Graphs Preview Grid */\n.graphs-preview {\n    position: fixed;\n    left: 70px;\n    top: 50%;\n    transform: translateY(-50%) translateX(-100%);\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-left: none;\n    border-radius: 0 12px 12px 0;\n    padding: 2rem;\n    width: 480px;\n    max-height: 90vh;\n    overflow-y: auto;\n    opacity: 0;\n    visibility: hidden;\n    pointer-events: none;\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease, visibility 0.3s;\n    box-shadow: 5px 0 40px rgba(57, 255, 20, 0.15);\n    z-index: 9998;\n    will-change: transform, opacity;\n}\n\n.graphs-preview::-webkit-scrollbar {\n    width: 6px;\n}\n\n.graphs-preview::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 3px;\n}\n\n.graphs-preview::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 3px;\n}\n\n.graphs-preview.show {\n    opacity: 1;\n    visibility: visible;\n    pointer-events: auto;\n    transform: translateY(-50%) translateX(0);\n}\n\n.preview-header {\n    margin-bottom: 1rem;\n    padding-bottom: 0.8rem;\n    border-bottom: 1px solid var(--border-color);\n}\n\n.preview-header h3 {\n    color: var(--accent-green);\n    font-size: 1.1rem;\n    margin-bottom: 0.3rem;\n}\n\n.preview-header p {\n    color: var(--text-secondary);\n    font-size: 0.85rem;\n}\n\n/* Analytics Miniview - Scaled down live view */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-content {\n    width: 100%;\n    height: 100%;\n    transform-origin: top left;\n    transform: scale(0.25);\n    width: 400%;\n    height: 400%;\n    pointer-events: none;\n    overflow: hidden;\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n.preview-home-nav {\n    margin-top: 1.5rem;\n    padding: 1rem;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 10px;\n    display: flex;\n    align-items: center;\n    gap: 0.8rem;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    opacity: 0;\n    visibility: hidden;\n    transform: translateY(10px);\n}\n\n.preview-home-nav.visible {\n    opacity: 1;\n    visibility: visible;\n    transform: translateY(0);\n}\n\n.preview-home-nav:hover {\n    background: var(--bg-hover);\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.preview-home-nav i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n}\n\n.preview-home-nav span {\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--text-primary);\n}\n\n.preview-label {\n    flex: 1;\n    font-size: 0.95rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    letter-spacing: 0.3px;\n}\n\n/* Analytics Miniview - Screenshot preview */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    padding: 1.5rem;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-preview {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    opacity: 0.7;\n}\n\n.preview-row {\n    display: flex;\n    gap: 1rem;\n    flex: 1;\n}\n\n.preview-box {\n    flex: 1;\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 6px;\n    position: relative;\n    overflow: hidden;\n    padding: 0.5rem;\n}\n\n.preview-box.large {\n    flex: 2;\n}\n\n.preview-box.wide {\n    flex: 1;\n    min-height: 150px;\n}\n\n.box-header {\n    font-size: 0.65rem;\n    color: var(--accent-green);\n    margin-bottom: 0.5rem;\n    opacity: 0.8;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.box-content {\n    height: calc(100% - 1.5rem);\n    position: relative;\n}\n\n.map-visual {\n    background: radial-gradient(circle at center, rgba(57, 255, 20, 0.05), transparent);\n    position: relative;\n}\n\n.map-dot {\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 10px var(--accent-green);\n    animation: map-pulse 2s ease-in-out infinite;\n}\n\n.map-dot:nth-child(2) { animation-delay: 0.5s; }\n.map-dot:nth-child(3) { animation-delay: 1s; }\n\n@keyframes map-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.6; }\n    50% { transform: scale(1.5); opacity: 1; }\n}\n\n.chart-visual {\n    display: flex;\n    align-items: flex-end;\n    justify-content: space-around;\n    height: 100%;\n    padding: 0.5rem;\n    gap: 0.3rem;\n}\n\n.chart-bar {\n    flex: 1;\n    background: linear-gradient(180deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    animation: bar-grow 2s ease-in-out infinite;\n    opacity: 0.7;\n}\n\n.chart-bar:nth-child(2) { animation-delay: 0.2s; }\n.chart-bar:nth-child(3) { animation-delay: 0.4s; }\n.chart-bar:nth-child(4) { animation-delay: 0.6s; }\n\n@keyframes bar-grow {\n    0%, 100% { transform: scaleY(0.8); }\n    50% { transform: scaleY(1); }\n}\n\n.list-visual {\n    display: flex;\n    flex-direction: column;\n    gap: 0.4rem;\n    padding: 0.3rem;\n}\n\n.list-item {\n    height: 0.4rem;\n    background: linear-gradient(90deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    opacity: 0.6;\n    animation: list-fade 3s ease-in-out infinite;\n}\n\n.list-item:nth-child(2) { animation-delay: 0.5s; width: 80%; }\n.list-item:nth-child(3) { animation-delay: 1s; width: 60%; }\n\n@keyframes list-fade {\n    0%, 100% { opacity: 0.4; }\n    50% { opacity: 0.8; }\n}\n\n.network-visual {\n    position: relative;\n    height: 100%;\n}\n\n.network-node {\n    position: absolute;\n    width: 6px;\n    height: 6px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 8px var(--accent-green);\n    animation: node-pulse 3s ease-in-out infinite;\n}\n\n.network-node:nth-child(2) { animation-delay: 0.7s; }\n.network-node:nth-child(3) { animation-delay: 1.4s; }\n\n@keyframes node-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.5; }\n    50% { transform: scale(1.3); opacity: 1; }\n}\n\n.heat-visual {\n    background: \n        radial-gradient(circle at 30% 30%, rgba(57, 255, 20, 0.3), transparent 40%),\n        radial-gradient(circle at 70% 60%, rgba(57, 255, 20, 0.2), transparent 40%),\n        radial-gradient(circle at 50% 80%, rgba(57, 255, 20, 0.25), transparent 40%);\n    animation: heat-shift 4s ease-in-out infinite;\n}\n\n@keyframes heat-shift {\n    0%, 100% { opacity: 0.5; }\n    50% { opacity: 0.8; }\n}\n\n.pie-visual {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n}\n\n.pie-chart {\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    background: conic-gradient(\n        var(--accent-green) 0deg 120deg,\n        var(--accent-yellow) 120deg 240deg,\n        var(--accent-red) 240deg 360deg\n    );\n    box-shadow: 0 0 15px rgba(57, 255, 20, 0.4);\n    animation: pie-spin 10s linear infinite;\n}\n\n@keyframes pie-spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n\n/* Main Content Area */\n.main-content {\n    margin-left: 70px;\n    min-height: 100vh;\n    padding: 2rem;\n    transition: margin-left 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    position: relative;\n}\n\n/* Backdrop overlay for preview panel */\n.preview-backdrop {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    background: rgba(0, 0, 0, 0.4);\n    backdrop-filter: blur(2px);\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    z-index: 9998;\n    pointer-events: none;\n}\n\n.preview-backdrop.show {\n    opacity: 1;\n    visibility: visible;\n}\n\n/* View Containers */\n.view-container {\n    display: none;\n    animation: fadeIn 0.4s ease-in-out;\n}\n\n.view-container.active {\n    display: block;\n}\n\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n        transform: translateY(10px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n/* Dashboard Header */\n.dashboard-header {\n    text-align: center;\n    margin-bottom: 2.5rem;\n}\n\n.header-content h1 {\n    font-size: 2.5rem;\n    margin-bottom: 0.5rem;\n    color: var(--accent-green);\n    font-weight: 700;\n    letter-spacing: 2px;\n}\n\n.header-content .subtitle {\n    font-size: 1.2rem;\n    color: var(--text-secondary);\n    font-weight: 500;\n}\n\n.pulse-icon {\n    display: inline-block;\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n@keyframes pulse-scale {\n    0%, 100% {\n        transform: scale(1);\n        filter: drop-shadow(0 0 5px var(--success-glow));\n    }\n    50% {\n        transform: scale(1.05);\n        filter: drop-shadow(0 0 15px var(--success-glow));\n    }\n}\n\n/* Animations */\n.animate-slide-in {\n    animation: slideIn 0.6s ease-out;\n}\n\n@keyframes slideIn {\n    from {\n        opacity: 0;\n        transform: translateX(-30px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n.animate-fade-in {\n    animation: fadeInUp 0.6s ease-out;\n}\n\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.container {\n    max-width: 1400px;\n    margin: 0 auto;\n}\n\n/* Theme Toggle Button */\n.theme-toggle {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    background: rgba(15, 15, 15, 0.85);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50px;\n    padding: 10px 20px;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    font-size: 1rem;\n    color: var(--text-primary);\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px rgba(57, 255, 20, 0.2);\n    font-weight: 600;\n}\n\n.theme-toggle:hover {\n    background: rgba(15, 15, 15, 0.8);\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.theme-toggle .icon {\n    font-size: 1.2rem;\n}\n\n/* Auto-scroll indicators */\n.scroll-indicator {\n    position: fixed;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 60px;\n    height: 60px;\n    background: rgba(57, 255, 20, 0.15);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 2px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    opacity: 0;\n    pointer-events: none;\n    transition: opacity 0.3s ease;\n    z-index: 10001;\n}\n\n.scroll-indicator.visible {\n    opacity: 1;\n    animation: scroll-pulse 1.5s ease-in-out infinite;\n}\n\n.scroll-indicator.scroll-up {\n    top: 20px;\n}\n\n.scroll-indicator.scroll-down {\n    bottom: 20px;\n}\n\n.scroll-indicator i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    animation: scroll-bounce 1s ease-in-out infinite;\n}\n\n.scroll-up i {\n    animation-name: scroll-bounce-up;\n}\n\n.scroll-down i {\n    animation-name: scroll-bounce-down;\n}\n\n@keyframes scroll-pulse {\n    0%, 100% {\n        box-shadow: 0 0 10px rgba(57, 255, 20, 0.3);\n    }\n    50% {\n        box-shadow: 0 0 25px rgba(57, 255, 20, 0.6);\n    }\n}\n\n@keyframes scroll-bounce-up {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(-5px);\n    }\n}\n\n@keyframes scroll-bounce-down {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(5px);\n    }\n}\n\n/* Threat Ticker */\n.threat-ticker-container {\n    background: var(--bg-secondary);\n    border: 2px solid var(--accent-green);\n    border-radius: 8px;\n    padding: 12px;\n    margin-bottom: 2rem;\n    display: flex;\n    align-items: center;\n    gap: 16px;\n    overflow: hidden;\n    box-shadow: 0 2px 8px var(--success-glow);\n}\n\n.ticker-label {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 8px 16px;\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    border-radius: 6px;\n    font-weight: 700;\n    font-size: 0.75rem;\n    color: #fff;\n    white-space: nowrap;\n    box-shadow: 0 2px 8px rgba(255, 71, 87, 0.4);\n}\n\n.ticker-label i {\n    animation: pulse-broadcast 2s infinite;\n}\n\n@keyframes pulse-broadcast {\n    0%, 100% { opacity: 1; transform: scale(1); }\n    50% { opacity: 0.6; transform: scale(0.9); }\n}\n\n.threat-ticker {\n    flex: 1;\n    overflow: hidden;\n    position: relative;\n}\n\n.ticker-content {\n    display: flex;\n    gap: 40px;\n    white-space: nowrap;\n    animation: scroll-ticker 30s linear infinite;\n}\n\n.ticker-content:hover {\n    animation-play-state: paused;\n}\n\n@keyframes scroll-ticker {\n    0% { transform: translateX(0); }\n    100% { transform: translateX(-50%); }\n}\n\n.ticker-item {\n    color: #e0e0e0;\n    font-size: 0.9rem;\n    display: inline-flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.ticker-item i {\n    font-size: 0.5rem;\n    animation: blink 1.5s infinite;\n}\n\n@keyframes blink {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.3; }\n}\n\n/* Notification System */\n.notification-container {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    max-width: 400px;\n}\n\n.threat-notification {\n    background: rgba(30, 30, 30, 0.98);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 8px;\n    padding: 16px;\n    display: flex;\n    gap: 12px;\n    align-items: flex-start;\n    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);\n    transform: translateX(450px);\n    opacity: 0;\n    transition: all 0.3s ease-out;\n}\n\n.threat-notification.show {\n    transform: translateX(0);\n    opacity: 1;\n}\n\n.notification-icon {\n    font-size: 1.5rem;\n    flex-shrink: 0;\n}\n\n.notification-content {\n    flex: 1;\n}\n\n.notification-title {\n    font-size: 0.95rem;\n    color: #e0e0e0;\n    margin-bottom: 4px;\n}\n\n.notification-title strong {\n    text-transform: uppercase;\n    font-weight: 800;\n}\n\n.notification-details {\n    font-size: 0.85rem;\n    color: #b0b0b0;\n    margin-bottom: 6px;\n}\n\n.notification-meta {\n    font-size: 0.75rem;\n    color: #888;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.notification-close {\n    cursor: pointer;\n    color: #666;\n    transition: color 0.2s;\n    font-size: 0.9rem;\n}\n\n.notification-close:hover {\n    color: #e0e0e0;\n}\n\n/* Stat Card Pulse Animation */\n.stat-pulse {\n    animation: stat-pulse-animation 0.6s ease-out;\n}\n\n@keyframes stat-pulse-animation {\n    0% { transform: scale(1); }\n    50% { transform: scale(1.05); box-shadow: 0 8px 24px rgba(90, 156, 248, 0.4); }\n    100% { transform: scale(1); }\n}\n\nh1 {\n    font-size: 2.5rem;\n    color: #5a9cf8;\n    margin-bottom: 0.5rem;\n}\n\n.subtitle {\n    color: #888;\n    font-size: 1.1rem;\n}\n\n.stats-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1.5rem;\n    margin-bottom: 3rem;\n}\n\n.stat-card {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 1.5rem;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.8rem;\n    position: relative;\n    overflow: hidden;\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.stat-card::before {\n    content: '';\n    position: absolute;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: radial-gradient(circle, var(--accent-green) 0%, transparent 70%);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover::before {\n    opacity: 0.05;\n}\n\n.stat-card:hover {\n    transform: translateY(-5px) scale(1.02);\n    border-color: var(--accent-green);\n    box-shadow: 0 10px 30px var(--success-glow);\n}\n\n.stat-card i {\n    font-size: 2.5rem;\n    opacity: 0.8;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover i {\n    transform: scale(1.1) rotateY(180deg);\n    opacity: 1;\n}\n\n.stat-number {\n    font-size: 2.5rem;\n    font-weight: 700;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover .stat-number {\n    transform: scale(1.1);\n    text-shadow: 0 0 20px currentColor;\n}\n\n.stat-label {\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n    font-weight: 600;\n}\n\n.stat-glow {\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    height: 3px;\n    background: linear-gradient(90deg, transparent, var(--accent-green), transparent);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover .stat-glow {\n    opacity: 1;\n    animation: glowSlide 2s ease-in-out infinite;\n}\n\n@keyframes glowSlide {\n    0%, 100% {\n        transform: translateX(-100%);\n    }\n    50% {\n        transform: translateX(100%);\n    }\n}\n\n.stat-card.malware {\n    border-color: rgba(255, 59, 59, 0.3);\n}\n\n.stat-card.malware i,\n.stat-card.malware .stat-number {\n    color: var(--accent-red);\n}\n\n.stat-card.malware:hover {\n    border-color: var(--accent-red);\n    box-shadow: 0 10px 30px var(--danger-glow);\n}\n\n.stat-card.suspicious {\n    border-color: rgba(255, 215, 0, 0.3);\n}\n\n.stat-card.suspicious i,\n.stat-card.suspicious .stat-number {\n    color: var(--accent-yellow);\n}\n\n.stat-card.suspicious:hover {\n    border-color: var(--accent-yellow);\n    box-shadow: 0 10px 30px var(--warning-glow);\n}\n\n.stat-card.benign i,\n.stat-card.benign .stat-number,\n.stat-card.info i,\n.stat-card.info .stat-number {\n    color: var(--accent-green);\n}\n\n/* Analytics View */\n.analytics-header {\n    display: flex;\n    align-items: center;\n    gap: 2rem;\n    margin-bottom: 2.5rem;\n}\n\n.back-btn {\n    background: var(--bg-card);\n    border: 2px solid var(--accent-green);\n    color: var(--accent-green);\n    padding: 0.8rem 1.5rem;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 600;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    transition: all 0.3s ease;\n}\n\n.back-btn:hover {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    transform: translateX(-5px);\n    box-shadow: 0 5px 20px var(--success-glow);\n}\n\n.analytics-header h1 {\n    font-size: 2rem;\n    color: var(--accent-green);\n    font-weight: 700;\n}\n\n.analytics-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));\n    gap: 2rem;\n    max-height: calc(100vh - 200px);\n    overflow-y: auto;\n    padding-right: 1rem;\n    grid-auto-flow: dense;\n}\n\n/* Panel size classes for flexible tiling */\n.analytics-panel.panel-small {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-medium {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-large {\n    grid-column: span 2;\n}\n\n@media (max-width: 1400px) {\n    .analytics-grid {\n        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));\n    }\n    \n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n}\n\n.analytics-grid::-webkit-scrollbar {\n    width: 8px;\n}\n\n.analytics-grid::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb:hover {\n    background: var(--accent-green-dim);\n}\n\n.analytics-panel {\n    animation: slideInPanel 0.5s ease-out;\n    animation-fill-mode: backwards;\n}\n\n.analytics-panel:nth-child(1) { animation-delay: 0.05s; }\n.analytics-panel:nth-child(2) { animation-delay: 0.1s; }\n.analytics-panel:nth-child(3) { animation-delay: 0.15s; }\n.analytics-panel:nth-child(4) { animation-delay: 0.2s; }\n.analytics-panel:nth-child(5) { animation-delay: 0.25s; }\n.analytics-panel:nth-child(6) { animation-delay: 0.3s; }\n\n@keyframes slideInPanel {\n    from {\n        opacity: 0;\n        transform: translateY(30px) scale(0.95);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n    }\n}\n\n/* Advanced Analytics Grid for Mini Charts */\n.advanced-analytics-grid {\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 12px;\n    padding: 1.5rem;\n}\n\n.mini-charts-grid {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 1.5rem;\n    margin-top: 1rem;\n}\n\n.mini-chart-container {\n    background: rgba(10, 10, 10, 0.6);\n    border: 1px solid rgba(57, 255, 20, 0.15);\n    border-radius: 8px;\n    padding: 1rem;\n}\n\n.mini-chart-container h3 {\n    color: var(--accent-green);\n    font-size: 0.95rem;\n    margin: 0 0 0.75rem 0;\n    font-weight: 600;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.mini-chart-container h3 i {\n    font-size: 0.9rem;\n}\n\n@media (max-width: 1200px) {\n    .mini-charts-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n/* Emerging Threat Intelligence Panel */\n.eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.1) 0%, rgba(255, 165, 2, 0.1) 100%);\n    border: 2px solid rgba(255, 71, 87, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(255, 71, 87, 0.2);\n}\n\n.eti-header {\n    margin-bottom: 24px;\n}\n\n.eti-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #ff6b6b;\n    text-shadow: 0 2px 4px rgba(255, 71, 87, 0.3);\n}\n\n.eti-header h2 i {\n    color: #ff4757;\n    margin-right: 10px;\n    animation: pulse 2s infinite;\n}\n\n@keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.6; }\n}\n\n.eti-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 8px 0 16px 0;\n}\n\n.eti-summary {\n    display: flex;\n    gap: 12px;\n    flex-wrap: wrap;\n}\n\n.eti-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 6px 14px;\n    border-radius: 20px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.eti-badge.recent {\n    background: rgba(255, 71, 87, 0.2);\n    border-color: rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.eti-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n    gap: 20px;\n}\n\n.eti-panel {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 18px;\n    transition: transform 0.3s, box-shadow 0.3s;\n}\n\n.eti-panel:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);\n}\n\n.eti-panel h3 {\n    margin: 0 0 6px 0;\n    font-size: 1.1rem;\n    color: #e0e0e0;\n}\n\n.eti-panel h3 i {\n    color: #ffa502;\n    margin-right: 8px;\n}\n\n.eti-subtitle-small {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 14px;\n}\n\n.eti-list {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n}\n\n.eti-item {\n    display: flex;\n    gap: 12px;\n    background: rgba(255, 255, 255, 0.03);\n    border: 1px solid rgba(255, 255, 255, 0.08);\n    border-radius: 8px;\n    padding: 12px;\n    transition: all 0.3s;\n}\n\n.eti-item:hover {\n    background: rgba(255, 255, 255, 0.06);\n    border-color: rgba(255, 165, 2, 0.4);\n    transform: translateX(4px);\n}\n\n.eti-rank {\n    flex-shrink: 0;\n    width: 32px;\n    height: 32px;\n    background: linear-gradient(135deg, #ff6b6b, #ffa502);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: bold;\n    font-size: 1rem;\n    color: #fff;\n    box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);\n}\n\n.eti-item[data-rank=\"1\"] .eti-rank {\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    transform: scale(1.1);\n}\n\n.eti-content {\n    flex: 1;\n    min-width: 0;\n}\n\n.eti-name {\n    font-weight: 600;\n    color: #e0e0e0;\n    font-size: 0.95rem;\n    margin-bottom: 4px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-meta {\n    display: flex;\n    gap: 8px;\n    flex-wrap: wrap;\n    align-items: center;\n}\n\n.eti-count {\n    color: #888;\n    font-size: 0.8rem;\n}\n\n.eti-recent-badge {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-agent-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-details {\n    margin-top: 6px;\n    color: #5a92e1;\n    font-size: 0.75rem;\n    font-style: italic;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-empty {\n    text-align: center;\n    color: #666;\n    padding: 20px;\n    font-style: italic;\n}\n\n/* Threat Modeler */\n.modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.1) 0%, rgba(38, 222, 129, 0.1) 100%);\n    border: 2px solid rgba(90, 156, 248, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(90, 156, 248, 0.2);\n}\n\n.modeler-header {\n    margin-bottom: 24px;\n}\n\n.modeler-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #5a9cf8;\n}\n\n.modeler-header h2 i {\n    color: #26de81;\n    margin-right: 10px;\n}\n\n.modeler-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 0;\n}\n\n.modeler-grid {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 24px;\n}\n\n@media (max-width: 1024px) {\n    .modeler-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n.modeler-builder,\n.modeler-results {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 20px;\n}\n\n.modeler-builder h3,\n.modeler-results h3 {\n    margin: 0 0 20px 0;\n    font-size: 1.2rem;\n    color: #e0e0e0;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n    padding-bottom: 10px;\n}\n\n.modeler-builder h3 i {\n    color: #26de81;\n    margin-right: 8px;\n}\n\n.modeler-results h3 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.modeler-field {\n    margin-bottom: 20px;\n}\n\n.modeler-field label {\n    display: block;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n    margin-bottom: 6px;\n    font-weight: 600;\n}\n\n.modeler-select {\n    width: 100%;\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.2);\n    border-radius: 6px;\n    color: #e0e0e0;\n    padding: 10px;\n    font-size: 0.9rem;\n    font-family: inherit;\n    cursor: pointer;\n    transition: all 0.3s;\n}\n\n.modeler-select:focus {\n    outline: none;\n    border-color: #5a9cf8;\n    background: rgba(90, 156, 248, 0.1);\n}\n\n.modeler-select option {\n    background: #1a1a2e;\n    color: #e0e0e0;\n    padding: 8px;\n}\n\n.modeler-hint {\n    display: block;\n    color: #666;\n    font-size: 0.75rem;\n    margin-top: 4px;\n    font-style: italic;\n}\n\n.modeler-analyze-btn {\n    width: 100%;\n    background: linear-gradient(135deg, #26de81, #20bf6b);\n    border: none;\n    color: #fff;\n    padding: 14px 24px;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 700;\n    cursor: pointer;\n    transition: all 0.3s;\n    box-shadow: 0 4px 12px rgba(38, 222, 129, 0.3);\n}\n\n.modeler-analyze-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(38, 222, 129, 0.4);\n}\n\n.modeler-analyze-btn i {\n    margin-right: 8px;\n}\n\n.modeler-output {\n    min-height: 400px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.modeler-placeholder {\n    text-align: center;\n    color: #666;\n}\n\n.modeler-placeholder i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n    opacity: 0.5;\n}\n\n.modeler-placeholder p {\n    font-size: 0.95rem;\n}\n\n.modeler-loading {\n    text-align: center;\n    color: #5a9cf8;\n}\n\n.modeler-loading i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.modeler-error {\n    text-align: center;\n    color: #ff4757;\n}\n\n.modeler-error i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.prediction-result {\n    width: 100%;\n}\n\n.prediction-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 24px;\n    padding: 20px;\n    background: rgba(255, 255, 255, 0.05);\n    border-radius: 8px;\n}\n\n.prediction-badge {\n    padding: 12px 24px;\n    border-radius: 8px;\n    font-size: 1.3rem;\n    font-weight: 800;\n    color: #fff;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n\n.prediction-confidence {\n    text-align: right;\n}\n\n.confidence-label {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 4px;\n}\n\n.confidence-value {\n    color: #5a9cf8;\n    font-size: 2rem;\n    font-weight: 800;\n}\n\n.prediction-family {\n    padding: 16px;\n    background: rgba(255, 71, 87, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 6px;\n    margin-bottom: 20px;\n    color: #e0e0e0;\n}\n\n.family-name {\n    color: #ff6b6b;\n    font-weight: 700;\n    font-size: 1.1rem;\n    margin-left: 8px;\n}\n\n.prediction-section {\n    margin-bottom: 20px;\n}\n\n.prediction-section h4 {\n    color: #5a9cf8;\n    font-size: 1rem;\n    margin: 0 0 12px 0;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 6px;\n}\n\n.analysis-item {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    padding: 8px 0;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n}\n\n.analysis-item i {\n    color: #ffa502;\n    width: 20px;\n}\n\n.indicator-group {\n    margin-bottom: 16px;\n}\n\n.indicator-group strong {\n    display: block;\n    color: #e0e0e0;\n    margin-bottom: 8px;\n    font-size: 0.9rem;\n}\n\n.indicator-list {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 8px;\n}\n\n.indicator-tag {\n    padding: 6px 12px;\n    border-radius: 6px;\n    font-size: 0.8rem;\n    font-weight: 600;\n    font-family: 'Courier New', monospace;\n}\n\n.api-tag {\n    background: rgba(255, 165, 2, 0.2);\n    border: 1px solid rgba(255, 165, 2, 0.4);\n    color: #ffa502;\n}\n\n.string-tag {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.prediction-footer {\n    margin-top: 20px;\n    padding: 12px;\n    background: rgba(90, 156, 248, 0.1);\n    border-radius: 6px;\n    color: #5a9cf8;\n    font-size: 0.85rem;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.scans-container {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 2rem;\n    transition: all 0.3s ease;\n}\n\n.scans-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--shadow-color);\n}\n\n.scans-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.scans-header h2 {\n    color: #2bcfae;\n}\n\n.refresh-btn {\n    background: #2bcfae;\n    color: white;\n    border: none;\n    padding: 0.75rem 1.5rem;\n    border-radius: 8px;\n    cursor: pointer;\n    font-size: 1rem;\n    transition: background 0.2s;\n}\n\n.refresh-btn:hover {\n    background: #1db084;\n}\n\n.scans-table {\n    width: 100%;\n    border-collapse: collapse;\n}\n\n.scans-table th {\n    text-align: left;\n    padding: 1rem;\n    background: rgba(255, 255, 255, 0.05);\n    color: #2bcfae;\n    font-weight: 600;\n}\n\n.scans-table td {\n    padding: 1rem;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.scans-table tr:hover {\n    background: rgba(255, 255, 255, 0.03);\n}\n\n.badge {\n    display: inline-block;\n    padding: 0.3rem 0.8rem;\n    border-radius: 6px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.badge.malware { background: #ff4757; color: white; }\n.badge.suspicious { background: #ffa502; color: white; }\n.badge.benign { background: #34d118; color: white; }\n.badge.non-pe { background: #4b5563; color: #fff; }\n\n.hash {\n    font-family: 'Courier New', monospace;\n    font-size: 0.85rem;\n    color: #888;\n}\n\n.empty-state {\n    text-align: center;\n    padding: 3rem;\n    color: #666;\n}\n\n.empty-state i {\n    font-size: 4rem;\n    margin-bottom: 1rem;\n    opacity: 0.3;\n}\n\n/* NEW: Chart Container Styles */\n.chart-container {\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 12px;\n    padding: 2rem;\n    margin-top: 2rem;\n}\n\n.chart-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.chart-header h2 {\n    color: var(--accent-green);\n    margin: 0;\n}\n\n.chart-subtitle {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    margin: 0.5rem 0 0 0;\n    font-weight: normal;\n}\n\n.chart-controls {\n    display: flex;\n    gap: 0.5rem;\n}\n\n.chart-btn {\n    background: rgba(255, 255, 255, 0.05);\n    color: #888;\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    padding: 0.5rem 1rem;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.2s;\n}\n\n.chart-btn:hover {\n    background: rgba(255, 255, 255, 0.1);\n    color: #e0e0e0;\n}\n\n.chart-btn.active {\n    background: #2bcfae;\n    color: white;\n    border-color: #2bcfae;\n}\n\n#dailyScansChart {\n    max-height: 400px;\n}\n\n@media (max-width: 1024px) {\n    .analytics-grid {\n        grid-template-columns: 1fr;\n        gap: 1.5rem;\n    }\n    \n    .analytics-panel.panel-small,\n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n    \n    .graphs-preview {\n        width: 400px;\n    }\n}\n\n@media (max-width: 768px) {\n    .main-content {\n        margin-left: 0;\n        padding: 1rem;\n    }\n    \n    .side-panel {\n        width: 50px;\n    }\n    \n    .panel-logo-icon {\n        width: 40px;\n        height: 40px;\n        font-size: 1.5rem;\n    }\n    \n    .graphs-preview {\n        left: 50px;\n        width: calc(100vw - 50px);\n        border-radius: 0;\n    }\n    \n    .dashboard-header h1 {\n        font-size: 1.8rem;\n    }\n    \n    .stats-grid {\n        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n        gap: 1rem;\n    }\n    \n    .chart-header {\n        flex-direction: column;\n        gap: 1rem;\n        align-items: flex-start;\n    }\n    \n    .chart-controls {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .chart-btn {\n        flex: 1;\n    }\n    \n    .map-view-toggle {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .map-btn {\n        flex: 1;\n        font-size: 0.8rem;\n        padding: 0.4rem 0.6rem;\n    }\n    \n    .geo-context-panel {\n        flex-direction: column;\n    }\n    \n    .context-stat {\n        width: 100%;\n    }\n    \n    .map-timeline-control {\n        flex-direction: column;\n        gap: 0.5rem;\n    }\n    \n    .timeline-info {\n        text-align: center;\n    }\n    \n    .analytics-header {\n        flex-direction: column;\n        align-items: flex-start;\n    }\n}\n\n/* Map Container */\n.map-container {\n    background: var(--bg-card);\n    border-radius: 12px;\n    padding: 24px;\n    box-shadow: 0 4px 12px var(--shadow-color);\n    border: 2px solid var(--border-color);\n    transition: all 0.3s ease;\n    min-height: 600px;\n}\n\n.map-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 8px 24px var(--shadow-color), 0 0 20px var(--success-glow);\n}\n\n#worldMap {\n    width: 100%;\n    height: 500px;\n    border-radius: 8px;\n    margin-bottom: 15px;\n    background: var(--bg-secondary);\n    border: 1px solid var(--border-color);\n    z-index: 1;\n    position: relative;\n}\n\n.map-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 20px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.map-header h2 {\n    margin: 0;\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-header h2 i {\n    color: var(--accent-green);\n    margin-right: 8px;\n}\n\n.map-controls {\n    display: flex;\n    gap: 20px;\n    align-items: center;\n    flex-wrap: wrap;\n}\n\n.map-view-toggle {\n    display: flex;\n    gap: 8px;\n    background: var(--bg-secondary);\n    padding: 4px;\n    border-radius: 8px;\n    border: 1px solid var(--border-color);\n}\n\n.map-btn {\n    background: transparent;\n    border: none;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.map-btn:hover {\n    background: var(--bg-hover);\n    color: var(--text-primary);\n}\n\n.map-btn.active {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    box-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-btn i {\n    font-size: 1rem;\n}\n\n.map-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.legend-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n}\n\n.legend-dot {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    box-shadow: 0 0 6px currentColor;\n}\n\n.malware-dot {\n    background-color: var(--accent-red);\n}\n\n.suspicious-dot {\n    background-color: var(--accent-yellow);\n}\n\n.benign-dot {\n    background-color: var(--accent-green);\n}\n\n.geo-context-panel {\n    display: flex;\n    justify-content: space-around;\n    gap: 20px;\n    padding: 15px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-bottom: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.context-stat {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 5px;\n}\n\n.context-label {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.context-value {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.context-value.threat-count {\n    color: var(--accent-red);\n    text-shadow: 0 0 10px var(--danger-glow);\n}\n\n.map-timeline-control {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 12px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-top: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.timeline-btn {\n    background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-green-dim) 100%);\n    color: var(--bg-primary);\n    border: none;\n    padding: 10px 20px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.95rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    box-shadow: 0 4px 12px var(--success-glow);\n}\n\n.timeline-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px var(--success-glow);\n    filter: brightness(1.1);\n}\n\n.timeline-btn i {\n    font-size: 1rem;\n}\n\n.timeline-info {\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-style: italic;\n}\n\n#worldMap {\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n}\n\n/* Leaflet popup customization for theme */\n.leaflet-popup-content-wrapper {\n    background: var(--bg-card) !important;\n    color: var(--text-primary) !important;\n    border: 2px solid var(--accent-green) !important;\n    box-shadow: 0 4px 15px var(--shadow-color) !important;\n    border-radius: 8px !important;\n}\n\n.leaflet-popup-tip {\n    background: var(--bg-card) !important;\n}\n\n.leaflet-popup-content h3 {\n    color: var(--accent-green) !important;\n}\n\n.leaflet-popup-content button {\n    background: var(--accent-green) !important;\n    color: var(--bg-primary) !important;\n    border: none !important;\n    padding: 8px 16px !important;\n    border-radius: 6px !important;\n    cursor: pointer !important;\n    font-weight: 600 !important;\n    transition: all 0.2s ease !important;\n}\n\n.leaflet-popup-content button:hover {\n    transform: translateY(-2px) !important;\n    box-shadow: 0 4px 12px var(--success-glow) !important;\n}\n\n/* Correlation Graph */\n.correlation-container {\n    background: rgba(255, 255, 255, 0.03);\n    border-radius: 12px;\n    padding: 24px;\n    margin-top: 24px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.correlation-header {\n    margin-bottom: 20px;\n}\n\n.correlation-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.5rem;\n    color: #e0e0e0;\n}\n\n.correlation-header h2 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.correlation-subtitle {\n    color: #888;\n    font-size: 0.9rem;\n    margin: 0;\n}\n\n.graph-controls {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 16px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.graph-btn {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.3s;\n}\n\n.graph-btn:hover {\n    background: rgba(90, 156, 248, 0.3);\n    border-color: #5a9cf8;\n}\n\n.graph-btn i {\n    margin-right: 6px;\n}\n\n.graph-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.node-sample {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    border: 2px solid #fff;\n}\n\n.malware-node {\n    background-color: #ff4757;\n}\n\n.agent-node {\n    background-color: #5a9cf8;\n}\n\n.api-node {\n    background-color: #ffa502;\n}\n\n.string-node {\n    background-color: #26de81;\n}\n\n#correlationGraph {\n    width: 100%;\n    min-height: 600px;\n    position: relative;\n    border-radius: 8px;\n    overflow: hidden;\n}\n\n.node-details {\n    position: absolute;\n    right: 24px;\n    top: 120px;\n    background: rgba(30, 30, 30, 0.95);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    border-radius: 8px;\n    padding: 16px;\n    max-width: 300px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    z-index: 1000;\n}\n\n.node-details h3 {\n    margin: 0 0 12px 0;\n    color: #5a9cf8;\n    font-size: 1.1rem;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 8px;\n}\n\n.node-details p {\n    margin: 8px 0;\n    color: #e0e0e0;\n    font-size: 0.9rem;\n}\n\n.node-details ul {\n    color: #b0b0b0;\n    font-size: 0.85rem;\n}\n\n.node-details li {\n    margin: 4px 0;\n}\n\n/* ========================================\n   LIGHT THEME CONTRAST FIXES\n   ======================================== */\n\n/* Fix 1 & 2: Analytics preview backgrounds - lighter for better green contrast */\n[data-theme=\"light\"] .eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.05) 0%, rgba(255, 165, 2, 0.05) 100%);\n    border-color: rgba(255, 71, 87, 0.2);\n}\n\n[data-theme=\"light\"] .modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.05) 0%, rgba(38, 222, 129, 0.05) 100%);\n    border-color: rgba(90, 156, 248, 0.2);\n}\n\n/* Fix 3: Theme toggle button text - darker for contrast */\n[data-theme=\"light\"] .theme-toggle {\n    color: #1a1f2e;\n    background: rgba(255, 255, 255, 0.8);\n    border-color: rgba(46, 214, 15, 0.4);\n}\n\n/* Fix 4: Daily Analysis chart - darker labels and grid (handled in JS via CSS vars) */\n[data-theme=\"light\"] {\n    --chart-text-color: #374151;\n    --chart-grid-color: rgba(0, 0, 0, 0.12);\n}\n\n:root {\n    --chart-text-color: #9ca3af;\n    --chart-grid-color: rgba(255, 255, 255, 0.1);\n}\n\n/* Fix 5: Chart container labels - darker in light theme */\n[data-theme=\"light\"] .chart-header h2,\n[data-theme=\"light\"] .chart-header {\n    color: #1a1f2e;\n}\n\n/* Fix 6: Threat Vector Correlation header - darker */\n[data-theme=\"light\"] .correlation-header h2 {\n    color: #1a1f2e;\n}\n\n[data-theme=\"light\"] .correlation-subtitle {\n    color: #4a5568;\n}\n\n/* Fix 7: ETI subtitle and summary - darker for better contrast */\n[data-theme=\"light\"] .eti-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .eti-summary {\n    color: #374151;\n}\n\n/* Fix 8: Prediction labels in threat modeler - darker */\n[data-theme=\"light\"] .modeler-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .modeler-field label {\n    color: #374151;\n}\n\n[data-theme=\"light\"] .modeler-hint {\n    color: #6b7280;\n}\n\n/* Fix 9: Analytics preview backgrounds - much lighter for green text visibility */\n[data-theme=\"light\"] .preview-box {\n    background: rgba(255, 255, 255, 0.6);\n    border-color: rgba(46, 214, 15, 0.3);\n}\n\n/* Fix 10: ETI item text - lighter for better readability */\n[data-theme=\"light\"] .eti-count {\n    color: #6b7280;\n}\n\n[data-theme=\"light\"] .eti-name {\n    color: #1f2937;\n}\n\n/* Fix 11: Make ETI details much more visible in light theme */\n[data-theme=\"light\"] .eti-details {\n    color: #437ed1;\n    font-weight: 500;\n}\n\n/* Fix 12: Threat ticker text visibility in light theme */\n[data-theme=\"light\"] .ticker-item {\n    color: #374151;\n    font-weight: 500;\n}\n\n/* Back to Top Button */\n.back-to-top {\n    position: fixed;\n    bottom: 30px;\n    right: 30px;\n    width: 50px;\n    height: 50px;\n    background: linear-gradient(135deg, var(--accent-green), var(--accent-green-dim));\n    border: 2px solid var(--accent-green);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    z-index: 9998;\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px var(--success-glow);\n    color: #000;\n    font-size: 1.2rem;\n}\n\n.back-to-top.visible {\n    opacity: 1;\n    visibility: visible;\n}\n\n.back-to-top:hover {\n    transform: translateY(-5px) scale(1.1);\n    box-shadow: 0 6px 30px var(--success-glow);\n}\n\n.back-to-top:active {\n    transform: translateY(-2px) scale(1.05);\n}\n\n[data-theme=\"light\"] .back-to-top {\n    background: linear-gradient(135deg, #2ed60f, #27b00c);\n    color: #fff;\n}\n","epoch":55,"telemetryInfo":{}}],["file:///home/trang/localnsv/mAIware-server/public/dashboard.html::request_b10a9f11-ae66-4c50-a78d-1a768eabe969",{"uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/dashboard.html","external":"file:///home/trang/localnsv/mAIware-server/public/dashboard.html","path":"/home/trang/localnsv/mAIware-server/public/dashboard.html","scheme":"file"},"requestId":"request_b10a9f11-ae66-4c50-a78d-1a768eabe969","content":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>mAIware Server Dashboard</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n    <link rel=\"stylesheet\" href=\"styles.css?v=3.0\">\n    <!-- Add Chart.js -->\n    <script src=\"https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js\"></script>\n    <!-- Add Leaflet.js for maps -->\n    <link rel=\"stylesheet\" href=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css\" />\n    <script src=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js\"></script>\n    <!-- Add Leaflet Heatmap Plugin -->\n    <script src=\"https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js\"></script>\n    <!-- Add D3.js for force-directed graph -->\n    <script src=\"https://d3js.org/d3.v7.min.js\"></script>\n    <!-- Add html2canvas for screenshots -->\n    <script src=\"https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js\"></script>\n</head>\n<body>\n    <!-- Theme Toggle Button -->\n    <button class=\"theme-toggle\" id=\"themeToggle\" onclick=\"toggleTheme()\">\n        <span class=\"icon\" id=\"themeIcon\">üåô</span>\n        <span id=\"themeText\">Dark</span>\n    </button>\n\n    <!-- Back to Top Button -->\n    <button class=\"back-to-top\" id=\"backToTop\" onclick=\"scrollToTop()\">\n        <i class=\"fas fa-arrow-up\"></i>\n    </button>\n\n    <!-- Preview Backdrop -->\n    <div class=\"preview-backdrop\" id=\"previewBackdrop\"></div>\n\n    <!-- Side Navigation Panel -->\n    <div class=\"side-panel\" id=\"sidePanel\">\n        <!-- Logo Icon (always visible) -->\n        <div class=\"panel-icon-strip\">\n            <div class=\"panel-logo-icon\">\n                <i class=\"fas fa-shield-virus\"></i>\n            </div>\n        </div>\n        \n        <!-- Analytics Preview Panel (slides out on hover) -->\n        <div class=\"graphs-preview\" id=\"graphsPreview\">\n            <div class=\"preview-header\">\n                <h3><i class=\"fas fa-chart-line\"></i> Analytics Preview</h3>\n                <p>Click anywhere to view full analytics</p>\n            </div>\n            \n            <!-- Scaled-down live view of analytics -->\n            <div class=\"analytics-miniview\" id=\"analyticsMiniview\" onclick=\"switchView('analytics')\">\n                <div class=\"miniview-preview\">\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box large\">\n                            <div class=\"box-header\">Global Threat Map</div>\n                            <div class=\"box-content map-visual\">\n                                <div class=\"map-dot\" style=\"top: 30%; left: 40%;\"></div>\n                                <div class=\"map-dot\" style=\"top: 60%; left: 70%;\"></div>\n                                <div class=\"map-dot\" style=\"top: 45%; left: 25%;\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box large\">\n                            <div class=\"box-header\">Attack Timeline</div>\n                            <div class=\"box-content chart-visual\">\n                                <div class=\"chart-bar\" style=\"height: 40%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 70%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 55%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 85%;\"></div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Top Threats</div>\n                            <div class=\"box-content list-visual\">\n                                <div class=\"list-item\"></div>\n                                <div class=\"list-item\"></div>\n                                <div class=\"list-item\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Correlations</div>\n                            <div class=\"box-content network-visual\">\n                                <div class=\"network-node\" style=\"top: 30%; left: 30%;\"></div>\n                                <div class=\"network-node\" style=\"top: 60%; left: 50%;\"></div>\n                                <div class=\"network-node\" style=\"top: 45%; left: 70%;\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Heatmap</div>\n                            <div class=\"box-content heat-visual\"></div>\n                        </div>\n                    </div>\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box wide\">\n                            <div class=\"box-header\">File Analysis & Distribution</div>\n                            <div class=\"box-content pie-visual\">\n                                <div class=\"pie-chart\"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"miniview-overlay\">\n                    <i class=\"fas fa-expand-alt\"></i>\n                    <span>Click to view analytics</span>\n                </div>\n            </div>                <!-- Home Navigation Button -->\n                <div class=\"preview-home-nav\" id=\"homeNavBtn\" onclick=\"switchView('dashboard')\">\n                    <i class=\"fas fa-home\"></i>\n                    <span>Back to Dashboard</span>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"main-content\" id=\"mainContent\">\n        <!-- DASHBOARD VIEW -->\n        <div class=\"view-container active\" id=\"dashboardView\">\n            <header class=\"dashboard-header\">\n                <div class=\"header-content\">\n                    <h1><i class=\"fas fa-shield-virus pulse-icon\"></i> mAIware Server</h1>\n                    <p class=\"subtitle\">Real-time Malware Analysis Dashboard</p>\n                </div>\n            </header>\n            \n            <!-- Real-time Threat Ticker -->\n            <div class=\"threat-ticker-container animate-slide-in\">\n                <div class=\"ticker-label\">\n                    <i class=\"fas fa-broadcast-tower pulse-icon\"></i>\n                    <span>LIVE THREAT FEED</span>\n                </div>\n                <div class=\"threat-ticker\" id=\"threat-ticker\">\n                    <div class=\"ticker-content\" id=\"ticker-content\">\n                        <span class=\"ticker-item\">System ready - Monitoring for threats...</span>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Notification Toast Container -->\n            <div id=\"notification-container\" class=\"notification-container\"></div>\n            \n            <!-- Stats Grid -->\n            <div class=\"stats-grid animate-fade-in\" id=\"stats-grid\">\n                <div class=\"stat-card info\">\n                    <i class=\"fas fa-laptop\"></i>\n                    <span class=\"stat-number\" id=\"stat-clients\">0</span>\n                    <span class=\"stat-label\">Active Clients</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card info\">\n                    <i class=\"fas fa-chart-line\"></i>\n                    <span class=\"stat-number\" id=\"stat-total\">0</span>\n                    <span class=\"stat-label\">Total Scans</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card malware\">\n                    <i class=\"fas fa-bug\"></i>\n                    <span class=\"stat-number\" id=\"stat-malware\">0</span>\n                    <span class=\"stat-label\">Malware</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card suspicious\">\n                    <i class=\"fas fa-exclamation-triangle\"></i>\n                    <span class=\"stat-number\" id=\"stat-suspicious\">0</span>\n                    <span class=\"stat-label\">Suspicious</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card benign\">\n                    <i class=\"fas fa-check-circle\"></i>\n                    <span class=\"stat-number\" id=\"stat-benign\">0</span>\n                    <span class=\"stat-label\">Benign</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n            </div>\n            \n            <!-- Recent Scans -->\n            <div class=\"scans-container animate-fade-in\">\n                <div class=\"scans-header\">\n                    <h2><i class=\"fas fa-list\"></i> Recent Scans</h2>\n                    <button class=\"refresh-btn\" onclick=\"manualRefresh()\">\n                        <i class=\"fas fa-sync-alt\"></i> Refresh\n                    </button>\n                </div>\n                \n                <table class=\"scans-table\">\n                    <thead>\n                        <tr>\n                            <th>Timestamp</th>\n                            <th>Filename</th>\n                            <th>Classification</th>\n                            <th>Client IP</th>\n                            <th>Hash (SHA256)</th>\n                        </tr>\n                    </thead>\n                    <tbody id=\"scans-tbody\">\n                        <tr>\n                            <td colspan=\"5\" class=\"empty-state\">\n                                <i class=\"fas fa-inbox\"></i>\n                                <p>No scans yet. Waiting for clients...</p>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n\n        <!-- ANALYTICS VIEW -->\n        <div class=\"view-container\" id=\"analyticsView\">\n            <div class=\"analytics-header\">\n                <button class=\"back-btn\" onclick=\"switchView('dashboard')\">\n                    <i class=\"fas fa-arrow-left\"></i> Back to Dashboard\n                </button>\n                <h1><i class=\"fas fa-chart-line\"></i> Analytics & Intelligence</h1>\n            </div>\n            \n            <div class=\"analytics-grid\" id=\"analyticsGrid\">\n                \n                <!-- Daily Analysis Chart -->\n                <div class=\"chart-container analytics-panel panel-large\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-line\"></i> Daily Analysis Trends</h2>\n                        <div class=\"chart-controls\">\n                            <button class=\"chart-btn active\" onclick=\"setChartDays(7)\">7 Days</button>\n                            <button class=\"chart-btn\" onclick=\"setChartDays(14)\">14 Days</button>\n                            <button class=\"chart-btn\" onclick=\"setChartDays(30)\">30 Days</button>\n                        </div>\n                    </div>\n                    <canvas id=\"dailyScansChart\"></canvas>\n                </div>\n                    <canvas id=\"dailyScansChart\"></canvas>\n                </div>\n\n                <!-- Geographic Threat Intelligence Map -->\n                <div class=\"map-container analytics-panel panel-large\">\n                    <div class=\"map-header\">\n                        <h2><i class=\"fas fa-globe-americas\"></i> Global Threat Intelligence Map</h2>\n                        <div class=\"map-controls\">\n                            <div class=\"map-view-toggle\">\n                                <button class=\"map-btn active\" data-view=\"markers\" onclick=\"switchMapView('markers')\">\n                                    <i class=\"fas fa-map-marker-alt\"></i> Markers\n                                </button>\n                                <button class=\"map-btn\" data-view=\"heatmap\" onclick=\"switchMapView('heatmap')\">\n                                    <i class=\"fas fa-fire\"></i> Heatmap\n                                </button>\n                                <button class=\"map-btn\" data-view=\"choropleth\" onclick=\"switchMapView('choropleth')\">\n                                    <i class=\"fas fa-globe\"></i> Choropleth\n                                </button>\n                            </div>\n                            <div class=\"map-legend\">\n                                <span class=\"legend-item\"><span class=\"legend-dot malware-dot\"></span> Malware</span>\n                                <span class=\"legend-item\"><span class=\"legend-dot suspicious-dot\"></span> Suspicious</span>\n                                <span class=\"legend-item\"><span class=\"legend-dot benign-dot\"></span> Benign</span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Geographic Context Panel -->\n                    <div class=\"geo-context-panel\" id=\"geoContext\">\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Active Regions:</span>\n                            <span class=\"context-value\" id=\"activeRegions\">0</span>\n                        </div>\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Hotspot:</span>\n                            <span class=\"context-value\" id=\"topRegion\">None</span>\n                        </div>\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Total Threats:</span>\n                            <span class=\"context-value threat-count\" id=\"geoThreatCount\">0</span>\n                        </div>\n                    </div>\n                    \n                    <div id=\"worldMap\" style=\"height: 500px; border-radius: 8px; margin-bottom: 15px;\"></div>\n                    \n                    <!-- Timeline Control -->\n                    <div class=\"map-timeline-control\">\n                        <button class=\"timeline-btn\" onclick=\"replayThreats()\" id=\"replayBtn\">\n                            <i class=\"fas fa-play\"></i> Replay Last 24h\n                        </button>\n                        <div class=\"timeline-info\" id=\"timelineInfo\">\n                            Click replay to see threat propagation over time\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Malware Source Distribution -->\n                <div class=\"chart-container analytics-panel panel-small\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-pie\"></i> Malware Source Distribution</h2>\n                    </div>\n                    <div style=\"max-width: 500px; margin: 0 auto;\">\n                        <canvas id=\"malwareSourceChart\"></canvas>\n                    </div>\n                </div>\n\n                <!-- Graph 2: \"Noisiest\" Agents Over Time -->\n                <div class=\"chart-container analytics-panel panel-large\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-desktop\"></i> \"Noisiest\" Agents Over Time</h2>\n                        <p class=\"chart-subtitle\">Threat detection trends for top 5 high-risk agents</p>\n                    </div>\n                    <div style=\"height: 300px;\">\n                        <canvas id=\"noisyAgentsChart\"></canvas>\n                    </div>\n                </div>\n\n                <!-- Advanced Analytics Grid -->\n                <div class=\"analytics-panel panel-large advanced-analytics-grid\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-area\"></i> Advanced Statistical Analysis</h2>\n                        <p class=\"chart-subtitle\">Deep dive into signature verification, packer usage, AI confidence, and entropy patterns</p>\n                    </div>\n                    \n                    <div class=\"mini-charts-grid\">\n                        <!-- Graph 3: Signature Status vs. Classification -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-certificate\"></i> Signature vs. Classification</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"signatureClassChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 4: Packer Usage vs. Classification -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-box\"></i> Packer vs. Classification</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"packerClassChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 5: Confidence Score Distribution -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-brain\"></i> AI Confidence Distribution</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"confidenceHistChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 6: File Entropy Distribution -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-chart-bar\"></i> Entropy Distribution</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"entropyBoxChart\"></canvas>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Threat Vector Correlation Explorer -->\n                <div class=\"correlation-container analytics-panel panel-large\">\n                    <div class=\"correlation-header\">\n                        <h2><i class=\"fas fa-project-diagram\"></i> Threat Vector Correlation Explorer</h2>\n                        <p class=\"correlation-subtitle\">Interactive intelligence map showing relationships between malware families, agents, APIs, and indicators</p>\n                    </div>\n                    <div class=\"graph-controls\">\n                        <button class=\"graph-btn\" onclick=\"resetGraph()\"><i class=\"fas fa-sync\"></i> Reset View</button>\n                        <button class=\"graph-btn\" onclick=\"centerGraph()\"><i class=\"fas fa-compress\"></i> Center</button>\n                        <div class=\"graph-legend\">\n                            <span class=\"legend-item\"><span class=\"node-sample malware-node\"></span> Malware Family</span>\n                            <span class=\"legend-item\"><span class=\"node-sample agent-node\"></span> Agent/System</span>\n                            <span class=\"legend-item\"><span class=\"node-sample api-node\"></span> API Call</span>\n                            <span class=\"legend-item\"><span class=\"node-sample string-node\"></span> Suspicious String</span>\n                        </div>\n                    </div>\n                    <div id=\"correlationGraph\"></div>\n                    <div id=\"nodeDetails\" class=\"node-details\" style=\"display: none;\">\n                        <h3 id=\"detailsTitle\"></h3>\n                        <div id=\"detailsContent\"></div>\n                    </div>\n                </div>\n\n                <!-- Emerging Threat Intelligence Panel -->\n                <div class=\"eti-container analytics-panel panel-large\">\n                    <div class=\"eti-header\">\n                        <h2><i class=\"fas fa-exclamation-triangle\"></i> Emerging Threat Intelligence (ETI)</h2>\n                        <p class=\"eti-subtitle\">Real-time actionable intelligence on active threats and indicators of compromise</p>\n                        <div class=\"eti-summary\">\n                            <span class=\"eti-badge\" id=\"eti-total\">0 Total Threats</span>\n                            <span class=\"eti-badge recent\" id=\"eti-recent\">0 Last 24h</span>\n                        </div>\n                    </div>\n                    \n                    <div class=\"eti-grid\">\n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-virus\"></i> Top Malware Families</h3>\n                            <div class=\"eti-subtitle-small\">Most active malware families detected</div>\n                            <div id=\"eti-malware\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-code\"></i> Top Suspicious APIs</h3>\n                            <div class=\"eti-subtitle-small\">Most frequently called malicious APIs</div>\n                            <div id=\"eti-apis\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-terminal\"></i> Top Malicious Strings</h3>\n                            <div class=\"eti-subtitle-small\">Most common IOC strings and commands</div>\n                            <div id=\"eti-strings\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-shield-alt\"></i> Top Packers/Obfuscators</h3>\n                            <div class=\"eti-subtitle-small\">Most used evasion techniques</div>\n                            <div id=\"eti-packers\" class=\"eti-list\"></div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Predictive Threat Modeler -->\n                <div class=\"modeler-container analytics-panel panel-large\">\n                    <div class=\"modeler-header\">\n                        <h2><i class=\"fas fa-flask\"></i> Predictive Threat Modeler</h2>\n                        <p class=\"modeler-subtitle\">Build hypothetical malware and predict how mAIware would classify it</p>\n                    </div>\n                    \n                    <div class=\"modeler-grid\">\n                <div class=\"modeler-builder\">\n                    <h3><i class=\"fas fa-cogs\"></i> Threat Configuration</h3>\n                    \n                    <div class=\"modeler-field\">\n                        <label>File Type</label>\n                        <select id=\"model-filetype\" class=\"modeler-select\">\n                            <option>PE32+ (GUI) x86-64</option>\n                            <option>PE32 (Console) Intel 80386</option>\n                            <option>PE32+ DLL x86-64</option>\n                            <option>MSI Installer</option>\n                            <option>PDF Document</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Packer/Obfuscator</label>\n                        <select id=\"model-packer\" class=\"modeler-select\">\n                            <option>None</option>\n                            <option>UPX</option>\n                            <option>VMProtect</option>\n                            <option>Themida</option>\n                            <option>ASPack</option>\n                            <option>Unknown (High Entropy)</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Digital Signature</label>\n                        <select id=\"model-signature\" class=\"modeler-select\">\n                            <option>Verified (Microsoft Corporation)</option>\n                            <option>Verified (Google LLC)</option>\n                            <option>Verified (Unknown Publisher)</option>\n                            <option>Not Signed</option>\n                            <option>Expired Certificate</option>\n                            <option>Self-Signed (Untrusted)</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>API Imports (select multiple)</label>\n                        <select id=\"model-apis\" class=\"modeler-select\" multiple size=\"6\">\n                            <option>CreateRemoteThread</option>\n                            <option>WriteProcessMemory</option>\n                            <option>VirtualAllocEx</option>\n                            <option>SetWindowsHookExW</option>\n                            <option>URLDownloadToFileW</option>\n                            <option>WinExec</option>\n                            <option>RegSetValueExW</option>\n                            <option>CryptEncrypt</option>\n                            <option>Socket</option>\n                            <option>ReadFile</option>\n                        </select>\n                        <small class=\"modeler-hint\">Hold Ctrl/Cmd to select multiple</small>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Suspicious Strings (select multiple)</label>\n                        <select id=\"model-strings\" class=\"modeler-select\" multiple size=\"6\">\n                            <option>http://bad-c2-server.com/payload.dat</option>\n                            <option>keylog.txt</option>\n                            <option>steal_passwords</option>\n                            <option>powershell -enc</option>\n                            <option>vssadmin.exe delete shadows</option>\n                            <option>HOW_TO_DECRYPT.txt</option>\n                            <option>crack</option>\n                            <option>patch</option>\n                            <option>disable_antivirus</option>\n                        </select>\n                        <small class=\"modeler-hint\">Hold Ctrl/Cmd to select multiple</small>\n                    </div>\n                    \n                    <button class=\"modeler-analyze-btn\" onclick=\"analyzeThreatModel()\">\n                        <i class=\"fas fa-brain\"></i> ANALYZE THREAT\n                    </button>\n                </div>\n                \n                <div class=\"modeler-results\">\n                    <h3><i class=\"fas fa-chart-line\"></i> Prediction Results</h3>\n                    <div id=\"modeler-output\" class=\"modeler-output\">\n                        <div class=\"modeler-placeholder\">\n                            <i class=\"fas fa-arrow-left\"></i>\n                            <p>Configure a threat profile and click ANALYZE to see predictions</p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n            </div>\n        </div>\n    </div>\n    \n    <script>\n        // Helper function to get CSS variable values dynamically for theming\n        function getCSSVar(varName) {\n            return getComputedStyle(document.documentElement).getPropertyValue(varName).trim();\n        }\n\n        // Back to Top Button\n        const backToTopBtn = document.getElementById('backToTop');\n        \n        window.addEventListener('scroll', () => {\n            if (window.pageYOffset > 300) {\n                backToTopBtn.classList.add('visible');\n            } else {\n                backToTopBtn.classList.remove('visible');\n            }\n        });\n\n        function scrollToTop() {\n            window.scrollTo({\n                top: 0,\n                behavior: 'smooth'\n            });\n        }\n\n        // View Switching System\n        function switchView(viewName) {\n            const views = document.querySelectorAll('.view-container');\n            \n            views.forEach(view => {\n                view.classList.remove('active');\n                if (view.id === `${viewName}View`) {\n                    view.classList.add('active');\n                }\n            });\n            \n            currentView = viewName;\n            \n            // Fix map display when switching to analytics view\n            if (viewName === 'analytics') {\n                loadAnalytics(); // Lazy load analytics components\n                setTimeout(() => {\n                    if (worldMap) {\n                        worldMap.invalidateSize();\n                    }\n                    // Capture screenshot for preview after charts has rendered\n                    setTimeout(() => {\n                        createAnalyticsMiniview();\n                    }, 1500);\n                }, 100);\n            }\n            \n            // Close graphs preview when switching views\n            document.getElementById('graphsPreview').classList.remove('show');\n            document.getElementById('previewBackdrop').classList.remove('show');\n        }\n        \n        // Side Panel Hover System\n        const sidePanel = document.getElementById('sidePanel');\n        const graphsPreview = document.getElementById('graphsPreview');\n        const previewBackdrop = document.getElementById('previewBackdrop');\n        const homeNavBtn = document.getElementById('homeNavBtn');\n        let previewTimeout;\n        let previewsRendered = false;\n        let currentView = 'dashboard';\n        \n        // Show preview panel on sidebar hover\n        sidePanel.addEventListener('mouseenter', () => {\n            clearTimeout(previewTimeout);\n            previewTimeout = setTimeout(() => {\n                graphsPreview.classList.add('show');\n                previewBackdrop.classList.add('show');\n                \n                // Show/hide home button based on current view\n                if (currentView === 'analytics') {\n                    homeNavBtn.classList.add('visible');\n                } else {\n                    homeNavBtn.classList.remove('visible');\n                }\n            }, 200);\n        });\n        \n        sidePanel.addEventListener('mouseleave', () => {\n            clearTimeout(previewTimeout);\n            setTimeout(() => {\n                if (!graphsPreview.matches(':hover')) {\n                    graphsPreview.classList.remove('show');\n                    previewBackdrop.classList.remove('show');\n                }\n            }, 100);\n        });\n        \n        // Keep preview open when hovering over it\n        graphsPreview.addEventListener('mouseleave', () => {\n            graphsPreview.classList.remove('show');\n            previewBackdrop.classList.remove('show');\n        });\n        \n        // Close preview when clicking backdrop\n        previewBackdrop.addEventListener('click', () => {\n            graphsPreview.classList.remove('show');\n            previewBackdrop.classList.remove('show');\n        });\n        \n        // Create analytics miniview by taking a screenshot\n        let isCapturingSnapshot = false;\n        let hasInitialSnapshot = false;\n        \n        async function createAnalyticsMiniview() {\n            // Simplified - no actual screenshot, just a visual preview\n            hasInitialSnapshot = true;\n        }\n        \n        // Auto-scroll on hover down in analytics view\n        let scrollInterval;\n        const analyticsGrid = document.getElementById('analyticsGrid');\n        \n        if (analyticsGrid) {\n            analyticsGrid.addEventListener('mousemove', (e) => {\n                const rect = analyticsGrid.getBoundingClientRect();\n                const mouseY = e.clientY - rect.top;\n                const triggerZone = 100; // pixels from bottom\n                \n                if (rect.height - mouseY < triggerZone) {\n                    if (!scrollInterval) {\n                        scrollInterval = setInterval(() => {\n                            analyticsGrid.scrollBy({ top: 2, behavior: 'smooth' });\n                        }, 16);\n                    }\n                } else {\n                    if (scrollInterval) {\n                        clearInterval(scrollInterval);\n                        scrollInterval = null;\n                    }\n                }\n            });\n            \n            analyticsGrid.addEventListener('mouseleave', () => {\n                if (scrollInterval) {\n                    clearInterval(scrollInterval);\n                    scrollInterval = null;\n                }\n            });\n        }\n        \n        // Theme Toggle\n        window.toggleTheme = function() {\n            const html = document.documentElement;\n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            const currentTheme = html.getAttribute('data-theme');\n            \n            if (currentTheme === 'light') {\n                html.setAttribute('data-theme', '');\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n                localStorage.setItem('theme', 'dark');\n            } else {\n                html.setAttribute('data-theme', 'light');\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n                localStorage.setItem('theme', 'light');\n            }\n        };\n        \n        // Load saved theme\n        const savedTheme = localStorage.getItem('theme');\n        if (savedTheme === 'light') {\n            document.documentElement.setAttribute('data-theme', 'light');\n            document.getElementById('themeIcon').textContent = '‚òÄÔ∏è';\n            document.getElementById('themeText').textContent = 'Light';\n        }\n        \n        let dailyChart = null;\n        let currentChartDays = 30;\n        \n        // Notification and Animation System\n        const notificationQueue = [];\n        let isShowingNotification = false;\n        \n        function showThreatNotification(scan) {\n            const container = document.getElementById('notification-container');\n            \n            const classColor = \n                scan.classification === 'Malware' ? '#ff4757' :\n                scan.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n            \n            const icon = \n                scan.classification === 'Malware' ? 'fa-skull-crossbones' :\n                scan.classification === 'Suspicious' ? 'fa-exclamation-triangle' : 'fa-check-circle';\n            \n            const notification = document.createElement('div');\n            notification.className = 'threat-notification';\n            notification.style.borderLeftColor = classColor;\n            notification.innerHTML = `\n                <div class=\"notification-icon\" style=\"color: ${classColor};\">\n                    <i class=\"fas ${icon}\"></i>\n                </div>\n                <div class=\"notification-content\">\n                    <div class=\"notification-title\">\n                        <strong>${scan.classification}</strong> detected\n                    </div>\n                    <div class=\"notification-details\">\n                        ${scan.detected_filename}\n                        ${scan.malware_family ? ` - ${scan.malware_family}` : ''}\n                    </div>\n                    <div class=\"notification-meta\">\n                        <i class=\"fas fa-desktop\"></i> ${scan.systemInfo?.hostname || scan.clientIp || 'Unknown'}\n                    </div>\n                </div>\n                <div class=\"notification-close\" onclick=\"this.parentElement.remove()\">\n                    <i class=\"fas fa-times\"></i>\n                </div>\n            `;\n            \n            container.appendChild(notification);\n            \n            // Animate in\n            setTimeout(() => notification.classList.add('show'), 10);\n            \n            // Auto-remove after 8 seconds\n            setTimeout(() => {\n                notification.classList.remove('show');\n                setTimeout(() => notification.remove(), 300);\n            }, 8000);\n        }\n        \n        function addToThreatTicker(scan) {\n            const ticker = document.getElementById('ticker-content');\n            const timestamp = new Date(scan.serverTimestamp).toLocaleTimeString();\n            \n            const classColor = \n                scan.classification === 'Malware' ? '#ff4757' :\n                scan.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n            \n            const tickerItem = document.createElement('span');\n            tickerItem.className = 'ticker-item';\n            tickerItem.style.color = classColor;\n            tickerItem.innerHTML = `\n                <i class=\"fas fa-circle\"></i>\n                [${timestamp}] ${scan.classification}: ${scan.detected_filename}\n                ${scan.malware_family ? `(${scan.malware_family})` : ''}\n                on ${scan.systemInfo?.hostname || scan.clientIp || 'Unknown'}\n            `;\n            \n            ticker.appendChild(tickerItem);\n            \n            // Keep only last 10 items\n            while (ticker.children.length > 10) {\n                ticker.removeChild(ticker.firstChild);\n            }\n        }\n        \n        function animateStatCard(elementId, newValue) {\n            const element = document.getElementById(elementId);\n            if (!element) return;\n            \n            const currentValue = parseInt(element.textContent) || 0;\n            if (newValue > currentValue) {\n                // Pulse animation\n                element.parentElement.classList.add('stat-pulse');\n                setTimeout(() => element.parentElement.classList.remove('stat-pulse'), 600);\n                \n                // Animate number increment\n                const duration = 500;\n                const steps = 20;\n                const increment = (newValue - currentValue) / steps;\n                let current = currentValue;\n                let step = 0;\n                \n                const interval = setInterval(() => {\n                    step++;\n                    current += increment;\n                    element.textContent = Math.round(current);\n                    \n                    if (step >= steps) {\n                        element.textContent = newValue;\n                        clearInterval(interval);\n                    }\n                }, duration / steps);\n            } else {\n                element.textContent = newValue;\n            }\n        }\n        \n        async function loadStats() {\n            try {\n                const response = await fetch('/api/stats');\n                const stats = await response.json();\n                \n                animateStatCard('stat-clients', stats.activeClients);\n                animateStatCard('stat-total', stats.totalScans);\n                animateStatCard('stat-malware', stats.malwareCount);\n                animateStatCard('stat-suspicious', stats.suspiciousCount);\n                animateStatCard('stat-benign', stats.benignCount);\n            } catch (error) {\n                console.error('Failed to load stats:', error);\n            }\n        }\n        \n        async function loadScans() {\n            try {\n                const response = await fetch('/api/scans?limit=50');\n                const data = await response.json();\n                \n                const tbody = document.getElementById('scans-tbody');\n                \n                if (data.scans.length === 0) {\n                    tbody.innerHTML = `\n                        <tr>\n                            <td colspan=\"5\" class=\"empty-state\">\n                                <i class=\"fas fa-inbox\"></i>\n                                <p>No scans yet. Waiting for clients...</p>\n                            </td>\n                        </tr>\n                    `;\n                    return;\n                }\n                \n                tbody.innerHTML = data.scans.map(scan => {\n                    const timestamp = new Date(scan.serverTimestamp).toLocaleString();\n                    const hash = scan.file_hashes?.sha256 || 'N/A';\n                    const hashShort = hash.length > 16 ? (hash.substring(0, 16) + '...') : hash;\n                    const isNonPe = scan.is_pe === false;\n                    const classification = isNonPe ? 'Non-PE' : (scan.classification || 'Unknown');\n                    const badgeClass = isNonPe ? 'non-pe' : classification.toLowerCase();\n                    const nonPeTag = isNonPe ? '<span class=\"badge non-pe\" title=\"Non-PE file\">Non-PE</span>' : '';\n                    return `\n                        <tr>\n                            <td>${timestamp}</td>\n                            <td>${scan.detected_filename} ${nonPeTag}</td>\n                            <td><span class=\"badge ${badgeClass}\">${classification}</span></td>\n                            <td>${scan.systemInfo?.ip || scan.clientIp || 'Unknown'}</td>\n                            <td class=\"hash\" title=\"${hash}\">${hashShort}</td>\n                        </tr>\n                    `;\n                }).join('');\n                \n            } catch (error) {\n                console.error('Failed to load scans:', error);\n            }\n        }\n        \n        async function loadDailyChart() {\n            try {\n                const response = await fetch(`/api/daily-scans?days=${currentChartDays}`);\n                const data = await response.json();\n                \n                const ctx = document.getElementById('dailyScansChart');\n                \n                // Format dates for display (MM/DD)\n                const labels = data.days.map(day => {\n                    const date = new Date(day.date);\n                    return `${date.getMonth() + 1}/${date.getDate()}`;\n                });\n                \n                // Reuse existing chart if it exists\n                if (dailyChart) {\n                    dailyChart.data.labels = labels;\n                    dailyChart.data.datasets[0].data = data.days.map(d => d.total);\n                    dailyChart.data.datasets[1].data = data.days.map(d => d.malware);\n                    dailyChart.data.datasets[2].data = data.days.map(d => d.suspicious);\n                    dailyChart.data.datasets[3].data = data.days.map(d => d.benign);\n                    dailyChart.update('none'); // Update without animation\n                    return;\n                }\n                \n                dailyChart = new Chart(ctx, {\n                    type: 'line',\n                    data: {\n                        labels: labels,\n                        datasets: [\n                            {\n                                label: 'Total Scans',\n                                data: data.days.map(d => d.total),\n                                borderColor: '#5a9cf8',\n                                backgroundColor: 'rgba(90, 156, 248, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Malware',\n                                data: data.days.map(d => d.malware),\n                                borderColor: '#ff4757',\n                                backgroundColor: 'rgba(255, 71, 87, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Suspicious',\n                                data: data.days.map(d => d.suspicious),\n                                borderColor: '#ffa502',\n                                backgroundColor: 'rgba(255, 165, 2, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Benign',\n                                data: data.days.map(d => d.benign),\n                                borderColor: '#34d118',\n                                backgroundColor: 'rgba(52, 209, 24, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        interaction: {\n                            mode: 'index',\n                            intersect: false,\n                        },\n                        plugins: {\n                            legend: {\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 12 }\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0',\n                                borderColor: 'rgba(255, 255, 255, 0.1)',\n                                borderWidth: 1\n                            }\n                        },\n                        scales: {\n                            x: {\n                                ticks: { \n                                    color: getCSSVar('--chart-text-color') || '#888',\n                                    maxRotation: 45,\n                                    minRotation: 45\n                                },\n                                grid: { \n                                    color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' \n                                }\n                            },\n                            y: {\n                                beginAtZero: true,\n                                ticks: { \n                                    color: getCSSVar('--chart-text-color') || '#888',\n                                    stepSize: 1\n                                },\n                                grid: { \n                                    color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' \n                                }\n                            }\n                        }\n                    }\n                });\n                \n            } catch (error) {\n                console.error('Failed to load daily chart:', error);\n            }\n        }\n        \n        let worldMap = null;\n        let markerLayer = null;\n        let heatmapLayer = null;\n        let choroplethLayer = null;\n        let mapInitialized = false;\n        let lastGeoDataHash = '';\n        let sourceChart = null;\n        let currentMapView = 'markers';\n        let geoDataCache = null;\n        let replayInterval = null;\n        \n        // Country boundaries for choropleth (simplified)\n        const countryCoordinates = {\n            'United States': { center: [37.0902, -95.7129], weight: 0 },\n            'China': { center: [35.8617, 104.1954], weight: 0 },\n            'United Kingdom': { center: [55.3781, -3.4360], weight: 0 },\n            'Germany': { center: [51.1657, 10.4515], weight: 0 },\n            'France': { center: [46.2276, 2.2137], weight: 0 },\n            'Russia': { center: [61.5240, 105.3188], weight: 0 },\n            'Japan': { center: [36.2048, 138.2529], weight: 0 },\n            'India': { center: [20.5937, 78.9629], weight: 0 },\n            'Brazil': { center: [-14.2350, -51.9253], weight: 0 },\n            'Australia': { center: [-25.2744, 133.7751], weight: 0 }\n        };\n        \n        function initializeMap() {\n            if (mapInitialized) return;\n            \n            try {\n                worldMap = L.map('worldMap', {\n                    zoomControl: true,\n                    scrollWheelZoom: true,\n                    preferCanvas: false,\n                    worldCopyJump: true\n                }).setView([20, 0], 2);\n                \n                // Use dark theme tiles\n                L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {\n                    attribution: '&copy; OpenStreetMap contributors',\n                    subdomains: 'abcd',\n                    maxZoom: 18,\n                    minZoom: 1,\n                    noWrap: false,\n                    bounds: [[-90, -180], [90, 180]]\n                }).addTo(worldMap);\n                \n                markerLayer = L.layerGroup().addTo(worldMap);\n                mapInitialized = true;\n                \n                // Fix map display after initialization\n                setTimeout(() => {\n                    if (worldMap) worldMap.invalidateSize();\n                }, 100);\n            } catch (error) {\n                console.error('Failed to initialize map:', error);\n            }\n        }\n        \n        // Switch between map visualization modes\n        window.switchMapView = function(view) {\n            currentMapView = view;\n            \n            // Update button states\n            document.querySelectorAll('.map-btn').forEach(btn => {\n                btn.classList.remove('active');\n            });\n            document.querySelector(`[data-view=\"${view}\"]`).classList.add('active');\n            \n            // Reload map with new view\n            if (geoDataCache) {\n                renderMapView(geoDataCache);\n            }\n        };\n        \n        // Render different map views\n        function renderMapView(data) {\n            if (!worldMap) return;\n            \n            // Clear all layers\n            if (markerLayer) markerLayer.clearLayers();\n            if (heatmapLayer) {\n                worldMap.removeLayer(heatmapLayer);\n                heatmapLayer = null;\n            }\n            if (choroplethLayer) {\n                worldMap.removeLayer(choroplethLayer);\n                choroplethLayer = null;\n            }\n            \n            switch (currentMapView) {\n                case 'markers':\n                    renderMarkers(data);\n                    break;\n                case 'heatmap':\n                    renderHeatmap(data);\n                    break;\n                case 'choropleth':\n                    renderChoropleth(data);\n                    break;\n            }\n            \n            updateGeoContext(data);\n        }\n        \n        // Render traditional markers\n        function renderMarkers(data) {\n            data.locations.forEach(location => {\n                const { lat, lng, city, country } = location.location;\n                \n                let markerColor = '#26de81'; // benign\n                if (location.malwareCount > 0) {\n                    markerColor = '#ff3b3b'; // malware\n                } else if (location.suspiciousCount > 0) {\n                    markerColor = '#ffd700'; // suspicious\n                }\n                \n                const markerSize = Math.min(24, Math.max(8, 8 + location.totalScans * 2));\n                \n                const marker = L.circleMarker([lat, lng], {\n                    radius: markerSize / 2,\n                    fillColor: markerColor,\n                    color: '#fff',\n                    weight: 2,\n                    opacity: 0.8,\n                    fillOpacity: 0.6\n                });\n                \n                const popupContent = `\n                    <div style=\"color: var(--text-primary); min-width: 200px;\">\n                        <h3 style=\"margin: 0 0 10px 0; color: var(--accent-green); font-size: 1.1rem;\">\n                            <i class=\"fas fa-map-marker-alt\" style=\"color: ${markerColor};\"></i>\n                            ${city}, ${country}\n                        </h3>\n                        <p style=\"margin: 5px 0;\"><strong>IP:</strong> ${location.ip}</p>\n                        <p style=\"margin: 5px 0;\"><strong>Total Scans:</strong> ${location.totalScans}</p>\n                        <div style=\"margin-top: 10px;\">\n                            <div><span style=\"color: #ff3b3b;\">‚óè</span> Malware: ${location.malwareCount}</div>\n                            <div><span style=\"color: #ffd700;\">‚óè</span> Suspicious: ${location.suspiciousCount}</div>\n                            <div><span style=\"color: #34d118;\">‚óè</span> Benign: ${location.benignCount}</div>\n                        </div>\n                        <button onclick=\"filterByLocation('${country}')\" \n                                style=\"margin-top: 10px; padding: 5px 10px; background: var(--accent-green); \n                                       color: var(--bg-primary); border: none; border-radius: 5px; cursor: pointer;\">\n                            Filter by ${country}\n                        </button>\n                    </div>\n                `;\n                \n                marker.bindPopup(popupContent);\n                marker.addTo(markerLayer);\n                \n                marker.on('mouseover', function() {\n                    this.setStyle({ fillOpacity: 0.9, opacity: 1 });\n                });\n                marker.on('mouseout', function() {\n                    this.setStyle({ fillOpacity: 0.6, opacity: 0.8 });\n                });\n            });\n        }\n        \n        // Render heatmap overlay\n        function renderHeatmap(data) {\n            const heatData = [];\n            \n            data.locations.forEach(location => {\n                const { lat, lng } = location.location;\n                // Weight by threat severity: malware = 1.0, suspicious = 0.5, benign = 0.2\n                const weight = (location.malwareCount * 1.0 + \n                               location.suspiciousCount * 0.5 + \n                               location.benignCount * 0.2) / location.totalScans;\n                \n                // Add multiple points for higher intensity\n                const intensity = Math.ceil(location.totalScans * weight);\n                for (let i = 0; i < intensity; i++) {\n                    heatData.push([lat, lng, weight]);\n                }\n            });\n            \n            heatmapLayer = L.heatLayer(heatData, {\n                radius: 35,\n                blur: 25,\n                maxZoom: 10,\n                max: 1.0,\n                gradient: {\n                    0.0: '#34d118',  // Green (low threat)\n                    0.3: '#ffd700',  // Yellow\n                    0.6: '#ffa502',  // Orange\n                    0.8: '#ff6348',  // Red\n                    1.0: '#ff3b3b'   // Bright red (high threat)\n                }\n            }).addTo(worldMap);\n        }\n        \n        // Render choropleth (country-level threat shading)\n        function renderChoropleth(data) {\n            // Aggregate threats by country\n            const countryStats = {};\n            data.locations.forEach(location => {\n                const country = location.location.country;\n                if (!countryStats[country]) {\n                    countryStats[country] = { total: 0, malware: 0, suspicious: 0 };\n                }\n                countryStats[country].total += location.totalScans;\n                countryStats[country].malware += location.malwareCount;\n                countryStats[country].suspicious += location.suspiciousCount;\n            });\n            \n            // Find max for normalization\n            const maxThreats = Math.max(...Object.values(countryStats).map(s => \n                s.malware + s.suspicious * 0.5\n            ));\n            \n            // Draw circles for countries with threat data\n            choroplethLayer = L.layerGroup();\n            \n            Object.entries(countryStats).forEach(([country, stats]) => {\n                if (countryCoordinates[country]) {\n                    const threatScore = (stats.malware + stats.suspicious * 0.5) / maxThreats;\n                    \n                    // Color gradient from green to red\n                    let color;\n                    if (threatScore < 0.2) color = '#34d118';\n                    else if (threatScore < 0.4) color = '#ffd700';\n                    else if (threatScore < 0.6) color = '#ffa502';\n                    else if (threatScore < 0.8) color = '#ff6348';\n                    else color = '#ff3b3b';\n                    \n                    const circle = L.circle(countryCoordinates[country].center, {\n                        color: color,\n                        fillColor: color,\n                        fillOpacity: 0.4,\n                        radius: 500000 * (1 + threatScore * 2),\n                        weight: 2\n                    });\n                    \n                    circle.bindPopup(`\n                        <div style=\"color: var(--text-primary);\">\n                            <h3 style=\"color: var(--accent-green);\">${country}</h3>\n                            <p><strong>Total Threats:</strong> ${stats.total}</p>\n                            <p><strong>Malware:</strong> ${stats.malware}</p>\n                            <p><strong>Suspicious:</strong> ${stats.suspicious}</p>\n                            <p><strong>Threat Level:</strong> ${(threatScore * 100).toFixed(0)}%</p>\n                        </div>\n                    `);\n                    \n                    circle.addTo(choroplethLayer);\n                }\n            });\n            \n            choroplethLayer.addTo(worldMap);\n        }\n        \n        // Update geographic context panel\n        function updateGeoContext(data) {\n            const countries = new Set(data.locations.map(l => l.location.country));\n            document.getElementById('activeRegions').textContent = countries.size;\n            \n            // Find hotspot (country with most threats)\n            const countryThreats = {};\n            data.locations.forEach(loc => {\n                const country = loc.location.country;\n                countryThreats[country] = (countryThreats[country] || 0) + \n                    loc.malwareCount + loc.suspiciousCount;\n            });\n            \n            const hotspot = Object.entries(countryThreats)\n                .sort((a, b) => b[1] - a[1])[0];\n            \n            if (hotspot) {\n                const percentage = ((hotspot[1] / data.locations.reduce((sum, l) => \n                    sum + l.malwareCount + l.suspiciousCount, 0)) * 100).toFixed(0);\n                document.getElementById('topRegion').textContent = \n                    `${hotspot[0]} (${percentage}% of threats)`;\n            }\n            \n            const totalThreats = data.locations.reduce((sum, l) => \n                sum + l.malwareCount + l.suspiciousCount, 0);\n            document.getElementById('geoThreatCount').textContent = totalThreats;\n        }\n        \n        // Filter dashboard by geographic location\n        window.filterByLocation = function(country) {\n            console.log(`Filtering by country: ${country}`);\n            // This would filter the tables and charts - simplified for demo\n            alert(`Geographic filtering activated for ${country}.\\nIn full implementation, this would filter all dashboard data.`);\n        };\n        \n        // Replay threats over last 24 hours\n        window.replayThreats = async function() {\n            const btn = document.getElementById('replayBtn');\n            const info = document.getElementById('timelineInfo');\n            \n            if (replayInterval) {\n                clearInterval(replayInterval);\n                replayInterval = null;\n                btn.innerHTML = '<i class=\"fas fa-play\"></i> Replay Last 24h';\n                info.textContent = 'Replay stopped';\n                if (geoDataCache) renderMapView(geoDataCache);\n                return;\n            }\n            \n            if (!geoDataCache || geoDataCache.locations.length === 0) {\n                info.textContent = 'No data available for replay';\n                return;\n            }\n            \n            btn.innerHTML = '<i class=\"fas fa-stop\"></i> Stop Replay';\n            info.textContent = 'Replaying threat detection timeline...';\n            \n            // Sort locations by timestamp\n            const sortedLocations = [...geoDataCache.locations].sort((a, b) => {\n                const timeA = a.scans[0]?.timestamp || 0;\n                const timeB = b.scans[0]?.timestamp || 0;\n                return new Date(timeA) - new Date(timeB);\n            });\n            \n            if (markerLayer) markerLayer.clearLayers();\n            let index = 0;\n            \n            replayInterval = setInterval(() => {\n                if (index >= sortedLocations.length) {\n                    clearInterval(replayInterval);\n                    replayInterval = null;\n                    btn.innerHTML = '<i class=\"fas fa-play\"></i> Replay Last 24h';\n                    info.textContent = 'Replay complete';\n                    return;\n                }\n                \n                const location = sortedLocations[index];\n                const { lat, lng, city, country } = location.location;\n                \n                let markerColor = location.malwareCount > 0 ? '#ff3b3b' : \n                                 location.suspiciousCount > 0 ? '#ffd700' : '#34d118';\n                \n                // Animated marker appearance\n                const marker = L.circleMarker([lat, lng], {\n                    radius: 0,\n                    fillColor: markerColor,\n                    color: '#fff',\n                    weight: 2,\n                    opacity: 1,\n                    fillOpacity: 0.8\n                }).addTo(markerLayer);\n                \n                // Animate marker growth\n                let size = 0;\n                const growInterval = setInterval(() => {\n                    size += 2;\n                    if (size >= 12) {\n                        clearInterval(growInterval);\n                        marker.setStyle({ opacity: 0.8, fillOpacity: 0.6 });\n                    }\n                    marker.setRadius(size / 2);\n                }, 50);\n                \n                marker.bindPopup(`\n                    <div style=\"color: var(--text-primary);\">\n                        <strong>${city}, ${country}</strong><br>\n                        ${location.scans[0]?.filename || 'Unknown file'}\n                    </div>\n                `);\n                \n                info.textContent = `Replaying: ${index + 1}/${sortedLocations.length} - ${city}, ${country}`;\n                index++;\n            }, 800); // Show new threat every 800ms\n        };\n        \n        async function loadGeoMap() {\n            try {\n                // Initialize map only once\n                if (!mapInitialized) {\n                    initializeMap();\n                }\n                \n                if (!worldMap) return;\n                \n                const response = await fetch('/api/geo-data');\n                const data = await response.json();\n                \n                // Generate hash of current data to detect changes\n                const currentHash = JSON.stringify(data.locations.map(l => \n                    `${l.ip}-${l.totalScans}-${l.malwareCount}-${l.suspiciousCount}`\n                )).substring(0, 100);\n                \n                // Skip update if data hasn't changed\n                if (currentHash === lastGeoDataHash && markerLayer && markerLayer.getLayers().length > 0) {\n                    return;\n                }\n                lastGeoDataHash = currentHash;\n                \n                // Cache data for replay and other features\n                geoDataCache = data;\n                \n                // Render current view\n                renderMapView(data);\n                \n                console.log(`Map updated with ${data.locations.length} locations in ${currentMapView} mode`);\n                \n            } catch (error) {\n                console.error('Failed to load geo map:', error);\n            }\n        }\n        \n        async function loadMalwareSources() {\n            try {\n                const response = await fetch('/api/malware-sources');\n                const data = await response.json();\n                \n                const ctx = document.getElementById('malwareSourceChart');\n                \n                const labels = data.sources.map(s => s.source);\n                const counts = data.sources.map(s => s.count);\n                \n                // Color scheme for different sources\n                const colors = [\n                    '#ff6b6b', // Email Attachment - red\n                    '#4ecdc4', // Web Download - teal\n                    '#ffe66d', // USB/External Drive - yellow\n                    '#a8dadc', // Internal Network - light blue\n                    '#95a5a6'  // Unknown - gray\n                ];\n                \n                // Reuse existing chart if it exists\n                if (sourceChart) {\n                    sourceChart.data.labels = labels;\n                    sourceChart.data.datasets[0].data = counts;\n                    sourceChart.update('none');\n                    return;\n                }\n                \n                sourceChart = new Chart(ctx, {\n                    type: 'pie',\n                    data: {\n                        labels: labels,\n                        datasets: [{\n                            data: counts,\n                            backgroundColor: colors,\n                            borderColor: '#1a1a2e',\n                            borderWidth: 2\n                        }]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: true,\n                        plugins: {\n                            legend: {\n                                position: 'bottom',\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 12 },\n                                    padding: 15\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0',\n                                borderColor: 'rgba(255, 255, 255, 0.1)',\n                                borderWidth: 1,\n                                callbacks: {\n                                    label: function(context) {\n                                        const label = context.label || '';\n                                        const value = context.parsed || 0;\n                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);\n                                        const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : 0;\n                                        return `${label}: ${value} (${percentage}%)`;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                });\n                \n            } catch (error) {\n                console.error('Failed to load malware sources:', error);\n            }\n        }\n        \n        // Graph 2: \"Noisiest\" Agents Over Time\n        let noisyAgentsChart = null;\n        async function loadNoisyAgentsChart() {\n            try {\n                const response = await fetch('/api/noisy-agents');\n                const data = await response.json();\n                \n                console.log('Noisy agents data:', data);\n                \n                const ctx = document.getElementById('noisyAgentsChart');\n                if (!ctx) return;\n                \n                // Show message if no data\n                if (!data.agents || data.agents.length === 0) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 2rem; text-align: center; color: var(--text-secondary);\">No agent data available yet. Start scanning files to see trends.</div>';\n                    return;\n                }\n                \n                const colors = [\n                    '#ff3b3b', '#34d118', '#ffd700', '#1e90ff', '#ff1493'\n                ];\n                \n                // Reuse existing chart if it exists\n                if (noisyAgentsChart) {\n                    noisyAgentsChart.data.labels = data.dates;\n                    noisyAgentsChart.data.datasets = data.agents.map((agent, idx) => ({\n                        label: agent.agentId,\n                        data: agent.counts,\n                        borderColor: colors[idx],\n                        backgroundColor: colors[idx] + '20',\n                        tension: 0.4,\n                        borderWidth: 2,\n                        fill: false\n                    }));\n                    noisyAgentsChart.update('none');\n                    return;\n                }\n                \n                noisyAgentsChart = new Chart(ctx, {\n                    type: 'line',\n                    data: {\n                        labels: data.dates,\n                        datasets: data.agents.map((agent, idx) => ({\n                            label: agent.agentId,\n                            data: agent.counts,\n                            borderColor: colors[idx],\n                            backgroundColor: colors[idx] + '20',\n                            tension: 0.4,\n                            borderWidth: 2,\n                            fill: false\n                        }))\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 11 }\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: getCSSVar('--chart-text-color') || '#888' },\n                                grid: { color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                ticks: { color: getCSSVar('--chart-text-color') || '#888' },\n                                grid: { color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load noisy agents chart:', error);\n                const ctx = document.getElementById('noisyAgentsChart');\n                if (ctx) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 2rem; text-align: center; color: var(--accent-red);\">Error loading chart data</div>';\n                }\n            }\n        }\n        \n        // Graph 3: Signature Status vs. Classification\n        let signatureClassChart = null;\n        async function loadSignatureClassChart() {\n            try {\n                const response = await fetch('/api/signature-classification');\n                const data = await response.json();\n                \n                console.log('Signature classification data:', data);\n                \n                const ctx = document.getElementById('signatureClassChart');\n                if (!ctx) {\n                    console.warn('signatureClassChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (signatureClassChart) {\n                    signatureClassChart.data.datasets[0].data = [data.benign.verified, data.suspicious.verified, data.malware.verified];\n                    signatureClassChart.data.datasets[1].data = [data.benign.unknown, data.suspicious.unknown, data.malware.unknown];\n                    signatureClassChart.data.datasets[2].data = [data.benign.untrusted, data.suspicious.untrusted, data.malware.untrusted];\n                    signatureClassChart.update('none');\n                    return;\n                }\n                \n                signatureClassChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: ['Benign', 'Suspicious', 'Malware'],\n                        datasets: [\n                            {\n                                label: 'Verified',\n                                data: [data.benign.verified, data.suspicious.verified, data.malware.verified],\n                                backgroundColor: '#34d118',\n                                stack: 'stack0'\n                            },\n                            {\n                                label: 'Unknown',\n                                data: [data.benign.unknown, data.suspicious.unknown, data.malware.unknown],\n                                backgroundColor: '#ffd700',\n                                stack: 'stack0'\n                            },\n                            {\n                                label: 'Untrusted',\n                                data: [data.benign.untrusted, data.suspicious.untrusted, data.malware.untrusted],\n                                backgroundColor: '#ff3b3b',\n                                stack: 'stack0'\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                callbacks: {\n                                    label: function(context) {\n                                        const total = context.chart.data.datasets\n                                            .reduce((sum, ds) => sum + ds.data[context.dataIndex], 0);\n                                        const percentage = ((context.parsed.y / total) * 100).toFixed(1);\n                                        return `${context.dataset.label}: ${context.parsed.y} (${percentage}%)`;\n                                    }\n                                }\n                            }\n                        },\n                        scales: {\n                            y: {\n                                stacked: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                stacked: true,\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load signature classification chart:', error);\n                const ctx = document.getElementById('signatureClassChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 4: Packer Usage vs. Classification\n        let packerClassChart = null;\n        async function loadPackerClassChart() {\n            try {\n                const response = await fetch('/api/packer-classification');\n                const data = await response.json();\n                \n                console.log('Packer classification data:', data);\n                \n                const ctx = document.getElementById('packerClassChart');\n                if (!ctx) {\n                    console.warn('packerClassChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (packerClassChart) {\n                    packerClassChart.data.labels = data.packers;\n                    packerClassChart.data.datasets[0].data = data.benignCounts;\n                    packerClassChart.data.datasets[1].data = data.malwareCounts;\n                    packerClassChart.update('none');\n                    return;\n                }\n                \n                packerClassChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: data.packers,\n                        datasets: [\n                            {\n                                label: 'Benign Files',\n                                data: data.benignCounts,\n                                backgroundColor: '#34d118'\n                            },\n                            {\n                                label: 'Malware Files',\n                                data: data.malwareCounts,\n                                backgroundColor: '#ff3b3b'\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load packer classification chart:', error);\n                const ctx = document.getElementById('packerClassChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 5: Confidence Score Histogram\n        let confidenceHistChart = null;\n        async function loadConfidenceHistChart() {\n            try {\n                const response = await fetch('/api/confidence-distribution');\n                const data = await response.json();\n                \n                console.log('Confidence distribution data:', data);\n                \n                const ctx = document.getElementById('confidenceHistChart');\n                if (!ctx) {\n                    console.warn('confidenceHistChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (confidenceHistChart) {\n                    confidenceHistChart.data.labels = data.bins;\n                    confidenceHistChart.data.datasets[0].data = data.counts;\n                    confidenceHistChart.update('none');\n                    return;\n                }\n                \n                confidenceHistChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: data.bins,\n                        datasets: [{\n                            label: 'Scan Count',\n                            data: data.counts,\n                            backgroundColor: '#5a9cf8',\n                            borderColor: '#4a8ce8',\n                            borderWidth: 1\n                        }]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' },\n                                title: {\n                                    display: true,\n                                    text: 'Number of Scans',\n                                    color: '#888'\n                                }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false },\n                                title: {\n                                    display: true,\n                                    text: 'Confidence Score Range',\n                                    color: '#888'\n                                }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load confidence histogram:', error);\n                const ctx = document.getElementById('confidenceHistChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 6: File Entropy Distribution (Box Plot simulation)\n        let entropyBoxChart = null;\n        async function loadEntropyBoxChart() {\n            try {\n                const response = await fetch('/api/entropy-distribution');\n                const data = await response.json();\n                \n                console.log('Entropy distribution data:', data);\n                \n                const ctx = document.getElementById('entropyBoxChart');\n                if (!ctx) {\n                    console.warn('entropyBoxChart canvas not found');\n                    return;\n                }\n                \n                // Create violin/box plot effect with multiple bars\n                const benignData = [\n                    data.benign.min,\n                    data.benign.q1,\n                    data.benign.median,\n                    data.benign.q3,\n                    data.benign.max\n                ];\n                \n                const malwareData = [\n                    data.malware.min,\n                    data.malware.q1,\n                    data.malware.median,\n                    data.malware.q3,\n                    data.malware.max\n                ];\n                \n                // Reuse existing chart if it exists\n                if (entropyBoxChart) {\n                    entropyBoxChart.data.datasets[0].data = benignData;\n                    entropyBoxChart.data.datasets[1].data = malwareData;\n                    entropyBoxChart.update('none');\n                    return;\n                }\n                \n                entropyBoxChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: ['Min', 'Q1', 'Median', 'Q3', 'Max'],\n                        datasets: [\n                            {\n                                label: 'Benign Files',\n                                data: benignData,\n                                backgroundColor: '#34d118',\n                                borderColor: '#2ed60f',\n                                borderWidth: 1\n                            },\n                            {\n                                label: 'Malware Files',\n                                data: malwareData,\n                                backgroundColor: '#ff3b3b',\n                                borderColor: '#cc2f2f',\n                                borderWidth: 1\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                callbacks: {\n                                    label: function(context) {\n                                        return `${context.dataset.label}: ${context.parsed.y.toFixed(3)}`;\n                                    }\n                                }\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                max: 8.0,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' },\n                                title: {\n                                    display: true,\n                                    text: 'Entropy Value',\n                                    color: '#888'\n                                }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load entropy distribution chart:', error);\n                const ctx = document.getElementById('entropyBoxChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        async function loadEmergingThreats() {\n            try {\n                const response = await fetch('/api/emerging-threats');\n                const data = await response.json();\n                \n                // Update summary badges\n                document.getElementById('eti-total').textContent = \n                    `${data.summary.totalThreats} Total Threats`;\n                document.getElementById('eti-recent').textContent = \n                    `${data.summary.recentThreats} Last 24h`;\n                \n                // Helper to render IOC list\n                const renderIOCList = (items, container) => {\n                    if (items.length === 0) {\n                        container.innerHTML = '<div class=\"eti-empty\">No threats detected</div>';\n                        return;\n                    }\n                    \n                    container.innerHTML = items.map((item, index) => {\n                        const rank = index + 1;\n                        const recentBadge = item.recent > 0 ? \n                            `<span class=\"eti-recent-badge\">${item.recent} recent</span>` : '';\n                        const agentBadge = item.agents > 0 ? \n                            `<span class=\"eti-agent-badge\">${item.agents} agents</span>` : '';\n                        \n                        return `\n                            <div class=\"eti-item\" data-rank=\"${rank}\">\n                                <div class=\"eti-rank\">${rank}</div>\n                                <div class=\"eti-content\">\n                                    <div class=\"eti-name\">${item.name}</div>\n                                    <div class=\"eti-meta\">\n                                        <span class=\"eti-count\">${item.count} occurrences</span>\n                                        ${recentBadge}\n                                        ${agentBadge}\n                                    </div>\n                                    ${item.details && item.details.length > 0 ? `\n                                        <div class=\"eti-details\">\n                                            ${item.details.slice(0, 2).join(', ')}\n                                            ${item.details.length > 2 ? '...' : ''}\n                                        </div>\n                                    ` : ''}\n                                </div>\n                            </div>\n                        `;\n                    }).join('');\n                };\n                \n                // Render each section\n                renderIOCList(data.topMalwareFamilies, document.getElementById('eti-malware'));\n                renderIOCList(data.topSuspiciousAPIs, document.getElementById('eti-apis'));\n                renderIOCList(data.topMaliciousStrings, document.getElementById('eti-strings'));\n                renderIOCList(data.topPackers, document.getElementById('eti-packers'));\n                \n            } catch (error) {\n                console.error('Failed to load emerging threats:', error);\n            }\n        }\n        \n        async function analyzeThreatModel() {\n            try {\n                // Get selected values\n                const fileType = document.getElementById('model-filetype').value;\n                const packer = document.getElementById('model-packer').value;\n                const signature = document.getElementById('model-signature').value;\n                \n                // Get multiple selections\n                const apisSelect = document.getElementById('model-apis');\n                const apiImports = Array.from(apisSelect.selectedOptions).map(opt => opt.value);\n                \n                const stringsSelect = document.getElementById('model-strings');\n                const keyStrings = Array.from(stringsSelect.selectedOptions).map(opt => opt.value);\n                \n                // Validate\n                if (apiImports.length === 0) {\n                    alert('Please select at least one API import');\n                    return;\n                }\n                if (keyStrings.length === 0) {\n                    alert('Please select at least one suspicious string');\n                    return;\n                }\n                \n                // Show loading state\n                const outputDiv = document.getElementById('modeler-output');\n                outputDiv.innerHTML = `\n                    <div class=\"modeler-loading\">\n                        <i class=\"fas fa-spinner fa-spin\"></i>\n                        <p>Analyzing threat profile...</p>\n                    </div>\n                `;\n                \n                // Send to server\n                const response = await fetch('/api/threat-model', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                        fileType,\n                        packer,\n                        signature,\n                        apiImports,\n                        keyStrings\n                    })\n                });\n                \n                const data = await response.json();\n                \n                if (data.success) {\n                    const result = data.result;\n                    const classColor = \n                        result.classification === 'Malware' ? '#ff4757' :\n                        result.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n                    \n                    outputDiv.innerHTML = `\n                        <div class=\"prediction-result\">\n                            <div class=\"prediction-header\">\n                                <div class=\"prediction-badge\" style=\"background: ${classColor};\">\n                                    ${result.classification.toUpperCase()}\n                                </div>\n                                <div class=\"prediction-confidence\">\n                                    <div class=\"confidence-label\">Confidence Score</div>\n                                    <div class=\"confidence-value\">${(parseFloat(result.confidence_score) * 100).toFixed(1)}%</div>\n                                </div>\n                            </div>\n                            \n                            ${result.malware_family ? `\n                                <div class=\"prediction-family\">\n                                    <strong>Predicted Malware Family:</strong>\n                                    <span class=\"family-name\">${result.malware_family}</span>\n                                </div>\n                            ` : ''}\n                            \n                            <div class=\"prediction-section\">\n                                <h4>Threat Analysis</h4>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-file\"></i>\n                                    <span><strong>File Type:</strong> ${result.key_findings.file_type}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-box\"></i>\n                                    <span><strong>Packer:</strong> ${result.key_findings.packer_detected}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-certificate\"></i>\n                                    <span><strong>Signature:</strong> ${result.key_findings.signature.name}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-tachometer-alt\"></i>\n                                    <span><strong>Threat Score:</strong> ${result.key_findings.threat_score}/100</span>\n                                </div>\n                            </div>\n                            \n                            <div class=\"prediction-section\">\n                                <h4>Detected Indicators</h4>\n                                <div class=\"indicator-group\">\n                                    <strong>API Imports:</strong>\n                                    <div class=\"indicator-list\">\n                                        ${result.key_findings.api_imports.map(api => \n                                            `<span class=\"indicator-tag api-tag\">${api}</span>`\n                                        ).join('')}\n                                    </div>\n                                </div>\n                                <div class=\"indicator-group\">\n                                    <strong>Suspicious Strings:</strong>\n                                    <div class=\"indicator-list\">\n                                        ${result.key_findings.key_strings.map(str => \n                                            `<span class=\"indicator-tag string-tag\">${str}</span>`\n                                        ).join('')}\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"prediction-footer\">\n                                <i class=\"fas fa-info-circle\"></i>\n                                This analysis has been added to the scan results and will appear in all visualizations.\n                            </div>\n                        </div>\n                    `;\n                } else {\n                    outputDiv.innerHTML = `\n                        <div class=\"modeler-error\">\n                            <i class=\"fas fa-exclamation-circle\"></i>\n                            <p>Analysis failed: ${data.error}</p>\n                        </div>\n                    `;\n                }\n                \n            } catch (error) {\n                console.error('Failed to analyze threat model:', error);\n                document.getElementById('modeler-output').innerHTML = `\n                    <div class=\"modeler-error\">\n                        <i class=\"fas fa-exclamation-circle\"></i>\n                        <p>Analysis failed. Please try again.</p>\n                    </div>\n                `;\n            }\n        }\n        \n        let graphSimulation = null;\n        let graphSvg = null;\n        \n        async function loadCorrelationGraph() {\n            try {\n                const response = await fetch('/api/threat-correlations');\n                const data = await response.json();\n                \n                // Clear existing graph\n                d3.select('#correlationGraph').selectAll('*').remove();\n                \n                const container = document.getElementById('correlationGraph');\n                const width = container.clientWidth;\n                const height = 600;\n                \n                // Create SVG\n                graphSvg = d3.select('#correlationGraph')\n                    .append('svg')\n                    .attr('width', width)\n                    .attr('height', height)\n                    .style('background', '#0a0a0a')\n                    .style('border-radius', '8px');\n                \n                const g = graphSvg.append('g');\n                \n                // Add zoom behavior\n                const zoom = d3.zoom()\n                    .scaleExtent([0.1, 4])\n                    .on('zoom', (event) => {\n                        g.attr('transform', event.transform);\n                    });\n                \n                graphSvg.call(zoom);\n                \n                // Color schemes for different node types\n                const colorMap = {\n                    malware: '#ff4757',\n                    agent: '#5a9cf8',\n                    api: '#ffa502',\n                    string: '#26de81'\n                };\n                \n                // Create force simulation\n                graphSimulation = d3.forceSimulation(data.nodes)\n                    .force('link', d3.forceLink(data.links)\n                        .id(d => d.id)\n                        .distance(d => d.type === 'correlated_with' ? 200 : 100)\n                        .strength(d => d.strength * 0.3))\n                    .force('charge', d3.forceManyBody().strength(-300))\n                    .force('center', d3.forceCenter(width / 2, height / 2))\n                    .force('collision', d3.forceCollide().radius(30));\n                \n                // Draw links\n                const link = g.append('g')\n                    .selectAll('line')\n                    .data(data.links)\n                    .enter()\n                    .append('line')\n                    .attr('stroke', d => {\n                        if (d.type === 'correlated_with') return '#ff6b6b';\n                        if (d.type === 'detected_by') return '#5a9cf8';\n                        if (d.type === 'uses_api') return '#ffa502';\n                        return '#26de81';\n                    })\n                    .attr('stroke-width', d => Math.sqrt(d.strength) + 1)\n                    .attr('stroke-opacity', 0.6);\n                \n                // Draw nodes\n                const node = g.append('g')\n                    .selectAll('circle')\n                    .data(data.nodes)\n                    .enter()\n                    .append('circle')\n                    .attr('r', d => {\n                        if (d.type === 'malware') return 15 + Math.min(d.count * 2, 15);\n                        if (d.type === 'agent') return 12 + Math.min(d.count, 10);\n                        return 8 + Math.min(d.count, 8);\n                    })\n                    .attr('fill', d => colorMap[d.type])\n                    .attr('stroke', '#fff')\n                    .attr('stroke-width', 2)\n                    .style('cursor', 'pointer')\n                    .call(d3.drag()\n                        .on('start', dragstarted)\n                        .on('drag', dragged)\n                        .on('end', dragended))\n                    .on('click', (event, d) => showNodeDetails(d, data))\n                    .on('mouseover', function(event, d) {\n                        d3.select(this)\n                            .transition()\n                            .duration(200)\n                            .attr('stroke-width', 4)\n                            .attr('r', function() {\n                                const currentR = parseFloat(d3.select(this).attr('r'));\n                                return currentR * 1.3;\n                            });\n                    })\n                    .on('mouseout', function(event, d) {\n                        d3.select(this)\n                            .transition()\n                            .duration(200)\n                            .attr('stroke-width', 2)\n                            .attr('r', function() {\n                                if (d.type === 'malware') return 15 + Math.min(d.count * 2, 15);\n                                if (d.type === 'agent') return 12 + Math.min(d.count, 10);\n                                return 8 + Math.min(d.count, 8);\n                            });\n                    });\n                \n                // Add labels\n                const label = g.append('g')\n                    .selectAll('text')\n                    .data(data.nodes)\n                    .enter()\n                    .append('text')\n                    .text(d => d.label.length > 20 ? d.label.substring(0, 20) + '...' : d.label)\n                    .attr('font-size', d => d.type === 'malware' ? '12px' : '10px')\n                    .attr('fill', '#e0e0e0')\n                    .attr('text-anchor', 'middle')\n                    .attr('dy', d => {\n                        if (d.type === 'malware') return 35;\n                        if (d.type === 'agent') return 25;\n                        return 20;\n                    })\n                    .style('pointer-events', 'none')\n                    .style('font-weight', d => d.type === 'malware' ? 'bold' : 'normal');\n                \n                // Update positions on simulation tick\n                graphSimulation.on('tick', () => {\n                    link\n                        .attr('x1', d => d.source.x)\n                        .attr('y1', d => d.source.y)\n                        .attr('x2', d => d.target.x)\n                        .attr('y2', d => d.target.y);\n                    \n                    node\n                        .attr('cx', d => d.x)\n                        .attr('cy', d => d.y);\n                    \n                    label\n                        .attr('x', d => d.x)\n                        .attr('y', d => d.y);\n                });\n                \n                // Drag functions\n                function dragstarted(event, d) {\n                    if (!event.active) graphSimulation.alphaTarget(0.3).restart();\n                    d.fx = d.x;\n                    d.fy = d.y;\n                }\n                \n                function dragged(event, d) {\n                    d.fx = event.x;\n                    d.fy = event.y;\n                }\n                \n                function dragended(event, d) {\n                    if (!event.active) graphSimulation.alphaTarget(0);\n                    d.fx = null;\n                    d.fy = null;\n                }\n                \n                console.log(`Correlation graph loaded: ${data.nodes.length} nodes, ${data.links.length} links`);\n                \n            } catch (error) {\n                console.error('Failed to load correlation graph:', error);\n            }\n        }\n        \n        function showNodeDetails(node, graphData) {\n            const detailsPanel = document.getElementById('nodeDetails');\n            const detailsTitle = document.getElementById('detailsTitle');\n            const detailsContent = document.getElementById('detailsContent');\n            \n            detailsTitle.textContent = node.label;\n            \n            let html = `<p><strong>Type:</strong> ${node.type.toUpperCase()}</p>`;\n            html += `<p><strong>Occurrences:</strong> ${node.count}</p>`;\n            \n            // Find connections\n            const connections = graphData.links.filter(l => \n                l.source.id === node.id || l.target.id === node.id\n            );\n            \n            if (connections.length > 0) {\n                html += `<p><strong>Connections:</strong> ${connections.length}</p>`;\n                html += '<ul style=\"margin: 10px 0; padding-left: 20px;\">';\n                connections.slice(0, 10).forEach(link => {\n                    const otherNode = link.source.id === node.id ? link.target : link.source;\n                    html += `<li>${link.type.replace(/_/g, ' ')}: ${otherNode.label}</li>`;\n                });\n                if (connections.length > 10) {\n                    html += `<li>...and ${connections.length - 10} more</li>`;\n                }\n                html += '</ul>';\n            }\n            \n            if (node.details && node.details.length > 0) {\n                html += '<p><strong>Associated Files:</strong></p>';\n                html += '<ul style=\"margin: 10px 0; padding-left: 20px; max-height: 150px; overflow-y: auto;\">';\n                node.details.slice(0, 10).forEach(file => {\n                    html += `<li>${file}</li>`;\n                });\n                if (node.details.length > 10) {\n                    html += `<li>...and ${node.details.length - 10} more</li>`;\n                }\n                html += '</ul>';\n            }\n            \n            detailsContent.innerHTML = html;\n            detailsPanel.style.display = 'block';\n        }\n        \n        function resetGraph() {\n            if (graphSimulation) {\n                graphSimulation.alpha(1).restart();\n            }\n        }\n        \n        function centerGraph() {\n            if (graphSvg) {\n                graphSvg.transition().duration(750).call(\n                    d3.zoom().transform,\n                    d3.zoomIdentity\n                );\n            }\n        }\n        \n        function setChartDays(days) {\n            currentChartDays = days;\n            \n            // Update button states\n            document.querySelectorAll('.chart-btn').forEach(btn => {\n                btn.classList.remove('active');\n            });\n            event.target.classList.add('active');\n            \n            loadDailyChart();\n        }\n        \n        function loadData() {\n            loadStats();\n            loadScans();\n            // Heavy components loaded lazily - see switchView()\n        }\n        \n        function loadDataWithoutMap() {\n            loadStats();\n            loadScans();\n        }\n        \n        // Track which analytics have been loaded\n        let analyticsLoaded = false;\n        \n        function loadAnalytics() {\n            console.log('Loading analytics view...');\n            loadDailyChart();\n            loadMalwareSources();\n            loadNoisyAgentsChart();\n            loadSignatureClassChart();\n            loadPackerClassChart();\n            loadConfidenceHistChart();\n            loadEntropyBoxChart();\n            loadEmergingThreats();\n            loadCorrelationGraph();\n            loadGeoMap();\n            \n            analyticsLoaded = true;\n        }\n        \n        // Initial load - only dashboard essentials\n        loadData();\n        \n        // Auto-scroll functionality with visual indicators\n        const scrollIndicatorUp = document.createElement('div');\n        scrollIndicatorUp.className = 'scroll-indicator scroll-up';\n        scrollIndicatorUp.innerHTML = '<i class=\"fas fa-chevron-up\"></i>';\n        document.body.appendChild(scrollIndicatorUp);\n        \n        const scrollIndicatorDown = document.createElement('div');\n        scrollIndicatorDown.className = 'scroll-indicator scroll-down';\n        scrollIndicatorDown.innerHTML = '<i class=\"fas fa-chevron-down\"></i>';\n        document.body.appendChild(scrollIndicatorDown);\n        \n        let pageScrollInterval = null;\n        const scrollSpeed = 3;\n        const triggerZone = 80; // pixels from top/bottom\n        \n        function handleAutoScroll(event) {\n            // Don't auto-scroll if page is hidden\n            if (document.hidden) return;\n            \n            const mouseY = event.clientY;\n            const windowHeight = window.innerHeight;\n            \n            // Check if near top\n            if (mouseY < triggerZone) {\n                scrollIndicatorUp.classList.add('visible');\n                scrollIndicatorDown.classList.remove('visible');\n                \n                if (!pageScrollInterval) {\n                    pageScrollInterval = setInterval(() => {\n                        if (document.hidden) {\n                            stopAutoScroll();\n                            return;\n                        }\n                        window.scrollBy({\n                            top: -scrollSpeed,\n                            behavior: 'auto'\n                        });\n                    }, 16); // ~60fps\n                }\n            }\n            // Check if near bottom\n            else if (mouseY > windowHeight - triggerZone) {\n                scrollIndicatorDown.classList.add('visible');\n                scrollIndicatorUp.classList.remove('visible');\n                \n                if (!pageScrollInterval) {\n                    pageScrollInterval = setInterval(() => {\n                        if (document.hidden) {\n                            stopAutoScroll();\n                            return;\n                        }\n                        window.scrollBy({\n                            top: scrollSpeed,\n                            behavior: 'auto'\n                        });\n                    }, 16);\n                }\n            }\n            // In neutral zone\n            else {\n                scrollIndicatorUp.classList.remove('visible');\n                scrollIndicatorDown.classList.remove('visible');\n                \n                if (pageScrollInterval) {\n                    clearInterval(pageScrollInterval);\n                    pageScrollInterval = null;\n                }\n            }\n        }\n        \n        function stopAutoScroll() {\n            scrollIndicatorUp.classList.remove('visible');\n            scrollIndicatorDown.classList.remove('visible');\n            \n            if (pageScrollInterval) {\n                clearInterval(pageScrollInterval);\n                pageScrollInterval = null;\n            }\n        }\n        \n        // Attach event listeners\n        document.addEventListener('mousemove', handleAutoScroll);\n        document.addEventListener('mouseleave', stopAutoScroll);\n        \n        // Stop scrolling when reaching top or bottom\n        let lastScrollTop = 0;\n        window.addEventListener('scroll', () => {\n            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n            const scrollHeight = document.documentElement.scrollHeight;\n            const clientHeight = document.documentElement.clientHeight;\n            \n            // At top\n            if (scrollTop === 0 && lastScrollTop > 0) {\n                stopAutoScroll();\n            }\n            // At bottom\n            if (scrollTop + clientHeight >= scrollHeight - 5) {\n                stopAutoScroll();\n            }\n            \n            lastScrollTop = scrollTop;\n        });\n        \n        // Set up Server-Sent Events for real-time updates\n        const eventSource = new EventSource('/api/events');\n        let updateDebounceTimer = null;\n        let pollingInterval = null;\n        let pendingUpdates = false;\n        \n        eventSource.onmessage = function(event) {\n            const data = JSON.parse(event.data);\n            \n            if (data.type === 'connected') {\n                console.log('Connected to server for real-time updates');\n            } else if (data.type === 'new-scan') {\n                console.log('New scan received:', data.scan.detected_filename);\n                \n                // Show notification toast\n                showThreatNotification(data.scan);\n                \n                // Add to threat ticker\n                addToThreatTicker(data.scan);\n                \n                // Debounce: batch multiple rapid scans into single update\n                pendingUpdates = true;\n                clearTimeout(updateDebounceTimer);\n                updateDebounceTimer = setTimeout(() => {\n                    if (pendingUpdates) {\n                        // Only reload lightweight data (stats + scan list)\n                        loadStats();\n                        loadScans();\n                        \n                        // If analytics view is open, refresh analytics too\n                        if (currentView === 'analytics' && analyticsLoaded) {\n                            loadAnalytics();\n                        }\n                        \n                        pendingUpdates = false;\n                        \n                        // Throttle map updates to once per 15 seconds\n                        if (!window.lastMapUpdate || Date.now() - window.lastMapUpdate > 15000) {\n                            loadGeoMap();\n                            window.lastMapUpdate = Date.now();\n                        }\n                    }\n                }, 1000); // Wait 1 second after last scan\n            }\n        };\n        \n        eventSource.onerror = function(error) {\n            console.error('SSE Error:', error);\n            // Fallback: reload data every 30 seconds if SSE connection fails (only once!)\n            if (eventSource.readyState === EventSource.CLOSED && !pollingInterval) {\n                console.log('SSE connection closed, falling back to polling...');\n                pollingInterval = setInterval(() => {\n                    loadStats();\n                    loadScans();\n                }, 30000);\n            }\n        };\n        \n        // Manual refresh button functionality\n        window.manualRefresh = function() {\n            loadData();\n        };\n    </script>\n    \n    <!-- Theme Toggle Script -->\n    <script>\n        // Theme Toggle Functionality\n        window.toggleTheme = function() {\n            const html = document.documentElement;\n            const currentTheme = html.getAttribute('data-theme');\n            const newTheme = currentTheme === 'light' ? '' : 'light';\n            \n            if (newTheme) {\n                html.setAttribute('data-theme', newTheme);\n            } else {\n                html.removeAttribute('data-theme');\n            }\n            localStorage.setItem('theme', newTheme || 'dark');\n            \n            // Update button icon and text\n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            if (newTheme === 'light') {\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n            } else {\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n            }\n        };\n        \n        // Load saved theme on page load\n        (function() {\n            const savedTheme = localStorage.getItem('theme') || 'dark';\n            if (savedTheme === 'light') {\n                document.documentElement.setAttribute('data-theme', 'light');\n            }\n            \n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            if (savedTheme === 'light') {\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n            } else {\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n            }\n        })();\n    </script>\n</body>\n</html>","epoch":59,"telemetryInfo":{}}]],"operations":[{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/dashboard.html","external":"file:///home/trang/localnsv/mAIware-server/public/dashboard.html","path":"/home/trang/localnsv/mAIware-server/public/dashboard.html","scheme":"file"},"requestId":"request_1af10ca8-d17d-442e-8756-8e3e11e7af34","epoch":4,"edits":[{"text":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>mAIware Server Dashboard</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n    <link rel=\"stylesheet\" href=\"styles.css?v=3.0\">\n    <!-- Add Chart.js -->\n    <script src=\"https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js\"></script>\n    <!-- Add Leaflet.js for maps -->\n    <link rel=\"stylesheet\" href=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css\" />\n    <script src=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js\"></script>\n    <!-- Add Leaflet Heatmap Plugin -->\n    <script src=\"https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js\"></script>\n    <!-- Add D3.js for force-directed graph -->\n    <script src=\"https://d3js.org/d3.v7.min.js\"></script>\n    <!-- Add html2canvas for screenshots -->\n    <script src=\"https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js\"></script>\n</head>\n<body>\n    <!-- Theme Toggle Button -->\n    <button class=\"theme-toggle\" id=\"themeToggle\" onclick=\"toggleTheme()\">\n        <span class=\"icon\" id=\"themeIcon\">üåô</span>\n        <span id=\"themeText\">Dark</span>\n    </button>\n\n    <!-- Back to Top Button -->\n    <button class=\"back-to-top\" id=\"backToTop\" onclick=\"scrollToTop()\">\n        <i class=\"fas fa-arrow-up\"></i>\n    </button>\n\n    <!-- Preview Backdrop -->\n    <div class=\"preview-backdrop\" id=\"previewBackdrop\"></div>\n\n    <!-- Side Navigation Panel -->\n    <div class=\"side-panel\" id=\"sidePanel\">\n        <!-- Logo Icon (always visible) -->\n        <div class=\"panel-icon-strip\">\n            <div class=\"panel-logo-icon\">\n                <i class=\"fas fa-shield-virus\"></i>\n            </div>\n        </div>\n        \n        <!-- Analytics Preview Panel (slides out on hover) -->\n        <div class=\"graphs-preview\" id=\"graphsPreview\">\n            <div class=\"preview-header\">\n                <h3><i class=\"fas fa-chart-line\"></i> Analytics Preview</h3>\n                <p>Click anywhere to view full analytics</p>\n            </div>\n            \n            <!-- Scaled-down live view of analytics -->\n            <div class=\"analytics-miniview\" id=\"analyticsMiniview\" onclick=\"switchView('analytics')\">\n                <div class=\"miniview-preview\">\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box large\">\n                            <div class=\"box-header\">Global Threat Map</div>\n                            <div class=\"box-content map-visual\">\n                                <div class=\"map-dot\" style=\"top: 30%; left: 40%;\"></div>\n                                <div class=\"map-dot\" style=\"top: 60%; left: 70%;\"></div>\n                                <div class=\"map-dot\" style=\"top: 45%; left: 25%;\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box large\">\n                            <div class=\"box-header\">Attack Timeline</div>\n                            <div class=\"box-content chart-visual\">\n                                <div class=\"chart-bar\" style=\"height: 40%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 70%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 55%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 85%;\"></div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Top Threats</div>\n                            <div class=\"box-content list-visual\">\n                                <div class=\"list-item\"></div>\n                                <div class=\"list-item\"></div>\n                                <div class=\"list-item\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Correlations</div>\n                            <div class=\"box-content network-visual\">\n                                <div class=\"network-node\" style=\"top: 30%; left: 30%;\"></div>\n                                <div class=\"network-node\" style=\"top: 60%; left: 50%;\"></div>\n                                <div class=\"network-node\" style=\"top: 45%; left: 70%;\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Heatmap</div>\n                            <div class=\"box-content heat-visual\"></div>\n                        </div>\n                    </div>\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box wide\">\n                            <div class=\"box-header\">File Analysis & Distribution</div>\n                            <div class=\"box-content pie-visual\">\n                                <div class=\"pie-chart\"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"miniview-overlay\">\n                    <i class=\"fas fa-expand-alt\"></i>\n                    <span>Click to view analytics</span>\n                </div>\n            </div>                <!-- Home Navigation Button -->\n                <div class=\"preview-home-nav\" id=\"homeNavBtn\" onclick=\"switchView('dashboard')\">\n                    <i class=\"fas fa-home\"></i>\n                    <span>Back to Dashboard</span>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"main-content\" id=\"mainContent\">\n        <!-- DASHBOARD VIEW -->\n        <div class=\"view-container active\" id=\"dashboardView\">\n            <header class=\"dashboard-header\">\n                <div class=\"header-content\">\n                    <h1><i class=\"fas fa-shield-virus pulse-icon\"></i> mAIware Server</h1>\n                    <p class=\"subtitle\">Real-time Malware Analysis Dashboard</p>\n                </div>\n            </header>\n            \n            <!-- Real-time Threat Ticker -->\n            <div class=\"threat-ticker-container animate-slide-in\">\n                <div class=\"ticker-label\">\n                    <i class=\"fas fa-broadcast-tower pulse-icon\"></i>\n                    <span>LIVE THREAT FEED</span>\n                </div>\n                <div class=\"threat-ticker\" id=\"threat-ticker\">\n                    <div class=\"ticker-content\" id=\"ticker-content\">\n                        <span class=\"ticker-item\">System ready - Monitoring for threats...</span>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Notification Toast Container -->\n            <div id=\"notification-container\" class=\"notification-container\"></div>\n            \n            <!-- Stats Grid -->\n            <div class=\"stats-grid animate-fade-in\" id=\"stats-grid\">\n                <div class=\"stat-card info\">\n                    <i class=\"fas fa-laptop\"></i>\n                    <span class=\"stat-number\" id=\"stat-clients\">0</span>\n                    <span class=\"stat-label\">Active Clients</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card info\">\n                    <i class=\"fas fa-chart-line\"></i>\n                    <span class=\"stat-number\" id=\"stat-total\">0</span>\n                    <span class=\"stat-label\">Total Scans</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card malware\">\n                    <i class=\"fas fa-bug\"></i>\n                    <span class=\"stat-number\" id=\"stat-malware\">0</span>\n                    <span class=\"stat-label\">Malware</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card suspicious\">\n                    <i class=\"fas fa-exclamation-triangle\"></i>\n                    <span class=\"stat-number\" id=\"stat-suspicious\">0</span>\n                    <span class=\"stat-label\">Suspicious</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card benign\">\n                    <i class=\"fas fa-check-circle\"></i>\n                    <span class=\"stat-number\" id=\"stat-benign\">0</span>\n                    <span class=\"stat-label\">Benign</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n            </div>\n            \n            <!-- Recent Scans -->\n            <div class=\"scans-container animate-fade-in\">\n                <div class=\"scans-header\">\n                    <h2><i class=\"fas fa-list\"></i> Recent Scans</h2>\n                    <button class=\"refresh-btn\" onclick=\"manualRefresh()\">\n                        <i class=\"fas fa-sync-alt\"></i> Refresh\n                    </button>\n                </div>\n                \n                <table class=\"scans-table\">\n                    <thead>\n                        <tr>\n                            <th>Timestamp</th>\n                            <th>Filename</th>\n                            <th>Classification</th>\n                            <th>Client IP</th>\n                            <th>Hash (SHA256)</th>\n                        </tr>\n                    </thead>\n                    <tbody id=\"scans-tbody\">\n                        <tr>\n                            <td colspan=\"5\" class=\"empty-state\">\n                                <i class=\"fas fa-inbox\"></i>\n                                <p>No scans yet. Waiting for clients...</p>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n\n        <!-- ANALYTICS VIEW -->\n        <div class=\"view-container\" id=\"analyticsView\">\n            <div class=\"analytics-header\">\n                <button class=\"back-btn\" onclick=\"switchView('dashboard')\">\n                    <i class=\"fas fa-arrow-left\"></i> Back to Dashboard\n                </button>\n                <h1><i class=\"fas fa-chart-line\"></i> Analytics & Intelligence</h1>\n            </div>\n            \n            <div class=\"analytics-grid\" id=\"analyticsGrid\">\n                \n                <!-- Daily Analysis Chart -->\n                <div class=\"chart-container analytics-panel panel-large\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-line\"></i> Daily Analysis Trends</h2>\n                        <div class=\"chart-controls\">\n                            <button class=\"chart-btn active\" onclick=\"setChartDays(7)\">7 Days</button>\n                            <button class=\"chart-btn\" onclick=\"setChartDays(14)\">14 Days</button>\n                            <button class=\"chart-btn\" onclick=\"setChartDays(30)\">30 Days</button>\n                        </div>\n                    </div>\n                    <canvas id=\"dailyScansChart\"></canvas>\n                </div>\n                    <canvas id=\"dailyScansChart\"></canvas>\n                </div>\n\n                <!-- Geographic Threat Intelligence Map -->\n                <div class=\"map-container analytics-panel panel-large\">\n                    <div class=\"map-header\">\n                        <h2><i class=\"fas fa-globe-americas\"></i> Global Threat Intelligence Map</h2>\n                        <div class=\"map-controls\">\n                            <div class=\"map-view-toggle\">\n                                <button class=\"map-btn active\" data-view=\"markers\" onclick=\"switchMapView('markers')\">\n                                    <i class=\"fas fa-map-marker-alt\"></i> Markers\n                                </button>\n                                <button class=\"map-btn\" data-view=\"heatmap\" onclick=\"switchMapView('heatmap')\">\n                                    <i class=\"fas fa-fire\"></i> Heatmap\n                                </button>\n                                <button class=\"map-btn\" data-view=\"choropleth\" onclick=\"switchMapView('choropleth')\">\n                                    <i class=\"fas fa-globe\"></i> Choropleth\n                                </button>\n                            </div>\n                            <div class=\"map-legend\">\n                                <span class=\"legend-item\"><span class=\"legend-dot malware-dot\"></span> Malware</span>\n                                <span class=\"legend-item\"><span class=\"legend-dot suspicious-dot\"></span> Suspicious</span>\n                                <span class=\"legend-item\"><span class=\"legend-dot benign-dot\"></span> Benign</span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Geographic Context Panel -->\n                    <div class=\"geo-context-panel\" id=\"geoContext\">\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Active Regions:</span>\n                            <span class=\"context-value\" id=\"activeRegions\">0</span>\n                        </div>\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Hotspot:</span>\n                            <span class=\"context-value\" id=\"topRegion\">None</span>\n                        </div>\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Total Threats:</span>\n                            <span class=\"context-value threat-count\" id=\"geoThreatCount\">0</span>\n                        </div>\n                    </div>\n                    \n                    <div id=\"worldMap\" style=\"height: 500px; border-radius: 8px; margin-bottom: 15px;\"></div>\n                    \n                    <!-- Timeline Control -->\n                    <div class=\"map-timeline-control\">\n                        <button class=\"timeline-btn\" onclick=\"replayThreats()\" id=\"replayBtn\">\n                            <i class=\"fas fa-play\"></i> Replay Last 24h\n                        </button>\n                        <div class=\"timeline-info\" id=\"timelineInfo\">\n                            Click replay to see threat propagation over time\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Malware Source Distribution -->\n                <div class=\"chart-container analytics-panel panel-small\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-pie\"></i> Malware Source Distribution</h2>\n                    </div>\n                    <div style=\"max-width: 500px; margin: 0 auto;\">\n                        <canvas id=\"malwareSourceChart\"></canvas>\n                    </div>\n                </div>\n\n                <!-- Graph 2: \"Noisiest\" Agents Over Time -->\n                <div class=\"chart-container analytics-panel panel-large\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-desktop\"></i> \"Noisiest\" Agents Over Time</h2>\n                        <p class=\"chart-subtitle\">Threat detection trends for top 5 high-risk agents</p>\n                    </div>\n                    <div style=\"height: 300px;\">\n                        <canvas id=\"noisyAgentsChart\"></canvas>\n                    </div>\n                </div>\n\n                <!-- Advanced Analytics Grid -->\n                <div class=\"analytics-panel panel-large advanced-analytics-grid\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-area\"></i> Advanced Statistical Analysis</h2>\n                        <p class=\"chart-subtitle\">Deep dive into signature verification, packer usage, AI confidence, and entropy patterns</p>\n                    </div>\n                    \n                    <div class=\"mini-charts-grid\">\n                        <!-- Graph 3: Signature Status vs. Classification -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-certificate\"></i> Signature vs. Classification</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"signatureClassChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 4: Packer Usage vs. Classification -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-box\"></i> Packer vs. Classification</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"packerClassChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 5: Confidence Score Distribution -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-brain\"></i> AI Confidence Distribution</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"confidenceHistChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 6: File Entropy Distribution -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-chart-bar\"></i> Entropy Distribution</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"entropyBoxChart\"></canvas>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Threat Vector Correlation Explorer -->\n                <div class=\"correlation-container analytics-panel panel-large\">\n                    <div class=\"correlation-header\">\n                        <h2><i class=\"fas fa-project-diagram\"></i> Threat Vector Correlation Explorer</h2>\n                        <p class=\"correlation-subtitle\">Interactive intelligence map showing relationships between malware families, agents, APIs, and indicators</p>\n                    </div>\n                    <div class=\"graph-controls\">\n                        <button class=\"graph-btn\" onclick=\"resetGraph()\"><i class=\"fas fa-sync\"></i> Reset View</button>\n                        <button class=\"graph-btn\" onclick=\"centerGraph()\"><i class=\"fas fa-compress\"></i> Center</button>\n                        <div class=\"graph-legend\">\n                            <span class=\"legend-item\"><span class=\"node-sample malware-node\"></span> Malware Family</span>\n                            <span class=\"legend-item\"><span class=\"node-sample agent-node\"></span> Agent/System</span>\n                            <span class=\"legend-item\"><span class=\"node-sample api-node\"></span> API Call</span>\n                            <span class=\"legend-item\"><span class=\"node-sample string-node\"></span> Suspicious String</span>\n                        </div>\n                    </div>\n                    <div id=\"correlationGraph\"></div>\n                    <div id=\"nodeDetails\" class=\"node-details\" style=\"display: none;\">\n                        <h3 id=\"detailsTitle\"></h3>\n                        <div id=\"detailsContent\"></div>\n                    </div>\n                </div>\n\n                <!-- Emerging Threat Intelligence Panel -->\n                <div class=\"eti-container analytics-panel panel-large\">\n                    <div class=\"eti-header\">\n                        <h2><i class=\"fas fa-exclamation-triangle\"></i> Emerging Threat Intelligence (ETI)</h2>\n                        <p class=\"eti-subtitle\">Real-time actionable intelligence on active threats and indicators of compromise</p>\n                        <div class=\"eti-summary\">\n                            <span class=\"eti-badge\" id=\"eti-total\">0 Total Threats</span>\n                            <span class=\"eti-badge recent\" id=\"eti-recent\">0 Last 24h</span>\n                        </div>\n                    </div>\n                    \n                    <div class=\"eti-grid\">\n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-virus\"></i> Top Malware Families</h3>\n                            <div class=\"eti-subtitle-small\">Most active malware families detected</div>\n                            <div id=\"eti-malware\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-code\"></i> Top Suspicious APIs</h3>\n                            <div class=\"eti-subtitle-small\">Most frequently called malicious APIs</div>\n                            <div id=\"eti-apis\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-terminal\"></i> Top Malicious Strings</h3>\n                            <div class=\"eti-subtitle-small\">Most common IOC strings and commands</div>\n                            <div id=\"eti-strings\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-shield-alt\"></i> Top Packers/Obfuscators</h3>\n                            <div class=\"eti-subtitle-small\">Most used evasion techniques</div>\n                            <div id=\"eti-packers\" class=\"eti-list\"></div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Predictive Threat Modeler -->\n                <div class=\"modeler-container analytics-panel panel-large\">\n                    <div class=\"modeler-header\">\n                        <h2><i class=\"fas fa-flask\"></i> Predictive Threat Modeler</h2>\n                        <p class=\"modeler-subtitle\">Build hypothetical malware and predict how mAIware would classify it</p>\n                    </div>\n                    \n                    <div class=\"modeler-grid\">\n                <div class=\"modeler-builder\">\n                    <h3><i class=\"fas fa-cogs\"></i> Threat Configuration</h3>\n                    \n                    <div class=\"modeler-field\">\n                        <label>File Type</label>\n                        <select id=\"model-filetype\" class=\"modeler-select\">\n                            <option>PE32+ (GUI) x86-64</option>\n                            <option>PE32 (Console) Intel 80386</option>\n                            <option>PE32+ DLL x86-64</option>\n                            <option>MSI Installer</option>\n                            <option>PDF Document</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Packer/Obfuscator</label>\n                        <select id=\"model-packer\" class=\"modeler-select\">\n                            <option>None</option>\n                            <option>UPX</option>\n                            <option>VMProtect</option>\n                            <option>Themida</option>\n                            <option>ASPack</option>\n                            <option>Unknown (High Entropy)</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Digital Signature</label>\n                        <select id=\"model-signature\" class=\"modeler-select\">\n                            <option>Verified (Microsoft Corporation)</option>\n                            <option>Verified (Google LLC)</option>\n                            <option>Verified (Unknown Publisher)</option>\n                            <option>Not Signed</option>\n                            <option>Expired Certificate</option>\n                            <option>Self-Signed (Untrusted)</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>API Imports (select multiple)</label>\n                        <select id=\"model-apis\" class=\"modeler-select\" multiple size=\"6\">\n                            <option>CreateRemoteThread</option>\n                            <option>WriteProcessMemory</option>\n                            <option>VirtualAllocEx</option>\n                            <option>SetWindowsHookExW</option>\n                            <option>URLDownloadToFileW</option>\n                            <option>WinExec</option>\n                            <option>RegSetValueExW</option>\n                            <option>CryptEncrypt</option>\n                            <option>Socket</option>\n                            <option>ReadFile</option>\n                        </select>\n                        <small class=\"modeler-hint\">Hold Ctrl/Cmd to select multiple</small>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Suspicious Strings (select multiple)</label>\n                        <select id=\"model-strings\" class=\"modeler-select\" multiple size=\"6\">\n                            <option>http://bad-c2-server.com/payload.dat</option>\n                            <option>keylog.txt</option>\n                            <option>steal_passwords</option>\n                            <option>powershell -enc</option>\n                            <option>vssadmin.exe delete shadows</option>\n                            <option>HOW_TO_DECRYPT.txt</option>\n                            <option>crack</option>\n                            <option>patch</option>\n                            <option>disable_antivirus</option>\n                        </select>\n                        <small class=\"modeler-hint\">Hold Ctrl/Cmd to select multiple</small>\n                    </div>\n                    \n                    <button class=\"modeler-analyze-btn\" onclick=\"analyzeThreatModel()\">\n                        <i class=\"fas fa-brain\"></i> ANALYZE THREAT\n                    </button>\n                </div>\n                \n                <div class=\"modeler-results\">\n                    <h3><i class=\"fas fa-chart-line\"></i> Prediction Results</h3>\n                    <div id=\"modeler-output\" class=\"modeler-output\">\n                        <div class=\"modeler-placeholder\">\n                            <i class=\"fas fa-arrow-left\"></i>\n                            <p>Configure a threat profile and click ANALYZE to see predictions</p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n            </div>\n        </div>\n    </div>\n    \n    <script>\n        // Helper function to get CSS variable values dynamically for theming\n        function getCSSVar(varName) {\n            return getComputedStyle(document.documentElement).getPropertyValue(varName).trim();\n        }\n\n        // Back to Top Button\n        const backToTopBtn = document.getElementById('backToTop');\n        \n        window.addEventListener('scroll', () => {\n            if (window.pageYOffset > 300) {\n                backToTopBtn.classList.add('visible');\n            } else {\n                backToTopBtn.classList.remove('visible');\n            }\n        });\n\n        function scrollToTop() {\n            window.scrollTo({\n                top: 0,\n                behavior: 'smooth'\n            });\n        }\n\n        // View Switching System\n        function switchView(viewName) {\n            const views = document.querySelectorAll('.view-container');\n            \n            views.forEach(view => {\n                view.classList.remove('active');\n                if (view.id === `${viewName}View`) {\n                    view.classList.add('active');\n                }\n            });\n            \n            currentView = viewName;\n            \n            // Fix map display when switching to analytics view\n            if (viewName === 'analytics') {\n                loadAnalytics(); // Lazy load analytics components\n                setTimeout(() => {\n                    if (worldMap) {\n                        worldMap.invalidateSize();\n                    }\n                    // Capture screenshot for preview after charts has rendered\n                    setTimeout(() => {\n                        createAnalyticsMiniview();\n                    }, 1500);\n                }, 100);\n            }\n            \n            // Close graphs preview when switching views\n            document.getElementById('graphsPreview').classList.remove('show');\n            document.getElementById('previewBackdrop').classList.remove('show');\n        }\n        \n        // Side Panel Hover System\n        const sidePanel = document.getElementById('sidePanel');\n        const graphsPreview = document.getElementById('graphsPreview');\n        const previewBackdrop = document.getElementById('previewBackdrop');\n        const homeNavBtn = document.getElementById('homeNavBtn');\n        let previewTimeout;\n        let previewsRendered = false;\n        let currentView = 'dashboard';\n        \n        // Show preview panel on sidebar hover\n        sidePanel.addEventListener('mouseenter', () => {\n            clearTimeout(previewTimeout);\n            previewTimeout = setTimeout(() => {\n                graphsPreview.classList.add('show');\n                previewBackdrop.classList.add('show');\n                \n                // Show/hide home button based on current view\n                if (currentView === 'analytics') {\n                    homeNavBtn.classList.add('visible');\n                } else {\n                    homeNavBtn.classList.remove('visible');\n                }\n            }, 200);\n        });\n        \n        sidePanel.addEventListener('mouseleave', () => {\n            clearTimeout(previewTimeout);\n            setTimeout(() => {\n                if (!graphsPreview.matches(':hover')) {\n                    graphsPreview.classList.remove('show');\n                    previewBackdrop.classList.remove('show');\n                }\n            }, 100);\n        });\n        \n        // Keep preview open when hovering over it\n        graphsPreview.addEventListener('mouseleave', () => {\n            graphsPreview.classList.remove('show');\n            previewBackdrop.classList.remove('show');\n        });\n        \n        // Close preview when clicking backdrop\n        previewBackdrop.addEventListener('click', () => {\n            graphsPreview.classList.remove('show');\n            previewBackdrop.classList.remove('show');\n        });\n        \n        // Create analytics miniview by taking a screenshot\n        let isCapturingSnapshot = false;\n        let hasInitialSnapshot = false;\n        \n        async function createAnalyticsMiniview() {\n            // Simplified - no actual screenshot, just a visual preview\n            hasInitialSnapshot = true;\n        }\n        \n        // Auto-scroll on hover down in analytics view\n        let scrollInterval;\n        const analyticsGrid = document.getElementById('analyticsGrid');\n        \n        if (analyticsGrid) {\n            analyticsGrid.addEventListener('mousemove', (e) => {\n                const rect = analyticsGrid.getBoundingClientRect();\n                const mouseY = e.clientY - rect.top;\n                const triggerZone = 100; // pixels from bottom\n                \n                if (rect.height - mouseY < triggerZone) {\n                    if (!scrollInterval) {\n                        scrollInterval = setInterval(() => {\n                            analyticsGrid.scrollBy({ top: 2, behavior: 'smooth' });\n                        }, 16);\n                    }\n                } else {\n                    if (scrollInterval) {\n                        clearInterval(scrollInterval);\n                        scrollInterval = null;\n                    }\n                }\n            });\n            \n            analyticsGrid.addEventListener('mouseleave', () => {\n                if (scrollInterval) {\n                    clearInterval(scrollInterval);\n                    scrollInterval = null;\n                }\n            });\n        }\n        \n        // Theme Toggle\n        window.toggleTheme = function() {\n            const html = document.documentElement;\n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            const currentTheme = html.getAttribute('data-theme');\n            \n            if (currentTheme === 'light') {\n                html.setAttribute('data-theme', '');\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n                localStorage.setItem('theme', 'dark');\n            } else {\n                html.setAttribute('data-theme', 'light');\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n                localStorage.setItem('theme', 'light');\n            }\n        };\n        \n        // Load saved theme\n        const savedTheme = localStorage.getItem('theme');\n        if (savedTheme === 'light') {\n            document.documentElement.setAttribute('data-theme', 'light');\n            document.getElementById('themeIcon').textContent = '‚òÄÔ∏è';\n            document.getElementById('themeText').textContent = 'Light';\n        }\n        \n        let dailyChart = null;\n        let currentChartDays = 30;\n        \n        // Notification and Animation System\n        const notificationQueue = [];\n        let isShowingNotification = false;\n        \n        function showThreatNotification(scan) {\n            const container = document.getElementById('notification-container');\n            \n            const classColor = \n                scan.classification === 'Malware' ? '#ff4757' :\n                scan.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n            \n            const icon = \n                scan.classification === 'Malware' ? 'fa-skull-crossbones' :\n                scan.classification === 'Suspicious' ? 'fa-exclamation-triangle' : 'fa-check-circle';\n            \n            const notification = document.createElement('div');\n            notification.className = 'threat-notification';\n            notification.style.borderLeftColor = classColor;\n            notification.innerHTML = `\n                <div class=\"notification-icon\" style=\"color: ${classColor};\">\n                    <i class=\"fas ${icon}\"></i>\n                </div>\n                <div class=\"notification-content\">\n                    <div class=\"notification-title\">\n                        <strong>${scan.classification}</strong> detected\n                    </div>\n                    <div class=\"notification-details\">\n                        ${scan.detected_filename}\n                        ${scan.malware_family ? ` - ${scan.malware_family}` : ''}\n                    </div>\n                    <div class=\"notification-meta\">\n                        <i class=\"fas fa-desktop\"></i> ${scan.systemInfo?.hostname || scan.clientIp || 'Unknown'}\n                    </div>\n                </div>\n                <div class=\"notification-close\" onclick=\"this.parentElement.remove()\">\n                    <i class=\"fas fa-times\"></i>\n                </div>\n            `;\n            \n            container.appendChild(notification);\n            \n            // Animate in\n            setTimeout(() => notification.classList.add('show'), 10);\n            \n            // Auto-remove after 8 seconds\n            setTimeout(() => {\n                notification.classList.remove('show');\n                setTimeout(() => notification.remove(), 300);\n            }, 8000);\n        }\n        \n        function addToThreatTicker(scan) {\n            const ticker = document.getElementById('ticker-content');\n            const timestamp = new Date(scan.serverTimestamp).toLocaleTimeString();\n            \n            const classColor = \n                scan.classification === 'Malware' ? '#ff4757' :\n                scan.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n            \n            const tickerItem = document.createElement('span');\n            tickerItem.className = 'ticker-item';\n            tickerItem.style.color = classColor;\n            tickerItem.innerHTML = `\n                <i class=\"fas fa-circle\"></i>\n                [${timestamp}] ${scan.classification}: ${scan.detected_filename}\n                ${scan.malware_family ? `(${scan.malware_family})` : ''}\n                on ${scan.systemInfo?.hostname || scan.clientIp || 'Unknown'}\n            `;\n            \n            ticker.appendChild(tickerItem);\n            \n            // Keep only last 10 items\n            while (ticker.children.length > 10) {\n                ticker.removeChild(ticker.firstChild);\n            }\n        }\n        \n        function animateStatCard(elementId, newValue) {\n            const element = document.getElementById(elementId);\n            if (!element) return;\n            \n            const currentValue = parseInt(element.textContent) || 0;\n            if (newValue > currentValue) {\n                // Pulse animation\n                element.parentElement.classList.add('stat-pulse');\n                setTimeout(() => element.parentElement.classList.remove('stat-pulse'), 600);\n                \n                // Animate number increment\n                const duration = 500;\n                const steps = 20;\n                const increment = (newValue - currentValue) / steps;\n                let current = currentValue;\n                let step = 0;\n                \n                const interval = setInterval(() => {\n                    step++;\n                    current += increment;\n                    element.textContent = Math.round(current);\n                    \n                    if (step >= steps) {\n                        element.textContent = newValue;\n                        clearInterval(interval);\n                    }\n                }, duration / steps);\n            } else {\n                element.textContent = newValue;\n            }\n        }\n        \n        async function loadStats() {\n            try {\n                const response = await fetch('/api/stats');\n                const stats = await response.json();\n                \n                animateStatCard('stat-clients', stats.activeClients);\n                animateStatCard('stat-total', stats.totalScans);\n                animateStatCard('stat-malware', stats.malwareCount);\n                animateStatCard('stat-suspicious', stats.suspiciousCount);\n                animateStatCard('stat-benign', stats.benignCount);\n            } catch (error) {\n                console.error('Failed to load stats:', error);\n            }\n        }\n        \n        async function loadScans() {\n            try {\n                const response = await fetch('/api/scans?limit=50');\n                const data = await response.json();\n                \n                const tbody = document.getElementById('scans-tbody');\n                \n                if (data.scans.length === 0) {\n                    tbody.innerHTML = `\n                        <tr>\n                            <td colspan=\"5\" class=\"empty-state\">\n                                <i class=\"fas fa-inbox\"></i>\n                                <p>No scans yet. Waiting for clients...</p>\n                            </td>\n                        </tr>\n                    `;\n                    return;\n                }\n                \n                tbody.innerHTML = data.scans.map(scan => {\n                    const timestamp = new Date(scan.serverTimestamp).toLocaleString();\n                    const hash = scan.file_hashes?.sha256 || 'N/A';\n                    const hashShort = hash.length > 16 ? (hash.substring(0, 16) + '...') : hash;\n                    const isNonPe = scan.is_pe === false;\n                    const classification = isNonPe ? 'Non-PE' : (scan.classification || 'Unknown');\n                    const badgeClass = isNonPe ? 'non-pe' : classification.toLowerCase();\n                    const nonPeTag = isNonPe ? '<span class=\"badge non-pe\" title=\"Non-PE file\">Non-PE</span>' : '';\n                    return `\n                        <tr>\n                            <td>${timestamp}</td>\n                            <td>${scan.detected_filename} ${nonPeTag}</td>\n                            <td><span class=\"badge ${badgeClass}\">${classification}</span></td>\n                            <td>${scan.systemInfo?.ip || scan.clientIp || 'Unknown'}</td>\n                            <td class=\"hash\" title=\"${hash}\">${hashShort}</td>\n                        </tr>\n                    `;\n                }).join('');\n                \n            } catch (error) {\n                console.error('Failed to load scans:', error);\n            }\n        }\n        \n        async function loadDailyChart() {\n            try {\n                const response = await fetch(`/api/daily-scans?days=${currentChartDays}`);\n                const data = await response.json();\n                \n                const ctx = document.getElementById('dailyScansChart');\n                \n                // Format dates for display (MM/DD)\n                const labels = data.days.map(day => {\n                    const date = new Date(day.date);\n                    return `${date.getMonth() + 1}/${date.getDate()}`;\n                });\n                \n                // Reuse existing chart if it exists\n                if (dailyChart) {\n                    dailyChart.data.labels = labels;\n                    dailyChart.data.datasets[0].data = data.days.map(d => d.total);\n                    dailyChart.data.datasets[1].data = data.days.map(d => d.malware);\n                    dailyChart.data.datasets[2].data = data.days.map(d => d.suspicious);\n                    dailyChart.data.datasets[3].data = data.days.map(d => d.benign);\n                    dailyChart.update('none'); // Update without animation\n                    return;\n                }\n                \n                dailyChart = new Chart(ctx, {\n                    type: 'line',\n                    data: {\n                        labels: labels,\n                        datasets: [\n                            {\n                                label: 'Total Scans',\n                                data: data.days.map(d => d.total),\n                                borderColor: '#5a9cf8',\n                                backgroundColor: 'rgba(90, 156, 248, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Malware',\n                                data: data.days.map(d => d.malware),\n                                borderColor: '#ff4757',\n                                backgroundColor: 'rgba(255, 71, 87, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Suspicious',\n                                data: data.days.map(d => d.suspicious),\n                                borderColor: '#ffa502',\n                                backgroundColor: 'rgba(255, 165, 2, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Benign',\n                                data: data.days.map(d => d.benign),\n                                borderColor: '#26de81',\n                                backgroundColor: 'rgba(38, 222, 129, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        interaction: {\n                            mode: 'index',\n                            intersect: false,\n                        },\n                        plugins: {\n                            legend: {\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 12 }\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0',\n                                borderColor: 'rgba(255, 255, 255, 0.1)',\n                                borderWidth: 1\n                            }\n                        },\n                        scales: {\n                            x: {\n                                ticks: { \n                                    color: getCSSVar('--chart-text-color') || '#888',\n                                    maxRotation: 45,\n                                    minRotation: 45\n                                },\n                                grid: { \n                                    color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' \n                                }\n                            },\n                            y: {\n                                beginAtZero: true,\n                                ticks: { \n                                    color: getCSSVar('--chart-text-color') || '#888',\n                                    stepSize: 1\n                                },\n                                grid: { \n                                    color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' \n                                }\n                            }\n                        }\n                    }\n                });\n                \n            } catch (error) {\n                console.error('Failed to load daily chart:', error);\n            }\n        }\n        \n        let worldMap = null;\n        let markerLayer = null;\n        let heatmapLayer = null;\n        let choroplethLayer = null;\n        let mapInitialized = false;\n        let lastGeoDataHash = '';\n        let sourceChart = null;\n        let currentMapView = 'markers';\n        let geoDataCache = null;\n        let replayInterval = null;\n        \n        // Country boundaries for choropleth (simplified)\n        const countryCoordinates = {\n            'United States': { center: [37.0902, -95.7129], weight: 0 },\n            'China': { center: [35.8617, 104.1954], weight: 0 },\n            'United Kingdom': { center: [55.3781, -3.4360], weight: 0 },\n            'Germany': { center: [51.1657, 10.4515], weight: 0 },\n            'France': { center: [46.2276, 2.2137], weight: 0 },\n            'Russia': { center: [61.5240, 105.3188], weight: 0 },\n            'Japan': { center: [36.2048, 138.2529], weight: 0 },\n            'India': { center: [20.5937, 78.9629], weight: 0 },\n            'Brazil': { center: [-14.2350, -51.9253], weight: 0 },\n            'Australia': { center: [-25.2744, 133.7751], weight: 0 }\n        };\n        \n        function initializeMap() {\n            if (mapInitialized) return;\n            \n            try {\n                worldMap = L.map('worldMap', {\n                    zoomControl: true,\n                    scrollWheelZoom: true,\n                    preferCanvas: false,\n                    worldCopyJump: true\n                }).setView([20, 0], 2);\n                \n                // Use dark theme tiles\n                L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {\n                    attribution: '&copy; OpenStreetMap contributors',\n                    subdomains: 'abcd',\n                    maxZoom: 18,\n                    minZoom: 1,\n                    noWrap: false,\n                    bounds: [[-90, -180], [90, 180]]\n                }).addTo(worldMap);\n                \n                markerLayer = L.layerGroup().addTo(worldMap);\n                mapInitialized = true;\n                \n                // Fix map display after initialization\n                setTimeout(() => {\n                    if (worldMap) worldMap.invalidateSize();\n                }, 100);\n            } catch (error) {\n                console.error('Failed to initialize map:', error);\n            }\n        }\n        \n        // Switch between map visualization modes\n        window.switchMapView = function(view) {\n            currentMapView = view;\n            \n            // Update button states\n            document.querySelectorAll('.map-btn').forEach(btn => {\n                btn.classList.remove('active');\n            });\n            document.querySelector(`[data-view=\"${view}\"]`).classList.add('active');\n            \n            // Reload map with new view\n            if (geoDataCache) {\n                renderMapView(geoDataCache);\n            }\n        };\n        \n        // Render different map views\n        function renderMapView(data) {\n            if (!worldMap) return;\n            \n            // Clear all layers\n            if (markerLayer) markerLayer.clearLayers();\n            if (heatmapLayer) {\n                worldMap.removeLayer(heatmapLayer);\n                heatmapLayer = null;\n            }\n            if (choroplethLayer) {\n                worldMap.removeLayer(choroplethLayer);\n                choroplethLayer = null;\n            }\n            \n            switch (currentMapView) {\n                case 'markers':\n                    renderMarkers(data);\n                    break;\n                case 'heatmap':\n                    renderHeatmap(data);\n                    break;\n                case 'choropleth':\n                    renderChoropleth(data);\n                    break;\n            }\n            \n            updateGeoContext(data);\n        }\n        \n        // Render traditional markers\n        function renderMarkers(data) {\n            data.locations.forEach(location => {\n                const { lat, lng, city, country } = location.location;\n                \n                let markerColor = '#26de81'; // benign\n                if (location.malwareCount > 0) {\n                    markerColor = '#ff3b3b'; // malware\n                } else if (location.suspiciousCount > 0) {\n                    markerColor = '#ffd700'; // suspicious\n                }\n                \n                const markerSize = Math.min(24, Math.max(8, 8 + location.totalScans * 2));\n                \n                const marker = L.circleMarker([lat, lng], {\n                    radius: markerSize / 2,\n                    fillColor: markerColor,\n                    color: '#fff',\n                    weight: 2,\n                    opacity: 0.8,\n                    fillOpacity: 0.6\n                });\n                \n                const popupContent = `\n                    <div style=\"color: var(--text-primary); min-width: 200px;\">\n                        <h3 style=\"margin: 0 0 10px 0; color: var(--accent-green); font-size: 1.1rem;\">\n                            <i class=\"fas fa-map-marker-alt\" style=\"color: ${markerColor};\"></i>\n                            ${city}, ${country}\n                        </h3>\n                        <p style=\"margin: 5px 0;\"><strong>IP:</strong> ${location.ip}</p>\n                        <p style=\"margin: 5px 0;\"><strong>Total Scans:</strong> ${location.totalScans}</p>\n                        <div style=\"margin-top: 10px;\">\n                            <div><span style=\"color: #ff3b3b;\">‚óè</span> Malware: ${location.malwareCount}</div>\n                            <div><span style=\"color: #ffd700;\">‚óè</span> Suspicious: ${location.suspiciousCount}</div>\n                            <div><span style=\"color: #39ff14;\">‚óè</span> Benign: ${location.benignCount}</div>\n                        </div>\n                        <button onclick=\"filterByLocation('${country}')\" \n                                style=\"margin-top: 10px; padding: 5px 10px; background: var(--accent-green); \n                                       color: var(--bg-primary); border: none; border-radius: 5px; cursor: pointer;\">\n                            Filter by ${country}\n                        </button>\n                    </div>\n                `;\n                \n                marker.bindPopup(popupContent);\n                marker.addTo(markerLayer);\n                \n                marker.on('mouseover', function() {\n                    this.setStyle({ fillOpacity: 0.9, opacity: 1 });\n                });\n                marker.on('mouseout', function() {\n                    this.setStyle({ fillOpacity: 0.6, opacity: 0.8 });\n                });\n            });\n        }\n        \n        // Render heatmap overlay\n        function renderHeatmap(data) {\n            const heatData = [];\n            \n            data.locations.forEach(location => {\n                const { lat, lng } = location.location;\n                // Weight by threat severity: malware = 1.0, suspicious = 0.5, benign = 0.2\n                const weight = (location.malwareCount * 1.0 + \n                               location.suspiciousCount * 0.5 + \n                               location.benignCount * 0.2) / location.totalScans;\n                \n                // Add multiple points for higher intensity\n                const intensity = Math.ceil(location.totalScans * weight);\n                for (let i = 0; i < intensity; i++) {\n                    heatData.push([lat, lng, weight]);\n                }\n            });\n            \n            heatmapLayer = L.heatLayer(heatData, {\n                radius: 35,\n                blur: 25,\n                maxZoom: 10,\n                max: 1.0,\n                gradient: {\n                    0.0: '#39ff14',  // Green (low threat)\n                    0.3: '#ffd700',  // Yellow\n                    0.6: '#ffa502',  // Orange\n                    0.8: '#ff6348',  // Red\n                    1.0: '#ff3b3b'   // Bright red (high threat)\n                }\n            }).addTo(worldMap);\n        }\n        \n        // Render choropleth (country-level threat shading)\n        function renderChoropleth(data) {\n            // Aggregate threats by country\n            const countryStats = {};\n            data.locations.forEach(location => {\n                const country = location.location.country;\n                if (!countryStats[country]) {\n                    countryStats[country] = { total: 0, malware: 0, suspicious: 0 };\n                }\n                countryStats[country].total += location.totalScans;\n                countryStats[country].malware += location.malwareCount;\n                countryStats[country].suspicious += location.suspiciousCount;\n            });\n            \n            // Find max for normalization\n            const maxThreats = Math.max(...Object.values(countryStats).map(s => \n                s.malware + s.suspicious * 0.5\n            ));\n            \n            // Draw circles for countries with threat data\n            choroplethLayer = L.layerGroup();\n            \n            Object.entries(countryStats).forEach(([country, stats]) => {\n                if (countryCoordinates[country]) {\n                    const threatScore = (stats.malware + stats.suspicious * 0.5) / maxThreats;\n                    \n                    // Color gradient from green to red\n                    let color;\n                    if (threatScore < 0.2) color = '#39ff14';\n                    else if (threatScore < 0.4) color = '#ffd700';\n                    else if (threatScore < 0.6) color = '#ffa502';\n                    else if (threatScore < 0.8) color = '#ff6348';\n                    else color = '#ff3b3b';\n                    \n                    const circle = L.circle(countryCoordinates[country].center, {\n                        color: color,\n                        fillColor: color,\n                        fillOpacity: 0.4,\n                        radius: 500000 * (1 + threatScore * 2),\n                        weight: 2\n                    });\n                    \n                    circle.bindPopup(`\n                        <div style=\"color: var(--text-primary);\">\n                            <h3 style=\"color: var(--accent-green);\">${country}</h3>\n                            <p><strong>Total Threats:</strong> ${stats.total}</p>\n                            <p><strong>Malware:</strong> ${stats.malware}</p>\n                            <p><strong>Suspicious:</strong> ${stats.suspicious}</p>\n                            <p><strong>Threat Level:</strong> ${(threatScore * 100).toFixed(0)}%</p>\n                        </div>\n                    `);\n                    \n                    circle.addTo(choroplethLayer);\n                }\n            });\n            \n            choroplethLayer.addTo(worldMap);\n        }\n        \n        // Update geographic context panel\n        function updateGeoContext(data) {\n            const countries = new Set(data.locations.map(l => l.location.country));\n            document.getElementById('activeRegions').textContent = countries.size;\n            \n            // Find hotspot (country with most threats)\n            const countryThreats = {};\n            data.locations.forEach(loc => {\n                const country = loc.location.country;\n                countryThreats[country] = (countryThreats[country] || 0) + \n                    loc.malwareCount + loc.suspiciousCount;\n            });\n            \n            const hotspot = Object.entries(countryThreats)\n                .sort((a, b) => b[1] - a[1])[0];\n            \n            if (hotspot) {\n                const percentage = ((hotspot[1] / data.locations.reduce((sum, l) => \n                    sum + l.malwareCount + l.suspiciousCount, 0)) * 100).toFixed(0);\n                document.getElementById('topRegion').textContent = \n                    `${hotspot[0]} (${percentage}% of threats)`;\n            }\n            \n            const totalThreats = data.locations.reduce((sum, l) => \n                sum + l.malwareCount + l.suspiciousCount, 0);\n            document.getElementById('geoThreatCount').textContent = totalThreats;\n        }\n        \n        // Filter dashboard by geographic location\n        window.filterByLocation = function(country) {\n            console.log(`Filtering by country: ${country}`);\n            // This would filter the tables and charts - simplified for demo\n            alert(`Geographic filtering activated for ${country}.\\nIn full implementation, this would filter all dashboard data.`);\n        };\n        \n        // Replay threats over last 24 hours\n        window.replayThreats = async function() {\n            const btn = document.getElementById('replayBtn');\n            const info = document.getElementById('timelineInfo');\n            \n            if (replayInterval) {\n                clearInterval(replayInterval);\n                replayInterval = null;\n                btn.innerHTML = '<i class=\"fas fa-play\"></i> Replay Last 24h';\n                info.textContent = 'Replay stopped';\n                if (geoDataCache) renderMapView(geoDataCache);\n                return;\n            }\n            \n            if (!geoDataCache || geoDataCache.locations.length === 0) {\n                info.textContent = 'No data available for replay';\n                return;\n            }\n            \n            btn.innerHTML = '<i class=\"fas fa-stop\"></i> Stop Replay';\n            info.textContent = 'Replaying threat detection timeline...';\n            \n            // Sort locations by timestamp\n            const sortedLocations = [...geoDataCache.locations].sort((a, b) => {\n                const timeA = a.scans[0]?.timestamp || 0;\n                const timeB = b.scans[0]?.timestamp || 0;\n                return new Date(timeA) - new Date(timeB);\n            });\n            \n            if (markerLayer) markerLayer.clearLayers();\n            let index = 0;\n            \n            replayInterval = setInterval(() => {\n                if (index >= sortedLocations.length) {\n                    clearInterval(replayInterval);\n                    replayInterval = null;\n                    btn.innerHTML = '<i class=\"fas fa-play\"></i> Replay Last 24h';\n                    info.textContent = 'Replay complete';\n                    return;\n                }\n                \n                const location = sortedLocations[index];\n                const { lat, lng, city, country } = location.location;\n                \n                let markerColor = location.malwareCount > 0 ? '#ff3b3b' : \n                                 location.suspiciousCount > 0 ? '#ffd700' : '#39ff14';\n                \n                // Animated marker appearance\n                const marker = L.circleMarker([lat, lng], {\n                    radius: 0,\n                    fillColor: markerColor,\n                    color: '#fff',\n                    weight: 2,\n                    opacity: 1,\n                    fillOpacity: 0.8\n                }).addTo(markerLayer);\n                \n                // Animate marker growth\n                let size = 0;\n                const growInterval = setInterval(() => {\n                    size += 2;\n                    if (size >= 12) {\n                        clearInterval(growInterval);\n                        marker.setStyle({ opacity: 0.8, fillOpacity: 0.6 });\n                    }\n                    marker.setRadius(size / 2);\n                }, 50);\n                \n                marker.bindPopup(`\n                    <div style=\"color: var(--text-primary);\">\n                        <strong>${city}, ${country}</strong><br>\n                        ${location.scans[0]?.filename || 'Unknown file'}\n                    </div>\n                `);\n                \n                info.textContent = `Replaying: ${index + 1}/${sortedLocations.length} - ${city}, ${country}`;\n                index++;\n            }, 800); // Show new threat every 800ms\n        };\n        \n        async function loadGeoMap() {\n            try {\n                // Initialize map only once\n                if (!mapInitialized) {\n                    initializeMap();\n                }\n                \n                if (!worldMap) return;\n                \n                const response = await fetch('/api/geo-data');\n                const data = await response.json();\n                \n                // Generate hash of current data to detect changes\n                const currentHash = JSON.stringify(data.locations.map(l => \n                    `${l.ip}-${l.totalScans}-${l.malwareCount}-${l.suspiciousCount}`\n                )).substring(0, 100);\n                \n                // Skip update if data hasn't changed\n                if (currentHash === lastGeoDataHash && markerLayer && markerLayer.getLayers().length > 0) {\n                    return;\n                }\n                lastGeoDataHash = currentHash;\n                \n                // Cache data for replay and other features\n                geoDataCache = data;\n                \n                // Render current view\n                renderMapView(data);\n                \n                console.log(`Map updated with ${data.locations.length} locations in ${currentMapView} mode`);\n                \n            } catch (error) {\n                console.error('Failed to load geo map:', error);\n            }\n        }\n        \n        async function loadMalwareSources() {\n            try {\n                const response = await fetch('/api/malware-sources');\n                const data = await response.json();\n                \n                const ctx = document.getElementById('malwareSourceChart');\n                \n                const labels = data.sources.map(s => s.source);\n                const counts = data.sources.map(s => s.count);\n                \n                // Color scheme for different sources\n                const colors = [\n                    '#ff6b6b', // Email Attachment - red\n                    '#4ecdc4', // Web Download - teal\n                    '#ffe66d', // USB/External Drive - yellow\n                    '#a8dadc', // Internal Network - light blue\n                    '#95a5a6'  // Unknown - gray\n                ];\n                \n                // Reuse existing chart if it exists\n                if (sourceChart) {\n                    sourceChart.data.labels = labels;\n                    sourceChart.data.datasets[0].data = counts;\n                    sourceChart.update('none');\n                    return;\n                }\n                \n                sourceChart = new Chart(ctx, {\n                    type: 'pie',\n                    data: {\n                        labels: labels,\n                        datasets: [{\n                            data: counts,\n                            backgroundColor: colors,\n                            borderColor: '#1a1a2e',\n                            borderWidth: 2\n                        }]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: true,\n                        plugins: {\n                            legend: {\n                                position: 'bottom',\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 12 },\n                                    padding: 15\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0',\n                                borderColor: 'rgba(255, 255, 255, 0.1)',\n                                borderWidth: 1,\n                                callbacks: {\n                                    label: function(context) {\n                                        const label = context.label || '';\n                                        const value = context.parsed || 0;\n                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);\n                                        const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : 0;\n                                        return `${label}: ${value} (${percentage}%)`;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                });\n                \n            } catch (error) {\n                console.error('Failed to load malware sources:', error);\n            }\n        }\n        \n        // Graph 2: \"Noisiest\" Agents Over Time\n        let noisyAgentsChart = null;\n        async function loadNoisyAgentsChart() {\n            try {\n                const response = await fetch('/api/noisy-agents');\n                const data = await response.json();\n                \n                console.log('Noisy agents data:', data);\n                \n                const ctx = document.getElementById('noisyAgentsChart');\n                if (!ctx) return;\n                \n                // Show message if no data\n                if (!data.agents || data.agents.length === 0) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 2rem; text-align: center; color: var(--text-secondary);\">No agent data available yet. Start scanning files to see trends.</div>';\n                    return;\n                }\n                \n                const colors = [\n                    '#ff3b3b', '#39ff14', '#ffd700', '#1e90ff', '#ff1493'\n                ];\n                \n                // Reuse existing chart if it exists\n                if (noisyAgentsChart) {\n                    noisyAgentsChart.data.labels = data.dates;\n                    noisyAgentsChart.data.datasets = data.agents.map((agent, idx) => ({\n                        label: agent.agentId,\n                        data: agent.counts,\n                        borderColor: colors[idx],\n                        backgroundColor: colors[idx] + '20',\n                        tension: 0.4,\n                        borderWidth: 2,\n                        fill: false\n                    }));\n                    noisyAgentsChart.update('none');\n                    return;\n                }\n                \n                noisyAgentsChart = new Chart(ctx, {\n                    type: 'line',\n                    data: {\n                        labels: data.dates,\n                        datasets: data.agents.map((agent, idx) => ({\n                            label: agent.agentId,\n                            data: agent.counts,\n                            borderColor: colors[idx],\n                            backgroundColor: colors[idx] + '20',\n                            tension: 0.4,\n                            borderWidth: 2,\n                            fill: false\n                        }))\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 11 }\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: getCSSVar('--chart-text-color') || '#888' },\n                                grid: { color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                ticks: { color: getCSSVar('--chart-text-color') || '#888' },\n                                grid: { color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load noisy agents chart:', error);\n                const ctx = document.getElementById('noisyAgentsChart');\n                if (ctx) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 2rem; text-align: center; color: var(--accent-red);\">Error loading chart data</div>';\n                }\n            }\n        }\n        \n        // Graph 3: Signature Status vs. Classification\n        let signatureClassChart = null;\n        async function loadSignatureClassChart() {\n            try {\n                const response = await fetch('/api/signature-classification');\n                const data = await response.json();\n                \n                console.log('Signature classification data:', data);\n                \n                const ctx = document.getElementById('signatureClassChart');\n                if (!ctx) {\n                    console.warn('signatureClassChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (signatureClassChart) {\n                    signatureClassChart.data.datasets[0].data = [data.benign.verified, data.suspicious.verified, data.malware.verified];\n                    signatureClassChart.data.datasets[1].data = [data.benign.unknown, data.suspicious.unknown, data.malware.unknown];\n                    signatureClassChart.data.datasets[2].data = [data.benign.untrusted, data.suspicious.untrusted, data.malware.untrusted];\n                    signatureClassChart.update('none');\n                    return;\n                }\n                \n                signatureClassChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: ['Benign', 'Suspicious', 'Malware'],\n                        datasets: [\n                            {\n                                label: 'Verified',\n                                data: [data.benign.verified, data.suspicious.verified, data.malware.verified],\n                                backgroundColor: '#39ff14',\n                                stack: 'stack0'\n                            },\n                            {\n                                label: 'Unknown',\n                                data: [data.benign.unknown, data.suspicious.unknown, data.malware.unknown],\n                                backgroundColor: '#ffd700',\n                                stack: 'stack0'\n                            },\n                            {\n                                label: 'Untrusted',\n                                data: [data.benign.untrusted, data.suspicious.untrusted, data.malware.untrusted],\n                                backgroundColor: '#ff3b3b',\n                                stack: 'stack0'\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                callbacks: {\n                                    label: function(context) {\n                                        const total = context.chart.data.datasets\n                                            .reduce((sum, ds) => sum + ds.data[context.dataIndex], 0);\n                                        const percentage = ((context.parsed.y / total) * 100).toFixed(1);\n                                        return `${context.dataset.label}: ${context.parsed.y} (${percentage}%)`;\n                                    }\n                                }\n                            }\n                        },\n                        scales: {\n                            y: {\n                                stacked: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                stacked: true,\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load signature classification chart:', error);\n                const ctx = document.getElementById('signatureClassChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 4: Packer Usage vs. Classification\n        let packerClassChart = null;\n        async function loadPackerClassChart() {\n            try {\n                const response = await fetch('/api/packer-classification');\n                const data = await response.json();\n                \n                console.log('Packer classification data:', data);\n                \n                const ctx = document.getElementById('packerClassChart');\n                if (!ctx) {\n                    console.warn('packerClassChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (packerClassChart) {\n                    packerClassChart.data.labels = data.packers;\n                    packerClassChart.data.datasets[0].data = data.benignCounts;\n                    packerClassChart.data.datasets[1].data = data.malwareCounts;\n                    packerClassChart.update('none');\n                    return;\n                }\n                \n                packerClassChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: data.packers,\n                        datasets: [\n                            {\n                                label: 'Benign Files',\n                                data: data.benignCounts,\n                                backgroundColor: '#39ff14'\n                            },\n                            {\n                                label: 'Malware Files',\n                                data: data.malwareCounts,\n                                backgroundColor: '#ff3b3b'\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load packer classification chart:', error);\n                const ctx = document.getElementById('packerClassChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 5: Confidence Score Histogram\n        let confidenceHistChart = null;\n        async function loadConfidenceHistChart() {\n            try {\n                const response = await fetch('/api/confidence-distribution');\n                const data = await response.json();\n                \n                console.log('Confidence distribution data:', data);\n                \n                const ctx = document.getElementById('confidenceHistChart');\n                if (!ctx) {\n                    console.warn('confidenceHistChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (confidenceHistChart) {\n                    confidenceHistChart.data.labels = data.bins;\n                    confidenceHistChart.data.datasets[0].data = data.counts;\n                    confidenceHistChart.update('none');\n                    return;\n                }\n                \n                confidenceHistChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: data.bins,\n                        datasets: [{\n                            label: 'Scan Count',\n                            data: data.counts,\n                            backgroundColor: '#39ff14',\n                            borderColor: '#2ed60f',\n                            borderWidth: 1\n                        }]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' },\n                                title: {\n                                    display: true,\n                                    text: 'Number of Scans',\n                                    color: '#888'\n                                }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false },\n                                title: {\n                                    display: true,\n                                    text: 'Confidence Score Range',\n                                    color: '#888'\n                                }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load confidence histogram:', error);\n                const ctx = document.getElementById('confidenceHistChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 6: File Entropy Distribution (Box Plot simulation)\n        let entropyBoxChart = null;\n        async function loadEntropyBoxChart() {\n            try {\n                const response = await fetch('/api/entropy-distribution');\n                const data = await response.json();\n                \n                console.log('Entropy distribution data:', data);\n                \n                const ctx = document.getElementById('entropyBoxChart');\n                if (!ctx) {\n                    console.warn('entropyBoxChart canvas not found');\n                    return;\n                }\n                \n                // Create violin/box plot effect with multiple bars\n                const benignData = [\n                    data.benign.min,\n                    data.benign.q1,\n                    data.benign.median,\n                    data.benign.q3,\n                    data.benign.max\n                ];\n                \n                const malwareData = [\n                    data.malware.min,\n                    data.malware.q1,\n                    data.malware.median,\n                    data.malware.q3,\n                    data.malware.max\n                ];\n                \n                // Reuse existing chart if it exists\n                if (entropyBoxChart) {\n                    entropyBoxChart.data.datasets[0].data = benignData;\n                    entropyBoxChart.data.datasets[1].data = malwareData;\n                    entropyBoxChart.update('none');\n                    return;\n                }\n                \n                entropyBoxChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: ['Min', 'Q1', 'Median', 'Q3', 'Max'],\n                        datasets: [\n                            {\n                                label: 'Benign Files',\n                                data: benignData,\n                                backgroundColor: '#39ff14',\n                                borderColor: '#2ed60f',\n                                borderWidth: 1\n                            },\n                            {\n                                label: 'Malware Files',\n                                data: malwareData,\n                                backgroundColor: '#ff3b3b',\n                                borderColor: '#cc2f2f',\n                                borderWidth: 1\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                callbacks: {\n                                    label: function(context) {\n                                        return `${context.dataset.label}: ${context.parsed.y.toFixed(3)}`;\n                                    }\n                                }\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                max: 8.0,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' },\n                                title: {\n                                    display: true,\n                                    text: 'Entropy Value',\n                                    color: '#888'\n                                }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load entropy distribution chart:', error);\n                const ctx = document.getElementById('entropyBoxChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        async function loadEmergingThreats() {\n            try {\n                const response = await fetch('/api/emerging-threats');\n                const data = await response.json();\n                \n                // Update summary badges\n                document.getElementById('eti-total').textContent = \n                    `${data.summary.totalThreats} Total Threats`;\n                document.getElementById('eti-recent').textContent = \n                    `${data.summary.recentThreats} Last 24h`;\n                \n                // Helper to render IOC list\n                const renderIOCList = (items, container) => {\n                    if (items.length === 0) {\n                        container.innerHTML = '<div class=\"eti-empty\">No threats detected</div>';\n                        return;\n                    }\n                    \n                    container.innerHTML = items.map((item, index) => {\n                        const rank = index + 1;\n                        const recentBadge = item.recent > 0 ? \n                            `<span class=\"eti-recent-badge\">${item.recent} recent</span>` : '';\n                        const agentBadge = item.agents > 0 ? \n                            `<span class=\"eti-agent-badge\">${item.agents} agents</span>` : '';\n                        \n                        return `\n                            <div class=\"eti-item\" data-rank=\"${rank}\">\n                                <div class=\"eti-rank\">${rank}</div>\n                                <div class=\"eti-content\">\n                                    <div class=\"eti-name\">${item.name}</div>\n                                    <div class=\"eti-meta\">\n                                        <span class=\"eti-count\">${item.count} occurrences</span>\n                                        ${recentBadge}\n                                        ${agentBadge}\n                                    </div>\n                                    ${item.details && item.details.length > 0 ? `\n                                        <div class=\"eti-details\">\n                                            ${item.details.slice(0, 2).join(', ')}\n                                            ${item.details.length > 2 ? '...' : ''}\n                                        </div>\n                                    ` : ''}\n                                </div>\n                            </div>\n                        `;\n                    }).join('');\n                };\n                \n                // Render each section\n                renderIOCList(data.topMalwareFamilies, document.getElementById('eti-malware'));\n                renderIOCList(data.topSuspiciousAPIs, document.getElementById('eti-apis'));\n                renderIOCList(data.topMaliciousStrings, document.getElementById('eti-strings'));\n                renderIOCList(data.topPackers, document.getElementById('eti-packers'));\n                \n            } catch (error) {\n                console.error('Failed to load emerging threats:', error);\n            }\n        }\n        \n        async function analyzeThreatModel() {\n            try {\n                // Get selected values\n                const fileType = document.getElementById('model-filetype').value;\n                const packer = document.getElementById('model-packer').value;\n                const signature = document.getElementById('model-signature').value;\n                \n                // Get multiple selections\n                const apisSelect = document.getElementById('model-apis');\n                const apiImports = Array.from(apisSelect.selectedOptions).map(opt => opt.value);\n                \n                const stringsSelect = document.getElementById('model-strings');\n                const keyStrings = Array.from(stringsSelect.selectedOptions).map(opt => opt.value);\n                \n                // Validate\n                if (apiImports.length === 0) {\n                    alert('Please select at least one API import');\n                    return;\n                }\n                if (keyStrings.length === 0) {\n                    alert('Please select at least one suspicious string');\n                    return;\n                }\n                \n                // Show loading state\n                const outputDiv = document.getElementById('modeler-output');\n                outputDiv.innerHTML = `\n                    <div class=\"modeler-loading\">\n                        <i class=\"fas fa-spinner fa-spin\"></i>\n                        <p>Analyzing threat profile...</p>\n                    </div>\n                `;\n                \n                // Send to server\n                const response = await fetch('/api/threat-model', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                        fileType,\n                        packer,\n                        signature,\n                        apiImports,\n                        keyStrings\n                    })\n                });\n                \n                const data = await response.json();\n                \n                if (data.success) {\n                    const result = data.result;\n                    const classColor = \n                        result.classification === 'Malware' ? '#ff4757' :\n                        result.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n                    \n                    outputDiv.innerHTML = `\n                        <div class=\"prediction-result\">\n                            <div class=\"prediction-header\">\n                                <div class=\"prediction-badge\" style=\"background: ${classColor};\">\n                                    ${result.classification.toUpperCase()}\n                                </div>\n                                <div class=\"prediction-confidence\">\n                                    <div class=\"confidence-label\">Confidence Score</div>\n                                    <div class=\"confidence-value\">${(parseFloat(result.confidence_score) * 100).toFixed(1)}%</div>\n                                </div>\n                            </div>\n                            \n                            ${result.malware_family ? `\n                                <div class=\"prediction-family\">\n                                    <strong>Predicted Malware Family:</strong>\n                                    <span class=\"family-name\">${result.malware_family}</span>\n                                </div>\n                            ` : ''}\n                            \n                            <div class=\"prediction-section\">\n                                <h4>Threat Analysis</h4>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-file\"></i>\n                                    <span><strong>File Type:</strong> ${result.key_findings.file_type}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-box\"></i>\n                                    <span><strong>Packer:</strong> ${result.key_findings.packer_detected}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-certificate\"></i>\n                                    <span><strong>Signature:</strong> ${result.key_findings.signature.name}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-tachometer-alt\"></i>\n                                    <span><strong>Threat Score:</strong> ${result.key_findings.threat_score}/100</span>\n                                </div>\n                            </div>\n                            \n                            <div class=\"prediction-section\">\n                                <h4>Detected Indicators</h4>\n                                <div class=\"indicator-group\">\n                                    <strong>API Imports:</strong>\n                                    <div class=\"indicator-list\">\n                                        ${result.key_findings.api_imports.map(api => \n                                            `<span class=\"indicator-tag api-tag\">${api}</span>`\n                                        ).join('')}\n                                    </div>\n                                </div>\n                                <div class=\"indicator-group\">\n                                    <strong>Suspicious Strings:</strong>\n                                    <div class=\"indicator-list\">\n                                        ${result.key_findings.key_strings.map(str => \n                                            `<span class=\"indicator-tag string-tag\">${str}</span>`\n                                        ).join('')}\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"prediction-footer\">\n                                <i class=\"fas fa-info-circle\"></i>\n                                This analysis has been added to the scan results and will appear in all visualizations.\n                            </div>\n                        </div>\n                    `;\n                } else {\n                    outputDiv.innerHTML = `\n                        <div class=\"modeler-error\">\n                            <i class=\"fas fa-exclamation-circle\"></i>\n                            <p>Analysis failed: ${data.error}</p>\n                        </div>\n                    `;\n                }\n                \n            } catch (error) {\n                console.error('Failed to analyze threat model:', error);\n                document.getElementById('modeler-output').innerHTML = `\n                    <div class=\"modeler-error\">\n                        <i class=\"fas fa-exclamation-circle\"></i>\n                        <p>Analysis failed. Please try again.</p>\n                    </div>\n                `;\n            }\n        }\n        \n        let graphSimulation = null;\n        let graphSvg = null;\n        \n        async function loadCorrelationGraph() {\n            try {\n                const response = await fetch('/api/threat-correlations');\n                const data = await response.json();\n                \n                // Clear existing graph\n                d3.select('#correlationGraph').selectAll('*').remove();\n                \n                const container = document.getElementById('correlationGraph');\n                const width = container.clientWidth;\n                const height = 600;\n                \n                // Create SVG\n                graphSvg = d3.select('#correlationGraph')\n                    .append('svg')\n                    .attr('width', width)\n                    .attr('height', height)\n                    .style('background', '#0a0a0a')\n                    .style('border-radius', '8px');\n                \n                const g = graphSvg.append('g');\n                \n                // Add zoom behavior\n                const zoom = d3.zoom()\n                    .scaleExtent([0.1, 4])\n                    .on('zoom', (event) => {\n                        g.attr('transform', event.transform);\n                    });\n                \n                graphSvg.call(zoom);\n                \n                // Color schemes for different node types\n                const colorMap = {\n                    malware: '#ff4757',\n                    agent: '#5a9cf8',\n                    api: '#ffa502',\n                    string: '#26de81'\n                };\n                \n                // Create force simulation\n                graphSimulation = d3.forceSimulation(data.nodes)\n                    .force('link', d3.forceLink(data.links)\n                        .id(d => d.id)\n                        .distance(d => d.type === 'correlated_with' ? 200 : 100)\n                        .strength(d => d.strength * 0.3))\n                    .force('charge', d3.forceManyBody().strength(-300))\n                    .force('center', d3.forceCenter(width / 2, height / 2))\n                    .force('collision', d3.forceCollide().radius(30));\n                \n                // Draw links\n                const link = g.append('g')\n                    .selectAll('line')\n                    .data(data.links)\n                    .enter()\n                    .append('line')\n                    .attr('stroke', d => {\n                        if (d.type === 'correlated_with') return '#ff6b6b';\n                        if (d.type === 'detected_by') return '#5a9cf8';\n                        if (d.type === 'uses_api') return '#ffa502';\n                        return '#26de81';\n                    })\n                    .attr('stroke-width', d => Math.sqrt(d.strength) + 1)\n                    .attr('stroke-opacity', 0.6);\n                \n                // Draw nodes\n                const node = g.append('g')\n                    .selectAll('circle')\n                    .data(data.nodes)\n                    .enter()\n                    .append('circle')\n                    .attr('r', d => {\n                        if (d.type === 'malware') return 15 + Math.min(d.count * 2, 15);\n                        if (d.type === 'agent') return 12 + Math.min(d.count, 10);\n                        return 8 + Math.min(d.count, 8);\n                    })\n                    .attr('fill', d => colorMap[d.type])\n                    .attr('stroke', '#fff')\n                    .attr('stroke-width', 2)\n                    .style('cursor', 'pointer')\n                    .call(d3.drag()\n                        .on('start', dragstarted)\n                        .on('drag', dragged)\n                        .on('end', dragended))\n                    .on('click', (event, d) => showNodeDetails(d, data))\n                    .on('mouseover', function(event, d) {\n                        d3.select(this)\n                            .transition()\n                            .duration(200)\n                            .attr('stroke-width', 4)\n                            .attr('r', function() {\n                                const currentR = parseFloat(d3.select(this).attr('r'));\n                                return currentR * 1.3;\n                            });\n                    })\n                    .on('mouseout', function(event, d) {\n                        d3.select(this)\n                            .transition()\n                            .duration(200)\n                            .attr('stroke-width', 2)\n                            .attr('r', function() {\n                                if (d.type === 'malware') return 15 + Math.min(d.count * 2, 15);\n                                if (d.type === 'agent') return 12 + Math.min(d.count, 10);\n                                return 8 + Math.min(d.count, 8);\n                            });\n                    });\n                \n                // Add labels\n                const label = g.append('g')\n                    .selectAll('text')\n                    .data(data.nodes)\n                    .enter()\n                    .append('text')\n                    .text(d => d.label.length > 20 ? d.label.substring(0, 20) + '...' : d.label)\n                    .attr('font-size', d => d.type === 'malware' ? '12px' : '10px')\n                    .attr('fill', '#e0e0e0')\n                    .attr('text-anchor', 'middle')\n                    .attr('dy', d => {\n                        if (d.type === 'malware') return 35;\n                        if (d.type === 'agent') return 25;\n                        return 20;\n                    })\n                    .style('pointer-events', 'none')\n                    .style('font-weight', d => d.type === 'malware' ? 'bold' : 'normal');\n                \n                // Update positions on simulation tick\n                graphSimulation.on('tick', () => {\n                    link\n                        .attr('x1', d => d.source.x)\n                        .attr('y1', d => d.source.y)\n                        .attr('x2', d => d.target.x)\n                        .attr('y2', d => d.target.y);\n                    \n                    node\n                        .attr('cx', d => d.x)\n                        .attr('cy', d => d.y);\n                    \n                    label\n                        .attr('x', d => d.x)\n                        .attr('y', d => d.y);\n                });\n                \n                // Drag functions\n                function dragstarted(event, d) {\n                    if (!event.active) graphSimulation.alphaTarget(0.3).restart();\n                    d.fx = d.x;\n                    d.fy = d.y;\n                }\n                \n                function dragged(event, d) {\n                    d.fx = event.x;\n                    d.fy = event.y;\n                }\n                \n                function dragended(event, d) {\n                    if (!event.active) graphSimulation.alphaTarget(0);\n                    d.fx = null;\n                    d.fy = null;\n                }\n                \n                console.log(`Correlation graph loaded: ${data.nodes.length} nodes, ${data.links.length} links`);\n                \n            } catch (error) {\n                console.error('Failed to load correlation graph:', error);\n            }\n        }\n        \n        function showNodeDetails(node, graphData) {\n            const detailsPanel = document.getElementById('nodeDetails');\n            const detailsTitle = document.getElementById('detailsTitle');\n            const detailsContent = document.getElementById('detailsContent');\n            \n            detailsTitle.textContent = node.label;\n            \n            let html = `<p><strong>Type:</strong> ${node.type.toUpperCase()}</p>`;\n            html += `<p><strong>Occurrences:</strong> ${node.count}</p>`;\n            \n            // Find connections\n            const connections = graphData.links.filter(l => \n                l.source.id === node.id || l.target.id === node.id\n            );\n            \n            if (connections.length > 0) {\n                html += `<p><strong>Connections:</strong> ${connections.length}</p>`;\n                html += '<ul style=\"margin: 10px 0; padding-left: 20px;\">';\n                connections.slice(0, 10).forEach(link => {\n                    const otherNode = link.source.id === node.id ? link.target : link.source;\n                    html += `<li>${link.type.replace(/_/g, ' ')}: ${otherNode.label}</li>`;\n                });\n                if (connections.length > 10) {\n                    html += `<li>...and ${connections.length - 10} more</li>`;\n                }\n                html += '</ul>';\n            }\n            \n            if (node.details && node.details.length > 0) {\n                html += '<p><strong>Associated Files:</strong></p>';\n                html += '<ul style=\"margin: 10px 0; padding-left: 20px; max-height: 150px; overflow-y: auto;\">';\n                node.details.slice(0, 10).forEach(file => {\n                    html += `<li>${file}</li>`;\n                });\n                if (node.details.length > 10) {\n                    html += `<li>...and ${node.details.length - 10} more</li>`;\n                }\n                html += '</ul>';\n            }\n            \n            detailsContent.innerHTML = html;\n            detailsPanel.style.display = 'block';\n        }\n        \n        function resetGraph() {\n            if (graphSimulation) {\n                graphSimulation.alpha(1).restart();\n            }\n        }\n        \n        function centerGraph() {\n            if (graphSvg) {\n                graphSvg.transition().duration(750).call(\n                    d3.zoom().transform,\n                    d3.zoomIdentity\n                );\n            }\n        }\n        \n        function setChartDays(days) {\n            currentChartDays = days;\n            \n            // Update button states\n            document.querySelectorAll('.chart-btn').forEach(btn => {\n                btn.classList.remove('active');\n            });\n            event.target.classList.add('active');\n            \n            loadDailyChart();\n        }\n        \n        function loadData() {\n            loadStats();\n            loadScans();\n            // Heavy components loaded lazily - see switchView()\n        }\n        \n        function loadDataWithoutMap() {\n            loadStats();\n            loadScans();\n        }\n        \n        // Track which analytics have been loaded\n        let analyticsLoaded = false;\n        \n        function loadAnalytics() {\n            console.log('Loading analytics view...');\n            loadDailyChart();\n            loadMalwareSources();\n            loadNoisyAgentsChart();\n            loadSignatureClassChart();\n            loadPackerClassChart();\n            loadConfidenceHistChart();\n            loadEntropyBoxChart();\n            loadEmergingThreats();\n            loadCorrelationGraph();\n            loadGeoMap();\n            \n            analyticsLoaded = true;\n        }\n        \n        // Initial load - only dashboard essentials\n        loadData();\n        \n        // Auto-scroll functionality with visual indicators\n        const scrollIndicatorUp = document.createElement('div');\n        scrollIndicatorUp.className = 'scroll-indicator scroll-up';\n        scrollIndicatorUp.innerHTML = '<i class=\"fas fa-chevron-up\"></i>';\n        document.body.appendChild(scrollIndicatorUp);\n        \n        const scrollIndicatorDown = document.createElement('div');\n        scrollIndicatorDown.className = 'scroll-indicator scroll-down';\n        scrollIndicatorDown.innerHTML = '<i class=\"fas fa-chevron-down\"></i>';\n        document.body.appendChild(scrollIndicatorDown);\n        \n        let pageScrollInterval = null;\n        const scrollSpeed = 3;\n        const triggerZone = 80; // pixels from top/bottom\n        \n        function handleAutoScroll(event) {\n            // Don't auto-scroll if page is hidden\n            if (document.hidden) return;\n            \n            const mouseY = event.clientY;\n            const windowHeight = window.innerHeight;\n            \n            // Check if near top\n            if (mouseY < triggerZone) {\n                scrollIndicatorUp.classList.add('visible');\n                scrollIndicatorDown.classList.remove('visible');\n                \n                if (!pageScrollInterval) {\n                    pageScrollInterval = setInterval(() => {\n                        if (document.hidden) {\n                            stopAutoScroll();\n                            return;\n                        }\n                        window.scrollBy({\n                            top: -scrollSpeed,\n                            behavior: 'auto'\n                        });\n                    }, 16); // ~60fps\n                }\n            }\n            // Check if near bottom\n            else if (mouseY > windowHeight - triggerZone) {\n                scrollIndicatorDown.classList.add('visible');\n                scrollIndicatorUp.classList.remove('visible');\n                \n                if (!pageScrollInterval) {\n                    pageScrollInterval = setInterval(() => {\n                        if (document.hidden) {\n                            stopAutoScroll();\n                            return;\n                        }\n                        window.scrollBy({\n                            top: scrollSpeed,\n                            behavior: 'auto'\n                        });\n                    }, 16);\n                }\n            }\n            // In neutral zone\n            else {\n                scrollIndicatorUp.classList.remove('visible');\n                scrollIndicatorDown.classList.remove('visible');\n                \n                if (pageScrollInterval) {\n                    clearInterval(pageScrollInterval);\n                    pageScrollInterval = null;\n                }\n            }\n        }\n        \n        function stopAutoScroll() {\n            scrollIndicatorUp.classList.remove('visible');\n            scrollIndicatorDown.classList.remove('visible');\n            \n            if (pageScrollInterval) {\n                clearInterval(pageScrollInterval);\n                pageScrollInterval = null;\n            }\n        }\n        \n        // Attach event listeners\n        document.addEventListener('mousemove', handleAutoScroll);\n        document.addEventListener('mouseleave', stopAutoScroll);\n        \n        // Stop scrolling when reaching top or bottom\n        let lastScrollTop = 0;\n        window.addEventListener('scroll', () => {\n            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n            const scrollHeight = document.documentElement.scrollHeight;\n            const clientHeight = document.documentElement.clientHeight;\n            \n            // At top\n            if (scrollTop === 0 && lastScrollTop > 0) {\n                stopAutoScroll();\n            }\n            // At bottom\n            if (scrollTop + clientHeight >= scrollHeight - 5) {\n                stopAutoScroll();\n            }\n            \n            lastScrollTop = scrollTop;\n        });\n        \n        // Set up Server-Sent Events for real-time updates\n        const eventSource = new EventSource('/api/events');\n        let updateDebounceTimer = null;\n        let pollingInterval = null;\n        let pendingUpdates = false;\n        \n        eventSource.onmessage = function(event) {\n            const data = JSON.parse(event.data);\n            \n            if (data.type === 'connected') {\n                console.log('Connected to server for real-time updates');\n            } else if (data.type === 'new-scan') {\n                console.log('New scan received:', data.scan.detected_filename);\n                \n                // Show notification toast\n                showThreatNotification(data.scan);\n                \n                // Add to threat ticker\n                addToThreatTicker(data.scan);\n                \n                // Debounce: batch multiple rapid scans into single update\n                pendingUpdates = true;\n                clearTimeout(updateDebounceTimer);\n                updateDebounceTimer = setTimeout(() => {\n                    if (pendingUpdates) {\n                        // Only reload lightweight data (stats + scan list)\n                        loadStats();\n                        loadScans();\n                        \n                        // If analytics view is open, refresh analytics too\n                        if (currentView === 'analytics' && analyticsLoaded) {\n                            loadAnalytics();\n                        }\n                        \n                        pendingUpdates = false;\n                        \n                        // Throttle map updates to once per 15 seconds\n                        if (!window.lastMapUpdate || Date.now() - window.lastMapUpdate > 15000) {\n                            loadGeoMap();\n                            window.lastMapUpdate = Date.now();\n                        }\n                    }\n                }, 1000); // Wait 1 second after last scan\n            }\n        };\n        \n        eventSource.onerror = function(error) {\n            console.error('SSE Error:', error);\n            // Fallback: reload data every 30 seconds if SSE connection fails (only once!)\n            if (eventSource.readyState === EventSource.CLOSED && !pollingInterval) {\n                console.log('SSE connection closed, falling back to polling...');\n                pollingInterval = setInterval(() => {\n                    loadStats();\n                    loadScans();\n                }, 30000);\n            }\n        };\n        \n        // Manual refresh button functionality\n        window.manualRefresh = function() {\n            loadData();\n        };\n    </script>\n    \n    <!-- Theme Toggle Script -->\n    <script>\n        // Theme Toggle Functionality\n        window.toggleTheme = function() {\n            const html = document.documentElement;\n            const currentTheme = html.getAttribute('data-theme');\n            const newTheme = currentTheme === 'light' ? '' : 'light';\n            \n            if (newTheme) {\n                html.setAttribute('data-theme', newTheme);\n            } else {\n                html.removeAttribute('data-theme');\n            }\n            localStorage.setItem('theme', newTheme || 'dark');\n            \n            // Update button icon and text\n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            if (newTheme === 'light') {\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n            } else {\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n            }\n        };\n        \n        // Load saved theme on page load\n        (function() {\n            const savedTheme = localStorage.getItem('theme') || 'dark';\n            if (savedTheme === 'light') {\n                document.documentElement.setAttribute('data-theme', 'light');\n            }\n            \n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            if (savedTheme === 'light') {\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n            } else {\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n            }\n        })();\n    </script>\n</body>\n</html>","range":{"startLineNumber":1,"startColumn":1,"endLineNumber":2576,"endColumn":1}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/styles.css","external":"file:///home/trang/localnsv/mAIware-server/public/styles.css","path":"/home/trang/localnsv/mAIware-server/public/styles.css","scheme":"file"},"requestId":"request_1af10ca8-d17d-442e-8756-8e3e11e7af34","epoch":7,"edits":[{"text":":root {\n    --bg-primary: #000000;\n    --bg-secondary: #0a0a0a;\n    --bg-card: #0f0f0f;\n    --bg-hover: #151515;\n    --text-primary: #e8f0e8;\n    --text-secondary: #9ca3af;\n    --accent-green: #39ff14;\n    --accent-green-dim: #2ed60f;\n    --accent-yellow: #ffd700;\n    --accent-red: #ff3b3b;\n    --accent-red-dim: #cc2f2f;\n    --border-color: #1a1a1a;\n    --shadow-color: rgba(0, 0, 0, 0.5);\n    --success-glow: rgba(57, 255, 20, 0.3);\n    --danger-glow: rgba(255, 59, 59, 0.3);\n    --warning-glow: rgba(255, 215, 0, 0.3);\n}\n\n[data-theme=\"light\"] {\n    --bg-primary: #f0f4f0;\n    --bg-secondary: #ffffff;\n    --bg-card: #fafafa;\n    --bg-hover: #e8f5e8;\n    --text-primary: #1a1f2e;\n    --text-secondary: #4a5568;\n    --accent-green: #2ed60f;\n    --accent-green-dim: #27b00c;\n    --accent-yellow: #cc9a00;\n    --accent-red: #dc2626;\n    --accent-red-dim: #b91c1c;\n    --border-color: #d1d5db;\n    --shadow-color: rgba(0, 0, 0, 0.1);\n    --success-glow: rgba(46, 214, 15, 0.2);\n    --danger-glow: rgba(220, 38, 38, 0.2);\n    --warning-glow: rgba(204, 154, 0, 0.2);\n    /* Chart theming overrides for light mode */\n    --chart-text-color: #374151; /* slate-700 for better contrast */\n    --chart-grid-color: rgba(0, 0, 0, 0.08);\n}\n\n* { \n    margin: 0; \n    padding: 0; \n    box-sizing: border-box; \n}\n\nbody {\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    background: var(--bg-primary);\n    color: var(--text-primary);\n    min-height: 100vh;\n    margin: 0;\n    overflow-x: hidden;\n    position: relative;\n}\n\nbody::before {\n    content: '';\n    position: fixed;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: \n        radial-gradient(circle at 20% 50%, rgba(57, 255, 20, 0.08) 0%, transparent 50%),\n        radial-gradient(circle at 80% 80%, rgba(57, 255, 20, 0.06) 0%, transparent 50%),\n        radial-gradient(circle at 40% 20%, rgba(57, 255, 20, 0.05) 0%, transparent 50%);\n    animation: backgroundGlow 15s ease-in-out infinite;\n    pointer-events: none;\n    z-index: 0;\n}\n\n@keyframes backgroundGlow {\n    0%, 100% { \n        transform: translate(0, 0) scale(1);\n        opacity: 0.4;\n    }\n    33% { \n        transform: translate(10%, 10%) scale(1.1);\n        opacity: 0.6;\n    }\n    66% { \n        transform: translate(-10%, 5%) scale(0.95);\n        opacity: 0.5;\n    }\n}\n\nbody > * {\n    position: relative;\n    z-index: 1;\n}\n\n/* Side Panel Navigation */\n.side-panel {\n    position: fixed;\n    left: 0;\n    top: 0;\n    height: 100vh;\n    width: 70px;\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border-right: 1px solid rgba(57, 255, 20, 0.2);\n    box-shadow: 0 0 30px rgba(57, 255, 20, 0.1);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    z-index: 9999;\n    transition: all 0.3s ease;\n}\n\n.side-panel:hover {\n    background: rgba(15, 15, 15, 0.8);\n    box-shadow: 0 0 40px rgba(57, 255, 20, 0.2);\n}\n\n.panel-icon-strip {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 2rem 0;\n}\n\n.panel-logo-icon {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 50px;\n    height: 50px;\n    color: var(--accent-green);\n    font-size: 2rem;\n    animation: pulse-glow 3s ease-in-out infinite;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.panel-logo-icon:hover {\n    transform: scale(1.1);\n    filter: drop-shadow(0 0 20px var(--success-glow));\n}\n\n@keyframes pulse-glow {\n    0%, 100% { filter: drop-shadow(0 0 5px var(--success-glow)); }\n    50% { filter: drop-shadow(0 0 15px var(--success-glow)) drop-shadow(0 0 25px var(--success-glow)); }\n}\n\n/* Graphs Preview Grid */\n.graphs-preview {\n    position: fixed;\n    left: 70px;\n    top: 50%;\n    transform: translateY(-50%) translateX(-100%);\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-left: none;\n    border-radius: 0 12px 12px 0;\n    padding: 2rem;\n    width: 480px;\n    max-height: 90vh;\n    overflow-y: auto;\n    opacity: 0;\n    visibility: hidden;\n    pointer-events: none;\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease, visibility 0.3s;\n    box-shadow: 5px 0 40px rgba(57, 255, 20, 0.15);\n    z-index: 9998;\n    will-change: transform, opacity;\n}\n\n.graphs-preview::-webkit-scrollbar {\n    width: 6px;\n}\n\n.graphs-preview::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 3px;\n}\n\n.graphs-preview::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 3px;\n}\n\n.graphs-preview.show {\n    opacity: 1;\n    visibility: visible;\n    pointer-events: auto;\n    transform: translateY(-50%) translateX(0);\n}\n\n.preview-header {\n    margin-bottom: 1rem;\n    padding-bottom: 0.8rem;\n    border-bottom: 1px solid var(--border-color);\n}\n\n.preview-header h3 {\n    color: var(--accent-green);\n    font-size: 1.1rem;\n    margin-bottom: 0.3rem;\n}\n\n.preview-header p {\n    color: var(--text-secondary);\n    font-size: 0.85rem;\n}\n\n/* Analytics Miniview - Scaled down live view */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-content {\n    width: 100%;\n    height: 100%;\n    transform-origin: top left;\n    transform: scale(0.25);\n    width: 400%;\n    height: 400%;\n    pointer-events: none;\n    overflow: hidden;\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n.preview-home-nav {\n    margin-top: 1.5rem;\n    padding: 1rem;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 10px;\n    display: flex;\n    align-items: center;\n    gap: 0.8rem;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    opacity: 0;\n    visibility: hidden;\n    transform: translateY(10px);\n}\n\n.preview-home-nav.visible {\n    opacity: 1;\n    visibility: visible;\n    transform: translateY(0);\n}\n\n.preview-home-nav:hover {\n    background: var(--bg-hover);\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.preview-home-nav i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n}\n\n.preview-home-nav span {\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--text-primary);\n}\n\n.preview-label {\n    flex: 1;\n    font-size: 0.95rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    letter-spacing: 0.3px;\n}\n\n/* Analytics Miniview - Screenshot preview */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    padding: 1.5rem;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-preview {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    opacity: 0.7;\n}\n\n.preview-row {\n    display: flex;\n    gap: 1rem;\n    flex: 1;\n}\n\n.preview-box {\n    flex: 1;\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 6px;\n    position: relative;\n    overflow: hidden;\n    padding: 0.5rem;\n}\n\n.preview-box.large {\n    flex: 2;\n}\n\n.preview-box.wide {\n    flex: 1;\n    min-height: 150px;\n}\n\n.box-header {\n    font-size: 0.65rem;\n    color: var(--accent-green);\n    margin-bottom: 0.5rem;\n    opacity: 0.8;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.box-content {\n    height: calc(100% - 1.5rem);\n    position: relative;\n}\n\n.map-visual {\n    background: radial-gradient(circle at center, rgba(57, 255, 20, 0.05), transparent);\n    position: relative;\n}\n\n.map-dot {\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 10px var(--accent-green);\n    animation: map-pulse 2s ease-in-out infinite;\n}\n\n.map-dot:nth-child(2) { animation-delay: 0.5s; }\n.map-dot:nth-child(3) { animation-delay: 1s; }\n\n@keyframes map-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.6; }\n    50% { transform: scale(1.5); opacity: 1; }\n}\n\n.chart-visual {\n    display: flex;\n    align-items: flex-end;\n    justify-content: space-around;\n    height: 100%;\n    padding: 0.5rem;\n    gap: 0.3rem;\n}\n\n.chart-bar {\n    flex: 1;\n    background: linear-gradient(180deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    animation: bar-grow 2s ease-in-out infinite;\n    opacity: 0.7;\n}\n\n.chart-bar:nth-child(2) { animation-delay: 0.2s; }\n.chart-bar:nth-child(3) { animation-delay: 0.4s; }\n.chart-bar:nth-child(4) { animation-delay: 0.6s; }\n\n@keyframes bar-grow {\n    0%, 100% { transform: scaleY(0.8); }\n    50% { transform: scaleY(1); }\n}\n\n.list-visual {\n    display: flex;\n    flex-direction: column;\n    gap: 0.4rem;\n    padding: 0.3rem;\n}\n\n.list-item {\n    height: 0.4rem;\n    background: linear-gradient(90deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    opacity: 0.6;\n    animation: list-fade 3s ease-in-out infinite;\n}\n\n.list-item:nth-child(2) { animation-delay: 0.5s; width: 80%; }\n.list-item:nth-child(3) { animation-delay: 1s; width: 60%; }\n\n@keyframes list-fade {\n    0%, 100% { opacity: 0.4; }\n    50% { opacity: 0.8; }\n}\n\n.network-visual {\n    position: relative;\n    height: 100%;\n}\n\n.network-node {\n    position: absolute;\n    width: 6px;\n    height: 6px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 8px var(--accent-green);\n    animation: node-pulse 3s ease-in-out infinite;\n}\n\n.network-node:nth-child(2) { animation-delay: 0.7s; }\n.network-node:nth-child(3) { animation-delay: 1.4s; }\n\n@keyframes node-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.5; }\n    50% { transform: scale(1.3); opacity: 1; }\n}\n\n.heat-visual {\n    background: \n        radial-gradient(circle at 30% 30%, rgba(57, 255, 20, 0.3), transparent 40%),\n        radial-gradient(circle at 70% 60%, rgba(57, 255, 20, 0.2), transparent 40%),\n        radial-gradient(circle at 50% 80%, rgba(57, 255, 20, 0.25), transparent 40%);\n    animation: heat-shift 4s ease-in-out infinite;\n}\n\n@keyframes heat-shift {\n    0%, 100% { opacity: 0.5; }\n    50% { opacity: 0.8; }\n}\n\n.pie-visual {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n}\n\n.pie-chart {\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    background: conic-gradient(\n        var(--accent-green) 0deg 120deg,\n        var(--accent-yellow) 120deg 240deg,\n        var(--accent-red) 240deg 360deg\n    );\n    box-shadow: 0 0 15px rgba(57, 255, 20, 0.4);\n    animation: pie-spin 10s linear infinite;\n}\n\n@keyframes pie-spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n\n/* Main Content Area */\n.main-content {\n    margin-left: 70px;\n    min-height: 100vh;\n    padding: 2rem;\n    transition: margin-left 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    position: relative;\n}\n\n/* Backdrop overlay for preview panel */\n.preview-backdrop {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    background: rgba(0, 0, 0, 0.4);\n    backdrop-filter: blur(2px);\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    z-index: 9998;\n    pointer-events: none;\n}\n\n.preview-backdrop.show {\n    opacity: 1;\n    visibility: visible;\n}\n\n/* View Containers */\n.view-container {\n    display: none;\n    animation: fadeIn 0.4s ease-in-out;\n}\n\n.view-container.active {\n    display: block;\n}\n\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n        transform: translateY(10px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n/* Dashboard Header */\n.dashboard-header {\n    text-align: center;\n    margin-bottom: 2.5rem;\n}\n\n.header-content h1 {\n    font-size: 2.5rem;\n    margin-bottom: 0.5rem;\n    color: var(--accent-green);\n    font-weight: 700;\n    letter-spacing: 2px;\n}\n\n.header-content .subtitle {\n    font-size: 1.2rem;\n    color: var(--text-secondary);\n    font-weight: 500;\n}\n\n.pulse-icon {\n    display: inline-block;\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n@keyframes pulse-scale {\n    0%, 100% {\n        transform: scale(1);\n        filter: drop-shadow(0 0 5px var(--success-glow));\n    }\n    50% {\n        transform: scale(1.05);\n        filter: drop-shadow(0 0 15px var(--success-glow));\n    }\n}\n\n/* Animations */\n.animate-slide-in {\n    animation: slideIn 0.6s ease-out;\n}\n\n@keyframes slideIn {\n    from {\n        opacity: 0;\n        transform: translateX(-30px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n.animate-fade-in {\n    animation: fadeInUp 0.6s ease-out;\n}\n\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.container {\n    max-width: 1400px;\n    margin: 0 auto;\n}\n\n/* Theme Toggle Button */\n.theme-toggle {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    background: rgba(15, 15, 15, 0.85);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50px;\n    padding: 10px 20px;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    font-size: 1rem;\n    color: var(--text-primary);\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px rgba(57, 255, 20, 0.2);\n    font-weight: 600;\n}\n\n.theme-toggle:hover {\n    background: rgba(15, 15, 15, 0.8);\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.theme-toggle .icon {\n    font-size: 1.2rem;\n}\n\n/* Auto-scroll indicators */\n.scroll-indicator {\n    position: fixed;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 60px;\n    height: 60px;\n    background: rgba(57, 255, 20, 0.15);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 2px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    opacity: 0;\n    pointer-events: none;\n    transition: opacity 0.3s ease;\n    z-index: 10001;\n}\n\n.scroll-indicator.visible {\n    opacity: 1;\n    animation: scroll-pulse 1.5s ease-in-out infinite;\n}\n\n.scroll-indicator.scroll-up {\n    top: 20px;\n}\n\n.scroll-indicator.scroll-down {\n    bottom: 20px;\n}\n\n.scroll-indicator i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    animation: scroll-bounce 1s ease-in-out infinite;\n}\n\n.scroll-up i {\n    animation-name: scroll-bounce-up;\n}\n\n.scroll-down i {\n    animation-name: scroll-bounce-down;\n}\n\n@keyframes scroll-pulse {\n    0%, 100% {\n        box-shadow: 0 0 10px rgba(57, 255, 20, 0.3);\n    }\n    50% {\n        box-shadow: 0 0 25px rgba(57, 255, 20, 0.6);\n    }\n}\n\n@keyframes scroll-bounce-up {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(-5px);\n    }\n}\n\n@keyframes scroll-bounce-down {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(5px);\n    }\n}\n\n/* Threat Ticker */\n.threat-ticker-container {\n    background: var(--bg-secondary);\n    border: 2px solid var(--accent-green);\n    border-radius: 8px;\n    padding: 12px;\n    margin-bottom: 2rem;\n    display: flex;\n    align-items: center;\n    gap: 16px;\n    overflow: hidden;\n    box-shadow: 0 2px 8px var(--success-glow);\n}\n\n.ticker-label {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 8px 16px;\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    border-radius: 6px;\n    font-weight: 700;\n    font-size: 0.75rem;\n    color: #fff;\n    white-space: nowrap;\n    box-shadow: 0 2px 8px rgba(255, 71, 87, 0.4);\n}\n\n.ticker-label i {\n    animation: pulse-broadcast 2s infinite;\n}\n\n@keyframes pulse-broadcast {\n    0%, 100% { opacity: 1; transform: scale(1); }\n    50% { opacity: 0.6; transform: scale(0.9); }\n}\n\n.threat-ticker {\n    flex: 1;\n    overflow: hidden;\n    position: relative;\n}\n\n.ticker-content {\n    display: flex;\n    gap: 40px;\n    white-space: nowrap;\n    animation: scroll-ticker 30s linear infinite;\n}\n\n.ticker-content:hover {\n    animation-play-state: paused;\n}\n\n@keyframes scroll-ticker {\n    0% { transform: translateX(0); }\n    100% { transform: translateX(-50%); }\n}\n\n.ticker-item {\n    color: #e0e0e0;\n    font-size: 0.9rem;\n    display: inline-flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.ticker-item i {\n    font-size: 0.5rem;\n    animation: blink 1.5s infinite;\n}\n\n@keyframes blink {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.3; }\n}\n\n/* Notification System */\n.notification-container {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    max-width: 400px;\n}\n\n.threat-notification {\n    background: rgba(30, 30, 30, 0.98);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 8px;\n    padding: 16px;\n    display: flex;\n    gap: 12px;\n    align-items: flex-start;\n    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);\n    transform: translateX(450px);\n    opacity: 0;\n    transition: all 0.3s ease-out;\n}\n\n.threat-notification.show {\n    transform: translateX(0);\n    opacity: 1;\n}\n\n.notification-icon {\n    font-size: 1.5rem;\n    flex-shrink: 0;\n}\n\n.notification-content {\n    flex: 1;\n}\n\n.notification-title {\n    font-size: 0.95rem;\n    color: #e0e0e0;\n    margin-bottom: 4px;\n}\n\n.notification-title strong {\n    text-transform: uppercase;\n    font-weight: 800;\n}\n\n.notification-details {\n    font-size: 0.85rem;\n    color: #b0b0b0;\n    margin-bottom: 6px;\n}\n\n.notification-meta {\n    font-size: 0.75rem;\n    color: #888;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.notification-close {\n    cursor: pointer;\n    color: #666;\n    transition: color 0.2s;\n    font-size: 0.9rem;\n}\n\n.notification-close:hover {\n    color: #e0e0e0;\n}\n\n/* Stat Card Pulse Animation */\n.stat-pulse {\n    animation: stat-pulse-animation 0.6s ease-out;\n}\n\n@keyframes stat-pulse-animation {\n    0% { transform: scale(1); }\n    50% { transform: scale(1.05); box-shadow: 0 8px 24px rgba(90, 156, 248, 0.4); }\n    100% { transform: scale(1); }\n}\n\nh1 {\n    font-size: 2.5rem;\n    color: #5a9cf8;\n    margin-bottom: 0.5rem;\n}\n\n.subtitle {\n    color: #888;\n    font-size: 1.1rem;\n}\n\n.stats-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1.5rem;\n    margin-bottom: 3rem;\n}\n\n.stat-card {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 1.5rem;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.8rem;\n    position: relative;\n    overflow: hidden;\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.stat-card::before {\n    content: '';\n    position: absolute;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: radial-gradient(circle, var(--accent-green) 0%, transparent 70%);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover::before {\n    opacity: 0.05;\n}\n\n.stat-card:hover {\n    transform: translateY(-5px) scale(1.02);\n    border-color: var(--accent-green);\n    box-shadow: 0 10px 30px var(--success-glow);\n}\n\n.stat-card i {\n    font-size: 2.5rem;\n    opacity: 0.8;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover i {\n    transform: scale(1.1) rotateY(180deg);\n    opacity: 1;\n}\n\n.stat-number {\n    font-size: 2.5rem;\n    font-weight: 700;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover .stat-number {\n    transform: scale(1.1);\n    text-shadow: 0 0 20px currentColor;\n}\n\n.stat-label {\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n    font-weight: 600;\n}\n\n.stat-glow {\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    height: 3px;\n    background: linear-gradient(90deg, transparent, var(--accent-green), transparent);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover .stat-glow {\n    opacity: 1;\n    animation: glowSlide 2s ease-in-out infinite;\n}\n\n@keyframes glowSlide {\n    0%, 100% {\n        transform: translateX(-100%);\n    }\n    50% {\n        transform: translateX(100%);\n    }\n}\n\n.stat-card.malware {\n    border-color: rgba(255, 59, 59, 0.3);\n}\n\n.stat-card.malware i,\n.stat-card.malware .stat-number {\n    color: var(--accent-red);\n}\n\n.stat-card.malware:hover {\n    border-color: var(--accent-red);\n    box-shadow: 0 10px 30px var(--danger-glow);\n}\n\n.stat-card.suspicious {\n    border-color: rgba(255, 215, 0, 0.3);\n}\n\n.stat-card.suspicious i,\n.stat-card.suspicious .stat-number {\n    color: var(--accent-yellow);\n}\n\n.stat-card.suspicious:hover {\n    border-color: var(--accent-yellow);\n    box-shadow: 0 10px 30px var(--warning-glow);\n}\n\n.stat-card.benign i,\n.stat-card.benign .stat-number,\n.stat-card.info i,\n.stat-card.info .stat-number {\n    color: var(--accent-green);\n}\n\n/* Analytics View */\n.analytics-header {\n    display: flex;\n    align-items: center;\n    gap: 2rem;\n    margin-bottom: 2.5rem;\n}\n\n.back-btn {\n    background: var(--bg-card);\n    border: 2px solid var(--accent-green);\n    color: var(--accent-green);\n    padding: 0.8rem 1.5rem;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 600;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    transition: all 0.3s ease;\n}\n\n.back-btn:hover {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    transform: translateX(-5px);\n    box-shadow: 0 5px 20px var(--success-glow);\n}\n\n.analytics-header h1 {\n    font-size: 2rem;\n    color: var(--accent-green);\n    font-weight: 700;\n}\n\n.analytics-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));\n    gap: 2rem;\n    max-height: calc(100vh - 200px);\n    overflow-y: auto;\n    padding-right: 1rem;\n    grid-auto-flow: dense;\n}\n\n/* Panel size classes for flexible tiling */\n.analytics-panel.panel-small {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-medium {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-large {\n    grid-column: span 2;\n}\n\n@media (max-width: 1400px) {\n    .analytics-grid {\n        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));\n    }\n    \n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n}\n\n.analytics-grid::-webkit-scrollbar {\n    width: 8px;\n}\n\n.analytics-grid::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb:hover {\n    background: var(--accent-green-dim);\n}\n\n.analytics-panel {\n    animation: slideInPanel 0.5s ease-out;\n    animation-fill-mode: backwards;\n}\n\n.analytics-panel:nth-child(1) { animation-delay: 0.05s; }\n.analytics-panel:nth-child(2) { animation-delay: 0.1s; }\n.analytics-panel:nth-child(3) { animation-delay: 0.15s; }\n.analytics-panel:nth-child(4) { animation-delay: 0.2s; }\n.analytics-panel:nth-child(5) { animation-delay: 0.25s; }\n.analytics-panel:nth-child(6) { animation-delay: 0.3s; }\n\n@keyframes slideInPanel {\n    from {\n        opacity: 0;\n        transform: translateY(30px) scale(0.95);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n    }\n}\n\n/* Advanced Analytics Grid for Mini Charts */\n.advanced-analytics-grid {\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 12px;\n    padding: 1.5rem;\n}\n\n.mini-charts-grid {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 1.5rem;\n    margin-top: 1rem;\n}\n\n.mini-chart-container {\n    background: rgba(10, 10, 10, 0.6);\n    border: 1px solid rgba(57, 255, 20, 0.15);\n    border-radius: 8px;\n    padding: 1rem;\n}\n\n.mini-chart-container h3 {\n    color: var(--accent-green);\n    font-size: 0.95rem;\n    margin: 0 0 0.75rem 0;\n    font-weight: 600;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.mini-chart-container h3 i {\n    font-size: 0.9rem;\n}\n\n@media (max-width: 1200px) {\n    .mini-charts-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n/* Emerging Threat Intelligence Panel */\n.eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.1) 0%, rgba(255, 165, 2, 0.1) 100%);\n    border: 2px solid rgba(255, 71, 87, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(255, 71, 87, 0.2);\n}\n\n.eti-header {\n    margin-bottom: 24px;\n}\n\n.eti-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #ff6b6b;\n    text-shadow: 0 2px 4px rgba(255, 71, 87, 0.3);\n}\n\n.eti-header h2 i {\n    color: #ff4757;\n    margin-right: 10px;\n    animation: pulse 2s infinite;\n}\n\n@keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.6; }\n}\n\n.eti-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 8px 0 16px 0;\n}\n\n.eti-summary {\n    display: flex;\n    gap: 12px;\n    flex-wrap: wrap;\n}\n\n.eti-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 6px 14px;\n    border-radius: 20px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.eti-badge.recent {\n    background: rgba(255, 71, 87, 0.2);\n    border-color: rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.eti-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n    gap: 20px;\n}\n\n.eti-panel {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 18px;\n    transition: transform 0.3s, box-shadow 0.3s;\n}\n\n.eti-panel:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);\n}\n\n.eti-panel h3 {\n    margin: 0 0 6px 0;\n    font-size: 1.1rem;\n    color: #e0e0e0;\n}\n\n.eti-panel h3 i {\n    color: #ffa502;\n    margin-right: 8px;\n}\n\n.eti-subtitle-small {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 14px;\n}\n\n.eti-list {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n}\n\n.eti-item {\n    display: flex;\n    gap: 12px;\n    background: rgba(255, 255, 255, 0.03);\n    border: 1px solid rgba(255, 255, 255, 0.08);\n    border-radius: 8px;\n    padding: 12px;\n    transition: all 0.3s;\n}\n\n.eti-item:hover {\n    background: rgba(255, 255, 255, 0.06);\n    border-color: rgba(255, 165, 2, 0.4);\n    transform: translateX(4px);\n}\n\n.eti-rank {\n    flex-shrink: 0;\n    width: 32px;\n    height: 32px;\n    background: linear-gradient(135deg, #ff6b6b, #ffa502);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: bold;\n    font-size: 1rem;\n    color: #fff;\n    box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);\n}\n\n.eti-item[data-rank=\"1\"] .eti-rank {\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    transform: scale(1.1);\n}\n\n.eti-content {\n    flex: 1;\n    min-width: 0;\n}\n\n.eti-name {\n    font-weight: 600;\n    color: #e0e0e0;\n    font-size: 0.95rem;\n    margin-bottom: 4px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-meta {\n    display: flex;\n    gap: 8px;\n    flex-wrap: wrap;\n    align-items: center;\n}\n\n.eti-count {\n    color: #888;\n    font-size: 0.8rem;\n}\n\n.eti-recent-badge {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-agent-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-details {\n    margin-top: 6px;\n    color: #999;\n    font-size: 0.75rem;\n    font-style: italic;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-empty {\n    text-align: center;\n    color: #666;\n    padding: 20px;\n    font-style: italic;\n}\n\n/* Threat Modeler */\n.modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.1) 0%, rgba(38, 222, 129, 0.1) 100%);\n    border: 2px solid rgba(90, 156, 248, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(90, 156, 248, 0.2);\n}\n\n.modeler-header {\n    margin-bottom: 24px;\n}\n\n.modeler-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #5a9cf8;\n}\n\n.modeler-header h2 i {\n    color: #26de81;\n    margin-right: 10px;\n}\n\n.modeler-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 0;\n}\n\n.modeler-grid {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 24px;\n}\n\n@media (max-width: 1024px) {\n    .modeler-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n.modeler-builder,\n.modeler-results {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 20px;\n}\n\n.modeler-builder h3,\n.modeler-results h3 {\n    margin: 0 0 20px 0;\n    font-size: 1.2rem;\n    color: #e0e0e0;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n    padding-bottom: 10px;\n}\n\n.modeler-builder h3 i {\n    color: #26de81;\n    margin-right: 8px;\n}\n\n.modeler-results h3 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.modeler-field {\n    margin-bottom: 20px;\n}\n\n.modeler-field label {\n    display: block;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n    margin-bottom: 6px;\n    font-weight: 600;\n}\n\n.modeler-select {\n    width: 100%;\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.2);\n    border-radius: 6px;\n    color: #e0e0e0;\n    padding: 10px;\n    font-size: 0.9rem;\n    font-family: inherit;\n    cursor: pointer;\n    transition: all 0.3s;\n}\n\n.modeler-select:focus {\n    outline: none;\n    border-color: #5a9cf8;\n    background: rgba(90, 156, 248, 0.1);\n}\n\n.modeler-select option {\n    background: #1a1a2e;\n    color: #e0e0e0;\n    padding: 8px;\n}\n\n.modeler-hint {\n    display: block;\n    color: #666;\n    font-size: 0.75rem;\n    margin-top: 4px;\n    font-style: italic;\n}\n\n.modeler-analyze-btn {\n    width: 100%;\n    background: linear-gradient(135deg, #26de81, #20bf6b);\n    border: none;\n    color: #fff;\n    padding: 14px 24px;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 700;\n    cursor: pointer;\n    transition: all 0.3s;\n    box-shadow: 0 4px 12px rgba(38, 222, 129, 0.3);\n}\n\n.modeler-analyze-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(38, 222, 129, 0.4);\n}\n\n.modeler-analyze-btn i {\n    margin-right: 8px;\n}\n\n.modeler-output {\n    min-height: 400px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.modeler-placeholder {\n    text-align: center;\n    color: #666;\n}\n\n.modeler-placeholder i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n    opacity: 0.5;\n}\n\n.modeler-placeholder p {\n    font-size: 0.95rem;\n}\n\n.modeler-loading {\n    text-align: center;\n    color: #5a9cf8;\n}\n\n.modeler-loading i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.modeler-error {\n    text-align: center;\n    color: #ff4757;\n}\n\n.modeler-error i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.prediction-result {\n    width: 100%;\n}\n\n.prediction-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 24px;\n    padding: 20px;\n    background: rgba(255, 255, 255, 0.05);\n    border-radius: 8px;\n}\n\n.prediction-badge {\n    padding: 12px 24px;\n    border-radius: 8px;\n    font-size: 1.3rem;\n    font-weight: 800;\n    color: #fff;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n\n.prediction-confidence {\n    text-align: right;\n}\n\n.confidence-label {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 4px;\n}\n\n.confidence-value {\n    color: #5a9cf8;\n    font-size: 2rem;\n    font-weight: 800;\n}\n\n.prediction-family {\n    padding: 16px;\n    background: rgba(255, 71, 87, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 6px;\n    margin-bottom: 20px;\n    color: #e0e0e0;\n}\n\n.family-name {\n    color: #ff6b6b;\n    font-weight: 700;\n    font-size: 1.1rem;\n    margin-left: 8px;\n}\n\n.prediction-section {\n    margin-bottom: 20px;\n}\n\n.prediction-section h4 {\n    color: #5a9cf8;\n    font-size: 1rem;\n    margin: 0 0 12px 0;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 6px;\n}\n\n.analysis-item {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    padding: 8px 0;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n}\n\n.analysis-item i {\n    color: #ffa502;\n    width: 20px;\n}\n\n.indicator-group {\n    margin-bottom: 16px;\n}\n\n.indicator-group strong {\n    display: block;\n    color: #e0e0e0;\n    margin-bottom: 8px;\n    font-size: 0.9rem;\n}\n\n.indicator-list {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 8px;\n}\n\n.indicator-tag {\n    padding: 6px 12px;\n    border-radius: 6px;\n    font-size: 0.8rem;\n    font-weight: 600;\n    font-family: 'Courier New', monospace;\n}\n\n.api-tag {\n    background: rgba(255, 165, 2, 0.2);\n    border: 1px solid rgba(255, 165, 2, 0.4);\n    color: #ffa502;\n}\n\n.string-tag {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.prediction-footer {\n    margin-top: 20px;\n    padding: 12px;\n    background: rgba(90, 156, 248, 0.1);\n    border-radius: 6px;\n    color: #5a9cf8;\n    font-size: 0.85rem;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.scans-container {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 2rem;\n    transition: all 0.3s ease;\n}\n\n.scans-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--shadow-color);\n}\n\n.scans-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.scans-header h2 {\n    color: #5a9cf8;\n}\n\n.refresh-btn {\n    background: #5a9cf8;\n    color: white;\n    border: none;\n    padding: 0.75rem 1.5rem;\n    border-radius: 8px;\n    cursor: pointer;\n    font-size: 1rem;\n    transition: background 0.2s;\n}\n\n.refresh-btn:hover {\n    background: #4a8ce8;\n}\n\n.scans-table {\n    width: 100%;\n    border-collapse: collapse;\n}\n\n.scans-table th {\n    text-align: left;\n    padding: 1rem;\n    background: rgba(255, 255, 255, 0.05);\n    color: #5a9cf8;\n    font-weight: 600;\n}\n\n.scans-table td {\n    padding: 1rem;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.scans-table tr:hover {\n    background: rgba(255, 255, 255, 0.03);\n}\n\n.badge {\n    display: inline-block;\n    padding: 0.3rem 0.8rem;\n    border-radius: 6px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.badge.malware { background: #ff4757; color: white; }\n.badge.suspicious { background: #ffa502; color: white; }\n.badge.benign { background: #26de81; color: white; }\n.badge.non-pe { background: #4b5563; color: #fff; }\n\n.hash {\n    font-family: 'Courier New', monospace;\n    font-size: 0.85rem;\n    color: #888;\n}\n\n.empty-state {\n    text-align: center;\n    padding: 3rem;\n    color: #666;\n}\n\n.empty-state i {\n    font-size: 4rem;\n    margin-bottom: 1rem;\n    opacity: 0.3;\n}\n\n/* NEW: Chart Container Styles */\n.chart-container {\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 12px;\n    padding: 2rem;\n    margin-top: 2rem;\n}\n\n.chart-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.chart-header h2 {\n    color: var(--accent-green);\n    margin: 0;\n}\n\n.chart-subtitle {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    margin: 0.5rem 0 0 0;\n    font-weight: normal;\n}\n\n.chart-controls {\n    display: flex;\n    gap: 0.5rem;\n}\n\n.chart-btn {\n    background: rgba(255, 255, 255, 0.05);\n    color: #888;\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    padding: 0.5rem 1rem;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.2s;\n}\n\n.chart-btn:hover {\n    background: rgba(255, 255, 255, 0.1);\n    color: #e0e0e0;\n}\n\n.chart-btn.active {\n    background: #5a9cf8;\n    color: white;\n    border-color: #5a9cf8;\n}\n\n#dailyScansChart {\n    max-height: 400px;\n}\n\n@media (max-width: 1024px) {\n    .analytics-grid {\n        grid-template-columns: 1fr;\n        gap: 1.5rem;\n    }\n    \n    .analytics-panel.panel-small,\n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n    \n    .graphs-preview {\n        width: 400px;\n    }\n}\n\n@media (max-width: 768px) {\n    .main-content {\n        margin-left: 0;\n        padding: 1rem;\n    }\n    \n    .side-panel {\n        width: 50px;\n    }\n    \n    .panel-logo-icon {\n        width: 40px;\n        height: 40px;\n        font-size: 1.5rem;\n    }\n    \n    .graphs-preview {\n        left: 50px;\n        width: calc(100vw - 50px);\n        border-radius: 0;\n    }\n    \n    .dashboard-header h1 {\n        font-size: 1.8rem;\n    }\n    \n    .stats-grid {\n        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n        gap: 1rem;\n    }\n    \n    .chart-header {\n        flex-direction: column;\n        gap: 1rem;\n        align-items: flex-start;\n    }\n    \n    .chart-controls {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .chart-btn {\n        flex: 1;\n    }\n    \n    .map-view-toggle {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .map-btn {\n        flex: 1;\n        font-size: 0.8rem;\n        padding: 0.4rem 0.6rem;\n    }\n    \n    .geo-context-panel {\n        flex-direction: column;\n    }\n    \n    .context-stat {\n        width: 100%;\n    }\n    \n    .map-timeline-control {\n        flex-direction: column;\n        gap: 0.5rem;\n    }\n    \n    .timeline-info {\n        text-align: center;\n    }\n    \n    .analytics-header {\n        flex-direction: column;\n        align-items: flex-start;\n    }\n}\n\n/* Map Container */\n.map-container {\n    background: var(--bg-card);\n    border-radius: 12px;\n    padding: 24px;\n    box-shadow: 0 4px 12px var(--shadow-color);\n    border: 2px solid var(--border-color);\n    transition: all 0.3s ease;\n    min-height: 600px;\n}\n\n.map-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 8px 24px var(--shadow-color), 0 0 20px var(--success-glow);\n}\n\n#worldMap {\n    width: 100%;\n    height: 500px;\n    border-radius: 8px;\n    margin-bottom: 15px;\n    background: var(--bg-secondary);\n    border: 1px solid var(--border-color);\n    z-index: 1;\n    position: relative;\n}\n\n.map-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 20px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.map-header h2 {\n    margin: 0;\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-header h2 i {\n    color: var(--accent-green);\n    margin-right: 8px;\n}\n\n.map-controls {\n    display: flex;\n    gap: 20px;\n    align-items: center;\n    flex-wrap: wrap;\n}\n\n.map-view-toggle {\n    display: flex;\n    gap: 8px;\n    background: var(--bg-secondary);\n    padding: 4px;\n    border-radius: 8px;\n    border: 1px solid var(--border-color);\n}\n\n.map-btn {\n    background: transparent;\n    border: none;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.map-btn:hover {\n    background: var(--bg-hover);\n    color: var(--text-primary);\n}\n\n.map-btn.active {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    box-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-btn i {\n    font-size: 1rem;\n}\n\n.map-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.legend-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n}\n\n.legend-dot {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    box-shadow: 0 0 6px currentColor;\n}\n\n.malware-dot {\n    background-color: var(--accent-red);\n}\n\n.suspicious-dot {\n    background-color: var(--accent-yellow);\n}\n\n.benign-dot {\n    background-color: var(--accent-green);\n}\n\n.geo-context-panel {\n    display: flex;\n    justify-content: space-around;\n    gap: 20px;\n    padding: 15px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-bottom: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.context-stat {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 5px;\n}\n\n.context-label {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.context-value {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.context-value.threat-count {\n    color: var(--accent-red);\n    text-shadow: 0 0 10px var(--danger-glow);\n}\n\n.map-timeline-control {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 12px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-top: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.timeline-btn {\n    background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-green-dim) 100%);\n    color: var(--bg-primary);\n    border: none;\n    padding: 10px 20px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.95rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    box-shadow: 0 4px 12px var(--success-glow);\n}\n\n.timeline-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px var(--success-glow);\n    filter: brightness(1.1);\n}\n\n.timeline-btn i {\n    font-size: 1rem;\n}\n\n.timeline-info {\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-style: italic;\n}\n\n#worldMap {\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n}\n\n/* Leaflet popup customization for theme */\n.leaflet-popup-content-wrapper {\n    background: var(--bg-card) !important;\n    color: var(--text-primary) !important;\n    border: 2px solid var(--accent-green) !important;\n    box-shadow: 0 4px 15px var(--shadow-color) !important;\n    border-radius: 8px !important;\n}\n\n.leaflet-popup-tip {\n    background: var(--bg-card) !important;\n}\n\n.leaflet-popup-content h3 {\n    color: var(--accent-green) !important;\n}\n\n.leaflet-popup-content button {\n    background: var(--accent-green) !important;\n    color: var(--bg-primary) !important;\n    border: none !important;\n    padding: 8px 16px !important;\n    border-radius: 6px !important;\n    cursor: pointer !important;\n    font-weight: 600 !important;\n    transition: all 0.2s ease !important;\n}\n\n.leaflet-popup-content button:hover {\n    transform: translateY(-2px) !important;\n    box-shadow: 0 4px 12px var(--success-glow) !important;\n}\n\n/* Correlation Graph */\n.correlation-container {\n    background: rgba(255, 255, 255, 0.03);\n    border-radius: 12px;\n    padding: 24px;\n    margin-top: 24px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.correlation-header {\n    margin-bottom: 20px;\n}\n\n.correlation-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.5rem;\n    color: #e0e0e0;\n}\n\n.correlation-header h2 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.correlation-subtitle {\n    color: #888;\n    font-size: 0.9rem;\n    margin: 0;\n}\n\n.graph-controls {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 16px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.graph-btn {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.3s;\n}\n\n.graph-btn:hover {\n    background: rgba(90, 156, 248, 0.3);\n    border-color: #5a9cf8;\n}\n\n.graph-btn i {\n    margin-right: 6px;\n}\n\n.graph-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.node-sample {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    border: 2px solid #fff;\n}\n\n.malware-node {\n    background-color: #ff4757;\n}\n\n.agent-node {\n    background-color: #5a9cf8;\n}\n\n.api-node {\n    background-color: #ffa502;\n}\n\n.string-node {\n    background-color: #26de81;\n}\n\n#correlationGraph {\n    width: 100%;\n    min-height: 600px;\n    position: relative;\n    border-radius: 8px;\n    overflow: hidden;\n}\n\n.node-details {\n    position: absolute;\n    right: 24px;\n    top: 120px;\n    background: rgba(30, 30, 30, 0.95);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    border-radius: 8px;\n    padding: 16px;\n    max-width: 300px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    z-index: 1000;\n}\n\n.node-details h3 {\n    margin: 0 0 12px 0;\n    color: #5a9cf8;\n    font-size: 1.1rem;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 8px;\n}\n\n.node-details p {\n    margin: 8px 0;\n    color: #e0e0e0;\n    font-size: 0.9rem;\n}\n\n.node-details ul {\n    color: #b0b0b0;\n    font-size: 0.85rem;\n}\n\n.node-details li {\n    margin: 4px 0;\n}\n\n/* ========================================\n   LIGHT THEME CONTRAST FIXES\n   ======================================== */\n\n/* Fix 1 & 2: Analytics preview backgrounds - lighter for better green contrast */\n[data-theme=\"light\"] .eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.05) 0%, rgba(255, 165, 2, 0.05) 100%);\n    border-color: rgba(255, 71, 87, 0.2);\n}\n\n[data-theme=\"light\"] .modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.05) 0%, rgba(38, 222, 129, 0.05) 100%);\n    border-color: rgba(90, 156, 248, 0.2);\n}\n\n/* Fix 3: Theme toggle button text - darker for contrast */\n[data-theme=\"light\"] .theme-toggle {\n    color: #1a1f2e;\n    background: rgba(255, 255, 255, 0.8);\n    border-color: rgba(46, 214, 15, 0.4);\n}\n\n/* Fix 4: Daily Analysis chart - darker labels and grid (handled in JS via CSS vars) */\n[data-theme=\"light\"] {\n    --chart-text-color: #374151;\n    --chart-grid-color: rgba(0, 0, 0, 0.12);\n}\n\n:root {\n    --chart-text-color: #9ca3af;\n    --chart-grid-color: rgba(255, 255, 255, 0.1);\n}\n\n/* Fix 5: Chart container labels - darker in light theme */\n[data-theme=\"light\"] .chart-header h2,\n[data-theme=\"light\"] .chart-header {\n    color: #1a1f2e;\n}\n\n/* Fix 6: Threat Vector Correlation header - darker */\n[data-theme=\"light\"] .correlation-header h2 {\n    color: #1a1f2e;\n}\n\n[data-theme=\"light\"] .correlation-subtitle {\n    color: #4a5568;\n}\n\n/* Fix 7: ETI subtitle and summary - darker for better contrast */\n[data-theme=\"light\"] .eti-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .eti-summary {\n    color: #374151;\n}\n\n/* Fix 8: Prediction labels in threat modeler - darker */\n[data-theme=\"light\"] .modeler-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .modeler-field label {\n    color: #374151;\n}\n\n[data-theme=\"light\"] .modeler-hint {\n    color: #6b7280;\n}\n\n/* Fix 9: Analytics preview backgrounds - much lighter for green text visibility */\n[data-theme=\"light\"] .preview-box {\n    background: rgba(255, 255, 255, 0.6);\n    border-color: rgba(46, 214, 15, 0.3);\n}\n\n/* Fix 10: ETI item text - lighter for better readability */\n[data-theme=\"light\"] .eti-count {\n    color: #6b7280;\n}\n\n[data-theme=\"light\"] .eti-details {\n    color: #9ca3af;\n}\n\n[data-theme=\"light\"] .eti-name {\n    color: #1f2937;\n}\n\n/* Fix 11: Make ETI details much more visible in light theme */\n[data-theme=\"light\"] .eti-details {\n    color: #5a9cf8;\n    font-weight: 500;\n}\n\n/* Fix 12: Threat ticker text visibility in light theme */\n[data-theme=\"light\"] .ticker-item {\n    color: #374151;\n    font-weight: 500;\n}\n\n/* Back to Top Button */\n.back-to-top {\n    position: fixed;\n    bottom: 30px;\n    right: 30px;\n    width: 50px;\n    height: 50px;\n    background: linear-gradient(135deg, var(--accent-green), var(--accent-green-dim));\n    border: 2px solid var(--accent-green);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    z-index: 9998;\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px var(--success-glow);\n    color: #000;\n    font-size: 1.2rem;\n}\n\n.back-to-top.visible {\n    opacity: 1;\n    visibility: visible;\n}\n\n.back-to-top:hover {\n    transform: translateY(-5px) scale(1.1);\n    box-shadow: 0 6px 30px var(--success-glow);\n}\n\n.back-to-top:active {\n    transform: translateY(-2px) scale(1.05);\n}\n\n[data-theme=\"light\"] .back-to-top {\n    background: linear-gradient(135deg, #2ed60f, #27b00c);\n    color: #fff;\n}\n","range":{"startLineNumber":1,"startColumn":1,"endLineNumber":2534,"endColumn":1}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/dashboard.html","external":"file:///home/trang/localnsv/mAIware-server/public/dashboard.html","path":"/home/trang/localnsv/mAIware-server/public/dashboard.html","scheme":"file"},"requestId":"request_6694fffe-f89c-4106-8293-523387669b6c","epoch":11,"edits":[{"text":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>mAIware Server Dashboard</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n    <link rel=\"stylesheet\" href=\"styles.css?v=3.0\">\n    <!-- Add Chart.js -->\n    <script src=\"https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js\"></script>\n    <!-- Add Leaflet.js for maps -->\n    <link rel=\"stylesheet\" href=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css\" />\n    <script src=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js\"></script>\n    <!-- Add Leaflet Heatmap Plugin -->\n    <script src=\"https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js\"></script>\n    <!-- Add D3.js for force-directed graph -->\n    <script src=\"https://d3js.org/d3.v7.min.js\"></script>\n    <!-- Add html2canvas for screenshots -->\n    <script src=\"https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js\"></script>\n</head>\n<body>\n    <!-- Theme Toggle Button -->\n    <button class=\"theme-toggle\" id=\"themeToggle\" onclick=\"toggleTheme()\">\n        <span class=\"icon\" id=\"themeIcon\">üåô</span>\n        <span id=\"themeText\">Dark</span>\n    </button>\n\n    <!-- Back to Top Button -->\n    <button class=\"back-to-top\" id=\"backToTop\" onclick=\"scrollToTop()\">\n        <i class=\"fas fa-arrow-up\"></i>\n    </button>\n\n    <!-- Preview Backdrop -->\n    <div class=\"preview-backdrop\" id=\"previewBackdrop\"></div>\n\n    <!-- Side Navigation Panel -->\n    <div class=\"side-panel\" id=\"sidePanel\">\n        <!-- Logo Icon (always visible) -->\n        <div class=\"panel-icon-strip\">\n            <div class=\"panel-logo-icon\">\n                <i class=\"fas fa-shield-virus\"></i>\n            </div>\n        </div>\n        \n        <!-- Analytics Preview Panel (slides out on hover) -->\n        <div class=\"graphs-preview\" id=\"graphsPreview\">\n            <div class=\"preview-header\">\n                <h3><i class=\"fas fa-chart-line\"></i> Analytics Preview</h3>\n                <p>Click anywhere to view full analytics</p>\n            </div>\n            \n            <!-- Scaled-down live view of analytics -->\n            <div class=\"analytics-miniview\" id=\"analyticsMiniview\" onclick=\"switchView('analytics')\">\n                <div class=\"miniview-preview\">\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box large\">\n                            <div class=\"box-header\">Global Threat Map</div>\n                            <div class=\"box-content map-visual\">\n                                <div class=\"map-dot\" style=\"top: 30%; left: 40%;\"></div>\n                                <div class=\"map-dot\" style=\"top: 60%; left: 70%;\"></div>\n                                <div class=\"map-dot\" style=\"top: 45%; left: 25%;\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box large\">\n                            <div class=\"box-header\">Attack Timeline</div>\n                            <div class=\"box-content chart-visual\">\n                                <div class=\"chart-bar\" style=\"height: 40%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 70%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 55%;\"></div>\n                                <div class=\"chart-bar\" style=\"height: 85%;\"></div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Top Threats</div>\n                            <div class=\"box-content list-visual\">\n                                <div class=\"list-item\"></div>\n                                <div class=\"list-item\"></div>\n                                <div class=\"list-item\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Correlations</div>\n                            <div class=\"box-content network-visual\">\n                                <div class=\"network-node\" style=\"top: 30%; left: 30%;\"></div>\n                                <div class=\"network-node\" style=\"top: 60%; left: 50%;\"></div>\n                                <div class=\"network-node\" style=\"top: 45%; left: 70%;\"></div>\n                            </div>\n                        </div>\n                        <div class=\"preview-box\">\n                            <div class=\"box-header\">Heatmap</div>\n                            <div class=\"box-content heat-visual\"></div>\n                        </div>\n                    </div>\n                    <div class=\"preview-row\">\n                        <div class=\"preview-box wide\">\n                            <div class=\"box-header\">File Analysis & Distribution</div>\n                            <div class=\"box-content pie-visual\">\n                                <div class=\"pie-chart\"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"miniview-overlay\">\n                    <i class=\"fas fa-expand-alt\"></i>\n                    <span>Click to view analytics</span>\n                </div>\n            </div>                <!-- Home Navigation Button -->\n                <div class=\"preview-home-nav\" id=\"homeNavBtn\" onclick=\"switchView('dashboard')\">\n                    <i class=\"fas fa-home\"></i>\n                    <span>Back to Dashboard</span>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"main-content\" id=\"mainContent\">\n        <!-- DASHBOARD VIEW -->\n        <div class=\"view-container active\" id=\"dashboardView\">\n            <header class=\"dashboard-header\">\n                <div class=\"header-content\">\n                    <h1><i class=\"fas fa-shield-virus pulse-icon\"></i> mAIware Server</h1>\n                    <p class=\"subtitle\">Real-time Malware Analysis Dashboard</p>\n                </div>\n            </header>\n            \n            <!-- Real-time Threat Ticker -->\n            <div class=\"threat-ticker-container animate-slide-in\">\n                <div class=\"ticker-label\">\n                    <i class=\"fas fa-broadcast-tower pulse-icon\"></i>\n                    <span>LIVE THREAT FEED</span>\n                </div>\n                <div class=\"threat-ticker\" id=\"threat-ticker\">\n                    <div class=\"ticker-content\" id=\"ticker-content\">\n                        <span class=\"ticker-item\">System ready - Monitoring for threats...</span>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Notification Toast Container -->\n            <div id=\"notification-container\" class=\"notification-container\"></div>\n            \n            <!-- Stats Grid -->\n            <div class=\"stats-grid animate-fade-in\" id=\"stats-grid\">\n                <div class=\"stat-card info\">\n                    <i class=\"fas fa-laptop\"></i>\n                    <span class=\"stat-number\" id=\"stat-clients\">0</span>\n                    <span class=\"stat-label\">Active Clients</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card info\">\n                    <i class=\"fas fa-chart-line\"></i>\n                    <span class=\"stat-number\" id=\"stat-total\">0</span>\n                    <span class=\"stat-label\">Total Scans</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card malware\">\n                    <i class=\"fas fa-bug\"></i>\n                    <span class=\"stat-number\" id=\"stat-malware\">0</span>\n                    <span class=\"stat-label\">Malware</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card suspicious\">\n                    <i class=\"fas fa-exclamation-triangle\"></i>\n                    <span class=\"stat-number\" id=\"stat-suspicious\">0</span>\n                    <span class=\"stat-label\">Suspicious</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n                <div class=\"stat-card benign\">\n                    <i class=\"fas fa-check-circle\"></i>\n                    <span class=\"stat-number\" id=\"stat-benign\">0</span>\n                    <span class=\"stat-label\">Benign</span>\n                    <div class=\"stat-glow\"></div>\n                </div>\n            </div>\n            \n            <!-- Recent Scans -->\n            <div class=\"scans-container animate-fade-in\">\n                <div class=\"scans-header\">\n                    <h2><i class=\"fas fa-list\"></i> Recent Scans</h2>\n                    <button class=\"refresh-btn\" onclick=\"manualRefresh()\">\n                        <i class=\"fas fa-sync-alt\"></i> Refresh\n                    </button>\n                </div>\n                \n                <table class=\"scans-table\">\n                    <thead>\n                        <tr>\n                            <th>Timestamp</th>\n                            <th>Filename</th>\n                            <th>Classification</th>\n                            <th>Client IP</th>\n                            <th>Hash (SHA256)</th>\n                        </tr>\n                    </thead>\n                    <tbody id=\"scans-tbody\">\n                        <tr>\n                            <td colspan=\"5\" class=\"empty-state\">\n                                <i class=\"fas fa-inbox\"></i>\n                                <p>No scans yet. Waiting for clients...</p>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n\n        <!-- ANALYTICS VIEW -->\n        <div class=\"view-container\" id=\"analyticsView\">\n            <div class=\"analytics-header\">\n                <button class=\"back-btn\" onclick=\"switchView('dashboard')\">\n                    <i class=\"fas fa-arrow-left\"></i> Back to Dashboard\n                </button>\n                <h1><i class=\"fas fa-chart-line\"></i> Analytics & Intelligence</h1>\n            </div>\n            \n            <div class=\"analytics-grid\" id=\"analyticsGrid\">\n                \n                <!-- Daily Analysis Chart -->\n                <div class=\"chart-container analytics-panel panel-large\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-line\"></i> Daily Analysis Trends</h2>\n                        <div class=\"chart-controls\">\n                            <button class=\"chart-btn active\" onclick=\"setChartDays(7)\">7 Days</button>\n                            <button class=\"chart-btn\" onclick=\"setChartDays(14)\">14 Days</button>\n                            <button class=\"chart-btn\" onclick=\"setChartDays(30)\">30 Days</button>\n                        </div>\n                    </div>\n                    <canvas id=\"dailyScansChart\"></canvas>\n                </div>\n                    <canvas id=\"dailyScansChart\"></canvas>\n                </div>\n\n                <!-- Geographic Threat Intelligence Map -->\n                <div class=\"map-container analytics-panel panel-large\">\n                    <div class=\"map-header\">\n                        <h2><i class=\"fas fa-globe-americas\"></i> Global Threat Intelligence Map</h2>\n                        <div class=\"map-controls\">\n                            <div class=\"map-view-toggle\">\n                                <button class=\"map-btn active\" data-view=\"markers\" onclick=\"switchMapView('markers')\">\n                                    <i class=\"fas fa-map-marker-alt\"></i> Markers\n                                </button>\n                                <button class=\"map-btn\" data-view=\"heatmap\" onclick=\"switchMapView('heatmap')\">\n                                    <i class=\"fas fa-fire\"></i> Heatmap\n                                </button>\n                                <button class=\"map-btn\" data-view=\"choropleth\" onclick=\"switchMapView('choropleth')\">\n                                    <i class=\"fas fa-globe\"></i> Choropleth\n                                </button>\n                            </div>\n                            <div class=\"map-legend\">\n                                <span class=\"legend-item\"><span class=\"legend-dot malware-dot\"></span> Malware</span>\n                                <span class=\"legend-item\"><span class=\"legend-dot suspicious-dot\"></span> Suspicious</span>\n                                <span class=\"legend-item\"><span class=\"legend-dot benign-dot\"></span> Benign</span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Geographic Context Panel -->\n                    <div class=\"geo-context-panel\" id=\"geoContext\">\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Active Regions:</span>\n                            <span class=\"context-value\" id=\"activeRegions\">0</span>\n                        </div>\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Hotspot:</span>\n                            <span class=\"context-value\" id=\"topRegion\">None</span>\n                        </div>\n                        <div class=\"context-stat\">\n                            <span class=\"context-label\">Total Threats:</span>\n                            <span class=\"context-value threat-count\" id=\"geoThreatCount\">0</span>\n                        </div>\n                    </div>\n                    \n                    <div id=\"worldMap\" style=\"height: 500px; border-radius: 8px; margin-bottom: 15px;\"></div>\n                    \n                    <!-- Timeline Control -->\n                    <div class=\"map-timeline-control\">\n                        <button class=\"timeline-btn\" onclick=\"replayThreats()\" id=\"replayBtn\">\n                            <i class=\"fas fa-play\"></i> Replay Last 24h\n                        </button>\n                        <div class=\"timeline-info\" id=\"timelineInfo\">\n                            Click replay to see threat propagation over time\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Malware Source Distribution -->\n                <div class=\"chart-container analytics-panel panel-small\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-pie\"></i> Malware Source Distribution</h2>\n                    </div>\n                    <div style=\"max-width: 500px; margin: 0 auto;\">\n                        <canvas id=\"malwareSourceChart\"></canvas>\n                    </div>\n                </div>\n\n                <!-- Graph 2: \"Noisiest\" Agents Over Time -->\n                <div class=\"chart-container analytics-panel panel-large\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-desktop\"></i> \"Noisiest\" Agents Over Time</h2>\n                        <p class=\"chart-subtitle\">Threat detection trends for top 5 high-risk agents</p>\n                    </div>\n                    <div style=\"height: 300px;\">\n                        <canvas id=\"noisyAgentsChart\"></canvas>\n                    </div>\n                </div>\n\n                <!-- Advanced Analytics Grid -->\n                <div class=\"analytics-panel panel-large advanced-analytics-grid\">\n                    <div class=\"chart-header\">\n                        <h2><i class=\"fas fa-chart-area\"></i> Advanced Statistical Analysis</h2>\n                        <p class=\"chart-subtitle\">Deep dive into signature verification, packer usage, AI confidence, and entropy patterns</p>\n                    </div>\n                    \n                    <div class=\"mini-charts-grid\">\n                        <!-- Graph 3: Signature Status vs. Classification -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-certificate\"></i> Signature vs. Classification</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"signatureClassChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 4: Packer Usage vs. Classification -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-box\"></i> Packer vs. Classification</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"packerClassChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 5: Confidence Score Distribution -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-brain\"></i> AI Confidence Distribution</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"confidenceHistChart\"></canvas>\n                            </div>\n                        </div>\n\n                        <!-- Graph 6: File Entropy Distribution -->\n                        <div class=\"mini-chart-container\">\n                            <h3><i class=\"fas fa-chart-bar\"></i> Entropy Distribution</h3>\n                            <div style=\"height: 200px;\">\n                                <canvas id=\"entropyBoxChart\"></canvas>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Threat Vector Correlation Explorer -->\n                <div class=\"correlation-container analytics-panel panel-large\">\n                    <div class=\"correlation-header\">\n                        <h2><i class=\"fas fa-project-diagram\"></i> Threat Vector Correlation Explorer</h2>\n                        <p class=\"correlation-subtitle\">Interactive intelligence map showing relationships between malware families, agents, APIs, and indicators</p>\n                    </div>\n                    <div class=\"graph-controls\">\n                        <button class=\"graph-btn\" onclick=\"resetGraph()\"><i class=\"fas fa-sync\"></i> Reset View</button>\n                        <button class=\"graph-btn\" onclick=\"centerGraph()\"><i class=\"fas fa-compress\"></i> Center</button>\n                        <div class=\"graph-legend\">\n                            <span class=\"legend-item\"><span class=\"node-sample malware-node\"></span> Malware Family</span>\n                            <span class=\"legend-item\"><span class=\"node-sample agent-node\"></span> Agent/System</span>\n                            <span class=\"legend-item\"><span class=\"node-sample api-node\"></span> API Call</span>\n                            <span class=\"legend-item\"><span class=\"node-sample string-node\"></span> Suspicious String</span>\n                        </div>\n                    </div>\n                    <div id=\"correlationGraph\"></div>\n                    <div id=\"nodeDetails\" class=\"node-details\" style=\"display: none;\">\n                        <h3 id=\"detailsTitle\"></h3>\n                        <div id=\"detailsContent\"></div>\n                    </div>\n                </div>\n\n                <!-- Emerging Threat Intelligence Panel -->\n                <div class=\"eti-container analytics-panel panel-large\">\n                    <div class=\"eti-header\">\n                        <h2><i class=\"fas fa-exclamation-triangle\"></i> Emerging Threat Intelligence (ETI)</h2>\n                        <p class=\"eti-subtitle\">Real-time actionable intelligence on active threats and indicators of compromise</p>\n                        <div class=\"eti-summary\">\n                            <span class=\"eti-badge\" id=\"eti-total\">0 Total Threats</span>\n                            <span class=\"eti-badge recent\" id=\"eti-recent\">0 Last 24h</span>\n                        </div>\n                    </div>\n                    \n                    <div class=\"eti-grid\">\n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-virus\"></i> Top Malware Families</h3>\n                            <div class=\"eti-subtitle-small\">Most active malware families detected</div>\n                            <div id=\"eti-malware\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-code\"></i> Top Suspicious APIs</h3>\n                            <div class=\"eti-subtitle-small\">Most frequently called malicious APIs</div>\n                            <div id=\"eti-apis\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-terminal\"></i> Top Malicious Strings</h3>\n                            <div class=\"eti-subtitle-small\">Most common IOC strings and commands</div>\n                            <div id=\"eti-strings\" class=\"eti-list\"></div>\n                        </div>\n                        \n                        <div class=\"eti-panel\">\n                            <h3><i class=\"fas fa-shield-alt\"></i> Top Packers/Obfuscators</h3>\n                            <div class=\"eti-subtitle-small\">Most used evasion techniques</div>\n                            <div id=\"eti-packers\" class=\"eti-list\"></div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Predictive Threat Modeler -->\n                <div class=\"modeler-container analytics-panel panel-large\">\n                    <div class=\"modeler-header\">\n                        <h2><i class=\"fas fa-flask\"></i> Predictive Threat Modeler</h2>\n                        <p class=\"modeler-subtitle\">Build hypothetical malware and predict how mAIware would classify it</p>\n                    </div>\n                    \n                    <div class=\"modeler-grid\">\n                <div class=\"modeler-builder\">\n                    <h3><i class=\"fas fa-cogs\"></i> Threat Configuration</h3>\n                    \n                    <div class=\"modeler-field\">\n                        <label>File Type</label>\n                        <select id=\"model-filetype\" class=\"modeler-select\">\n                            <option>PE32+ (GUI) x86-64</option>\n                            <option>PE32 (Console) Intel 80386</option>\n                            <option>PE32+ DLL x86-64</option>\n                            <option>MSI Installer</option>\n                            <option>PDF Document</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Packer/Obfuscator</label>\n                        <select id=\"model-packer\" class=\"modeler-select\">\n                            <option>None</option>\n                            <option>UPX</option>\n                            <option>VMProtect</option>\n                            <option>Themida</option>\n                            <option>ASPack</option>\n                            <option>Unknown (High Entropy)</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Digital Signature</label>\n                        <select id=\"model-signature\" class=\"modeler-select\">\n                            <option>Verified (Microsoft Corporation)</option>\n                            <option>Verified (Google LLC)</option>\n                            <option>Verified (Unknown Publisher)</option>\n                            <option>Not Signed</option>\n                            <option>Expired Certificate</option>\n                            <option>Self-Signed (Untrusted)</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>API Imports (select multiple)</label>\n                        <select id=\"model-apis\" class=\"modeler-select\" multiple size=\"6\">\n                            <option>CreateRemoteThread</option>\n                            <option>WriteProcessMemory</option>\n                            <option>VirtualAllocEx</option>\n                            <option>SetWindowsHookExW</option>\n                            <option>URLDownloadToFileW</option>\n                            <option>WinExec</option>\n                            <option>RegSetValueExW</option>\n                            <option>CryptEncrypt</option>\n                            <option>Socket</option>\n                            <option>ReadFile</option>\n                        </select>\n                        <small class=\"modeler-hint\">Hold Ctrl/Cmd to select multiple</small>\n                    </div>\n                    \n                    <div class=\"modeler-field\">\n                        <label>Suspicious Strings (select multiple)</label>\n                        <select id=\"model-strings\" class=\"modeler-select\" multiple size=\"6\">\n                            <option>http://bad-c2-server.com/payload.dat</option>\n                            <option>keylog.txt</option>\n                            <option>steal_passwords</option>\n                            <option>powershell -enc</option>\n                            <option>vssadmin.exe delete shadows</option>\n                            <option>HOW_TO_DECRYPT.txt</option>\n                            <option>crack</option>\n                            <option>patch</option>\n                            <option>disable_antivirus</option>\n                        </select>\n                        <small class=\"modeler-hint\">Hold Ctrl/Cmd to select multiple</small>\n                    </div>\n                    \n                    <button class=\"modeler-analyze-btn\" onclick=\"analyzeThreatModel()\">\n                        <i class=\"fas fa-brain\"></i> ANALYZE THREAT\n                    </button>\n                </div>\n                \n                <div class=\"modeler-results\">\n                    <h3><i class=\"fas fa-chart-line\"></i> Prediction Results</h3>\n                    <div id=\"modeler-output\" class=\"modeler-output\">\n                        <div class=\"modeler-placeholder\">\n                            <i class=\"fas fa-arrow-left\"></i>\n                            <p>Configure a threat profile and click ANALYZE to see predictions</p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n            </div>\n        </div>\n    </div>\n    \n    <script>\n        // Helper function to get CSS variable values dynamically for theming\n        function getCSSVar(varName) {\n            return getComputedStyle(document.documentElement).getPropertyValue(varName).trim();\n        }\n\n        // Back to Top Button\n        const backToTopBtn = document.getElementById('backToTop');\n        \n        window.addEventListener('scroll', () => {\n            if (window.pageYOffset > 300) {\n                backToTopBtn.classList.add('visible');\n            } else {\n                backToTopBtn.classList.remove('visible');\n            }\n        });\n\n        function scrollToTop() {\n            window.scrollTo({\n                top: 0,\n                behavior: 'smooth'\n            });\n        }\n\n        // View Switching System\n        function switchView(viewName) {\n            const views = document.querySelectorAll('.view-container');\n            \n            views.forEach(view => {\n                view.classList.remove('active');\n                if (view.id === `${viewName}View`) {\n                    view.classList.add('active');\n                }\n            });\n            \n            currentView = viewName;\n            \n            // Fix map display when switching to analytics view\n            if (viewName === 'analytics') {\n                loadAnalytics(); // Lazy load analytics components\n                setTimeout(() => {\n                    if (worldMap) {\n                        worldMap.invalidateSize();\n                    }\n                    // Capture screenshot for preview after charts has rendered\n                    setTimeout(() => {\n                        createAnalyticsMiniview();\n                    }, 1500);\n                }, 100);\n            }\n            \n            // Close graphs preview when switching views\n            document.getElementById('graphsPreview').classList.remove('show');\n            document.getElementById('previewBackdrop').classList.remove('show');\n        }\n        \n        // Side Panel Hover System\n        const sidePanel = document.getElementById('sidePanel');\n        const graphsPreview = document.getElementById('graphsPreview');\n        const previewBackdrop = document.getElementById('previewBackdrop');\n        const homeNavBtn = document.getElementById('homeNavBtn');\n        let previewTimeout;\n        let previewsRendered = false;\n        let currentView = 'dashboard';\n        \n        // Show preview panel on sidebar hover\n        sidePanel.addEventListener('mouseenter', () => {\n            clearTimeout(previewTimeout);\n            previewTimeout = setTimeout(() => {\n                graphsPreview.classList.add('show');\n                previewBackdrop.classList.add('show');\n                \n                // Show/hide home button based on current view\n                if (currentView === 'analytics') {\n                    homeNavBtn.classList.add('visible');\n                } else {\n                    homeNavBtn.classList.remove('visible');\n                }\n            }, 200);\n        });\n        \n        sidePanel.addEventListener('mouseleave', () => {\n            clearTimeout(previewTimeout);\n            setTimeout(() => {\n                if (!graphsPreview.matches(':hover')) {\n                    graphsPreview.classList.remove('show');\n                    previewBackdrop.classList.remove('show');\n                }\n            }, 100);\n        });\n        \n        // Keep preview open when hovering over it\n        graphsPreview.addEventListener('mouseleave', () => {\n            graphsPreview.classList.remove('show');\n            previewBackdrop.classList.remove('show');\n        });\n        \n        // Close preview when clicking backdrop\n        previewBackdrop.addEventListener('click', () => {\n            graphsPreview.classList.remove('show');\n            previewBackdrop.classList.remove('show');\n        });\n        \n        // Create analytics miniview by taking a screenshot\n        let isCapturingSnapshot = false;\n        let hasInitialSnapshot = false;\n        \n        async function createAnalyticsMiniview() {\n            // Simplified - no actual screenshot, just a visual preview\n            hasInitialSnapshot = true;\n        }\n        \n        // Auto-scroll on hover down in analytics view\n        let scrollInterval;\n        const analyticsGrid = document.getElementById('analyticsGrid');\n        \n        if (analyticsGrid) {\n            analyticsGrid.addEventListener('mousemove', (e) => {\n                const rect = analyticsGrid.getBoundingClientRect();\n                const mouseY = e.clientY - rect.top;\n                const triggerZone = 100; // pixels from bottom\n                \n                if (rect.height - mouseY < triggerZone) {\n                    if (!scrollInterval) {\n                        scrollInterval = setInterval(() => {\n                            analyticsGrid.scrollBy({ top: 2, behavior: 'smooth' });\n                        }, 16);\n                    }\n                } else {\n                    if (scrollInterval) {\n                        clearInterval(scrollInterval);\n                        scrollInterval = null;\n                    }\n                }\n            });\n            \n            analyticsGrid.addEventListener('mouseleave', () => {\n                if (scrollInterval) {\n                    clearInterval(scrollInterval);\n                    scrollInterval = null;\n                }\n            });\n        }\n        \n        // Theme Toggle\n        window.toggleTheme = function() {\n            const html = document.documentElement;\n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            const currentTheme = html.getAttribute('data-theme');\n            \n            if (currentTheme === 'light') {\n                html.setAttribute('data-theme', '');\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n                localStorage.setItem('theme', 'dark');\n            } else {\n                html.setAttribute('data-theme', 'light');\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n                localStorage.setItem('theme', 'light');\n            }\n        };\n        \n        // Load saved theme\n        const savedTheme = localStorage.getItem('theme');\n        if (savedTheme === 'light') {\n            document.documentElement.setAttribute('data-theme', 'light');\n            document.getElementById('themeIcon').textContent = '‚òÄÔ∏è';\n            document.getElementById('themeText').textContent = 'Light';\n        }\n        \n        let dailyChart = null;\n        let currentChartDays = 30;\n        \n        // Notification and Animation System\n        const notificationQueue = [];\n        let isShowingNotification = false;\n        \n        function showThreatNotification(scan) {\n            const container = document.getElementById('notification-container');\n            \n            const classColor = \n                scan.classification === 'Malware' ? '#ff4757' :\n                scan.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n            \n            const icon = \n                scan.classification === 'Malware' ? 'fa-skull-crossbones' :\n                scan.classification === 'Suspicious' ? 'fa-exclamation-triangle' : 'fa-check-circle';\n            \n            const notification = document.createElement('div');\n            notification.className = 'threat-notification';\n            notification.style.borderLeftColor = classColor;\n            notification.innerHTML = `\n                <div class=\"notification-icon\" style=\"color: ${classColor};\">\n                    <i class=\"fas ${icon}\"></i>\n                </div>\n                <div class=\"notification-content\">\n                    <div class=\"notification-title\">\n                        <strong>${scan.classification}</strong> detected\n                    </div>\n                    <div class=\"notification-details\">\n                        ${scan.detected_filename}\n                        ${scan.malware_family ? ` - ${scan.malware_family}` : ''}\n                    </div>\n                    <div class=\"notification-meta\">\n                        <i class=\"fas fa-desktop\"></i> ${scan.systemInfo?.hostname || scan.clientIp || 'Unknown'}\n                    </div>\n                </div>\n                <div class=\"notification-close\" onclick=\"this.parentElement.remove()\">\n                    <i class=\"fas fa-times\"></i>\n                </div>\n            `;\n            \n            container.appendChild(notification);\n            \n            // Animate in\n            setTimeout(() => notification.classList.add('show'), 10);\n            \n            // Auto-remove after 8 seconds\n            setTimeout(() => {\n                notification.classList.remove('show');\n                setTimeout(() => notification.remove(), 300);\n            }, 8000);\n        }\n        \n        function addToThreatTicker(scan) {\n            const ticker = document.getElementById('ticker-content');\n            const timestamp = new Date(scan.serverTimestamp).toLocaleTimeString();\n            \n            const classColor = \n                scan.classification === 'Malware' ? '#ff4757' :\n                scan.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n            \n            const tickerItem = document.createElement('span');\n            tickerItem.className = 'ticker-item';\n            tickerItem.style.color = classColor;\n            tickerItem.innerHTML = `\n                <i class=\"fas fa-circle\"></i>\n                [${timestamp}] ${scan.classification}: ${scan.detected_filename}\n                ${scan.malware_family ? `(${scan.malware_family})` : ''}\n                on ${scan.systemInfo?.hostname || scan.clientIp || 'Unknown'}\n            `;\n            \n            ticker.appendChild(tickerItem);\n            \n            // Keep only last 10 items\n            while (ticker.children.length > 10) {\n                ticker.removeChild(ticker.firstChild);\n            }\n        }\n        \n        function animateStatCard(elementId, newValue) {\n            const element = document.getElementById(elementId);\n            if (!element) return;\n            \n            const currentValue = parseInt(element.textContent) || 0;\n            if (newValue > currentValue) {\n                // Pulse animation\n                element.parentElement.classList.add('stat-pulse');\n                setTimeout(() => element.parentElement.classList.remove('stat-pulse'), 600);\n                \n                // Animate number increment\n                const duration = 500;\n                const steps = 20;\n                const increment = (newValue - currentValue) / steps;\n                let current = currentValue;\n                let step = 0;\n                \n                const interval = setInterval(() => {\n                    step++;\n                    current += increment;\n                    element.textContent = Math.round(current);\n                    \n                    if (step >= steps) {\n                        element.textContent = newValue;\n                        clearInterval(interval);\n                    }\n                }, duration / steps);\n            } else {\n                element.textContent = newValue;\n            }\n        }\n        \n        async function loadStats() {\n            try {\n                const response = await fetch('/api/stats');\n                const stats = await response.json();\n                \n                animateStatCard('stat-clients', stats.activeClients);\n                animateStatCard('stat-total', stats.totalScans);\n                animateStatCard('stat-malware', stats.malwareCount);\n                animateStatCard('stat-suspicious', stats.suspiciousCount);\n                animateStatCard('stat-benign', stats.benignCount);\n            } catch (error) {\n                console.error('Failed to load stats:', error);\n            }\n        }\n        \n        async function loadScans() {\n            try {\n                const response = await fetch('/api/scans?limit=50');\n                const data = await response.json();\n                \n                const tbody = document.getElementById('scans-tbody');\n                \n                if (data.scans.length === 0) {\n                    tbody.innerHTML = `\n                        <tr>\n                            <td colspan=\"5\" class=\"empty-state\">\n                                <i class=\"fas fa-inbox\"></i>\n                                <p>No scans yet. Waiting for clients...</p>\n                            </td>\n                        </tr>\n                    `;\n                    return;\n                }\n                \n                tbody.innerHTML = data.scans.map(scan => {\n                    const timestamp = new Date(scan.serverTimestamp).toLocaleString();\n                    const hash = scan.file_hashes?.sha256 || 'N/A';\n                    const hashShort = hash.length > 16 ? (hash.substring(0, 16) + '...') : hash;\n                    const isNonPe = scan.is_pe === false;\n                    const classification = isNonPe ? 'Non-PE' : (scan.classification || 'Unknown');\n                    const badgeClass = isNonPe ? 'non-pe' : classification.toLowerCase();\n                    const nonPeTag = isNonPe ? '<span class=\"badge non-pe\" title=\"Non-PE file\">Non-PE</span>' : '';\n                    return `\n                        <tr>\n                            <td>${timestamp}</td>\n                            <td>${scan.detected_filename} ${nonPeTag}</td>\n                            <td><span class=\"badge ${badgeClass}\">${classification}</span></td>\n                            <td>${scan.systemInfo?.ip || scan.clientIp || 'Unknown'}</td>\n                            <td class=\"hash\" title=\"${hash}\">${hashShort}</td>\n                        </tr>\n                    `;\n                }).join('');\n                \n            } catch (error) {\n                console.error('Failed to load scans:', error);\n            }\n        }\n        \n        async function loadDailyChart() {\n            try {\n                const response = await fetch(`/api/daily-scans?days=${currentChartDays}`);\n                const data = await response.json();\n                \n                const ctx = document.getElementById('dailyScansChart');\n                \n                // Format dates for display (MM/DD)\n                const labels = data.days.map(day => {\n                    const date = new Date(day.date);\n                    return `${date.getMonth() + 1}/${date.getDate()}`;\n                });\n                \n                // Reuse existing chart if it exists\n                if (dailyChart) {\n                    dailyChart.data.labels = labels;\n                    dailyChart.data.datasets[0].data = data.days.map(d => d.total);\n                    dailyChart.data.datasets[1].data = data.days.map(d => d.malware);\n                    dailyChart.data.datasets[2].data = data.days.map(d => d.suspicious);\n                    dailyChart.data.datasets[3].data = data.days.map(d => d.benign);\n                    dailyChart.update('none'); // Update without animation\n                    return;\n                }\n                \n                dailyChart = new Chart(ctx, {\n                    type: 'line',\n                    data: {\n                        labels: labels,\n                        datasets: [\n                            {\n                                label: 'Total Scans',\n                                data: data.days.map(d => d.total),\n                                borderColor: '#5a9cf8',\n                                backgroundColor: 'rgba(90, 156, 248, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Malware',\n                                data: data.days.map(d => d.malware),\n                                borderColor: '#ff4757',\n                                backgroundColor: 'rgba(255, 71, 87, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Suspicious',\n                                data: data.days.map(d => d.suspicious),\n                                borderColor: '#ffa502',\n                                backgroundColor: 'rgba(255, 165, 2, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            },\n                            {\n                                label: 'Benign',\n                                data: data.days.map(d => d.benign),\n                                borderColor: '#26de81',\n                                backgroundColor: 'rgba(38, 222, 129, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        interaction: {\n                            mode: 'index',\n                            intersect: false,\n                        },\n                        plugins: {\n                            legend: {\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 12 }\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0',\n                                borderColor: 'rgba(255, 255, 255, 0.1)',\n                                borderWidth: 1\n                            }\n                        },\n                        scales: {\n                            x: {\n                                ticks: { \n                                    color: getCSSVar('--chart-text-color') || '#888',\n                                    maxRotation: 45,\n                                    minRotation: 45\n                                },\n                                grid: { \n                                    color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' \n                                }\n                            },\n                            y: {\n                                beginAtZero: true,\n                                ticks: { \n                                    color: getCSSVar('--chart-text-color') || '#888',\n                                    stepSize: 1\n                                },\n                                grid: { \n                                    color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' \n                                }\n                            }\n                        }\n                    }\n                });\n                \n            } catch (error) {\n                console.error('Failed to load daily chart:', error);\n            }\n        }\n        \n        let worldMap = null;\n        let markerLayer = null;\n        let heatmapLayer = null;\n        let choroplethLayer = null;\n        let mapInitialized = false;\n        let lastGeoDataHash = '';\n        let sourceChart = null;\n        let currentMapView = 'markers';\n        let geoDataCache = null;\n        let replayInterval = null;\n        \n        // Country boundaries for choropleth (simplified)\n        const countryCoordinates = {\n            'United States': { center: [37.0902, -95.7129], weight: 0 },\n            'China': { center: [35.8617, 104.1954], weight: 0 },\n            'United Kingdom': { center: [55.3781, -3.4360], weight: 0 },\n            'Germany': { center: [51.1657, 10.4515], weight: 0 },\n            'France': { center: [46.2276, 2.2137], weight: 0 },\n            'Russia': { center: [61.5240, 105.3188], weight: 0 },\n            'Japan': { center: [36.2048, 138.2529], weight: 0 },\n            'India': { center: [20.5937, 78.9629], weight: 0 },\n            'Brazil': { center: [-14.2350, -51.9253], weight: 0 },\n            'Australia': { center: [-25.2744, 133.7751], weight: 0 }\n        };\n        \n        function initializeMap() {\n            if (mapInitialized) return;\n            \n            try {\n                worldMap = L.map('worldMap', {\n                    zoomControl: true,\n                    scrollWheelZoom: true,\n                    preferCanvas: false,\n                    worldCopyJump: true\n                }).setView([20, 0], 2);\n                \n                // Use dark theme tiles\n                L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {\n                    attribution: '&copy; OpenStreetMap contributors',\n                    subdomains: 'abcd',\n                    maxZoom: 18,\n                    minZoom: 1,\n                    noWrap: false,\n                    bounds: [[-90, -180], [90, 180]]\n                }).addTo(worldMap);\n                \n                markerLayer = L.layerGroup().addTo(worldMap);\n                mapInitialized = true;\n                \n                // Fix map display after initialization\n                setTimeout(() => {\n                    if (worldMap) worldMap.invalidateSize();\n                }, 100);\n            } catch (error) {\n                console.error('Failed to initialize map:', error);\n            }\n        }\n        \n        // Switch between map visualization modes\n        window.switchMapView = function(view) {\n            currentMapView = view;\n            \n            // Update button states\n            document.querySelectorAll('.map-btn').forEach(btn => {\n                btn.classList.remove('active');\n            });\n            document.querySelector(`[data-view=\"${view}\"]`).classList.add('active');\n            \n            // Reload map with new view\n            if (geoDataCache) {\n                renderMapView(geoDataCache);\n            }\n        };\n        \n        // Render different map views\n        function renderMapView(data) {\n            if (!worldMap) return;\n            \n            // Clear all layers\n            if (markerLayer) markerLayer.clearLayers();\n            if (heatmapLayer) {\n                worldMap.removeLayer(heatmapLayer);\n                heatmapLayer = null;\n            }\n            if (choroplethLayer) {\n                worldMap.removeLayer(choroplethLayer);\n                choroplethLayer = null;\n            }\n            \n            switch (currentMapView) {\n                case 'markers':\n                    renderMarkers(data);\n                    break;\n                case 'heatmap':\n                    renderHeatmap(data);\n                    break;\n                case 'choropleth':\n                    renderChoropleth(data);\n                    break;\n            }\n            \n            updateGeoContext(data);\n        }\n        \n        // Render traditional markers\n        function renderMarkers(data) {\n            data.locations.forEach(location => {\n                const { lat, lng, city, country } = location.location;\n                \n                let markerColor = '#26de81'; // benign\n                if (location.malwareCount > 0) {\n                    markerColor = '#ff3b3b'; // malware\n                } else if (location.suspiciousCount > 0) {\n                    markerColor = '#ffd700'; // suspicious\n                }\n                \n                const markerSize = Math.min(24, Math.max(8, 8 + location.totalScans * 2));\n                \n                const marker = L.circleMarker([lat, lng], {\n                    radius: markerSize / 2,\n                    fillColor: markerColor,\n                    color: '#fff',\n                    weight: 2,\n                    opacity: 0.8,\n                    fillOpacity: 0.6\n                });\n                \n                const popupContent = `\n                    <div style=\"color: var(--text-primary); min-width: 200px;\">\n                        <h3 style=\"margin: 0 0 10px 0; color: var(--accent-green); font-size: 1.1rem;\">\n                            <i class=\"fas fa-map-marker-alt\" style=\"color: ${markerColor};\"></i>\n                            ${city}, ${country}\n                        </h3>\n                        <p style=\"margin: 5px 0;\"><strong>IP:</strong> ${location.ip}</p>\n                        <p style=\"margin: 5px 0;\"><strong>Total Scans:</strong> ${location.totalScans}</p>\n                        <div style=\"margin-top: 10px;\">\n                            <div><span style=\"color: #ff3b3b;\">‚óè</span> Malware: ${location.malwareCount}</div>\n                            <div><span style=\"color: #ffd700;\">‚óè</span> Suspicious: ${location.suspiciousCount}</div>\n                            <div><span style=\"color: #39ff14;\">‚óè</span> Benign: ${location.benignCount}</div>\n                        </div>\n                        <button onclick=\"filterByLocation('${country}')\" \n                                style=\"margin-top: 10px; padding: 5px 10px; background: var(--accent-green); \n                                       color: var(--bg-primary); border: none; border-radius: 5px; cursor: pointer;\">\n                            Filter by ${country}\n                        </button>\n                    </div>\n                `;\n                \n                marker.bindPopup(popupContent);\n                marker.addTo(markerLayer);\n                \n                marker.on('mouseover', function() {\n                    this.setStyle({ fillOpacity: 0.9, opacity: 1 });\n                });\n                marker.on('mouseout', function() {\n                    this.setStyle({ fillOpacity: 0.6, opacity: 0.8 });\n                });\n            });\n        }\n        \n        // Render heatmap overlay\n        function renderHeatmap(data) {\n            const heatData = [];\n            \n            data.locations.forEach(location => {\n                const { lat, lng } = location.location;\n                // Weight by threat severity: malware = 1.0, suspicious = 0.5, benign = 0.2\n                const weight = (location.malwareCount * 1.0 + \n                               location.suspiciousCount * 0.5 + \n                               location.benignCount * 0.2) / location.totalScans;\n                \n                // Add multiple points for higher intensity\n                const intensity = Math.ceil(location.totalScans * weight);\n                for (let i = 0; i < intensity; i++) {\n                    heatData.push([lat, lng, weight]);\n                }\n            });\n            \n            heatmapLayer = L.heatLayer(heatData, {\n                radius: 35,\n                blur: 25,\n                maxZoom: 10,\n                max: 1.0,\n                gradient: {\n                    0.0: '#39ff14',  // Green (low threat)\n                    0.3: '#ffd700',  // Yellow\n                    0.6: '#ffa502',  // Orange\n                    0.8: '#ff6348',  // Red\n                    1.0: '#ff3b3b'   // Bright red (high threat)\n                }\n            }).addTo(worldMap);\n        }\n        \n        // Render choropleth (country-level threat shading)\n        function renderChoropleth(data) {\n            // Aggregate threats by country\n            const countryStats = {};\n            data.locations.forEach(location => {\n                const country = location.location.country;\n                if (!countryStats[country]) {\n                    countryStats[country] = { total: 0, malware: 0, suspicious: 0 };\n                }\n                countryStats[country].total += location.totalScans;\n                countryStats[country].malware += location.malwareCount;\n                countryStats[country].suspicious += location.suspiciousCount;\n            });\n            \n            // Find max for normalization\n            const maxThreats = Math.max(...Object.values(countryStats).map(s => \n                s.malware + s.suspicious * 0.5\n            ));\n            \n            // Draw circles for countries with threat data\n            choroplethLayer = L.layerGroup();\n            \n            Object.entries(countryStats).forEach(([country, stats]) => {\n                if (countryCoordinates[country]) {\n                    const threatScore = (stats.malware + stats.suspicious * 0.5) / maxThreats;\n                    \n                    // Color gradient from green to red\n                    let color;\n                    if (threatScore < 0.2) color = '#39ff14';\n                    else if (threatScore < 0.4) color = '#ffd700';\n                    else if (threatScore < 0.6) color = '#ffa502';\n                    else if (threatScore < 0.8) color = '#ff6348';\n                    else color = '#ff3b3b';\n                    \n                    const circle = L.circle(countryCoordinates[country].center, {\n                        color: color,\n                        fillColor: color,\n                        fillOpacity: 0.4,\n                        radius: 500000 * (1 + threatScore * 2),\n                        weight: 2\n                    });\n                    \n                    circle.bindPopup(`\n                        <div style=\"color: var(--text-primary);\">\n                            <h3 style=\"color: var(--accent-green);\">${country}</h3>\n                            <p><strong>Total Threats:</strong> ${stats.total}</p>\n                            <p><strong>Malware:</strong> ${stats.malware}</p>\n                            <p><strong>Suspicious:</strong> ${stats.suspicious}</p>\n                            <p><strong>Threat Level:</strong> ${(threatScore * 100).toFixed(0)}%</p>\n                        </div>\n                    `);\n                    \n                    circle.addTo(choroplethLayer);\n                }\n            });\n            \n            choroplethLayer.addTo(worldMap);\n        }\n        \n        // Update geographic context panel\n        function updateGeoContext(data) {\n            const countries = new Set(data.locations.map(l => l.location.country));\n            document.getElementById('activeRegions').textContent = countries.size;\n            \n            // Find hotspot (country with most threats)\n            const countryThreats = {};\n            data.locations.forEach(loc => {\n                const country = loc.location.country;\n                countryThreats[country] = (countryThreats[country] || 0) + \n                    loc.malwareCount + loc.suspiciousCount;\n            });\n            \n            const hotspot = Object.entries(countryThreats)\n                .sort((a, b) => b[1] - a[1])[0];\n            \n            if (hotspot) {\n                const percentage = ((hotspot[1] / data.locations.reduce((sum, l) => \n                    sum + l.malwareCount + l.suspiciousCount, 0)) * 100).toFixed(0);\n                document.getElementById('topRegion').textContent = \n                    `${hotspot[0]} (${percentage}% of threats)`;\n            }\n            \n            const totalThreats = data.locations.reduce((sum, l) => \n                sum + l.malwareCount + l.suspiciousCount, 0);\n            document.getElementById('geoThreatCount').textContent = totalThreats;\n        }\n        \n        // Filter dashboard by geographic location\n        window.filterByLocation = function(country) {\n            console.log(`Filtering by country: ${country}`);\n            // This would filter the tables and charts - simplified for demo\n            alert(`Geographic filtering activated for ${country}.\\nIn full implementation, this would filter all dashboard data.`);\n        };\n        \n        // Replay threats over last 24 hours\n        window.replayThreats = async function() {\n            const btn = document.getElementById('replayBtn');\n            const info = document.getElementById('timelineInfo');\n            \n            if (replayInterval) {\n                clearInterval(replayInterval);\n                replayInterval = null;\n                btn.innerHTML = '<i class=\"fas fa-play\"></i> Replay Last 24h';\n                info.textContent = 'Replay stopped';\n                if (geoDataCache) renderMapView(geoDataCache);\n                return;\n            }\n            \n            if (!geoDataCache || geoDataCache.locations.length === 0) {\n                info.textContent = 'No data available for replay';\n                return;\n            }\n            \n            btn.innerHTML = '<i class=\"fas fa-stop\"></i> Stop Replay';\n            info.textContent = 'Replaying threat detection timeline...';\n            \n            // Sort locations by timestamp\n            const sortedLocations = [...geoDataCache.locations].sort((a, b) => {\n                const timeA = a.scans[0]?.timestamp || 0;\n                const timeB = b.scans[0]?.timestamp || 0;\n                return new Date(timeA) - new Date(timeB);\n            });\n            \n            if (markerLayer) markerLayer.clearLayers();\n            let index = 0;\n            \n            replayInterval = setInterval(() => {\n                if (index >= sortedLocations.length) {\n                    clearInterval(replayInterval);\n                    replayInterval = null;\n                    btn.innerHTML = '<i class=\"fas fa-play\"></i> Replay Last 24h';\n                    info.textContent = 'Replay complete';\n                    return;\n                }\n                \n                const location = sortedLocations[index];\n                const { lat, lng, city, country } = location.location;\n                \n                let markerColor = location.malwareCount > 0 ? '#ff3b3b' : \n                                 location.suspiciousCount > 0 ? '#ffd700' : '#39ff14';\n                \n                // Animated marker appearance\n                const marker = L.circleMarker([lat, lng], {\n                    radius: 0,\n                    fillColor: markerColor,\n                    color: '#fff',\n                    weight: 2,\n                    opacity: 1,\n                    fillOpacity: 0.8\n                }).addTo(markerLayer);\n                \n                // Animate marker growth\n                let size = 0;\n                const growInterval = setInterval(() => {\n                    size += 2;\n                    if (size >= 12) {\n                        clearInterval(growInterval);\n                        marker.setStyle({ opacity: 0.8, fillOpacity: 0.6 });\n                    }\n                    marker.setRadius(size / 2);\n                }, 50);\n                \n                marker.bindPopup(`\n                    <div style=\"color: var(--text-primary);\">\n                        <strong>${city}, ${country}</strong><br>\n                        ${location.scans[0]?.filename || 'Unknown file'}\n                    </div>\n                `);\n                \n                info.textContent = `Replaying: ${index + 1}/${sortedLocations.length} - ${city}, ${country}`;\n                index++;\n            }, 800); // Show new threat every 800ms\n        };\n        \n        async function loadGeoMap() {\n            try {\n                // Initialize map only once\n                if (!mapInitialized) {\n                    initializeMap();\n                }\n                \n                if (!worldMap) return;\n                \n                const response = await fetch('/api/geo-data');\n                const data = await response.json();\n                \n                // Generate hash of current data to detect changes\n                const currentHash = JSON.stringify(data.locations.map(l => \n                    `${l.ip}-${l.totalScans}-${l.malwareCount}-${l.suspiciousCount}`\n                )).substring(0, 100);\n                \n                // Skip update if data hasn't changed\n                if (currentHash === lastGeoDataHash && markerLayer && markerLayer.getLayers().length > 0) {\n                    return;\n                }\n                lastGeoDataHash = currentHash;\n                \n                // Cache data for replay and other features\n                geoDataCache = data;\n                \n                // Render current view\n                renderMapView(data);\n                \n                console.log(`Map updated with ${data.locations.length} locations in ${currentMapView} mode`);\n                \n            } catch (error) {\n                console.error('Failed to load geo map:', error);\n            }\n        }\n        \n        async function loadMalwareSources() {\n            try {\n                const response = await fetch('/api/malware-sources');\n                const data = await response.json();\n                \n                const ctx = document.getElementById('malwareSourceChart');\n                \n                const labels = data.sources.map(s => s.source);\n                const counts = data.sources.map(s => s.count);\n                \n                // Color scheme for different sources\n                const colors = [\n                    '#ff6b6b', // Email Attachment - red\n                    '#4ecdc4', // Web Download - teal\n                    '#ffe66d', // USB/External Drive - yellow\n                    '#a8dadc', // Internal Network - light blue\n                    '#95a5a6'  // Unknown - gray\n                ];\n                \n                // Reuse existing chart if it exists\n                if (sourceChart) {\n                    sourceChart.data.labels = labels;\n                    sourceChart.data.datasets[0].data = counts;\n                    sourceChart.update('none');\n                    return;\n                }\n                \n                sourceChart = new Chart(ctx, {\n                    type: 'pie',\n                    data: {\n                        labels: labels,\n                        datasets: [{\n                            data: counts,\n                            backgroundColor: colors,\n                            borderColor: '#1a1a2e',\n                            borderWidth: 2\n                        }]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: true,\n                        plugins: {\n                            legend: {\n                                position: 'bottom',\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 12 },\n                                    padding: 15\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0',\n                                borderColor: 'rgba(255, 255, 255, 0.1)',\n                                borderWidth: 1,\n                                callbacks: {\n                                    label: function(context) {\n                                        const label = context.label || '';\n                                        const value = context.parsed || 0;\n                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);\n                                        const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : 0;\n                                        return `${label}: ${value} (${percentage}%)`;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                });\n                \n            } catch (error) {\n                console.error('Failed to load malware sources:', error);\n            }\n        }\n        \n        // Graph 2: \"Noisiest\" Agents Over Time\n        let noisyAgentsChart = null;\n        async function loadNoisyAgentsChart() {\n            try {\n                const response = await fetch('/api/noisy-agents');\n                const data = await response.json();\n                \n                console.log('Noisy agents data:', data);\n                \n                const ctx = document.getElementById('noisyAgentsChart');\n                if (!ctx) return;\n                \n                // Show message if no data\n                if (!data.agents || data.agents.length === 0) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 2rem; text-align: center; color: var(--text-secondary);\">No agent data available yet. Start scanning files to see trends.</div>';\n                    return;\n                }\n                \n                const colors = [\n                    '#ff3b3b', '#39ff14', '#ffd700', '#1e90ff', '#ff1493'\n                ];\n                \n                // Reuse existing chart if it exists\n                if (noisyAgentsChart) {\n                    noisyAgentsChart.data.labels = data.dates;\n                    noisyAgentsChart.data.datasets = data.agents.map((agent, idx) => ({\n                        label: agent.agentId,\n                        data: agent.counts,\n                        borderColor: colors[idx],\n                        backgroundColor: colors[idx] + '20',\n                        tension: 0.4,\n                        borderWidth: 2,\n                        fill: false\n                    }));\n                    noisyAgentsChart.update('none');\n                    return;\n                }\n                \n                noisyAgentsChart = new Chart(ctx, {\n                    type: 'line',\n                    data: {\n                        labels: data.dates,\n                        datasets: data.agents.map((agent, idx) => ({\n                            label: agent.agentId,\n                            data: agent.counts,\n                            borderColor: colors[idx],\n                            backgroundColor: colors[idx] + '20',\n                            tension: 0.4,\n                            borderWidth: 2,\n                            fill: false\n                        }))\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: {\n                                    color: getCSSVar('--chart-text-color') || '#e0e0e0',\n                                    font: { size: 11 }\n                                }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                titleColor: '#fff',\n                                bodyColor: '#e0e0e0'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: getCSSVar('--chart-text-color') || '#888' },\n                                grid: { color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                ticks: { color: getCSSVar('--chart-text-color') || '#888' },\n                                grid: { color: getCSSVar('--chart-grid-color') || 'rgba(255, 255, 255, 0.05)' }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load noisy agents chart:', error);\n                const ctx = document.getElementById('noisyAgentsChart');\n                if (ctx) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 2rem; text-align: center; color: var(--accent-red);\">Error loading chart data</div>';\n                }\n            }\n        }\n        \n        // Graph 3: Signature Status vs. Classification\n        let signatureClassChart = null;\n        async function loadSignatureClassChart() {\n            try {\n                const response = await fetch('/api/signature-classification');\n                const data = await response.json();\n                \n                console.log('Signature classification data:', data);\n                \n                const ctx = document.getElementById('signatureClassChart');\n                if (!ctx) {\n                    console.warn('signatureClassChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (signatureClassChart) {\n                    signatureClassChart.data.datasets[0].data = [data.benign.verified, data.suspicious.verified, data.malware.verified];\n                    signatureClassChart.data.datasets[1].data = [data.benign.unknown, data.suspicious.unknown, data.malware.unknown];\n                    signatureClassChart.data.datasets[2].data = [data.benign.untrusted, data.suspicious.untrusted, data.malware.untrusted];\n                    signatureClassChart.update('none');\n                    return;\n                }\n                \n                signatureClassChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: ['Benign', 'Suspicious', 'Malware'],\n                        datasets: [\n                            {\n                                label: 'Verified',\n                                data: [data.benign.verified, data.suspicious.verified, data.malware.verified],\n                                backgroundColor: '#39ff14',\n                                stack: 'stack0'\n                            },\n                            {\n                                label: 'Unknown',\n                                data: [data.benign.unknown, data.suspicious.unknown, data.malware.unknown],\n                                backgroundColor: '#ffd700',\n                                stack: 'stack0'\n                            },\n                            {\n                                label: 'Untrusted',\n                                data: [data.benign.untrusted, data.suspicious.untrusted, data.malware.untrusted],\n                                backgroundColor: '#ff3b3b',\n                                stack: 'stack0'\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                callbacks: {\n                                    label: function(context) {\n                                        const total = context.chart.data.datasets\n                                            .reduce((sum, ds) => sum + ds.data[context.dataIndex], 0);\n                                        const percentage = ((context.parsed.y / total) * 100).toFixed(1);\n                                        return `${context.dataset.label}: ${context.parsed.y} (${percentage}%)`;\n                                    }\n                                }\n                            }\n                        },\n                        scales: {\n                            y: {\n                                stacked: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                stacked: true,\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load signature classification chart:', error);\n                const ctx = document.getElementById('signatureClassChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 4: Packer Usage vs. Classification\n        let packerClassChart = null;\n        async function loadPackerClassChart() {\n            try {\n                const response = await fetch('/api/packer-classification');\n                const data = await response.json();\n                \n                console.log('Packer classification data:', data);\n                \n                const ctx = document.getElementById('packerClassChart');\n                if (!ctx) {\n                    console.warn('packerClassChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (packerClassChart) {\n                    packerClassChart.data.labels = data.packers;\n                    packerClassChart.data.datasets[0].data = data.benignCounts;\n                    packerClassChart.data.datasets[1].data = data.malwareCounts;\n                    packerClassChart.update('none');\n                    return;\n                }\n                \n                packerClassChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: data.packers,\n                        datasets: [\n                            {\n                                label: 'Benign Files',\n                                data: data.benignCounts,\n                                backgroundColor: '#39ff14'\n                            },\n                            {\n                                label: 'Malware Files',\n                                data: data.malwareCounts,\n                                backgroundColor: '#ff3b3b'\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load packer classification chart:', error);\n                const ctx = document.getElementById('packerClassChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 5: Confidence Score Histogram\n        let confidenceHistChart = null;\n        async function loadConfidenceHistChart() {\n            try {\n                const response = await fetch('/api/confidence-distribution');\n                const data = await response.json();\n                \n                console.log('Confidence distribution data:', data);\n                \n                const ctx = document.getElementById('confidenceHistChart');\n                if (!ctx) {\n                    console.warn('confidenceHistChart canvas not found');\n                    return;\n                }\n                \n                // Reuse existing chart if it exists\n                if (confidenceHistChart) {\n                    confidenceHistChart.data.labels = data.bins;\n                    confidenceHistChart.data.datasets[0].data = data.counts;\n                    confidenceHistChart.update('none');\n                    return;\n                }\n                \n                confidenceHistChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: data.bins,\n                        datasets: [{\n                            label: 'Scan Count',\n                            data: data.counts,\n                            backgroundColor: '#39ff14',\n                            borderColor: '#2ed60f',\n                            borderWidth: 1\n                        }]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)'\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' },\n                                title: {\n                                    display: true,\n                                    text: 'Number of Scans',\n                                    color: '#888'\n                                }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false },\n                                title: {\n                                    display: true,\n                                    text: 'Confidence Score Range',\n                                    color: '#888'\n                                }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load confidence histogram:', error);\n                const ctx = document.getElementById('confidenceHistChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        // Graph 6: File Entropy Distribution (Box Plot simulation)\n        let entropyBoxChart = null;\n        async function loadEntropyBoxChart() {\n            try {\n                const response = await fetch('/api/entropy-distribution');\n                const data = await response.json();\n                \n                console.log('Entropy distribution data:', data);\n                \n                const ctx = document.getElementById('entropyBoxChart');\n                if (!ctx) {\n                    console.warn('entropyBoxChart canvas not found');\n                    return;\n                }\n                \n                // Create violin/box plot effect with multiple bars\n                const benignData = [\n                    data.benign.min,\n                    data.benign.q1,\n                    data.benign.median,\n                    data.benign.q3,\n                    data.benign.max\n                ];\n                \n                const malwareData = [\n                    data.malware.min,\n                    data.malware.q1,\n                    data.malware.median,\n                    data.malware.q3,\n                    data.malware.max\n                ];\n                \n                // Reuse existing chart if it exists\n                if (entropyBoxChart) {\n                    entropyBoxChart.data.datasets[0].data = benignData;\n                    entropyBoxChart.data.datasets[1].data = malwareData;\n                    entropyBoxChart.update('none');\n                    return;\n                }\n                \n                entropyBoxChart = new Chart(ctx, {\n                    type: 'bar',\n                    data: {\n                        labels: ['Min', 'Q1', 'Median', 'Q3', 'Max'],\n                        datasets: [\n                            {\n                                label: 'Benign Files',\n                                data: benignData,\n                                backgroundColor: '#39ff14',\n                                borderColor: '#2ed60f',\n                                borderWidth: 1\n                            },\n                            {\n                                label: 'Malware Files',\n                                data: malwareData,\n                                backgroundColor: '#ff3b3b',\n                                borderColor: '#cc2f2f',\n                                borderWidth: 1\n                            }\n                        ]\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        plugins: {\n                            legend: {\n                                labels: { color: '#e0e0e0', font: { size: 11 } }\n                            },\n                            tooltip: {\n                                backgroundColor: 'rgba(0, 0, 0, 0.8)',\n                                callbacks: {\n                                    label: function(context) {\n                                        return `${context.dataset.label}: ${context.parsed.y.toFixed(3)}`;\n                                    }\n                                }\n                            }\n                        },\n                        scales: {\n                            y: {\n                                beginAtZero: true,\n                                max: 8.0,\n                                ticks: { color: '#888' },\n                                grid: { color: 'rgba(255, 255, 255, 0.05)' },\n                                title: {\n                                    display: true,\n                                    text: 'Entropy Value',\n                                    color: '#888'\n                                }\n                            },\n                            x: {\n                                ticks: { color: '#888' },\n                                grid: { display: false }\n                            }\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Failed to load entropy distribution chart:', error);\n                const ctx = document.getElementById('entropyBoxChart');\n                if (ctx && ctx.parentElement) {\n                    ctx.parentElement.innerHTML = '<div style=\"padding: 1rem; text-align: center; color: var(--text-secondary); font-size: 0.85rem;\">No data available</div>';\n                }\n            }\n        }\n        \n        async function loadEmergingThreats() {\n            try {\n                const response = await fetch('/api/emerging-threats');\n                const data = await response.json();\n                \n                // Update summary badges\n                document.getElementById('eti-total').textContent = \n                    `${data.summary.totalThreats} Total Threats`;\n                document.getElementById('eti-recent').textContent = \n                    `${data.summary.recentThreats} Last 24h`;\n                \n                // Helper to render IOC list\n                const renderIOCList = (items, container) => {\n                    if (items.length === 0) {\n                        container.innerHTML = '<div class=\"eti-empty\">No threats detected</div>';\n                        return;\n                    }\n                    \n                    container.innerHTML = items.map((item, index) => {\n                        const rank = index + 1;\n                        const recentBadge = item.recent > 0 ? \n                            `<span class=\"eti-recent-badge\">${item.recent} recent</span>` : '';\n                        const agentBadge = item.agents > 0 ? \n                            `<span class=\"eti-agent-badge\">${item.agents} agents</span>` : '';\n                        \n                        return `\n                            <div class=\"eti-item\" data-rank=\"${rank}\">\n                                <div class=\"eti-rank\">${rank}</div>\n                                <div class=\"eti-content\">\n                                    <div class=\"eti-name\">${item.name}</div>\n                                    <div class=\"eti-meta\">\n                                        <span class=\"eti-count\">${item.count} occurrences</span>\n                                        ${recentBadge}\n                                        ${agentBadge}\n                                    </div>\n                                    ${item.details && item.details.length > 0 ? `\n                                        <div class=\"eti-details\">\n                                            ${item.details.slice(0, 2).join(', ')}\n                                            ${item.details.length > 2 ? '...' : ''}\n                                        </div>\n                                    ` : ''}\n                                </div>\n                            </div>\n                        `;\n                    }).join('');\n                };\n                \n                // Render each section\n                renderIOCList(data.topMalwareFamilies, document.getElementById('eti-malware'));\n                renderIOCList(data.topSuspiciousAPIs, document.getElementById('eti-apis'));\n                renderIOCList(data.topMaliciousStrings, document.getElementById('eti-strings'));\n                renderIOCList(data.topPackers, document.getElementById('eti-packers'));\n                \n            } catch (error) {\n                console.error('Failed to load emerging threats:', error);\n            }\n        }\n        \n        async function analyzeThreatModel() {\n            try {\n                // Get selected values\n                const fileType = document.getElementById('model-filetype').value;\n                const packer = document.getElementById('model-packer').value;\n                const signature = document.getElementById('model-signature').value;\n                \n                // Get multiple selections\n                const apisSelect = document.getElementById('model-apis');\n                const apiImports = Array.from(apisSelect.selectedOptions).map(opt => opt.value);\n                \n                const stringsSelect = document.getElementById('model-strings');\n                const keyStrings = Array.from(stringsSelect.selectedOptions).map(opt => opt.value);\n                \n                // Validate\n                if (apiImports.length === 0) {\n                    alert('Please select at least one API import');\n                    return;\n                }\n                if (keyStrings.length === 0) {\n                    alert('Please select at least one suspicious string');\n                    return;\n                }\n                \n                // Show loading state\n                const outputDiv = document.getElementById('modeler-output');\n                outputDiv.innerHTML = `\n                    <div class=\"modeler-loading\">\n                        <i class=\"fas fa-spinner fa-spin\"></i>\n                        <p>Analyzing threat profile...</p>\n                    </div>\n                `;\n                \n                // Send to server\n                const response = await fetch('/api/threat-model', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                        fileType,\n                        packer,\n                        signature,\n                        apiImports,\n                        keyStrings\n                    })\n                });\n                \n                const data = await response.json();\n                \n                if (data.success) {\n                    const result = data.result;\n                    const classColor = \n                        result.classification === 'Malware' ? '#ff4757' :\n                        result.classification === 'Suspicious' ? '#ffa502' : '#26de81';\n                    \n                    outputDiv.innerHTML = `\n                        <div class=\"prediction-result\">\n                            <div class=\"prediction-header\">\n                                <div class=\"prediction-badge\" style=\"background: ${classColor};\">\n                                    ${result.classification.toUpperCase()}\n                                </div>\n                                <div class=\"prediction-confidence\">\n                                    <div class=\"confidence-label\">Confidence Score</div>\n                                    <div class=\"confidence-value\">${(parseFloat(result.confidence_score) * 100).toFixed(1)}%</div>\n                                </div>\n                            </div>\n                            \n                            ${result.malware_family ? `\n                                <div class=\"prediction-family\">\n                                    <strong>Predicted Malware Family:</strong>\n                                    <span class=\"family-name\">${result.malware_family}</span>\n                                </div>\n                            ` : ''}\n                            \n                            <div class=\"prediction-section\">\n                                <h4>Threat Analysis</h4>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-file\"></i>\n                                    <span><strong>File Type:</strong> ${result.key_findings.file_type}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-box\"></i>\n                                    <span><strong>Packer:</strong> ${result.key_findings.packer_detected}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-certificate\"></i>\n                                    <span><strong>Signature:</strong> ${result.key_findings.signature.name}</span>\n                                </div>\n                                <div class=\"analysis-item\">\n                                    <i class=\"fas fa-tachometer-alt\"></i>\n                                    <span><strong>Threat Score:</strong> ${result.key_findings.threat_score}/100</span>\n                                </div>\n                            </div>\n                            \n                            <div class=\"prediction-section\">\n                                <h4>Detected Indicators</h4>\n                                <div class=\"indicator-group\">\n                                    <strong>API Imports:</strong>\n                                    <div class=\"indicator-list\">\n                                        ${result.key_findings.api_imports.map(api => \n                                            `<span class=\"indicator-tag api-tag\">${api}</span>`\n                                        ).join('')}\n                                    </div>\n                                </div>\n                                <div class=\"indicator-group\">\n                                    <strong>Suspicious Strings:</strong>\n                                    <div class=\"indicator-list\">\n                                        ${result.key_findings.key_strings.map(str => \n                                            `<span class=\"indicator-tag string-tag\">${str}</span>`\n                                        ).join('')}\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"prediction-footer\">\n                                <i class=\"fas fa-info-circle\"></i>\n                                This analysis has been added to the scan results and will appear in all visualizations.\n                            </div>\n                        </div>\n                    `;\n                } else {\n                    outputDiv.innerHTML = `\n                        <div class=\"modeler-error\">\n                            <i class=\"fas fa-exclamation-circle\"></i>\n                            <p>Analysis failed: ${data.error}</p>\n                        </div>\n                    `;\n                }\n                \n            } catch (error) {\n                console.error('Failed to analyze threat model:', error);\n                document.getElementById('modeler-output').innerHTML = `\n                    <div class=\"modeler-error\">\n                        <i class=\"fas fa-exclamation-circle\"></i>\n                        <p>Analysis failed. Please try again.</p>\n                    </div>\n                `;\n            }\n        }\n        \n        let graphSimulation = null;\n        let graphSvg = null;\n        \n        async function loadCorrelationGraph() {\n            try {\n                const response = await fetch('/api/threat-correlations');\n                const data = await response.json();\n                \n                // Clear existing graph\n                d3.select('#correlationGraph').selectAll('*').remove();\n                \n                const container = document.getElementById('correlationGraph');\n                const width = container.clientWidth;\n                const height = 600;\n                \n                // Create SVG\n                graphSvg = d3.select('#correlationGraph')\n                    .append('svg')\n                    .attr('width', width)\n                    .attr('height', height)\n                    .style('background', '#0a0a0a')\n                    .style('border-radius', '8px');\n                \n                const g = graphSvg.append('g');\n                \n                // Add zoom behavior\n                const zoom = d3.zoom()\n                    .scaleExtent([0.1, 4])\n                    .on('zoom', (event) => {\n                        g.attr('transform', event.transform);\n                    });\n                \n                graphSvg.call(zoom);\n                \n                // Color schemes for different node types\n                const colorMap = {\n                    malware: '#ff4757',\n                    agent: '#5a9cf8',\n                    api: '#ffa502',\n                    string: '#26de81'\n                };\n                \n                // Create force simulation\n                graphSimulation = d3.forceSimulation(data.nodes)\n                    .force('link', d3.forceLink(data.links)\n                        .id(d => d.id)\n                        .distance(d => d.type === 'correlated_with' ? 200 : 100)\n                        .strength(d => d.strength * 0.3))\n                    .force('charge', d3.forceManyBody().strength(-300))\n                    .force('center', d3.forceCenter(width / 2, height / 2))\n                    .force('collision', d3.forceCollide().radius(30));\n                \n                // Draw links\n                const link = g.append('g')\n                    .selectAll('line')\n                    .data(data.links)\n                    .enter()\n                    .append('line')\n                    .attr('stroke', d => {\n                        if (d.type === 'correlated_with') return '#ff6b6b';\n                        if (d.type === 'detected_by') return '#5a9cf8';\n                        if (d.type === 'uses_api') return '#ffa502';\n                        return '#26de81';\n                    })\n                    .attr('stroke-width', d => Math.sqrt(d.strength) + 1)\n                    .attr('stroke-opacity', 0.6);\n                \n                // Draw nodes\n                const node = g.append('g')\n                    .selectAll('circle')\n                    .data(data.nodes)\n                    .enter()\n                    .append('circle')\n                    .attr('r', d => {\n                        if (d.type === 'malware') return 15 + Math.min(d.count * 2, 15);\n                        if (d.type === 'agent') return 12 + Math.min(d.count, 10);\n                        return 8 + Math.min(d.count, 8);\n                    })\n                    .attr('fill', d => colorMap[d.type])\n                    .attr('stroke', '#fff')\n                    .attr('stroke-width', 2)\n                    .style('cursor', 'pointer')\n                    .call(d3.drag()\n                        .on('start', dragstarted)\n                        .on('drag', dragged)\n                        .on('end', dragended))\n                    .on('click', (event, d) => showNodeDetails(d, data))\n                    .on('mouseover', function(event, d) {\n                        d3.select(this)\n                            .transition()\n                            .duration(200)\n                            .attr('stroke-width', 4)\n                            .attr('r', function() {\n                                const currentR = parseFloat(d3.select(this).attr('r'));\n                                return currentR * 1.3;\n                            });\n                    })\n                    .on('mouseout', function(event, d) {\n                        d3.select(this)\n                            .transition()\n                            .duration(200)\n                            .attr('stroke-width', 2)\n                            .attr('r', function() {\n                                if (d.type === 'malware') return 15 + Math.min(d.count * 2, 15);\n                                if (d.type === 'agent') return 12 + Math.min(d.count, 10);\n                                return 8 + Math.min(d.count, 8);\n                            });\n                    });\n                \n                // Add labels\n                const label = g.append('g')\n                    .selectAll('text')\n                    .data(data.nodes)\n                    .enter()\n                    .append('text')\n                    .text(d => d.label.length > 20 ? d.label.substring(0, 20) + '...' : d.label)\n                    .attr('font-size', d => d.type === 'malware' ? '12px' : '10px')\n                    .attr('fill', '#e0e0e0')\n                    .attr('text-anchor', 'middle')\n                    .attr('dy', d => {\n                        if (d.type === 'malware') return 35;\n                        if (d.type === 'agent') return 25;\n                        return 20;\n                    })\n                    .style('pointer-events', 'none')\n                    .style('font-weight', d => d.type === 'malware' ? 'bold' : 'normal');\n                \n                // Update positions on simulation tick\n                graphSimulation.on('tick', () => {\n                    link\n                        .attr('x1', d => d.source.x)\n                        .attr('y1', d => d.source.y)\n                        .attr('x2', d => d.target.x)\n                        .attr('y2', d => d.target.y);\n                    \n                    node\n                        .attr('cx', d => d.x)\n                        .attr('cy', d => d.y);\n                    \n                    label\n                        .attr('x', d => d.x)\n                        .attr('y', d => d.y);\n                });\n                \n                // Drag functions\n                function dragstarted(event, d) {\n                    if (!event.active) graphSimulation.alphaTarget(0.3).restart();\n                    d.fx = d.x;\n                    d.fy = d.y;\n                }\n                \n                function dragged(event, d) {\n                    d.fx = event.x;\n                    d.fy = event.y;\n                }\n                \n                function dragended(event, d) {\n                    if (!event.active) graphSimulation.alphaTarget(0);\n                    d.fx = null;\n                    d.fy = null;\n                }\n                \n                console.log(`Correlation graph loaded: ${data.nodes.length} nodes, ${data.links.length} links`);\n                \n            } catch (error) {\n                console.error('Failed to load correlation graph:', error);\n            }\n        }\n        \n        function showNodeDetails(node, graphData) {\n            const detailsPanel = document.getElementById('nodeDetails');\n            const detailsTitle = document.getElementById('detailsTitle');\n            const detailsContent = document.getElementById('detailsContent');\n            \n            detailsTitle.textContent = node.label;\n            \n            let html = `<p><strong>Type:</strong> ${node.type.toUpperCase()}</p>`;\n            html += `<p><strong>Occurrences:</strong> ${node.count}</p>`;\n            \n            // Find connections\n            const connections = graphData.links.filter(l => \n                l.source.id === node.id || l.target.id === node.id\n            );\n            \n            if (connections.length > 0) {\n                html += `<p><strong>Connections:</strong> ${connections.length}</p>`;\n                html += '<ul style=\"margin: 10px 0; padding-left: 20px;\">';\n                connections.slice(0, 10).forEach(link => {\n                    const otherNode = link.source.id === node.id ? link.target : link.source;\n                    html += `<li>${link.type.replace(/_/g, ' ')}: ${otherNode.label}</li>`;\n                });\n                if (connections.length > 10) {\n                    html += `<li>...and ${connections.length - 10} more</li>`;\n                }\n                html += '</ul>';\n            }\n            \n            if (node.details && node.details.length > 0) {\n                html += '<p><strong>Associated Files:</strong></p>';\n                html += '<ul style=\"margin: 10px 0; padding-left: 20px; max-height: 150px; overflow-y: auto;\">';\n                node.details.slice(0, 10).forEach(file => {\n                    html += `<li>${file}</li>`;\n                });\n                if (node.details.length > 10) {\n                    html += `<li>...and ${node.details.length - 10} more</li>`;\n                }\n                html += '</ul>';\n            }\n            \n            detailsContent.innerHTML = html;\n            detailsPanel.style.display = 'block';\n        }\n        \n        function resetGraph() {\n            if (graphSimulation) {\n                graphSimulation.alpha(1).restart();\n            }\n        }\n        \n        function centerGraph() {\n            if (graphSvg) {\n                graphSvg.transition().duration(750).call(\n                    d3.zoom().transform,\n                    d3.zoomIdentity\n                );\n            }\n        }\n        \n        function setChartDays(days) {\n            currentChartDays = days;\n            \n            // Update button states\n            document.querySelectorAll('.chart-btn').forEach(btn => {\n                btn.classList.remove('active');\n            });\n            event.target.classList.add('active');\n            \n            loadDailyChart();\n        }\n        \n        function loadData() {\n            loadStats();\n            loadScans();\n            // Heavy components loaded lazily - see switchView()\n        }\n        \n        function loadDataWithoutMap() {\n            loadStats();\n            loadScans();\n        }\n        \n        // Track which analytics have been loaded\n        let analyticsLoaded = false;\n        \n        function loadAnalytics() {\n            console.log('Loading analytics view...');\n            loadDailyChart();\n            loadMalwareSources();\n            loadNoisyAgentsChart();\n            loadSignatureClassChart();\n            loadPackerClassChart();\n            loadConfidenceHistChart();\n            loadEntropyBoxChart();\n            loadEmergingThreats();\n            loadCorrelationGraph();\n            loadGeoMap();\n            \n            analyticsLoaded = true;\n        }\n        \n        // Initial load - only dashboard essentials\n        loadData();\n        \n        // Auto-scroll functionality with visual indicators\n        const scrollIndicatorUp = document.createElement('div');\n        scrollIndicatorUp.className = 'scroll-indicator scroll-up';\n        scrollIndicatorUp.innerHTML = '<i class=\"fas fa-chevron-up\"></i>';\n        document.body.appendChild(scrollIndicatorUp);\n        \n        const scrollIndicatorDown = document.createElement('div');\n        scrollIndicatorDown.className = 'scroll-indicator scroll-down';\n        scrollIndicatorDown.innerHTML = '<i class=\"fas fa-chevron-down\"></i>';\n        document.body.appendChild(scrollIndicatorDown);\n        \n        let pageScrollInterval = null;\n        const scrollSpeed = 3;\n        const triggerZone = 80; // pixels from top/bottom\n        \n        function handleAutoScroll(event) {\n            // Don't auto-scroll if page is hidden\n            if (document.hidden) return;\n            \n            const mouseY = event.clientY;\n            const windowHeight = window.innerHeight;\n            \n            // Check if near top\n            if (mouseY < triggerZone) {\n                scrollIndicatorUp.classList.add('visible');\n                scrollIndicatorDown.classList.remove('visible');\n                \n                if (!pageScrollInterval) {\n                    pageScrollInterval = setInterval(() => {\n                        if (document.hidden) {\n                            stopAutoScroll();\n                            return;\n                        }\n                        window.scrollBy({\n                            top: -scrollSpeed,\n                            behavior: 'auto'\n                        });\n                    }, 16); // ~60fps\n                }\n            }\n            // Check if near bottom\n            else if (mouseY > windowHeight - triggerZone) {\n                scrollIndicatorDown.classList.add('visible');\n                scrollIndicatorUp.classList.remove('visible');\n                \n                if (!pageScrollInterval) {\n                    pageScrollInterval = setInterval(() => {\n                        if (document.hidden) {\n                            stopAutoScroll();\n                            return;\n                        }\n                        window.scrollBy({\n                            top: scrollSpeed,\n                            behavior: 'auto'\n                        });\n                    }, 16);\n                }\n            }\n            // In neutral zone\n            else {\n                scrollIndicatorUp.classList.remove('visible');\n                scrollIndicatorDown.classList.remove('visible');\n                \n                if (pageScrollInterval) {\n                    clearInterval(pageScrollInterval);\n                    pageScrollInterval = null;\n                }\n            }\n        }\n        \n        function stopAutoScroll() {\n            scrollIndicatorUp.classList.remove('visible');\n            scrollIndicatorDown.classList.remove('visible');\n            \n            if (pageScrollInterval) {\n                clearInterval(pageScrollInterval);\n                pageScrollInterval = null;\n            }\n        }\n        \n        // Attach event listeners\n        document.addEventListener('mousemove', handleAutoScroll);\n        document.addEventListener('mouseleave', stopAutoScroll);\n        \n        // Stop scrolling when reaching top or bottom\n        let lastScrollTop = 0;\n        window.addEventListener('scroll', () => {\n            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n            const scrollHeight = document.documentElement.scrollHeight;\n            const clientHeight = document.documentElement.clientHeight;\n            \n            // At top\n            if (scrollTop === 0 && lastScrollTop > 0) {\n                stopAutoScroll();\n            }\n            // At bottom\n            if (scrollTop + clientHeight >= scrollHeight - 5) {\n                stopAutoScroll();\n            }\n            \n            lastScrollTop = scrollTop;\n        });\n        \n        // Set up Server-Sent Events for real-time updates\n        const eventSource = new EventSource('/api/events');\n        let updateDebounceTimer = null;\n        let pollingInterval = null;\n        let pendingUpdates = false;\n        \n        eventSource.onmessage = function(event) {\n            const data = JSON.parse(event.data);\n            \n            if (data.type === 'connected') {\n                console.log('Connected to server for real-time updates');\n            } else if (data.type === 'new-scan') {\n                console.log('New scan received:', data.scan.detected_filename);\n                \n                // Show notification toast\n                showThreatNotification(data.scan);\n                \n                // Add to threat ticker\n                addToThreatTicker(data.scan);\n                \n                // Debounce: batch multiple rapid scans into single update\n                pendingUpdates = true;\n                clearTimeout(updateDebounceTimer);\n                updateDebounceTimer = setTimeout(() => {\n                    if (pendingUpdates) {\n                        // Only reload lightweight data (stats + scan list)\n                        loadStats();\n                        loadScans();\n                        \n                        // If analytics view is open, refresh analytics too\n                        if (currentView === 'analytics' && analyticsLoaded) {\n                            loadAnalytics();\n                        }\n                        \n                        pendingUpdates = false;\n                        \n                        // Throttle map updates to once per 15 seconds\n                        if (!window.lastMapUpdate || Date.now() - window.lastMapUpdate > 15000) {\n                            loadGeoMap();\n                            window.lastMapUpdate = Date.now();\n                        }\n                    }\n                }, 1000); // Wait 1 second after last scan\n            }\n        };\n        \n        eventSource.onerror = function(error) {\n            console.error('SSE Error:', error);\n            // Fallback: reload data every 30 seconds if SSE connection fails (only once!)\n            if (eventSource.readyState === EventSource.CLOSED && !pollingInterval) {\n                console.log('SSE connection closed, falling back to polling...');\n                pollingInterval = setInterval(() => {\n                    loadStats();\n                    loadScans();\n                }, 30000);\n            }\n        };\n        \n        // Manual refresh button functionality\n        window.manualRefresh = function() {\n            loadData();\n        };\n    </script>\n    \n    <!-- Theme Toggle Script -->\n    <script>\n        // Theme Toggle Functionality\n        window.toggleTheme = function() {\n            const html = document.documentElement;\n            const currentTheme = html.getAttribute('data-theme');\n            const newTheme = currentTheme === 'light' ? '' : 'light';\n            \n            if (newTheme) {\n                html.setAttribute('data-theme', newTheme);\n            } else {\n                html.removeAttribute('data-theme');\n            }\n            localStorage.setItem('theme', newTheme || 'dark');\n            \n            // Update button icon and text\n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            if (newTheme === 'light') {\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n            } else {\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n            }\n        };\n        \n        // Load saved theme on page load\n        (function() {\n            const savedTheme = localStorage.getItem('theme') || 'dark';\n            if (savedTheme === 'light') {\n                document.documentElement.setAttribute('data-theme', 'light');\n            }\n            \n            const themeIcon = document.getElementById('themeIcon');\n            const themeText = document.getElementById('themeText');\n            \n            if (savedTheme === 'light') {\n                themeIcon.textContent = '‚òÄÔ∏è';\n                themeText.textContent = 'Light';\n            } else {\n                themeIcon.textContent = 'üåô';\n                themeText.textContent = 'Dark';\n            }\n        })();\n    </script>\n</body>\n</html>","range":{"startLineNumber":1,"startColumn":1,"endLineNumber":2576,"endColumn":1}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/styles.css","external":"file:///home/trang/localnsv/mAIware-server/public/styles.css","path":"/home/trang/localnsv/mAIware-server/public/styles.css","scheme":"file"},"requestId":"request_4e420508-80ce-43b8-82a1-fed6912f3e58","epoch":16,"edits":[{"text":":root {\n    --bg-primary: #000000;\n    --bg-secondary: #0a0a0a;\n    --bg-card: #0f0f0f;\n    --bg-hover: #151515;\n    --text-primary: #e8f0e8;\n    --text-secondary: #9ca3af;\n    --accent-green: #39ff14;\n    --accent-green-dim: #2ed60f;\n    --accent-yellow: #ffd700;\n    --accent-red: #ff3b3b;\n    --accent-red-dim: #cc2f2f;\n    --border-color: #1a1a1a;\n    --shadow-color: rgba(0, 0, 0, 0.5);\n    --success-glow: rgba(57, 255, 20, 0.3);\n    --danger-glow: rgba(255, 59, 59, 0.3);\n    --warning-glow: rgba(255, 215, 0, 0.3);\n    /* Chart theming */\n    --chart-text-color: #9ca3af;\n    --chart-grid-color: rgba(255, 255, 255, 0.1);\n}\n\n[data-theme=\"light\"] {\n    --bg-primary: #f0f4f0;\n    --bg-secondary: #ffffff;\n    --bg-card: #fafafa;\n    --bg-hover: #e8f5e8;\n    --text-primary: #1a1f2e;\n    --text-secondary: #4a5568;\n    --accent-green: #2ed60f;\n    --accent-green-dim: #27b00c;\n    --accent-yellow: #cc9a00;\n    --accent-red: #dc2626;\n    --accent-red-dim: #b91c1c;\n    --border-color: #d1d5db;\n    --shadow-color: rgba(0, 0, 0, 0.1);\n    --success-glow: rgba(46, 214, 15, 0.2);\n    --danger-glow: rgba(220, 38, 38, 0.2);\n    --warning-glow: rgba(204, 154, 0, 0.2);\n    --chart-text-color: #374151; /* higher contrast for light theme */\n    --chart-grid-color: rgba(0, 0, 0, 0.12);\n}\n\n* { \n    margin: 0; \n    padding: 0; \n    box-sizing: border-box; \n}\n\nbody {\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    background: var(--bg-primary);\n    color: var(--text-primary);\n    min-height: 100vh;\n    margin: 0;\n    overflow-x: hidden;\n    position: relative;\n}\n\nbody::before {\n    content: '';\n    position: fixed;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: \n        radial-gradient(circle at 20% 50%, rgba(57, 255, 20, 0.08) 0%, transparent 50%),\n        radial-gradient(circle at 80% 80%, rgba(57, 255, 20, 0.06) 0%, transparent 50%),\n        radial-gradient(circle at 40% 20%, rgba(57, 255, 20, 0.05) 0%, transparent 50%);\n    animation: backgroundGlow 15s ease-in-out infinite;\n    pointer-events: none;\n    z-index: 0;\n}\n\n@keyframes backgroundGlow {\n    0%, 100% { \n        transform: translate(0, 0) scale(1);\n        opacity: 0.4;\n    }\n    33% { \n        transform: translate(10%, 10%) scale(1.1);\n        opacity: 0.6;\n    }\n    66% { \n        transform: translate(-10%, 5%) scale(0.95);\n        opacity: 0.5;\n    }\n}\n\nbody > * {\n    position: relative;\n    z-index: 1;\n}\n\n/* Side Panel Navigation */\n.side-panel {\n    position: fixed;\n    left: 0;\n    top: 0;\n    height: 100vh;\n    width: 70px;\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border-right: 1px solid rgba(57, 255, 20, 0.2);\n    box-shadow: 0 0 30px rgba(57, 255, 20, 0.1);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    z-index: 9999;\n    transition: all 0.3s ease;\n}\n\n.side-panel:hover {\n    background: rgba(15, 15, 15, 0.8);\n    box-shadow: 0 0 40px rgba(57, 255, 20, 0.2);\n}\n\n.panel-icon-strip {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 2rem 0;\n}\n\n.panel-logo-icon {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 50px;\n    height: 50px;\n    color: var(--accent-green);\n    font-size: 2rem;\n    animation: pulse-glow 3s ease-in-out infinite;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.panel-logo-icon:hover {\n    transform: scale(1.1);\n    filter: drop-shadow(0 0 20px var(--success-glow));\n}\n\n@keyframes pulse-glow {\n    0%, 100% { filter: drop-shadow(0 0 5px var(--success-glow)); }\n    50% { filter: drop-shadow(0 0 15px var(--success-glow)) drop-shadow(0 0 25px var(--success-glow)); }\n}\n\n/* Graphs Preview Grid */\n.graphs-preview {\n    position: fixed;\n    left: 70px;\n    top: 50%;\n    transform: translateY(-50%) translateX(-100%);\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-left: none;\n    border-radius: 0 12px 12px 0;\n    padding: 2rem;\n    width: 480px;\n    max-height: 90vh;\n    overflow-y: auto;\n    opacity: 0;\n    visibility: hidden;\n    pointer-events: none;\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease, visibility 0.3s;\n    box-shadow: 5px 0 40px rgba(57, 255, 20, 0.15);\n    z-index: 9998;\n    will-change: transform, opacity;\n}\n\n.graphs-preview::-webkit-scrollbar {\n    width: 6px;\n}\n\n.graphs-preview::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 3px;\n}\n\n.graphs-preview::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 3px;\n}\n\n.graphs-preview.show {\n    opacity: 1;\n    visibility: visible;\n    pointer-events: auto;\n    transform: translateY(-50%) translateX(0);\n}\n\n.preview-header {\n    margin-bottom: 1rem;\n    padding-bottom: 0.8rem;\n    border-bottom: 1px solid var(--border-color);\n}\n\n.preview-header h3 {\n    color: var(--accent-green);\n    font-size: 1.1rem;\n    margin-bottom: 0.3rem;\n}\n\n.preview-header p {\n    color: var(--text-secondary);\n    font-size: 0.85rem;\n}\n\n/* Analytics Miniview - Scaled down live view */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-content {\n    width: 100%;\n    height: 100%;\n    transform-origin: top left;\n    transform: scale(0.25);\n    width: 400%;\n    height: 400%;\n    pointer-events: none;\n    overflow: hidden;\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n.preview-home-nav {\n    margin-top: 1.5rem;\n    padding: 1rem;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 10px;\n    display: flex;\n    align-items: center;\n    gap: 0.8rem;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    opacity: 0;\n    visibility: hidden;\n    transform: translateY(10px);\n}\n\n.preview-home-nav.visible {\n    opacity: 1;\n    visibility: visible;\n    transform: translateY(0);\n}\n\n.preview-home-nav:hover {\n    background: var(--bg-hover);\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.preview-home-nav i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n}\n\n.preview-home-nav span {\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--text-primary);\n}\n\n.preview-label {\n    flex: 1;\n    font-size: 0.95rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    letter-spacing: 0.3px;\n}\n\n/* Analytics Miniview - Screenshot preview */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    padding: 1.5rem;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-preview {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    opacity: 0.7;\n}\n\n.preview-row {\n    display: flex;\n    gap: 1rem;\n    flex: 1;\n}\n\n.preview-box {\n    flex: 1;\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 6px;\n    position: relative;\n    overflow: hidden;\n    padding: 0.5rem;\n}\n\n.preview-box.large {\n    flex: 2;\n}\n\n.preview-box.wide {\n    flex: 1;\n    min-height: 150px;\n}\n\n.box-header {\n    font-size: 0.65rem;\n    color: var(--accent-green);\n    margin-bottom: 0.5rem;\n    opacity: 0.8;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.box-content {\n    height: calc(100% - 1.5rem);\n    position: relative;\n}\n\n.map-visual {\n    background: radial-gradient(circle at center, rgba(57, 255, 20, 0.05), transparent);\n    position: relative;\n}\n\n.map-dot {\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 10px var(--accent-green);\n    animation: map-pulse 2s ease-in-out infinite;\n}\n\n.map-dot:nth-child(2) { animation-delay: 0.5s; }\n.map-dot:nth-child(3) { animation-delay: 1s; }\n\n@keyframes map-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.6; }\n    50% { transform: scale(1.5); opacity: 1; }\n}\n\n.chart-visual {\n    display: flex;\n    align-items: flex-end;\n    justify-content: space-around;\n    height: 100%;\n    padding: 0.5rem;\n    gap: 0.3rem;\n}\n\n.chart-bar {\n    flex: 1;\n    background: linear-gradient(180deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    animation: bar-grow 2s ease-in-out infinite;\n    opacity: 0.7;\n}\n\n.chart-bar:nth-child(2) { animation-delay: 0.2s; }\n.chart-bar:nth-child(3) { animation-delay: 0.4s; }\n.chart-bar:nth-child(4) { animation-delay: 0.6s; }\n\n@keyframes bar-grow {\n    0%, 100% { transform: scaleY(0.8); }\n    50% { transform: scaleY(1); }\n}\n\n.list-visual {\n    display: flex;\n    flex-direction: column;\n    gap: 0.4rem;\n    padding: 0.3rem;\n}\n\n.list-item {\n    height: 0.4rem;\n    background: linear-gradient(90deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    opacity: 0.6;\n    animation: list-fade 3s ease-in-out infinite;\n}\n\n.list-item:nth-child(2) { animation-delay: 0.5s; width: 80%; }\n.list-item:nth-child(3) { animation-delay: 1s; width: 60%; }\n\n@keyframes list-fade {\n    0%, 100% { opacity: 0.4; }\n    50% { opacity: 0.8; }\n}\n\n.network-visual {\n    position: relative;\n    height: 100%;\n}\n\n.network-node {\n    position: absolute;\n    width: 6px;\n    height: 6px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 8px var(--accent-green);\n    animation: node-pulse 3s ease-in-out infinite;\n}\n\n.network-node:nth-child(2) { animation-delay: 0.7s; }\n.network-node:nth-child(3) { animation-delay: 1.4s; }\n\n@keyframes node-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.5; }\n    50% { transform: scale(1.3); opacity: 1; }\n}\n\n.heat-visual {\n    background: \n        radial-gradient(circle at 30% 30%, rgba(57, 255, 20, 0.3), transparent 40%),\n        radial-gradient(circle at 70% 60%, rgba(57, 255, 20, 0.2), transparent 40%),\n        radial-gradient(circle at 50% 80%, rgba(57, 255, 20, 0.25), transparent 40%);\n    animation: heat-shift 4s ease-in-out infinite;\n}\n\n@keyframes heat-shift {\n    0%, 100% { opacity: 0.5; }\n    50% { opacity: 0.8; }\n}\n\n.pie-visual {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n}\n\n.pie-chart {\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    background: conic-gradient(\n        var(--accent-green) 0deg 120deg,\n        var(--accent-yellow) 120deg 240deg,\n        var(--accent-red) 240deg 360deg\n    );\n    box-shadow: 0 0 15px rgba(57, 255, 20, 0.4);\n    animation: pie-spin 10s linear infinite;\n}\n\n@keyframes pie-spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n\n/* Main Content Area */\n.main-content {\n    margin-left: 70px;\n    min-height: 100vh;\n    padding: 2rem;\n    transition: margin-left 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    position: relative;\n}\n\n/* Backdrop overlay for preview panel */\n.preview-backdrop {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    background: rgba(0, 0, 0, 0.4);\n    backdrop-filter: blur(2px);\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    z-index: 9998;\n    pointer-events: none;\n}\n\n.preview-backdrop.show {\n    opacity: 1;\n    visibility: visible;\n}\n\n/* View Containers */\n.view-container {\n    display: none;\n    animation: fadeIn 0.4s ease-in-out;\n}\n\n.view-container.active {\n    display: block;\n}\n\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n        transform: translateY(10px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n/* Dashboard Header */\n.dashboard-header {\n    text-align: center;\n    margin-bottom: 2.5rem;\n}\n\n.header-content h1 {\n    font-size: 2.5rem;\n    margin-bottom: 0.5rem;\n    color: var(--accent-green);\n    font-weight: 700;\n    letter-spacing: 2px;\n}\n\n.header-content .subtitle {\n    font-size: 1.2rem;\n    color: var(--text-secondary);\n    font-weight: 500;\n}\n\n.pulse-icon {\n    display: inline-block;\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n@keyframes pulse-scale {\n    0%, 100% {\n        transform: scale(1);\n        filter: drop-shadow(0 0 5px var(--success-glow));\n    }\n    50% {\n        transform: scale(1.05);\n        filter: drop-shadow(0 0 15px var(--success-glow));\n    }\n}\n\n/* Animations */\n.animate-slide-in {\n    animation: slideIn 0.6s ease-out;\n}\n\n@keyframes slideIn {\n    from {\n        opacity: 0;\n        transform: translateX(-30px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n.animate-fade-in {\n    animation: fadeInUp 0.6s ease-out;\n}\n\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.container {\n    max-width: 1400px;\n    margin: 0 auto;\n}\n\n/* Theme Toggle Button */\n.theme-toggle {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    background: rgba(15, 15, 15, 0.85);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50px;\n    padding: 10px 20px;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    font-size: 1rem;\n    color: var(--text-primary);\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px rgba(57, 255, 20, 0.2);\n    font-weight: 600;\n}\n\n.theme-toggle:hover {\n    background: rgba(15, 15, 15, 0.8);\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.theme-toggle .icon {\n    font-size: 1.2rem;\n}\n\n/* Auto-scroll indicators */\n.scroll-indicator {\n    position: fixed;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 60px;\n    height: 60px;\n    background: rgba(57, 255, 20, 0.15);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 2px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    opacity: 0;\n    pointer-events: none;\n    transition: opacity 0.3s ease;\n    z-index: 10001;\n}\n\n.scroll-indicator.visible {\n    opacity: 1;\n    animation: scroll-pulse 1.5s ease-in-out infinite;\n}\n\n.scroll-indicator.scroll-up {\n    top: 20px;\n}\n\n.scroll-indicator.scroll-down {\n    bottom: 20px;\n}\n\n.scroll-indicator i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    animation: scroll-bounce 1s ease-in-out infinite;\n}\n\n.scroll-up i {\n    animation-name: scroll-bounce-up;\n}\n\n.scroll-down i {\n    animation-name: scroll-bounce-down;\n}\n\n@keyframes scroll-pulse {\n    0%, 100% {\n        box-shadow: 0 0 10px rgba(57, 255, 20, 0.3);\n    }\n    50% {\n        box-shadow: 0 0 25px rgba(57, 255, 20, 0.6);\n    }\n}\n\n@keyframes scroll-bounce-up {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(-5px);\n    }\n}\n\n@keyframes scroll-bounce-down {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(5px);\n    }\n}\n\n/* Threat Ticker */\n.threat-ticker-container {\n    background: var(--bg-secondary);\n    border: 2px solid var(--accent-green);\n    border-radius: 8px;\n    padding: 12px;\n    margin-bottom: 2rem;\n    display: flex;\n    align-items: center;\n    gap: 16px;\n    overflow: hidden;\n    box-shadow: 0 2px 8px var(--success-glow);\n}\n\n.ticker-label {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 8px 16px;\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    border-radius: 6px;\n    font-weight: 700;\n    font-size: 0.75rem;\n    color: #fff;\n    white-space: nowrap;\n    box-shadow: 0 2px 8px rgba(255, 71, 87, 0.4);\n}\n\n.ticker-label i {\n    animation: pulse-broadcast 2s infinite;\n}\n\n@keyframes pulse-broadcast {\n    0%, 100% { opacity: 1; transform: scale(1); }\n    50% { opacity: 0.6; transform: scale(0.9); }\n}\n\n.threat-ticker {\n    flex: 1;\n    overflow: hidden;\n    position: relative;\n}\n\n.ticker-content {\n    display: flex;\n    gap: 40px;\n    white-space: nowrap;\n    animation: scroll-ticker 30s linear infinite;\n}\n\n.ticker-content:hover {\n    animation-play-state: paused;\n}\n\n@keyframes scroll-ticker {\n    0% { transform: translateX(0); }\n    100% { transform: translateX(-50%); }\n}\n\n.ticker-item {\n    color: #e0e0e0;\n    font-size: 0.9rem;\n    display: inline-flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.ticker-item i {\n    font-size: 0.5rem;\n    animation: blink 1.5s infinite;\n}\n\n@keyframes blink {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.3; }\n}\n\n/* Notification System */\n.notification-container {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    max-width: 400px;\n}\n\n.threat-notification {\n    background: rgba(30, 30, 30, 0.98);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 8px;\n    padding: 16px;\n    display: flex;\n    gap: 12px;\n    align-items: flex-start;\n    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);\n    transform: translateX(450px);\n    opacity: 0;\n    transition: all 0.3s ease-out;\n}\n\n.threat-notification.show {\n    transform: translateX(0);\n    opacity: 1;\n}\n\n.notification-icon {\n    font-size: 1.5rem;\n    flex-shrink: 0;\n}\n\n.notification-content {\n    flex: 1;\n}\n\n.notification-title {\n    font-size: 0.95rem;\n    color: #e0e0e0;\n    margin-bottom: 4px;\n}\n\n.notification-title strong {\n    text-transform: uppercase;\n    font-weight: 800;\n}\n\n.notification-details {\n    font-size: 0.85rem;\n    color: #b0b0b0;\n    margin-bottom: 6px;\n}\n\n.notification-meta {\n    font-size: 0.75rem;\n    color: #888;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.notification-close {\n    cursor: pointer;\n    color: #666;\n    transition: color 0.2s;\n    font-size: 0.9rem;\n}\n\n.notification-close:hover {\n    color: #e0e0e0;\n}\n\n/* Stat Card Pulse Animation */\n.stat-pulse {\n    animation: stat-pulse-animation 0.6s ease-out;\n}\n\n@keyframes stat-pulse-animation {\n    0% { transform: scale(1); }\n    50% { transform: scale(1.05); box-shadow: 0 8px 24px rgba(90, 156, 248, 0.4); }\n    100% { transform: scale(1); }\n}\n\nh1 {\n    font-size: 2.5rem;\n    color: #5a9cf8;\n    margin-bottom: 0.5rem;\n}\n\n.subtitle {\n    color: #888;\n    font-size: 1.1rem;\n}\n\n.stats-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1.5rem;\n    margin-bottom: 3rem;\n}\n\n.stat-card {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 1.5rem;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.8rem;\n    position: relative;\n    overflow: hidden;\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.stat-card::before {\n    content: '';\n    position: absolute;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: radial-gradient(circle, var(--accent-green) 0%, transparent 70%);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover::before {\n    opacity: 0.05;\n}\n\n.stat-card:hover {\n    transform: translateY(-5px) scale(1.02);\n    border-color: var(--accent-green);\n    box-shadow: 0 10px 30px var(--success-glow);\n}\n\n.stat-card i {\n    font-size: 2.5rem;\n    opacity: 0.8;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover i {\n    transform: scale(1.1) rotateY(180deg);\n    opacity: 1;\n}\n\n.stat-number {\n    font-size: 2.5rem;\n    font-weight: 700;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover .stat-number {\n    transform: scale(1.1);\n    text-shadow: 0 0 20px currentColor;\n}\n\n.stat-label {\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n    font-weight: 600;\n}\n\n.stat-glow {\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    height: 3px;\n    background: linear-gradient(90deg, transparent, var(--accent-green), transparent);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover .stat-glow {\n    opacity: 1;\n    animation: glowSlide 2s ease-in-out infinite;\n}\n\n@keyframes glowSlide {\n    0%, 100% {\n        transform: translateX(-100%);\n    }\n    50% {\n        transform: translateX(100%);\n    }\n}\n\n.stat-card.malware {\n    border-color: rgba(255, 59, 59, 0.3);\n}\n\n.stat-card.malware i,\n.stat-card.malware .stat-number {\n    color: var(--accent-red);\n}\n\n.stat-card.malware:hover {\n    border-color: var(--accent-red);\n    box-shadow: 0 10px 30px var(--danger-glow);\n}\n\n.stat-card.suspicious {\n    border-color: rgba(255, 215, 0, 0.3);\n}\n\n.stat-card.suspicious i,\n.stat-card.suspicious .stat-number {\n    color: var(--accent-yellow);\n}\n\n.stat-card.suspicious:hover {\n    border-color: var(--accent-yellow);\n    box-shadow: 0 10px 30px var(--warning-glow);\n}\n\n.stat-card.benign i,\n.stat-card.benign .stat-number,\n.stat-card.info i,\n.stat-card.info .stat-number {\n    color: var(--accent-green);\n}\n\n/* Analytics View */\n.analytics-header {\n    display: flex;\n    align-items: center;\n    gap: 2rem;\n    margin-bottom: 2.5rem;\n}\n\n.back-btn {\n    background: var(--bg-card);\n    border: 2px solid var(--accent-green);\n    color: var(--accent-green);\n    padding: 0.8rem 1.5rem;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 600;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    transition: all 0.3s ease;\n}\n\n.back-btn:hover {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    transform: translateX(-5px);\n    box-shadow: 0 5px 20px var(--success-glow);\n}\n\n.analytics-header h1 {\n    font-size: 2rem;\n    color: var(--accent-green);\n    font-weight: 700;\n}\n\n.analytics-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));\n    gap: 2rem;\n    max-height: calc(100vh - 200px);\n    overflow-y: auto;\n    padding-right: 1rem;\n    grid-auto-flow: dense;\n}\n\n/* Panel size classes for flexible tiling */\n.analytics-panel.panel-small {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-medium {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-large {\n    grid-column: span 2;\n}\n\n@media (max-width: 1400px) {\n    .analytics-grid {\n        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));\n    }\n    \n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n}\n\n.analytics-grid::-webkit-scrollbar {\n    width: 8px;\n}\n\n.analytics-grid::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb:hover {\n    background: var(--accent-green-dim);\n}\n\n.analytics-panel {\n    animation: slideInPanel 0.5s ease-out;\n    animation-fill-mode: backwards;\n}\n\n.analytics-panel:nth-child(1) { animation-delay: 0.05s; }\n.analytics-panel:nth-child(2) { animation-delay: 0.1s; }\n.analytics-panel:nth-child(3) { animation-delay: 0.15s; }\n.analytics-panel:nth-child(4) { animation-delay: 0.2s; }\n.analytics-panel:nth-child(5) { animation-delay: 0.25s; }\n.analytics-panel:nth-child(6) { animation-delay: 0.3s; }\n\n@keyframes slideInPanel {\n    from {\n        opacity: 0;\n        transform: translateY(30px) scale(0.95);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n    }\n}\n\n/* Advanced Analytics Grid for Mini Charts */\n.advanced-analytics-grid {\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 12px;\n    padding: 1.5rem;\n}\n\n.mini-charts-grid {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 1.5rem;\n    margin-top: 1rem;\n}\n\n.mini-chart-container {\n    background: rgba(10, 10, 10, 0.6);\n    border: 1px solid rgba(57, 255, 20, 0.15);\n    border-radius: 8px;\n    padding: 1rem;\n}\n\n.mini-chart-container h3 {\n    color: var(--accent-green);\n    font-size: 0.95rem;\n    margin: 0 0 0.75rem 0;\n    font-weight: 600;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.mini-chart-container h3 i {\n    font-size: 0.9rem;\n}\n\n@media (max-width: 1200px) {\n    .mini-charts-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n/* Emerging Threat Intelligence Panel */\n.eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.1) 0%, rgba(255, 165, 2, 0.1) 100%);\n    border: 2px solid rgba(255, 71, 87, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(255, 71, 87, 0.2);\n}\n\n.eti-header {\n    margin-bottom: 24px;\n}\n\n.eti-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #ff6b6b;\n    text-shadow: 0 2px 4px rgba(255, 71, 87, 0.3);\n}\n\n.eti-header h2 i {\n    color: #ff4757;\n    margin-right: 10px;\n    animation: pulse 2s infinite;\n}\n\n@keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.6; }\n}\n\n.eti-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 8px 0 16px 0;\n}\n\n.eti-summary {\n    display: flex;\n    gap: 12px;\n    flex-wrap: wrap;\n}\n\n.eti-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 6px 14px;\n    border-radius: 20px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.eti-badge.recent {\n    background: rgba(255, 71, 87, 0.2);\n    border-color: rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.eti-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n    gap: 20px;\n}\n\n.eti-panel {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 18px;\n    transition: transform 0.3s, box-shadow 0.3s;\n}\n\n.eti-panel:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);\n}\n\n.eti-panel h3 {\n    margin: 0 0 6px 0;\n    font-size: 1.1rem;\n    color: #e0e0e0;\n}\n\n.eti-panel h3 i {\n    color: #ffa502;\n    margin-right: 8px;\n}\n\n.eti-subtitle-small {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 14px;\n}\n\n.eti-list {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n}\n\n.eti-item {\n    display: flex;\n    gap: 12px;\n    background: rgba(255, 255, 255, 0.03);\n    border: 1px solid rgba(255, 255, 255, 0.08);\n    border-radius: 8px;\n    padding: 12px;\n    transition: all 0.3s;\n}\n\n.eti-item:hover {\n    background: rgba(255, 255, 255, 0.06);\n    border-color: rgba(255, 165, 2, 0.4);\n    transform: translateX(4px);\n}\n\n.eti-rank {\n    flex-shrink: 0;\n    width: 32px;\n    height: 32px;\n    background: linear-gradient(135deg, #ff6b6b, #ffa502);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: bold;\n    font-size: 1rem;\n    color: #fff;\n    box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);\n}\n\n.eti-item[data-rank=\"1\"] .eti-rank {\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    transform: scale(1.1);\n}\n\n.eti-content {\n    flex: 1;\n    min-width: 0;\n}\n\n.eti-name {\n    font-weight: 600;\n    color: #e0e0e0;\n    font-size: 0.95rem;\n    margin-bottom: 4px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-meta {\n    display: flex;\n    gap: 8px;\n    flex-wrap: wrap;\n    align-items: center;\n}\n\n.eti-count {\n    color: #888;\n    font-size: 0.8rem;\n}\n\n.eti-recent-badge {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-agent-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-details {\n    margin-top: 6px;\n    color: #999;\n    font-size: 0.75rem;\n    font-style: italic;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-empty {\n    text-align: center;\n    color: #666;\n    padding: 20px;\n    font-style: italic;\n}\n\n/* Threat Modeler */\n.modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.1) 0%, rgba(38, 222, 129, 0.1) 100%);\n    border: 2px solid rgba(90, 156, 248, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(90, 156, 248, 0.2);\n}\n\n.modeler-header {\n    margin-bottom: 24px;\n}\n\n.modeler-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #5a9cf8;\n}\n\n.modeler-header h2 i {\n    color: #26de81;\n    margin-right: 10px;\n}\n\n.modeler-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 0;\n}\n\n.modeler-grid {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 24px;\n}\n\n@media (max-width: 1024px) {\n    .modeler-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n.modeler-builder,\n.modeler-results {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 20px;\n}\n\n.modeler-builder h3,\n.modeler-results h3 {\n    margin: 0 0 20px 0;\n    font-size: 1.2rem;\n    color: #e0e0e0;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n    padding-bottom: 10px;\n}\n\n.modeler-builder h3 i {\n    color: #26de81;\n    margin-right: 8px;\n}\n\n.modeler-results h3 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.modeler-field {\n    margin-bottom: 20px;\n}\n\n.modeler-field label {\n    display: block;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n    margin-bottom: 6px;\n    font-weight: 600;\n}\n\n.modeler-select {\n    width: 100%;\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.2);\n    border-radius: 6px;\n    color: #e0e0e0;\n    padding: 10px;\n    font-size: 0.9rem;\n    font-family: inherit;\n    cursor: pointer;\n    transition: all 0.3s;\n}\n\n.modeler-select:focus {\n    outline: none;\n    border-color: #5a9cf8;\n    background: rgba(90, 156, 248, 0.1);\n}\n\n.modeler-select option {\n    background: #1a1a2e;\n    color: #e0e0e0;\n    padding: 8px;\n}\n\n.modeler-hint {\n    display: block;\n    color: #666;\n    font-size: 0.75rem;\n    margin-top: 4px;\n    font-style: italic;\n}\n\n.modeler-analyze-btn {\n    width: 100%;\n    background: linear-gradient(135deg, #26de81, #20bf6b);\n    border: none;\n    color: #fff;\n    padding: 14px 24px;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 700;\n    cursor: pointer;\n    transition: all 0.3s;\n    box-shadow: 0 4px 12px rgba(38, 222, 129, 0.3);\n}\n\n.modeler-analyze-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(38, 222, 129, 0.4);\n}\n\n.modeler-analyze-btn i {\n    margin-right: 8px;\n}\n\n.modeler-output {\n    min-height: 400px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.modeler-placeholder {\n    text-align: center;\n    color: #666;\n}\n\n.modeler-placeholder i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n    opacity: 0.5;\n}\n\n.modeler-placeholder p {\n    font-size: 0.95rem;\n}\n\n.modeler-loading {\n    text-align: center;\n    color: #5a9cf8;\n}\n\n.modeler-loading i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.modeler-error {\n    text-align: center;\n    color: #ff4757;\n}\n\n.modeler-error i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.prediction-result {\n    width: 100%;\n}\n\n.prediction-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 24px;\n    padding: 20px;\n    background: rgba(255, 255, 255, 0.05);\n    border-radius: 8px;\n}\n\n.prediction-badge {\n    padding: 12px 24px;\n    border-radius: 8px;\n    font-size: 1.3rem;\n    font-weight: 800;\n    color: #fff;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n\n.prediction-confidence {\n    text-align: right;\n}\n\n.confidence-label {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 4px;\n}\n\n.confidence-value {\n    color: #5a9cf8;\n    font-size: 2rem;\n    font-weight: 800;\n}\n\n.prediction-family {\n    padding: 16px;\n    background: rgba(255, 71, 87, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 6px;\n    margin-bottom: 20px;\n    color: #e0e0e0;\n}\n\n.family-name {\n    color: #ff6b6b;\n    font-weight: 700;\n    font-size: 1.1rem;\n    margin-left: 8px;\n}\n\n.prediction-section {\n    margin-bottom: 20px;\n}\n\n.prediction-section h4 {\n    color: #5a9cf8;\n    font-size: 1rem;\n    margin: 0 0 12px 0;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 6px;\n}\n\n.analysis-item {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    padding: 8px 0;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n}\n\n.analysis-item i {\n    color: #ffa502;\n    width: 20px;\n}\n\n.indicator-group {\n    margin-bottom: 16px;\n}\n\n.indicator-group strong {\n    display: block;\n    color: #e0e0e0;\n    margin-bottom: 8px;\n    font-size: 0.9rem;\n}\n\n.indicator-list {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 8px;\n}\n\n.indicator-tag {\n    padding: 6px 12px;\n    border-radius: 6px;\n    font-size: 0.8rem;\n    font-weight: 600;\n    font-family: 'Courier New', monospace;\n}\n\n.api-tag {\n    background: rgba(255, 165, 2, 0.2);\n    border: 1px solid rgba(255, 165, 2, 0.4);\n    color: #ffa502;\n}\n\n.string-tag {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.prediction-footer {\n    margin-top: 20px;\n    padding: 12px;\n    background: rgba(90, 156, 248, 0.1);\n    border-radius: 6px;\n    color: #5a9cf8;\n    font-size: 0.85rem;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.scans-container {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 2rem;\n    transition: all 0.3s ease;\n}\n\n.scans-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--shadow-color);\n}\n\n.scans-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.scans-header h2 {\n    color: #5a9cf8;\n}\n\n.refresh-btn {\n    background: #5a9cf8;\n    color: white;\n    border: none;\n    padding: 0.75rem 1.5rem;\n    border-radius: 8px;\n    cursor: pointer;\n    font-size: 1rem;\n    transition: background 0.2s;\n}\n\n.refresh-btn:hover {\n    background: #4a8ce8;\n}\n\n.scans-table {\n    width: 100%;\n    border-collapse: collapse;\n}\n\n.scans-table th {\n    text-align: left;\n    padding: 1rem;\n    background: rgba(255, 255, 255, 0.05);\n    color: #5a9cf8;\n    font-weight: 600;\n}\n\n.scans-table td {\n    padding: 1rem;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.scans-table tr:hover {\n    background: rgba(255, 255, 255, 0.03);\n}\n\n.badge {\n    display: inline-block;\n    padding: 0.3rem 0.8rem;\n    border-radius: 6px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.badge.malware { background: #ff4757; color: white; }\n.badge.suspicious { background: #ffa502; color: white; }\n.badge.benign { background: #26de81; color: white; }\n.badge.non-pe { background: #4b5563; color: #fff; }\n\n.hash {\n    font-family: 'Courier New', monospace;\n    font-size: 0.85rem;\n    color: #888;\n}\n\n.empty-state {\n    text-align: center;\n    padding: 3rem;\n    color: #666;\n}\n\n.empty-state i {\n    font-size: 4rem;\n    margin-bottom: 1rem;\n    opacity: 0.3;\n}\n\n/* NEW: Chart Container Styles */\n.chart-container {\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 12px;\n    padding: 2rem;\n    margin-top: 2rem;\n}\n\n.chart-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.chart-header h2 {\n    color: var(--accent-green);\n    margin: 0;\n}\n\n.chart-subtitle {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    margin: 0.5rem 0 0 0;\n    font-weight: normal;\n}\n\n.chart-controls {\n    display: flex;\n    gap: 0.5rem;\n}\n\n.chart-btn {\n    background: rgba(255, 255, 255, 0.05);\n    color: #888;\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    padding: 0.5rem 1rem;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.2s;\n}\n\n.chart-btn:hover {\n    background: rgba(255, 255, 255, 0.1);\n    color: #e0e0e0;\n}\n\n.chart-btn.active {\n    background: #5a9cf8;\n    color: white;\n    border-color: #5a9cf8;\n}\n\n#dailyScansChart {\n    max-height: 400px;\n}\n\n@media (max-width: 1024px) {\n    .analytics-grid {\n        grid-template-columns: 1fr;\n        gap: 1.5rem;\n    }\n    \n    .analytics-panel.panel-small,\n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n    \n    .graphs-preview {\n        width: 400px;\n    }\n}\n\n@media (max-width: 768px) {\n    .main-content {\n        margin-left: 0;\n        padding: 1rem;\n    }\n    \n    .side-panel {\n        width: 50px;\n    }\n    \n    .panel-logo-icon {\n        width: 40px;\n        height: 40px;\n        font-size: 1.5rem;\n    }\n    \n    .graphs-preview {\n        left: 50px;\n        width: calc(100vw - 50px);\n        border-radius: 0;\n    }\n    \n    .dashboard-header h1 {\n        font-size: 1.8rem;\n    }\n    \n    .stats-grid {\n        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n        gap: 1rem;\n    }\n    \n    .chart-header {\n        flex-direction: column;\n        gap: 1rem;\n        align-items: flex-start;\n    }\n    \n    .chart-controls {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .chart-btn {\n        flex: 1;\n    }\n    \n    .map-view-toggle {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .map-btn {\n        flex: 1;\n        font-size: 0.8rem;\n        padding: 0.4rem 0.6rem;\n    }\n    \n    .geo-context-panel {\n        flex-direction: column;\n    }\n    \n    .context-stat {\n        width: 100%;\n    }\n    \n    .map-timeline-control {\n        flex-direction: column;\n        gap: 0.5rem;\n    }\n    \n    .timeline-info {\n        text-align: center;\n    }\n    \n    .analytics-header {\n        flex-direction: column;\n        align-items: flex-start;\n    }\n}\n\n/* Map Container */\n.map-container {\n    background: var(--bg-card);\n    border-radius: 12px;\n    padding: 24px;\n    box-shadow: 0 4px 12px var(--shadow-color);\n    border: 2px solid var(--border-color);\n    transition: all 0.3s ease;\n    min-height: 600px;\n}\n\n.map-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 8px 24px var(--shadow-color), 0 0 20px var(--success-glow);\n}\n\n#worldMap {\n    width: 100%;\n    height: 500px;\n    border-radius: 8px;\n    margin-bottom: 15px;\n    background: var(--bg-secondary);\n    border: 1px solid var(--border-color);\n    z-index: 1;\n    position: relative;\n}\n\n.map-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 20px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.map-header h2 {\n    margin: 0;\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-header h2 i {\n    color: var(--accent-green);\n    margin-right: 8px;\n}\n\n.map-controls {\n    display: flex;\n    gap: 20px;\n    align-items: center;\n    flex-wrap: wrap;\n}\n\n.map-view-toggle {\n    display: flex;\n    gap: 8px;\n    background: var(--bg-secondary);\n    padding: 4px;\n    border-radius: 8px;\n    border: 1px solid var(--border-color);\n}\n\n.map-btn {\n    background: transparent;\n    border: none;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.map-btn:hover {\n    background: var(--bg-hover);\n    color: var(--text-primary);\n}\n\n.map-btn.active {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    box-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-btn i {\n    font-size: 1rem;\n}\n\n.map-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.legend-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n}\n\n.legend-dot {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    box-shadow: 0 0 6px currentColor;\n}\n\n.malware-dot {\n    background-color: var(--accent-red);\n}\n\n.suspicious-dot {\n    background-color: var(--accent-yellow);\n}\n\n.benign-dot {\n    background-color: var(--accent-green);\n}\n\n.geo-context-panel {\n    display: flex;\n    justify-content: space-around;\n    gap: 20px;\n    padding: 15px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-bottom: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.context-stat {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 5px;\n}\n\n.context-label {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.context-value {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.context-value.threat-count {\n    color: var(--accent-red);\n    text-shadow: 0 0 10px var(--danger-glow);\n}\n\n.map-timeline-control {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 12px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-top: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.timeline-btn {\n    background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-green-dim) 100%);\n    color: var(--bg-primary);\n    border: none;\n    padding: 10px 20px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.95rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    box-shadow: 0 4px 12px var(--success-glow);\n}\n\n.timeline-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px var(--success-glow);\n    filter: brightness(1.1);\n}\n\n.timeline-btn i {\n    font-size: 1rem;\n}\n\n.timeline-info {\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-style: italic;\n}\n\n#worldMap {\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n}\n\n/* Leaflet popup customization for theme */\n.leaflet-popup-content-wrapper {\n    background: var(--bg-card) !important;\n    color: var(--text-primary) !important;\n    border: 2px solid var(--accent-green) !important;\n    box-shadow: 0 4px 15px var(--shadow-color) !important;\n    border-radius: 8px !important;\n}\n\n.leaflet-popup-tip {\n    background: var(--bg-card) !important;\n}\n\n.leaflet-popup-content h3 {\n    color: var(--accent-green) !important;\n}\n\n.leaflet-popup-content button {\n    background: var(--accent-green) !important;\n    color: var(--bg-primary) !important;\n    border: none !important;\n    padding: 8px 16px !important;\n    border-radius: 6px !important;\n    cursor: pointer !important;\n    font-weight: 600 !important;\n    transition: all 0.2s ease !important;\n}\n\n.leaflet-popup-content button:hover {\n    transform: translateY(-2px) !important;\n    box-shadow: 0 4px 12px var(--success-glow) !important;\n}\n\n/* Correlation Graph */\n.correlation-container {\n    background: rgba(255, 255, 255, 0.03);\n    border-radius: 12px;\n    padding: 24px;\n    margin-top: 24px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.correlation-header {\n    margin-bottom: 20px;\n}\n\n.correlation-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.5rem;\n    color: #e0e0e0;\n}\n\n.correlation-header h2 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.correlation-subtitle {\n    color: #888;\n    font-size: 0.9rem;\n    margin: 0;\n}\n\n.graph-controls {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 16px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.graph-btn {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.3s;\n}\n\n.graph-btn:hover {\n    background: rgba(90, 156, 248, 0.3);\n    border-color: #5a9cf8;\n}\n\n.graph-btn i {\n    margin-right: 6px;\n}\n\n.graph-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.node-sample {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    border: 2px solid #fff;\n}\n\n.malware-node {\n    background-color: #ff4757;\n}\n\n.agent-node {\n    background-color: #5a9cf8;\n}\n\n.api-node {\n    background-color: #ffa502;\n}\n\n.string-node {\n    background-color: #26de81;\n}\n\n#correlationGraph {\n    width: 100%;\n    min-height: 600px;\n    position: relative;\n    border-radius: 8px;\n    overflow: hidden;\n}\n\n.node-details {\n    position: absolute;\n    right: 24px;\n    top: 120px;\n    background: rgba(30, 30, 30, 0.95);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    border-radius: 8px;\n    padding: 16px;\n    max-width: 300px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    z-index: 1000;\n}\n\n.node-details h3 {\n    margin: 0 0 12px 0;\n    color: #5a9cf8;\n    font-size: 1.1rem;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 8px;\n}\n\n.node-details p {\n    margin: 8px 0;\n    color: #e0e0e0;\n    font-size: 0.9rem;\n}\n\n.node-details ul {\n    color: #b0b0b0;\n    font-size: 0.85rem;\n}\n\n.node-details li {\n    margin: 4px 0;\n}\n\n/* ========================================\n   LIGHT THEME CONTRAST FIXES\n   ======================================== */\n\n/* Fix 1 & 2: Analytics preview backgrounds - lighter for better green contrast */\n[data-theme=\"light\"] .eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.05) 0%, rgba(255, 165, 2, 0.05) 100%);\n    border-color: rgba(255, 71, 87, 0.2);\n}\n\n[data-theme=\"light\"] .modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.05) 0%, rgba(38, 222, 129, 0.05) 100%);\n    border-color: rgba(90, 156, 248, 0.2);\n}\n\n/* Fix 3: Theme toggle button text - darker for contrast */\n[data-theme=\"light\"] .theme-toggle {\n    color: #1a1f2e;\n    background: rgba(255, 255, 255, 0.8);\n    border-color: rgba(46, 214, 15, 0.4);\n}\n\n/* Fix 4: Daily Analysis chart - darker labels and grid (handled in JS via CSS vars) */\n[data-theme=\"light\"] {\n    --chart-text-color: #374151;\n    --chart-grid-color: rgba(0, 0, 0, 0.12);\n}\n\n:root {\n    --chart-text-color: #9ca3af;\n    --chart-grid-color: rgba(255, 255, 255, 0.1);\n}\n\n/* Fix 5: Chart container labels - darker in light theme */\n[data-theme=\"light\"] .chart-header h2,\n[data-theme=\"light\"] .chart-header {\n    color: #1a1f2e;\n}\n\n/* Fix 6: Threat Vector Correlation header - darker */\n[data-theme=\"light\"] .correlation-header h2 {\n    color: #1a1f2e;\n}\n\n[data-theme=\"light\"] .correlation-subtitle {\n    color: #4a5568;\n}\n\n/* Fix 7: ETI subtitle and summary - darker for better contrast */\n[data-theme=\"light\"] .eti-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .eti-summary {\n    color: #374151;\n}\n\n/* Fix 8: Prediction labels in threat modeler - darker */\n[data-theme=\"light\"] .modeler-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .modeler-field label {\n    color: #374151;\n}\n\n[data-theme=\"light\"] .modeler-hint {\n    color: #6b7280;\n}\n\n/* Fix 9: Analytics preview backgrounds - much lighter for green text visibility */\n[data-theme=\"light\"] .preview-box {\n    background: rgba(255, 255, 255, 0.6);\n    border-color: rgba(46, 214, 15, 0.3);\n}\n\n/* Fix 10: ETI item text - lighter for better readability */\n[data-theme=\"light\"] .eti-count {\n    color: #6b7280;\n}\n\n[data-theme=\"light\"] .eti-details {\n    color: #9ca3af;\n}\n\n[data-theme=\"light\"] .eti-name {\n    color: #1f2937;\n}\n\n/* Fix 11: Make ETI details much more visible in light theme */\n[data-theme=\"light\"] .eti-details {\n    color: #5a9cf8;\n    font-weight: 500;\n}\n\n/* Fix 12: Threat ticker text visibility in light theme */\n[data-theme=\"light\"] .ticker-item {\n    color: #374151;\n    font-weight: 500;\n}\n\n/* Back to Top Button */\n.back-to-top {\n    position: fixed;\n    bottom: 30px;\n    right: 30px;\n    width: 50px;\n    height: 50px;\n    background: linear-gradient(135deg, var(--accent-green), var(--accent-green-dim));\n    border: 2px solid var(--accent-green);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    z-index: 9998;\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px var(--success-glow);\n    color: #000;\n    font-size: 1.2rem;\n}\n\n.back-to-top.visible {\n    opacity: 1;\n    visibility: visible;\n}\n\n.back-to-top:hover {\n    transform: translateY(-5px) scale(1.1);\n    box-shadow: 0 6px 30px var(--success-glow);\n}\n\n.back-to-top:active {\n    transform: translateY(-2px) scale(1.05);\n}\n\n[data-theme=\"light\"] .back-to-top {\n    background: linear-gradient(135deg, #2ed60f, #27b00c);\n    color: #fff;\n}\n","range":{"startLineNumber":1,"startColumn":1,"endLineNumber":2536,"endColumn":1}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/styles.css","external":"file:///home/trang/localnsv/mAIware-server/public/styles.css","path":"/home/trang/localnsv/mAIware-server/public/styles.css","scheme":"file"},"requestId":"request_4e420508-80ce-43b8-82a1-fed6912f3e58","epoch":18,"edits":[{"text":":root {\n    --bg-primary: #000000;\n    --bg-secondary: #0a0a0a;\n    --bg-card: #0f0f0f;\n    --bg-hover: #151515;\n    --text-primary: #e8f0e8;\n    --text-secondary: #9ca3af;\n    --accent-green: #39ff14;\n    --accent-green-dim: #2ed60f;\n    --accent-yellow: #ffd700;\n    --accent-red: #ff3b3b;\n    --accent-red-dim: #cc2f2f;\n    --border-color: #1a1a1a;\n    --shadow-color: rgba(0, 0, 0, 0.5);\n    --success-glow: rgba(57, 255, 20, 0.3);\n    --danger-glow: rgba(255, 59, 59, 0.3);\n    --warning-glow: rgba(255, 215, 0, 0.3);\n    /* Chart theming */\n    --chart-text-color: #9ca3af;\n    --chart-grid-color: rgba(255, 255, 255, 0.1);\n}\n\n[data-theme=\"light\"] {\n    --bg-primary: #f0f4f0;\n    --bg-secondary: #ffffff;\n    --bg-card: #fafafa;\n    --bg-hover: #e8f5e8;\n    --text-primary: #1a1f2e;\n    --text-secondary: #4a5568;\n    --accent-green: #2ed60f;\n    --accent-green-dim: #27b00c;\n    --accent-yellow: #cc9a00;\n    --accent-red: #dc2626;\n    --accent-red-dim: #b91c1c;\n    --border-color: #d1d5db;\n    --shadow-color: rgba(0, 0, 0, 0.1);\n    --success-glow: rgba(46, 214, 15, 0.2);\n    --danger-glow: rgba(220, 38, 38, 0.2);\n    --warning-glow: rgba(204, 154, 0, 0.2);\n    --chart-text-color: #374151; /* higher contrast for light theme */\n    --chart-grid-color: rgba(0, 0, 0, 0.12);\n}\n\n* { \n    margin: 0; \n    padding: 0; \n    box-sizing: border-box; \n}\n\nbody {\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    background: var(--bg-primary);\n    color: var(--text-primary);\n    min-height: 100vh;\n    margin: 0;\n    overflow-x: hidden;\n    position: relative;\n}\n\nbody::before {\n    content: '';\n    position: fixed;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: \n        radial-gradient(circle at 20% 50%, rgba(57, 255, 20, 0.08) 0%, transparent 50%),\n        radial-gradient(circle at 80% 80%, rgba(57, 255, 20, 0.06) 0%, transparent 50%),\n        radial-gradient(circle at 40% 20%, rgba(57, 255, 20, 0.05) 0%, transparent 50%);\n    animation: backgroundGlow 15s ease-in-out infinite;\n    pointer-events: none;\n    z-index: 0;\n}\n\n@keyframes backgroundGlow {\n    0%, 100% { \n        transform: translate(0, 0) scale(1);\n        opacity: 0.4;\n    }\n    33% { \n        transform: translate(10%, 10%) scale(1.1);\n        opacity: 0.6;\n    }\n    66% { \n        transform: translate(-10%, 5%) scale(0.95);\n        opacity: 0.5;\n    }\n}\n\nbody > * {\n    position: relative;\n    z-index: 1;\n}\n\n/* Side Panel Navigation */\n.side-panel {\n    position: fixed;\n    left: 0;\n    top: 0;\n    height: 100vh;\n    width: 70px;\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border-right: 1px solid rgba(57, 255, 20, 0.2);\n    box-shadow: 0 0 30px rgba(57, 255, 20, 0.1);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    z-index: 9999;\n    transition: all 0.3s ease;\n}\n\n.side-panel:hover {\n    background: rgba(15, 15, 15, 0.8);\n    box-shadow: 0 0 40px rgba(57, 255, 20, 0.2);\n}\n\n.panel-icon-strip {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 2rem 0;\n}\n\n.panel-logo-icon {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 50px;\n    height: 50px;\n    color: var(--accent-green);\n    font-size: 2rem;\n    animation: pulse-glow 3s ease-in-out infinite;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.panel-logo-icon:hover {\n    transform: scale(1.1);\n    filter: drop-shadow(0 0 20px var(--success-glow));\n}\n\n@keyframes pulse-glow {\n    0%, 100% { filter: drop-shadow(0 0 5px var(--success-glow)); }\n    50% { filter: drop-shadow(0 0 15px var(--success-glow)) drop-shadow(0 0 25px var(--success-glow)); }\n}\n\n/* Graphs Preview Grid */\n.graphs-preview {\n    position: fixed;\n    left: 70px;\n    top: 50%;\n    transform: translateY(-50%) translateX(-100%);\n    background: rgba(10, 10, 10, 0.92);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-left: none;\n    border-radius: 0 12px 12px 0;\n    padding: 2rem;\n    width: 480px;\n    max-height: 90vh;\n    overflow-y: auto;\n    opacity: 0;\n    visibility: hidden;\n    pointer-events: none;\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease, visibility 0.3s;\n    box-shadow: 5px 0 40px rgba(57, 255, 20, 0.15);\n    z-index: 9998;\n    will-change: transform, opacity;\n}\n\n.graphs-preview::-webkit-scrollbar {\n    width: 6px;\n}\n\n.graphs-preview::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 3px;\n}\n\n.graphs-preview::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 3px;\n}\n\n.graphs-preview.show {\n    opacity: 1;\n    visibility: visible;\n    pointer-events: auto;\n    transform: translateY(-50%) translateX(0);\n}\n\n.preview-header {\n    margin-bottom: 1rem;\n    padding-bottom: 0.8rem;\n    border-bottom: 1px solid var(--border-color);\n}\n\n.preview-header h3 {\n    color: var(--accent-green);\n    font-size: 1.1rem;\n    margin-bottom: 0.3rem;\n}\n\n.preview-header p {\n    color: var(--text-secondary);\n    font-size: 0.85rem;\n}\n\n/* Analytics Miniview - Scaled down live view */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-content {\n    width: 100%;\n    height: 100%;\n    transform-origin: top left;\n    transform: scale(0.25);\n    width: 400%;\n    height: 400%;\n    pointer-events: none;\n    overflow: hidden;\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n.preview-home-nav {\n    margin-top: 1.5rem;\n    padding: 1rem;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 10px;\n    display: flex;\n    align-items: center;\n    gap: 0.8rem;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    opacity: 0;\n    visibility: hidden;\n    transform: translateY(10px);\n}\n\n.preview-home-nav.visible {\n    opacity: 1;\n    visibility: visible;\n    transform: translateY(0);\n}\n\n.preview-home-nav:hover {\n    background: var(--bg-hover);\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.preview-home-nav i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n}\n\n.preview-home-nav span {\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--text-primary);\n}\n\n.preview-label {\n    flex: 1;\n    font-size: 0.95rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    letter-spacing: 0.3px;\n}\n\n/* Analytics Miniview - Screenshot preview */\n.analytics-miniview {\n    position: relative;\n    width: 100%;\n    height: 70vh;\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n    border-radius: 8px;\n    overflow: hidden;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    padding: 1.5rem;\n}\n\n.analytics-miniview:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n}\n\n.miniview-preview {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    opacity: 0.7;\n}\n\n.preview-row {\n    display: flex;\n    gap: 1rem;\n    flex: 1;\n}\n\n.preview-box {\n    flex: 1;\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 6px;\n    position: relative;\n    overflow: hidden;\n    padding: 0.5rem;\n}\n\n.preview-box.large {\n    flex: 2;\n}\n\n.preview-box.wide {\n    flex: 1;\n    min-height: 150px;\n}\n\n.box-header {\n    font-size: 0.65rem;\n    color: var(--accent-green);\n    margin-bottom: 0.5rem;\n    opacity: 0.8;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.box-content {\n    height: calc(100% - 1.5rem);\n    position: relative;\n}\n\n.map-visual {\n    background: radial-gradient(circle at center, rgba(57, 255, 20, 0.05), transparent);\n    position: relative;\n}\n\n.map-dot {\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 10px var(--accent-green);\n    animation: map-pulse 2s ease-in-out infinite;\n}\n\n.map-dot:nth-child(2) { animation-delay: 0.5s; }\n.map-dot:nth-child(3) { animation-delay: 1s; }\n\n@keyframes map-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.6; }\n    50% { transform: scale(1.5); opacity: 1; }\n}\n\n.chart-visual {\n    display: flex;\n    align-items: flex-end;\n    justify-content: space-around;\n    height: 100%;\n    padding: 0.5rem;\n    gap: 0.3rem;\n}\n\n.chart-bar {\n    flex: 1;\n    background: linear-gradient(180deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    animation: bar-grow 2s ease-in-out infinite;\n    opacity: 0.7;\n}\n\n.chart-bar:nth-child(2) { animation-delay: 0.2s; }\n.chart-bar:nth-child(3) { animation-delay: 0.4s; }\n.chart-bar:nth-child(4) { animation-delay: 0.6s; }\n\n@keyframes bar-grow {\n    0%, 100% { transform: scaleY(0.8); }\n    50% { transform: scaleY(1); }\n}\n\n.list-visual {\n    display: flex;\n    flex-direction: column;\n    gap: 0.4rem;\n    padding: 0.3rem;\n}\n\n.list-item {\n    height: 0.4rem;\n    background: linear-gradient(90deg, var(--accent-green), transparent);\n    border-radius: 2px;\n    opacity: 0.6;\n    animation: list-fade 3s ease-in-out infinite;\n}\n\n.list-item:nth-child(2) { animation-delay: 0.5s; width: 80%; }\n.list-item:nth-child(3) { animation-delay: 1s; width: 60%; }\n\n@keyframes list-fade {\n    0%, 100% { opacity: 0.4; }\n    50% { opacity: 0.8; }\n}\n\n.network-visual {\n    position: relative;\n    height: 100%;\n}\n\n.network-node {\n    position: absolute;\n    width: 6px;\n    height: 6px;\n    background: var(--accent-green);\n    border-radius: 50%;\n    box-shadow: 0 0 8px var(--accent-green);\n    animation: node-pulse 3s ease-in-out infinite;\n}\n\n.network-node:nth-child(2) { animation-delay: 0.7s; }\n.network-node:nth-child(3) { animation-delay: 1.4s; }\n\n@keyframes node-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.5; }\n    50% { transform: scale(1.3); opacity: 1; }\n}\n\n.heat-visual {\n    background: \n        radial-gradient(circle at 30% 30%, rgba(57, 255, 20, 0.3), transparent 40%),\n        radial-gradient(circle at 70% 60%, rgba(57, 255, 20, 0.2), transparent 40%),\n        radial-gradient(circle at 50% 80%, rgba(57, 255, 20, 0.25), transparent 40%);\n    animation: heat-shift 4s ease-in-out infinite;\n}\n\n@keyframes heat-shift {\n    0%, 100% { opacity: 0.5; }\n    50% { opacity: 0.8; }\n}\n\n.pie-visual {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n}\n\n.pie-chart {\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    background: conic-gradient(\n        var(--accent-green) 0deg 120deg,\n        var(--accent-yellow) 120deg 240deg,\n        var(--accent-red) 240deg 360deg\n    );\n    box-shadow: 0 0 15px rgba(57, 255, 20, 0.4);\n    animation: pie-spin 10s linear infinite;\n}\n\n@keyframes pie-spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n\n.miniview-overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(10, 14, 20, 0.7);\n    backdrop-filter: blur(1px);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    opacity: 0;\n    transition: opacity 0.3s ease;\n    pointer-events: none;\n}\n\n.analytics-miniview:hover .miniview-overlay {\n    opacity: 1;\n}\n\n.miniview-overlay i {\n    font-size: 3rem;\n    color: var(--accent-green);\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n.miniview-overlay span {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n\n/* Main Content Area */\n.main-content {\n    margin-left: 70px;\n    min-height: 100vh;\n    padding: 2rem;\n    transition: margin-left 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    position: relative;\n}\n\n/* Backdrop overlay for preview panel */\n.preview-backdrop {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    background: rgba(0, 0, 0, 0.4);\n    backdrop-filter: blur(2px);\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    z-index: 9998;\n    pointer-events: none;\n}\n\n.preview-backdrop.show {\n    opacity: 1;\n    visibility: visible;\n}\n\n/* View Containers */\n.view-container {\n    display: none;\n    animation: fadeIn 0.4s ease-in-out;\n}\n\n.view-container.active {\n    display: block;\n}\n\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n        transform: translateY(10px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n/* Dashboard Header */\n.dashboard-header {\n    text-align: center;\n    margin-bottom: 2.5rem;\n}\n\n.header-content h1 {\n    font-size: 2.5rem;\n    margin-bottom: 0.5rem;\n    color: var(--accent-green);\n    font-weight: 700;\n    letter-spacing: 2px;\n}\n\n.header-content .subtitle {\n    font-size: 1.2rem;\n    color: var(--text-secondary);\n    font-weight: 500;\n}\n\n.pulse-icon {\n    display: inline-block;\n    animation: pulse-scale 2s ease-in-out infinite;\n}\n\n@keyframes pulse-scale {\n    0%, 100% {\n        transform: scale(1);\n        filter: drop-shadow(0 0 5px var(--success-glow));\n    }\n    50% {\n        transform: scale(1.05);\n        filter: drop-shadow(0 0 15px var(--success-glow));\n    }\n}\n\n/* Animations */\n.animate-slide-in {\n    animation: slideIn 0.6s ease-out;\n}\n\n@keyframes slideIn {\n    from {\n        opacity: 0;\n        transform: translateX(-30px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n.animate-fade-in {\n    animation: fadeInUp 0.6s ease-out;\n}\n\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.container {\n    max-width: 1400px;\n    margin: 0 auto;\n}\n\n/* Theme Toggle Button */\n.theme-toggle {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    background: rgba(15, 15, 15, 0.85);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n    border: 1px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50px;\n    padding: 10px 20px;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    font-size: 1rem;\n    color: var(--text-primary);\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px rgba(57, 255, 20, 0.2);\n    font-weight: 600;\n}\n\n.theme-toggle:hover {\n    background: rgba(15, 15, 15, 0.8);\n    border-color: var(--accent-green);\n    box-shadow: 0 0 30px var(--success-glow);\n    transform: translateY(-2px);\n}\n\n.theme-toggle .icon {\n    font-size: 1.2rem;\n}\n\n/* Auto-scroll indicators */\n.scroll-indicator {\n    position: fixed;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 60px;\n    height: 60px;\n    background: rgba(57, 255, 20, 0.15);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    border: 2px solid rgba(57, 255, 20, 0.3);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    opacity: 0;\n    pointer-events: none;\n    transition: opacity 0.3s ease;\n    z-index: 10001;\n}\n\n.scroll-indicator.visible {\n    opacity: 1;\n    animation: scroll-pulse 1.5s ease-in-out infinite;\n}\n\n.scroll-indicator.scroll-up {\n    top: 20px;\n}\n\n.scroll-indicator.scroll-down {\n    bottom: 20px;\n}\n\n.scroll-indicator i {\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    animation: scroll-bounce 1s ease-in-out infinite;\n}\n\n.scroll-up i {\n    animation-name: scroll-bounce-up;\n}\n\n.scroll-down i {\n    animation-name: scroll-bounce-down;\n}\n\n@keyframes scroll-pulse {\n    0%, 100% {\n        box-shadow: 0 0 10px rgba(57, 255, 20, 0.3);\n    }\n    50% {\n        box-shadow: 0 0 25px rgba(57, 255, 20, 0.6);\n    }\n}\n\n@keyframes scroll-bounce-up {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(-5px);\n    }\n}\n\n@keyframes scroll-bounce-down {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(5px);\n    }\n}\n\n/* Threat Ticker */\n.threat-ticker-container {\n    background: var(--bg-secondary);\n    border: 2px solid var(--accent-green);\n    border-radius: 8px;\n    padding: 12px;\n    margin-bottom: 2rem;\n    display: flex;\n    align-items: center;\n    gap: 16px;\n    overflow: hidden;\n    box-shadow: 0 2px 8px var(--success-glow);\n}\n\n.ticker-label {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 8px 16px;\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    border-radius: 6px;\n    font-weight: 700;\n    font-size: 0.75rem;\n    color: #fff;\n    white-space: nowrap;\n    box-shadow: 0 2px 8px rgba(255, 71, 87, 0.4);\n}\n\n.ticker-label i {\n    animation: pulse-broadcast 2s infinite;\n}\n\n@keyframes pulse-broadcast {\n    0%, 100% { opacity: 1; transform: scale(1); }\n    50% { opacity: 0.6; transform: scale(0.9); }\n}\n\n.threat-ticker {\n    flex: 1;\n    overflow: hidden;\n    position: relative;\n}\n\n.ticker-content {\n    display: flex;\n    gap: 40px;\n    white-space: nowrap;\n    animation: scroll-ticker 30s linear infinite;\n}\n\n.ticker-content:hover {\n    animation-play-state: paused;\n}\n\n@keyframes scroll-ticker {\n    0% { transform: translateX(0); }\n    100% { transform: translateX(-50%); }\n}\n\n.ticker-item {\n    color: #e0e0e0;\n    font-size: 0.9rem;\n    display: inline-flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.ticker-item i {\n    font-size: 0.5rem;\n    animation: blink 1.5s infinite;\n}\n\n@keyframes blink {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.3; }\n}\n\n/* Notification System */\n.notification-container {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    max-width: 400px;\n}\n\n.threat-notification {\n    background: rgba(30, 30, 30, 0.98);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 8px;\n    padding: 16px;\n    display: flex;\n    gap: 12px;\n    align-items: flex-start;\n    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);\n    transform: translateX(450px);\n    opacity: 0;\n    transition: all 0.3s ease-out;\n}\n\n.threat-notification.show {\n    transform: translateX(0);\n    opacity: 1;\n}\n\n.notification-icon {\n    font-size: 1.5rem;\n    flex-shrink: 0;\n}\n\n.notification-content {\n    flex: 1;\n}\n\n.notification-title {\n    font-size: 0.95rem;\n    color: #e0e0e0;\n    margin-bottom: 4px;\n}\n\n.notification-title strong {\n    text-transform: uppercase;\n    font-weight: 800;\n}\n\n.notification-details {\n    font-size: 0.85rem;\n    color: #b0b0b0;\n    margin-bottom: 6px;\n}\n\n.notification-meta {\n    font-size: 0.75rem;\n    color: #888;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.notification-close {\n    cursor: pointer;\n    color: #666;\n    transition: color 0.2s;\n    font-size: 0.9rem;\n}\n\n.notification-close:hover {\n    color: #e0e0e0;\n}\n\n/* Stat Card Pulse Animation */\n.stat-pulse {\n    animation: stat-pulse-animation 0.6s ease-out;\n}\n\n@keyframes stat-pulse-animation {\n    0% { transform: scale(1); }\n    50% { transform: scale(1.05); box-shadow: 0 8px 24px rgba(90, 156, 248, 0.4); }\n    100% { transform: scale(1); }\n}\n\nh1 {\n    font-size: 2.5rem;\n    color: #5a9cf8;\n    margin-bottom: 0.5rem;\n}\n\n.subtitle {\n    color: #888;\n    font-size: 1.1rem;\n}\n\n.stats-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1.5rem;\n    margin-bottom: 3rem;\n}\n\n.stat-card {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 1.5rem;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.8rem;\n    position: relative;\n    overflow: hidden;\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.stat-card::before {\n    content: '';\n    position: absolute;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: radial-gradient(circle, var(--accent-green) 0%, transparent 70%);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover::before {\n    opacity: 0.05;\n}\n\n.stat-card:hover {\n    transform: translateY(-5px) scale(1.02);\n    border-color: var(--accent-green);\n    box-shadow: 0 10px 30px var(--success-glow);\n}\n\n.stat-card i {\n    font-size: 2.5rem;\n    opacity: 0.8;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover i {\n    transform: scale(1.1) rotateY(180deg);\n    opacity: 1;\n}\n\n.stat-number {\n    font-size: 2.5rem;\n    font-weight: 700;\n    transition: all 0.3s ease;\n}\n\n.stat-card:hover .stat-number {\n    transform: scale(1.1);\n    text-shadow: 0 0 20px currentColor;\n}\n\n.stat-label {\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n    font-weight: 600;\n}\n\n.stat-glow {\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    height: 3px;\n    background: linear-gradient(90deg, transparent, var(--accent-green), transparent);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.stat-card:hover .stat-glow {\n    opacity: 1;\n    animation: glowSlide 2s ease-in-out infinite;\n}\n\n@keyframes glowSlide {\n    0%, 100% {\n        transform: translateX(-100%);\n    }\n    50% {\n        transform: translateX(100%);\n    }\n}\n\n.stat-card.malware {\n    border-color: rgba(255, 59, 59, 0.3);\n}\n\n.stat-card.malware i,\n.stat-card.malware .stat-number {\n    color: var(--accent-red);\n}\n\n.stat-card.malware:hover {\n    border-color: var(--accent-red);\n    box-shadow: 0 10px 30px var(--danger-glow);\n}\n\n.stat-card.suspicious {\n    border-color: rgba(255, 215, 0, 0.3);\n}\n\n.stat-card.suspicious i,\n.stat-card.suspicious .stat-number {\n    color: var(--accent-yellow);\n}\n\n.stat-card.suspicious:hover {\n    border-color: var(--accent-yellow);\n    box-shadow: 0 10px 30px var(--warning-glow);\n}\n\n.stat-card.benign i,\n.stat-card.benign .stat-number,\n.stat-card.info i,\n.stat-card.info .stat-number {\n    color: var(--accent-green);\n}\n\n/* Analytics View */\n.analytics-header {\n    display: flex;\n    align-items: center;\n    gap: 2rem;\n    margin-bottom: 2.5rem;\n}\n\n.back-btn {\n    background: var(--bg-card);\n    border: 2px solid var(--accent-green);\n    color: var(--accent-green);\n    padding: 0.8rem 1.5rem;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 600;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    transition: all 0.3s ease;\n}\n\n.back-btn:hover {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    transform: translateX(-5px);\n    box-shadow: 0 5px 20px var(--success-glow);\n}\n\n.analytics-header h1 {\n    font-size: 2rem;\n    color: var(--accent-green);\n    font-weight: 700;\n}\n\n.analytics-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));\n    gap: 2rem;\n    max-height: calc(100vh - 200px);\n    overflow-y: auto;\n    padding-right: 1rem;\n    grid-auto-flow: dense;\n}\n\n/* Panel size classes for flexible tiling */\n.analytics-panel.panel-small {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-medium {\n    grid-column: span 1;\n}\n\n.analytics-panel.panel-large {\n    grid-column: span 2;\n}\n\n@media (max-width: 1400px) {\n    .analytics-grid {\n        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));\n    }\n    \n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n}\n\n.analytics-grid::-webkit-scrollbar {\n    width: 8px;\n}\n\n.analytics-grid::-webkit-scrollbar-track {\n    background: var(--bg-secondary);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb {\n    background: var(--accent-green);\n    border-radius: 4px;\n}\n\n.analytics-grid::-webkit-scrollbar-thumb:hover {\n    background: var(--accent-green-dim);\n}\n\n.analytics-panel {\n    animation: slideInPanel 0.5s ease-out;\n    animation-fill-mode: backwards;\n}\n\n.analytics-panel:nth-child(1) { animation-delay: 0.05s; }\n.analytics-panel:nth-child(2) { animation-delay: 0.1s; }\n.analytics-panel:nth-child(3) { animation-delay: 0.15s; }\n.analytics-panel:nth-child(4) { animation-delay: 0.2s; }\n.analytics-panel:nth-child(5) { animation-delay: 0.25s; }\n.analytics-panel:nth-child(6) { animation-delay: 0.3s; }\n\n@keyframes slideInPanel {\n    from {\n        opacity: 0;\n        transform: translateY(30px) scale(0.95);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n    }\n}\n\n/* Advanced Analytics Grid for Mini Charts */\n.advanced-analytics-grid {\n    background: rgba(15, 15, 15, 0.5);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(57, 255, 20, 0.2);\n    border-radius: 12px;\n    padding: 1.5rem;\n}\n\n.mini-charts-grid {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 1.5rem;\n    margin-top: 1rem;\n}\n\n.mini-chart-container {\n    background: rgba(10, 10, 10, 0.6);\n    border: 1px solid rgba(57, 255, 20, 0.15);\n    border-radius: 8px;\n    padding: 1rem;\n}\n\n.mini-chart-container h3 {\n    color: var(--accent-green);\n    font-size: 0.95rem;\n    margin: 0 0 0.75rem 0;\n    font-weight: 600;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.mini-chart-container h3 i {\n    font-size: 0.9rem;\n}\n\n@media (max-width: 1200px) {\n    .mini-charts-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n/* Emerging Threat Intelligence Panel */\n.eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.1) 0%, rgba(255, 165, 2, 0.1) 100%);\n    border: 2px solid rgba(255, 71, 87, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(255, 71, 87, 0.2);\n}\n\n.eti-header {\n    margin-bottom: 24px;\n}\n\n.eti-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #ff6b6b;\n    text-shadow: 0 2px 4px rgba(255, 71, 87, 0.3);\n}\n\n.eti-header h2 i {\n    color: #ff4757;\n    margin-right: 10px;\n    animation: pulse 2s infinite;\n}\n\n@keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.6; }\n}\n\n.eti-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 8px 0 16px 0;\n}\n\n.eti-summary {\n    display: flex;\n    gap: 12px;\n    flex-wrap: wrap;\n}\n\n.eti-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 6px 14px;\n    border-radius: 20px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.eti-badge.recent {\n    background: rgba(255, 71, 87, 0.2);\n    border-color: rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.eti-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n    gap: 20px;\n}\n\n.eti-panel {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 18px;\n    transition: transform 0.3s, box-shadow 0.3s;\n}\n\n.eti-panel:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);\n}\n\n.eti-panel h3 {\n    margin: 0 0 6px 0;\n    font-size: 1.1rem;\n    color: #e0e0e0;\n}\n\n.eti-panel h3 i {\n    color: #ffa502;\n    margin-right: 8px;\n}\n\n.eti-subtitle-small {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 14px;\n}\n\n.eti-list {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n}\n\n.eti-item {\n    display: flex;\n    gap: 12px;\n    background: rgba(255, 255, 255, 0.03);\n    border: 1px solid rgba(255, 255, 255, 0.08);\n    border-radius: 8px;\n    padding: 12px;\n    transition: all 0.3s;\n}\n\n.eti-item:hover {\n    background: rgba(255, 255, 255, 0.06);\n    border-color: rgba(255, 165, 2, 0.4);\n    transform: translateX(4px);\n}\n\n.eti-rank {\n    flex-shrink: 0;\n    width: 32px;\n    height: 32px;\n    background: linear-gradient(135deg, #ff6b6b, #ffa502);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: bold;\n    font-size: 1rem;\n    color: #fff;\n    box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);\n}\n\n.eti-item[data-rank=\"1\"] .eti-rank {\n    background: linear-gradient(135deg, #ff4757, #ff6348);\n    transform: scale(1.1);\n}\n\n.eti-content {\n    flex: 1;\n    min-width: 0;\n}\n\n.eti-name {\n    font-weight: 600;\n    color: #e0e0e0;\n    font-size: 0.95rem;\n    margin-bottom: 4px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-meta {\n    display: flex;\n    gap: 8px;\n    flex-wrap: wrap;\n    align-items: center;\n}\n\n.eti-count {\n    color: #888;\n    font-size: 0.8rem;\n}\n\n.eti-recent-badge {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-agent-badge {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 0.75rem;\n    font-weight: 600;\n}\n\n.eti-details {\n    margin-top: 6px;\n    color: #999;\n    font-size: 0.75rem;\n    font-style: italic;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.eti-empty {\n    text-align: center;\n    color: #666;\n    padding: 20px;\n    font-style: italic;\n}\n\n/* Threat Modeler */\n.modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.1) 0%, rgba(38, 222, 129, 0.1) 100%);\n    border: 2px solid rgba(90, 156, 248, 0.3);\n    border-radius: 12px;\n    padding: 24px;\n    margin-bottom: 3rem;\n    box-shadow: 0 4px 16px rgba(90, 156, 248, 0.2);\n}\n\n.modeler-header {\n    margin-bottom: 24px;\n}\n\n.modeler-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.8rem;\n    color: #5a9cf8;\n}\n\n.modeler-header h2 i {\n    color: #26de81;\n    margin-right: 10px;\n}\n\n.modeler-subtitle {\n    color: #b0b0b0;\n    font-size: 0.95rem;\n    margin: 0;\n}\n\n.modeler-grid {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 24px;\n}\n\n@media (max-width: 1024px) {\n    .modeler-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n.modeler-builder,\n.modeler-results {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 10px;\n    padding: 20px;\n}\n\n.modeler-builder h3,\n.modeler-results h3 {\n    margin: 0 0 20px 0;\n    font-size: 1.2rem;\n    color: #e0e0e0;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n    padding-bottom: 10px;\n}\n\n.modeler-builder h3 i {\n    color: #26de81;\n    margin-right: 8px;\n}\n\n.modeler-results h3 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.modeler-field {\n    margin-bottom: 20px;\n}\n\n.modeler-field label {\n    display: block;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n    margin-bottom: 6px;\n    font-weight: 600;\n}\n\n.modeler-select {\n    width: 100%;\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.2);\n    border-radius: 6px;\n    color: #e0e0e0;\n    padding: 10px;\n    font-size: 0.9rem;\n    font-family: inherit;\n    cursor: pointer;\n    transition: all 0.3s;\n}\n\n.modeler-select:focus {\n    outline: none;\n    border-color: #5a9cf8;\n    background: rgba(90, 156, 248, 0.1);\n}\n\n.modeler-select option {\n    background: #1a1a2e;\n    color: #e0e0e0;\n    padding: 8px;\n}\n\n.modeler-hint {\n    display: block;\n    color: #666;\n    font-size: 0.75rem;\n    margin-top: 4px;\n    font-style: italic;\n}\n\n.modeler-analyze-btn {\n    width: 100%;\n    background: linear-gradient(135deg, #26de81, #20bf6b);\n    border: none;\n    color: #fff;\n    padding: 14px 24px;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 700;\n    cursor: pointer;\n    transition: all 0.3s;\n    box-shadow: 0 4px 12px rgba(38, 222, 129, 0.3);\n}\n\n.modeler-analyze-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(38, 222, 129, 0.4);\n}\n\n.modeler-analyze-btn i {\n    margin-right: 8px;\n}\n\n.modeler-output {\n    min-height: 400px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.modeler-placeholder {\n    text-align: center;\n    color: #666;\n}\n\n.modeler-placeholder i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n    opacity: 0.5;\n}\n\n.modeler-placeholder p {\n    font-size: 0.95rem;\n}\n\n.modeler-loading {\n    text-align: center;\n    color: #5a9cf8;\n}\n\n.modeler-loading i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.modeler-error {\n    text-align: center;\n    color: #ff4757;\n}\n\n.modeler-error i {\n    font-size: 3rem;\n    margin-bottom: 16px;\n}\n\n.prediction-result {\n    width: 100%;\n}\n\n.prediction-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 24px;\n    padding: 20px;\n    background: rgba(255, 255, 255, 0.05);\n    border-radius: 8px;\n}\n\n.prediction-badge {\n    padding: 12px 24px;\n    border-radius: 8px;\n    font-size: 1.3rem;\n    font-weight: 800;\n    color: #fff;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n\n.prediction-confidence {\n    text-align: right;\n}\n\n.confidence-label {\n    color: #888;\n    font-size: 0.8rem;\n    margin-bottom: 4px;\n}\n\n.confidence-value {\n    color: #5a9cf8;\n    font-size: 2rem;\n    font-weight: 800;\n}\n\n.prediction-family {\n    padding: 16px;\n    background: rgba(255, 71, 87, 0.1);\n    border-left: 4px solid #ff4757;\n    border-radius: 6px;\n    margin-bottom: 20px;\n    color: #e0e0e0;\n}\n\n.family-name {\n    color: #ff6b6b;\n    font-weight: 700;\n    font-size: 1.1rem;\n    margin-left: 8px;\n}\n\n.prediction-section {\n    margin-bottom: 20px;\n}\n\n.prediction-section h4 {\n    color: #5a9cf8;\n    font-size: 1rem;\n    margin: 0 0 12px 0;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 6px;\n}\n\n.analysis-item {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    padding: 8px 0;\n    color: #b0b0b0;\n    font-size: 0.9rem;\n}\n\n.analysis-item i {\n    color: #ffa502;\n    width: 20px;\n}\n\n.indicator-group {\n    margin-bottom: 16px;\n}\n\n.indicator-group strong {\n    display: block;\n    color: #e0e0e0;\n    margin-bottom: 8px;\n    font-size: 0.9rem;\n}\n\n.indicator-list {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 8px;\n}\n\n.indicator-tag {\n    padding: 6px 12px;\n    border-radius: 6px;\n    font-size: 0.8rem;\n    font-weight: 600;\n    font-family: 'Courier New', monospace;\n}\n\n.api-tag {\n    background: rgba(255, 165, 2, 0.2);\n    border: 1px solid rgba(255, 165, 2, 0.4);\n    color: #ffa502;\n}\n\n.string-tag {\n    background: rgba(255, 71, 87, 0.2);\n    border: 1px solid rgba(255, 71, 87, 0.4);\n    color: #ff6b6b;\n}\n\n.prediction-footer {\n    margin-top: 20px;\n    padding: 12px;\n    background: rgba(90, 156, 248, 0.1);\n    border-radius: 6px;\n    color: #5a9cf8;\n    font-size: 0.85rem;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.scans-container {\n    background: var(--bg-card);\n    border: 2px solid var(--border-color);\n    border-radius: 12px;\n    padding: 2rem;\n    transition: all 0.3s ease;\n}\n\n.scans-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 5px 20px var(--shadow-color);\n}\n\n.scans-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.scans-header h2 {\n    color: #5a9cf8;\n}\n\n.refresh-btn {\n    background: #5a9cf8;\n    color: white;\n    border: none;\n    padding: 0.75rem 1.5rem;\n    border-radius: 8px;\n    cursor: pointer;\n    font-size: 1rem;\n    transition: background 0.2s;\n}\n\n.refresh-btn:hover {\n    background: #4a8ce8;\n}\n\n.scans-table {\n    width: 100%;\n    border-collapse: collapse;\n}\n\n.scans-table th {\n    text-align: left;\n    padding: 1rem;\n    background: rgba(255, 255, 255, 0.05);\n    color: #5a9cf8;\n    font-weight: 600;\n}\n\n.scans-table td {\n    padding: 1rem;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.scans-table tr:hover {\n    background: rgba(255, 255, 255, 0.03);\n}\n\n.badge {\n    display: inline-block;\n    padding: 0.3rem 0.8rem;\n    border-radius: 6px;\n    font-size: 0.85rem;\n    font-weight: 600;\n}\n\n.badge.malware { background: #ff4757; color: white; }\n.badge.suspicious { background: #ffa502; color: white; }\n.badge.benign { background: #26de81; color: white; }\n.badge.non-pe { background: #4b5563; color: #fff; }\n\n.hash {\n    font-family: 'Courier New', monospace;\n    font-size: 0.85rem;\n    color: #888;\n}\n\n.empty-state {\n    text-align: center;\n    padding: 3rem;\n    color: #666;\n}\n\n.empty-state i {\n    font-size: 4rem;\n    margin-bottom: 1rem;\n    opacity: 0.3;\n}\n\n/* NEW: Chart Container Styles */\n.chart-container {\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 12px;\n    padding: 2rem;\n    margin-top: 2rem;\n}\n\n.chart-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.chart-header h2 {\n    color: var(--accent-green);\n    margin: 0;\n}\n\n.chart-subtitle {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    margin: 0.5rem 0 0 0;\n    font-weight: normal;\n}\n\n.chart-controls {\n    display: flex;\n    gap: 0.5rem;\n}\n\n.chart-btn {\n    background: rgba(255, 255, 255, 0.05);\n    color: #888;\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    padding: 0.5rem 1rem;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.2s;\n}\n\n.chart-btn:hover {\n    background: rgba(255, 255, 255, 0.1);\n    color: #e0e0e0;\n}\n\n.chart-btn.active {\n    background: #5a9cf8;\n    color: white;\n    border-color: #5a9cf8;\n}\n\n#dailyScansChart {\n    max-height: 400px;\n}\n\n@media (max-width: 1024px) {\n    .analytics-grid {\n        grid-template-columns: 1fr;\n        gap: 1.5rem;\n    }\n    \n    .analytics-panel.panel-small,\n    .analytics-panel.panel-large {\n        grid-column: span 1;\n    }\n    \n    .graphs-preview {\n        width: 400px;\n    }\n}\n\n@media (max-width: 768px) {\n    .main-content {\n        margin-left: 0;\n        padding: 1rem;\n    }\n    \n    .side-panel {\n        width: 50px;\n    }\n    \n    .panel-logo-icon {\n        width: 40px;\n        height: 40px;\n        font-size: 1.5rem;\n    }\n    \n    .graphs-preview {\n        left: 50px;\n        width: calc(100vw - 50px);\n        border-radius: 0;\n    }\n    \n    .dashboard-header h1 {\n        font-size: 1.8rem;\n    }\n    \n    .stats-grid {\n        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n        gap: 1rem;\n    }\n    \n    .chart-header {\n        flex-direction: column;\n        gap: 1rem;\n        align-items: flex-start;\n    }\n    \n    .chart-controls {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .chart-btn {\n        flex: 1;\n    }\n    \n    .map-view-toggle {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .map-btn {\n        flex: 1;\n        font-size: 0.8rem;\n        padding: 0.4rem 0.6rem;\n    }\n    \n    .geo-context-panel {\n        flex-direction: column;\n    }\n    \n    .context-stat {\n        width: 100%;\n    }\n    \n    .map-timeline-control {\n        flex-direction: column;\n        gap: 0.5rem;\n    }\n    \n    .timeline-info {\n        text-align: center;\n    }\n    \n    .analytics-header {\n        flex-direction: column;\n        align-items: flex-start;\n    }\n}\n\n/* Map Container */\n.map-container {\n    background: var(--bg-card);\n    border-radius: 12px;\n    padding: 24px;\n    box-shadow: 0 4px 12px var(--shadow-color);\n    border: 2px solid var(--border-color);\n    transition: all 0.3s ease;\n    min-height: 600px;\n}\n\n.map-container:hover {\n    border-color: var(--accent-green);\n    box-shadow: 0 8px 24px var(--shadow-color), 0 0 20px var(--success-glow);\n}\n\n#worldMap {\n    width: 100%;\n    height: 500px;\n    border-radius: 8px;\n    margin-bottom: 15px;\n    background: var(--bg-secondary);\n    border: 1px solid var(--border-color);\n    z-index: 1;\n    position: relative;\n}\n\n.map-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 20px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.map-header h2 {\n    margin: 0;\n    font-size: 1.5rem;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-header h2 i {\n    color: var(--accent-green);\n    margin-right: 8px;\n}\n\n.map-controls {\n    display: flex;\n    gap: 20px;\n    align-items: center;\n    flex-wrap: wrap;\n}\n\n.map-view-toggle {\n    display: flex;\n    gap: 8px;\n    background: var(--bg-secondary);\n    padding: 4px;\n    border-radius: 8px;\n    border: 1px solid var(--border-color);\n}\n\n.map-btn {\n    background: transparent;\n    border: none;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.map-btn:hover {\n    background: var(--bg-hover);\n    color: var(--text-primary);\n}\n\n.map-btn.active {\n    background: var(--accent-green);\n    color: var(--bg-primary);\n    box-shadow: 0 0 10px var(--success-glow);\n}\n\n.map-btn i {\n    font-size: 1rem;\n}\n\n.map-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.legend-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n}\n\n.legend-dot {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    box-shadow: 0 0 6px currentColor;\n}\n\n.malware-dot {\n    background-color: var(--accent-red);\n}\n\n.suspicious-dot {\n    background-color: var(--accent-yellow);\n}\n\n.benign-dot {\n    background-color: var(--accent-green);\n}\n\n.geo-context-panel {\n    display: flex;\n    justify-content: space-around;\n    gap: 20px;\n    padding: 15px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-bottom: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.context-stat {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 5px;\n}\n\n.context-label {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.context-value {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--accent-green);\n    text-shadow: 0 0 10px var(--success-glow);\n}\n\n.context-value.threat-count {\n    color: var(--accent-red);\n    text-shadow: 0 0 10px var(--danger-glow);\n}\n\n.map-timeline-control {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 12px;\n    background: var(--bg-secondary);\n    border-radius: 8px;\n    margin-top: 15px;\n    border: 1px solid var(--border-color);\n}\n\n.timeline-btn {\n    background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-green-dim) 100%);\n    color: var(--bg-primary);\n    border: none;\n    padding: 10px 20px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.95rem;\n    font-weight: 600;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    box-shadow: 0 4px 12px var(--success-glow);\n}\n\n.timeline-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px var(--success-glow);\n    filter: brightness(1.1);\n}\n\n.timeline-btn i {\n    font-size: 1rem;\n}\n\n.timeline-info {\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-style: italic;\n}\n\n#worldMap {\n    background: var(--bg-secondary);\n    border: 2px solid var(--border-color);\n}\n\n/* Leaflet popup customization for theme */\n.leaflet-popup-content-wrapper {\n    background: var(--bg-card) !important;\n    color: var(--text-primary) !important;\n    border: 2px solid var(--accent-green) !important;\n    box-shadow: 0 4px 15px var(--shadow-color) !important;\n    border-radius: 8px !important;\n}\n\n.leaflet-popup-tip {\n    background: var(--bg-card) !important;\n}\n\n.leaflet-popup-content h3 {\n    color: var(--accent-green) !important;\n}\n\n.leaflet-popup-content button {\n    background: var(--accent-green) !important;\n    color: var(--bg-primary) !important;\n    border: none !important;\n    padding: 8px 16px !important;\n    border-radius: 6px !important;\n    cursor: pointer !important;\n    font-weight: 600 !important;\n    transition: all 0.2s ease !important;\n}\n\n.leaflet-popup-content button:hover {\n    transform: translateY(-2px) !important;\n    box-shadow: 0 4px 12px var(--success-glow) !important;\n}\n\n/* Correlation Graph */\n.correlation-container {\n    background: rgba(255, 255, 255, 0.03);\n    border-radius: 12px;\n    padding: 24px;\n    margin-top: 24px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.correlation-header {\n    margin-bottom: 20px;\n}\n\n.correlation-header h2 {\n    margin: 0 0 8px 0;\n    font-size: 1.5rem;\n    color: #e0e0e0;\n}\n\n.correlation-header h2 i {\n    color: #5a9cf8;\n    margin-right: 8px;\n}\n\n.correlation-subtitle {\n    color: #888;\n    font-size: 0.9rem;\n    margin: 0;\n}\n\n.graph-controls {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 16px;\n    flex-wrap: wrap;\n    gap: 16px;\n}\n\n.graph-btn {\n    background: rgba(90, 156, 248, 0.2);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    color: #5a9cf8;\n    padding: 8px 16px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.3s;\n}\n\n.graph-btn:hover {\n    background: rgba(90, 156, 248, 0.3);\n    border-color: #5a9cf8;\n}\n\n.graph-btn i {\n    margin-right: 6px;\n}\n\n.graph-legend {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.node-sample {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    display: inline-block;\n    border: 2px solid #fff;\n}\n\n.malware-node {\n    background-color: #ff4757;\n}\n\n.agent-node {\n    background-color: #5a9cf8;\n}\n\n.api-node {\n    background-color: #ffa502;\n}\n\n.string-node {\n    background-color: #26de81;\n}\n\n#correlationGraph {\n    width: 100%;\n    min-height: 600px;\n    position: relative;\n    border-radius: 8px;\n    overflow: hidden;\n}\n\n.node-details {\n    position: absolute;\n    right: 24px;\n    top: 120px;\n    background: rgba(30, 30, 30, 0.95);\n    border: 1px solid rgba(90, 156, 248, 0.4);\n    border-radius: 8px;\n    padding: 16px;\n    max-width: 300px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    z-index: 1000;\n}\n\n.node-details h3 {\n    margin: 0 0 12px 0;\n    color: #5a9cf8;\n    font-size: 1.1rem;\n    border-bottom: 1px solid rgba(90, 156, 248, 0.3);\n    padding-bottom: 8px;\n}\n\n.node-details p {\n    margin: 8px 0;\n    color: #e0e0e0;\n    font-size: 0.9rem;\n}\n\n.node-details ul {\n    color: #b0b0b0;\n    font-size: 0.85rem;\n}\n\n.node-details li {\n    margin: 4px 0;\n}\n\n/* ========================================\n   LIGHT THEME CONTRAST FIXES\n   ======================================== */\n\n/* Fix 1 & 2: Analytics preview backgrounds - lighter for better green contrast */\n[data-theme=\"light\"] .eti-container {\n    background: linear-gradient(135deg, rgba(255, 71, 87, 0.05) 0%, rgba(255, 165, 2, 0.05) 100%);\n    border-color: rgba(255, 71, 87, 0.2);\n}\n\n[data-theme=\"light\"] .modeler-container {\n    background: linear-gradient(135deg, rgba(90, 156, 248, 0.05) 0%, rgba(38, 222, 129, 0.05) 100%);\n    border-color: rgba(90, 156, 248, 0.2);\n}\n\n/* Fix 3: Theme toggle button text - darker for contrast */\n[data-theme=\"light\"] .theme-toggle {\n    color: #1a1f2e;\n    background: rgba(255, 255, 255, 0.8);\n    border-color: rgba(46, 214, 15, 0.4);\n}\n\n/* Fix 4: Daily Analysis chart - labels and grid use consolidated CSS vars above */\n\n/* Fix 5: Chart container labels - darker in light theme */\n[data-theme=\"light\"] .chart-header h2,\n[data-theme=\"light\"] .chart-header {\n    color: #1a1f2e;\n}\n\n/* Fix 6: Threat Vector Correlation header - darker */\n[data-theme=\"light\"] .correlation-header h2 {\n    color: #1a1f2e;\n}\n\n[data-theme=\"light\"] .correlation-subtitle {\n    color: #4a5568;\n}\n\n/* Fix 7: ETI subtitle and summary - darker for better contrast */\n[data-theme=\"light\"] .eti-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .eti-summary {\n    color: #374151;\n}\n\n/* Fix 8: Prediction labels in threat modeler - darker */\n[data-theme=\"light\"] .modeler-subtitle {\n    color: #4a5568;\n}\n\n[data-theme=\"light\"] .modeler-field label {\n    color: #374151;\n}\n\n[data-theme=\"light\"] .modeler-hint {\n    color: #6b7280;\n}\n\n/* Fix 9: Analytics preview backgrounds - much lighter for green text visibility */\n[data-theme=\"light\"] .preview-box {\n    background: rgba(255, 255, 255, 0.6);\n    border-color: rgba(46, 214, 15, 0.3);\n}\n\n/* Fix 10: ETI item text - lighter for better readability */\n[data-theme=\"light\"] .eti-count {\n    color: #6b7280;\n}\n\n[data-theme=\"light\"] .eti-details {\n    color: #9ca3af;\n}\n\n[data-theme=\"light\"] .eti-name {\n    color: #1f2937;\n}\n\n/* Fix 11: Make ETI details much more visible in light theme */\n[data-theme=\"light\"] .eti-details {\n    color: #5a9cf8;\n    font-weight: 500;\n}\n\n/* Fix 12: Threat ticker text visibility in light theme */\n[data-theme=\"light\"] .ticker-item {\n    color: #374151;\n    font-weight: 500;\n}\n\n/* Back to Top Button */\n.back-to-top {\n    position: fixed;\n    bottom: 30px;\n    right: 30px;\n    width: 50px;\n    height: 50px;\n    background: linear-gradient(135deg, var(--accent-green), var(--accent-green-dim));\n    border: 2px solid var(--accent-green);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    z-index: 9998;\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 20px var(--success-glow);\n    color: #000;\n    font-size: 1.2rem;\n}\n\n.back-to-top.visible {\n    opacity: 1;\n    visibility: visible;\n}\n\n.back-to-top:hover {\n    transform: translateY(-5px) scale(1.1);\n    box-shadow: 0 6px 30px var(--success-glow);\n}\n\n.back-to-top:active {\n    transform: translateY(-2px) scale(1.05);\n}\n\n[data-theme=\"light\"] .back-to-top {\n    background: linear-gradient(135deg, #2ed60f, #27b00c);\n    color: #fff;\n}\n","range":{"startLineNumber":1,"startColumn":1,"endLineNumber":2527,"endColumn":1}},{"text":"","range":{"startLineNumber":2527,"startColumn":1,"endLineNumber":2536,"endColumn":1}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/styles.css","external":"file:///home/trang/localnsv/mAIware-server/public/styles.css","path":"/home/trang/localnsv/mAIware-server/public/styles.css","scheme":"file"},"requestId":"request_22000fc3-1554-4fe6-b1a3-e47e57297a0e","epoch":23,"edits":[{"text":"    --success-glow: rgba(57, 255, 20, 0.3);\n    --danger-glow: rgba(255, 59, 59, 0.3);\n    --warning-glow: rgba(255, 215, 0, 0.3);\n    /* Chart theming */\n    --chart-text-color: #9ca3af;\n    --chart-grid-color: rgba(255, 255, 255, 0.1);\n}\n\n[data-theme=\"light\"] {","range":{"startLineNumber":15,"startColumn":1,"endLineNumber":20,"endColumn":23}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/styles.css","external":"file:///home/trang/localnsv/mAIware-server/public/styles.css","path":"/home/trang/localnsv/mAIware-server/public/styles.css","scheme":"file"},"requestId":"request_22000fc3-1554-4fe6-b1a3-e47e57297a0e","epoch":25,"edits":[{"text":"    --danger-glow: rgba(220, 38, 38, 0.2);\n    --warning-glow: rgba(204, 154, 0, 0.2);\n    /* Chart theming overrides for light mode */\n    --chart-text-color: #1f2937; /* gray-800 for maximum contrast */\n    --chart-grid-color: rgba(0, 0, 0, 0.12);\n}","range":{"startLineNumber":38,"startColumn":1,"endLineNumber":43,"endColumn":2}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/styles.css","external":"file:///home/trang/localnsv/mAIware-server/public/styles.css","path":"/home/trang/localnsv/mAIware-server/public/styles.css","scheme":"file"},"requestId":"request_84fdc38b-9630-4d5e-aa54-3779d49a4552","epoch":29,"edits":[{"text":".refresh-btn:hover {\n    background: #1e9258;\n}","range":{"startLineNumber":1803,"startColumn":1,"endLineNumber":1805,"endColumn":2}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/styles.css","external":"file:///home/trang/localnsv/mAIware-server/public/styles.css","path":"/home/trang/localnsv/mAIware-server/public/styles.css","scheme":"file"},"requestId":"request_84fdc38b-9630-4d5e-aa54-3779d49a4552","epoch":30,"edits":[{"text":".scans-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 2rem;\n}\n\n.scans-header h2 {\n    color: #24ae6b;\n}\n\n.refresh-btn {\n    background: #24ae6b;","range":{"startLineNumber":1781,"startColumn":1,"endLineNumber":1793,"endColumn":25}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/styles.css","external":"file:///home/trang/localnsv/mAIware-server/public/styles.css","path":"/home/trang/localnsv/mAIware-server/public/styles.css","scheme":"file"},"requestId":"request_fcbfa3b8-88ac-48bc-80d5-4ae65eb5dfdf","epoch":34,"edits":[{"text":".scans-table th {\n    text-align: left;\n    padding: 1rem;\n    background: rgba(255, 255, 255, 0.05);\n    color: #24ae6b;\n    font-weight: 600;\n}","range":{"startLineNumber":1812,"startColumn":1,"endLineNumber":1818,"endColumn":2}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/dashboard.html","external":"file:///home/trang/localnsv/mAIware-server/public/dashboard.html","path":"/home/trang/localnsv/mAIware-server/public/dashboard.html","scheme":"file"},"requestId":"request_7d2258a4-51bc-4f20-ba08-270fe0c6db2a","epoch":38,"edits":[{"text":"                        datasets: [\n                            {\n                                label: 'Benign Files',\n                                data: benignData,\n                                backgroundColor: '#5a9cf8',\n                                borderColor: '#4a8ce8',\n                                borderWidth: 1\n                            },","range":{"startLineNumber":1829,"startColumn":1,"endLineNumber":1836,"endColumn":31}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/dashboard.html","external":"file:///home/trang/localnsv/mAIware-server/public/dashboard.html","path":"/home/trang/localnsv/mAIware-server/public/dashboard.html","scheme":"file"},"requestId":"request_7d2258a4-51bc-4f20-ba08-270fe0c6db2a","epoch":39,"edits":[{"text":"                        datasets: [\n                            {\n                                label: 'Benign Files',\n                                data: data.benignCounts,\n                                backgroundColor: '#5a9cf8'\n                            },","range":{"startLineNumber":1661,"startColumn":1,"endLineNumber":1666,"endColumn":31}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/dashboard.html","external":"file:///home/trang/localnsv/mAIware-server/public/dashboard.html","path":"/home/trang/localnsv/mAIware-server/public/dashboard.html","scheme":"file"},"requestId":"request_7d2258a4-51bc-4f20-ba08-270fe0c6db2a","epoch":40,"edits":[{"text":"                            {\n                                label: 'Verified',\n                                data: [data.benign.verified, data.suspicious.verified, data.malware.verified],\n                                backgroundColor: '#5a9cf8',\n                                stack: 'stack0'\n                            },","range":{"startLineNumber":1571,"startColumn":1,"endLineNumber":1576,"endColumn":31}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/dashboard.html","external":"file:///home/trang/localnsv/mAIware-server/public/dashboard.html","path":"/home/trang/localnsv/mAIware-server/public/dashboard.html","scheme":"file"},"requestId":"request_5ed1c503-e959-41d2-adbb-12b539ea050b","epoch":44,"edits":[{"text":"                    data: {\n                        labels: data.bins,\n                        datasets: [{\n                            label: 'Scan Count',\n                            data: data.counts,\n                            backgroundColor: '#5a9cf8',\n                            borderColor: '#4a8ce8',\n                            borderWidth: 1\n                        }]\n                    },","range":{"startLineNumber":1732,"startColumn":1,"endLineNumber":1741,"endColumn":23}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/dashboard.html","external":"file:///home/trang/localnsv/mAIware-server/public/dashboard.html","path":"/home/trang/localnsv/mAIware-server/public/dashboard.html","scheme":"file"},"requestId":"request_d6846186-7601-45b3-9fc2-c861c84e6ee9","epoch":48,"edits":[{"text":"                            {\n                                label: 'Benign',\n                                data: data.days.map(d => d.benign),\n                                borderColor: '#34d118',\n                                backgroundColor: 'rgba(52, 209, 24, 0.1)',\n                                fill: true,\n                                tension: 0.4,\n                                borderWidth: 2\n                            }","range":{"startLineNumber":911,"startColumn":1,"endLineNumber":919,"endColumn":30}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/styles.css","external":"file:///home/trang/localnsv/mAIware-server/public/styles.css","path":"/home/trang/localnsv/mAIware-server/public/styles.css","scheme":"file"},"requestId":"request_9b6d6ff6-0134-45c8-b199-39ef27e3027c","epoch":52,"edits":[{"text":".chart-btn.active {\n    background: #2bcfae;\n    color: white;\n    border-color: #2bcfae;\n}","range":{"startLineNumber":1909,"startColumn":1,"endLineNumber":1913,"endColumn":2}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/styles.css","external":"file:///home/trang/localnsv/mAIware-server/public/styles.css","path":"/home/trang/localnsv/mAIware-server/public/styles.css","scheme":"file"},"requestId":"request_319f88cc-c105-40bf-9ccf-2a83e597e944","epoch":56,"edits":[{"text":"body::before {\n    content: '';\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: url('https://img6.thuthuatphanmem.vn/uploads/2022/02/12/background-thoi-su-3d-dep_095011550.jpg') no-repeat center center;\n    background-size: cover;\n    opacity: 0.15;\n    pointer-events: none;\n    z-index: 0;\n}","range":{"startLineNumber":61,"startColumn":1,"endLineNumber":75,"endColumn":2}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware-server/public/dashboard.html","external":"file:///home/trang/localnsv/mAIware-server/public/dashboard.html","path":"/home/trang/localnsv/mAIware-server/public/dashboard.html","scheme":"file"},"requestId":"request_b10a9f11-ae66-4c50-a78d-1a768eabe969","epoch":60,"edits":[{"text":"        function handleAutoScroll(event) {\n            // Don't auto-scroll if page is hidden\n            if (document.hidden) return;\n            \n            // Don't auto-scroll if hovering over back-to-top button\n            const backToTopBtn = document.getElementById('backToTop');\n            if (backToTopBtn && backToTopBtn.matches(':hover')) {\n                stopAutoScroll();\n                return;\n            }\n            \n            const mouseY = event.clientY;\n            const windowHeight = window.innerHeight;","range":{"startLineNumber":2375,"startColumn":1,"endLineNumber":2380,"endColumn":53}}]}],"epochCounter":61},"recentSnapshot":{"entries":[{"resource":"file:///home/trang/localnsv/mAIware-server/public/dashboard.html","languageId":"html","originalHash":"4f8170d","currentHash":"4f8170d","state":1,"snapshotUri":"chat-editing-snapshot-text-model:/home/trang/localnsv/mAIware-server/public/dashboard.html?%7B%22sessionId%22%3A%2240d6ee31-b9c4-4756-a406-b62c7942f20d%22%2C%22requestId%22%3A%22%22%2C%22undoStop%22%3A%22%22%7D","telemetryInfo":{"requestId":"request_b10a9f11-ae66-4c50-a78d-1a768eabe969","agentId":"github.copilot.editsAgent","modelId":"copilot/claude-sonnet-4.5","modeId":"agent"}},{"resource":"file:///home/trang/localnsv/mAIware-server/public/styles.css","languageId":"css","originalHash":"e5d17d0","currentHash":"e5d17d0","state":2,"snapshotUri":"chat-editing-snapshot-text-model:/home/trang/localnsv/mAIware-server/public/styles.css?%7B%22sessionId%22%3A%2240d6ee31-b9c4-4756-a406-b62c7942f20d%22%2C%22requestId%22%3A%22%22%2C%22undoStop%22%3A%22%22%7D","telemetryInfo":{"requestId":"request_319f88cc-c105-40bf-9ccf-2a83e597e944","agentId":"github.copilot.editsAgent","modelId":"copilot/claude-sonnet-4.5","modeId":"agent"}}]}}