{"version":2,"sessionId":"60b140d3-7125-496b-b31c-540b0b9c4ba7","initialFileContents":[["file:///home/trang/localnsv/mAIware/style.css","124c45b"],["file:///home/trang/localnsv/mAIware/background-controller.js","90f54ce"],["file:///home/trang/localnsv/mAIware/index.html","2c9e5b4"],["file:///home/trang/localnsv/mAIware/script.js","3b69ef5"]],"timeline":{"checkpoints":[{"checkpointId":"62431138-01bc-4e63-8c91-ade8003b33d7","epoch":0,"label":"Initial State","description":"Starting point before any edits"},{"checkpointId":"4dcd1f19-9ef0-42bf-9e9d-0335cb6b02a7","requestId":"request_aae1e94a-0d53-44bf-b0fa-88b6365ff1cf","epoch":1,"label":"Request request_aae1e94a-0d53-44bf-b0fa-88b6365ff1cf"},{"checkpointId":"c663f50c-fd40-4c47-a4f4-5dfdfc429a55","requestId":"request_aae1e94a-0d53-44bf-b0fa-88b6365ff1cf","undoStopId":"5615aa0a-df68-44ca-8f27-5a714c099766","epoch":2,"label":"Request request_aae1e94a-0d53-44bf-b0fa-88b6365ff1cf - Stop 5615aa0a-df68-44ca-8f27-5a714c099766"},{"checkpointId":"d8a3e0e7-74e2-4e52-8ce2-bfb6135cead3","requestId":"request_5c76fc1b-ce49-4733-b35a-1b234523720a","epoch":5,"label":"Request request_5c76fc1b-ce49-4733-b35a-1b234523720a"},{"checkpointId":"71f272ab-2659-443e-b8a5-1f3e70c8334d","requestId":"request_5c76fc1b-ce49-4733-b35a-1b234523720a","undoStopId":"e05a912f-834d-42aa-ae63-032bc01d0a28","epoch":6,"label":"Request request_5c76fc1b-ce49-4733-b35a-1b234523720a - Stop e05a912f-834d-42aa-ae63-032bc01d0a28"},{"checkpointId":"aad6f337-164c-4105-8124-f378c518193d","requestId":"request_6e987b26-6b7b-49b1-88a8-e33cd26adc69","epoch":9,"label":"Request request_6e987b26-6b7b-49b1-88a8-e33cd26adc69"},{"checkpointId":"e2cc244e-8dd5-4bed-8329-560efd31d29d","requestId":"request_6e987b26-6b7b-49b1-88a8-e33cd26adc69","undoStopId":"cb43c911-a16d-4d56-b234-d0a571334194","epoch":10,"label":"Request request_6e987b26-6b7b-49b1-88a8-e33cd26adc69 - Stop cb43c911-a16d-4d56-b234-d0a571334194"},{"checkpointId":"3014780a-5d25-408a-97d1-2c87891610cb","requestId":"request_08977571-1b04-4fb0-ae1d-5bc8f60d4119","epoch":13,"label":"Request request_08977571-1b04-4fb0-ae1d-5bc8f60d4119"},{"checkpointId":"66fdc010-49f8-4973-925d-c325a5d63baa","requestId":"request_05accfe6-1b1c-4894-bdda-18aee7591480","epoch":14,"label":"Request request_05accfe6-1b1c-4894-bdda-18aee7591480"},{"checkpointId":"ea89e7f9-ff73-4cef-a75a-7d7e305f0c1e","requestId":"request_12456880-9335-4f74-90f1-0ed95f9fb0ab","epoch":15,"label":"Request request_12456880-9335-4f74-90f1-0ed95f9fb0ab"},{"checkpointId":"d09245e4-4ae2-4191-a258-fc3f7c3a76e5","requestId":"request_12456880-9335-4f74-90f1-0ed95f9fb0ab","undoStopId":"a278c911-47d7-47b7-86e0-48f8440166fb","epoch":16,"label":"Request request_12456880-9335-4f74-90f1-0ed95f9fb0ab - Stop a278c911-47d7-47b7-86e0-48f8440166fb"},{"checkpointId":"fdf9c4cb-4b2f-4d00-a97e-28eaeffccd5c","requestId":"request_12456880-9335-4f74-90f1-0ed95f9fb0ab","undoStopId":"2c4a82d4-3854-42e4-8a80-12657eddb5cd","epoch":17,"label":"Request request_12456880-9335-4f74-90f1-0ed95f9fb0ab - Stop 2c4a82d4-3854-42e4-8a80-12657eddb5cd"},{"checkpointId":"3f320174-a6bb-41f0-89ac-c0b79f4efd98","requestId":"request_12456880-9335-4f74-90f1-0ed95f9fb0ab","undoStopId":"c3f5f68d-c724-4586-93a5-77f1cdd7bbe6","epoch":23,"label":"Request request_12456880-9335-4f74-90f1-0ed95f9fb0ab - Stop c3f5f68d-c724-4586-93a5-77f1cdd7bbe6"}],"currentEpoch":25,"fileBaselines":[["file:///home/trang/localnsv/mAIware/style.css::request_aae1e94a-0d53-44bf-b0fa-88b6365ff1cf",{"uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware/style.css","external":"file:///home/trang/localnsv/mAIware/style.css","path":"/home/trang/localnsv/mAIware/style.css","scheme":"file"},"requestId":"request_aae1e94a-0d53-44bf-b0fa-88b6365ff1cf","content":"/* --- Global & Fonts --- */\n:root {\n    /* --- Dark Theme (Default) --- */\n    --bg-dark-1: #121212;\n    --bg-dark-2: #1e1e1e;\n    --bg-dark-3: #2a2a2e;\n    --bg-dark-4: #333333;\n    --border-color: #444444;\n    --text-light: #e0e0e0;\n    --text-medium: #aaa;\n    --text-dark: #888;\n    \n    /* --- Semantic Colors --- */\n    --blue: #007bff;\n    --red: #e74c3c;\n    --yellow: #f1c40f;\n    --green: #2ecc71;\n    \n    /* --- Syntax & Node Colors --- */\n    --syntax-op: #c39eff;\n    --syntax-string: #e6db74;\n    --syntax-const-text: #ffffff; /* Constant white for dark buttons/nodes */\n    --node-bg-entry: #254a25;\n    --node-bg-api: #2a3e4a;\n    --node-bg-suspicious: #4a452a;\n    --node-bg-malicious: #4a2a2a;\n\n    --chart-legend-text: var(--text-light);  /* #e0e0e0 */\n    --chart-axes-text: var(--text-medium);   /* #aaa */\n    --chart-grid-line: var(--border-color);\n}\n\n/* --- Light Theme --- */\n/* Add \".light-theme\" to the <body> tag to activate */\nbody.light-theme {\n    --bg-dark-1: #f8f9fa;     /* Main background */\n    --bg-dark-2: #ffffff;     /* Card background */\n    --bg-dark-3: #e9ecef;     /* Hover/active background */\n    --bg-dark-4: #ced4da;     /* Secondary button background */\n    --border-color: #dee2e6;  /* Border color */\n    --text-light: #212529;    /* Main text */\n    --text-medium: #6c757d;   /* Secondary text */\n    --text-dark: #888;        /* Tertiary text (can stay gray) */\n    \n    /* Semantic colors are unchanged */\n    /* --blue, --red, --yellow, --green */\n    \n    /* --- Light Theme Syntax --- */\n    --syntax-op: #a040ff;       /* Darker purple */\n    --syntax-string: #b8860b;     /* Dark goldenrod */\n    --syntax-const-text: #ffffff; /* Stays white for colored buttons/nodes */\n    \n    /* Node backgrounds are unchanged, they look good on a light BG */\n    --chart-legend-text: var(--text-medium); /* User Request */\n    --chart-axes-text: var(--text-medium);   /* User Request */\n    --chart-grid-line: var(--border-color);\n}\n\n\n/* Apply overflow-x to html as well */\nhtml {\n    overflow-x: hidden;\n    font-size: 16px; /* Ensure base font size */\n}\n\nbody {\n    font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif;\n    background-color: var(--bg-dark-1);\n    color: var(--text-light);\n    margin: 0;\n    padding-top: 60px; /* Make space for fixed top nav */\n    overflow-x: hidden; /* Prevent horizontal scroll */\n    width: 100%;\n    min-height: 100vh;\n}\n\n/* --- Main Grid Container --- */\n.main-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr; /* Simpler 2-column definition */\n    grid-template-rows: auto auto; /* Rows for content and graph */\n    gap: 2rem;\n    padding: 2rem; /* Spacing from nav and screen edges */\n    align-items: start;\n    \n    /* Set max-width on the grid itself */\n    max-width: 1400px; \n    /* Center the whole grid */\n    margin: 0 auto; \n    \n    min-height: calc(100vh - 60px); /* Full height minus nav */\n    box-sizing: border-box;\n    width: 100%;\n}\n\n.scanner-wrapper {\n    grid-column: 1 / 2; /* Span first column */\n    grid-row: 1 / 2;\n    display: flex;\n    flex-direction: column;\n    gap: 1.5rem;\n    width: 100%; /* Fill the column */\n}\n\n.right-panel-wrapper {\n    grid-column: 2 / 3; /* Span second column */\n    grid-row: 1 / 2;\n    display: flex; /* Make it a flex container */\n    flex-direction: column; /* Stack its children vertically */\n    gap: 1.5rem; /* Space between its children */\n    width: 100%; /* Fill the column */\n}\n\n.graph-wrapper {\n    grid-column: 1 / 3; /* Span BOTH columns */\n    grid-row: 2 / 3;\n    width: 100%;\n    /* max-width is now inherited from main-container */\n    justify-self: center; /* Center in the grid area */\n}\n\n\n/* --- Top Navigation --- */\n.top-nav {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 60px;\n    background-color: var(--bg-dark-2);\n    border-bottom: 1px solid var(--border-color);\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0 2rem;\n    z-index: 1000;\n    box-sizing: border-box;\n}\n\n.top-nav .logo {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    font-size: 1.3rem;\n    font-weight: 600;\n    color: var(--text-light);\n}\n\n.top-nav .logo i {\n    color: var(--blue);\n}\n\n.nav-links {\n    display: flex;\n    gap: 0.5rem;\n}\n\n.nav-link {\n    color: var(--text-medium);\n    font-size: 1.25rem;\n    padding: 0.75rem;\n    border-radius: 8px;\n    transition: all 0.2s ease;\n    position: relative;\n    text-decoration: none;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.nav-link .link-text {\n    font-size: 0.9rem;\n    font-weight: 500;\n    max-width: 0;\n    overflow: hidden;\n    white-space: nowrap;\n    transition: all 0.3s ease;\n}\n\n.nav-link:hover {\n    background-color: var(--bg-dark-3);\n    color: var(--text-light);\n}\n\n.nav-link:hover .link-text {\n    max-width: 80px; /* Expand text on hover */\n    margin-left: 0.25rem;\n}\n\n/* --- Tooltip --- */\n.nav-link:hover::before {\n    content: attr(data-tooltip);\n    position: absolute;\n    bottom: -35px;\n    left: 50%;\n    transform: translateX(-50%);\n    background-color: var(--bg-dark-3);\n    color: var(--text-light);\n    padding: 5px 10px;\n    border-radius: 4px;\n    font-size: 0.8rem;\n    white-space: nowrap;\n    opacity: 0;\n    transition: opacity 0.2s 0.3s; /* Delay tooltip */\n    pointer-events: none;\n}\n.nav-link:hover .link-text {\n    display: none; /* Hide expanded text if tooltip is showing */\n}\n.nav-link:hover:hover::before {\n    opacity: 1;\n}\n\n/* On smaller screens, stack the columns */\n@media (max-width: 1280px) { /* Widened breakpoint */\n    .main-container {\n        grid-template-columns: 1fr; /* Stack columns */\n        padding: 1rem;\n    }\n    .scanner-wrapper, .right-panel-wrapper, .graph-wrapper {\n        grid-column: 1 / 2; /* All in one column */\n        max-width: 100%;\n        justify-self: center;\n    }\n    .right-panel-wrapper {\n        grid-row: 2 / 3;\n    }\n    .graph-wrapper {\n        grid-row: 3 / 4;\n    }\n}\n\n/* Hide link text on very small screens */\n@media (max-width: 768px) {\n    .nav-link .link-text { display: none; }\n    .nav-link:hover .link-text { display: none; }\n    .top-nav { padding: 0 1rem; }\n}\n\n\n/* --- Main Scanner Box --- */\n.scanner-container {\n    width: 100%; /* Ensure it fills its flex parent */\n    background-color: var(--bg-dark-2);\n    border-radius: 12px;\n    border: 1px solid var(--border-color);\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n    padding: 2.5rem;\n    text-align: center;\n    overflow: hidden;\n    transition: all 0.3s ease;\n    box-sizing: border-box; /* Include padding in width */\n}\n\nh1 {\n    color: var(--text-light);\n    margin-top: 0;\n    margin-bottom: 1rem;\n}\n\n.scanner-container p {\n    color: var(--text-medium);\n    margin-bottom: 2rem;\n    font-size: 1.1rem;\n}\n\n.scanner-state {\n    display: none;\n}\n.scanner-state.active {\n    display: block;\n}\n\n/* --- State 1: Upload --- */\n.upload-zone {\n    border: 2px dashed var(--border-color);\n    border-radius: 8px;\n    padding: 3rem 2rem;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n.upload-zone:hover {\n    background-color: var(--bg-dark-3);\n    border-color: var(--blue);\n}\n.upload-icon {\n    font-size: 4rem;\n    color: var(--blue);\n    margin-bottom: 1rem;\n}\n.upload-zone h3 {\n    margin: 0;\n    color: var(--text-light);\n}\n.upload-zone span {\n    color: var(--text-dark);\n}\n\n.manual-upload {\n    margin-top: 1.5rem;\n    text-align: center;\n}\n\n.manual-upload .btn {\n    width: 100%;\n    justify-content: center;\n}\n\n.manual-scan-hint {\n    color: var(--text-dark);\n    font-size: 0.95rem;\n    margin: 0.75rem 0 0;\n}\n\n.manual-error {\n    color: var(--red);\n    font-size: 0.9rem;\n    margin-top: 0.5rem;\n    min-height: 1.2rem;\n}\n\n/* --- State 2: Analyzing --- */\n.analyzing-icon .loader {\n    width: 80px;\n    height: 80px;\n    border: 6px solid var(--bg-dark-4);\n    border-top-color: var(--blue);\n    border-radius: 50%;\n    animation: spin 1s linear infinite;\n    margin: 2rem auto;\n}\n@keyframes spin {\n    to { transform: rotate(360deg); }\n}\n.analyzing-state h3 {\n    color: var(--text-light);\n    margin-bottom: 0.5rem;\n}\n.analyzing-state .filename,\n.result-state .filename {\n    color: var(--text-medium);\n    font-family: 'Courier New', Courier, monospace;\n    font-size: 1.1rem;\n    word-break: break-all;\n}\n\n/* --- State 3: Result --- */\n.result-icon {\n    font-size: 6rem;\n    line-height: 1;\n    margin: 1.5rem 0;\n}\n.result-state h2 {\n    font-size: 2.5rem;\n    margin: 0 0 0.5rem 0;\n}\n.result-malware .result-icon, .result-malware h2 { color: var(--red); }\n.result-suspicious .result-icon, .result-suspicious h2 { color: var(--yellow); }\n.result-safe .result-icon, .result-safe h2 { color: var(--green); }\n.result-state p {\n    font-size: 1rem;\n    margin-bottom: 2rem;\n}\n\n/* --- Scan Navigation Controls --- */\n.scan-navigation {\n    display: none;\n    align-items: center;\n    justify-content: center;\n    gap: 1.5rem;\n    margin: 1.5rem 0;\n    padding: 1rem;\n    background: rgba(255, 255, 255, 0.03);\n    border-radius: 8px;\n}\n\n/* Show navigation only when results are displayed */\nbody.is-showing-result .scan-navigation,\nbody.is-non-pe .scan-navigation {\n    display: flex;\n}\n\n.nav-btn {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.75rem 1.5rem;\n    background: linear-gradient(135deg, var(--primary), var(--secondary));\n    color: white;\n    border: none;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 600;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);\n}\n\n.nav-btn:hover:not(:disabled) {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 20px rgba(139, 92, 246, 0.5);\n}\n\n.nav-btn:active:not(:disabled) {\n    transform: translateY(0);\n}\n\n.nav-btn:disabled {\n    background: rgba(255, 255, 255, 0.1) !important;\n    color: rgba(255, 255, 255, 0.3) !important;\n    cursor: not-allowed;\n    box-shadow: none !important;\n}\n\n.nav-info {\n    color: var(--text-medium);\n    font-size: 0.95rem;\n    font-weight: 500;\n    min-width: 80px;\n    text-align: center;\n}\n\n.non-pe-result {\n    display: none;\n    flex-direction: column;\n    align-items: center;\n    gap: 1.5rem;\n    color: var(--text-light);\n    padding: 1rem 0 0 0;\n}\n\n.non-pe-result.active {\n    display: flex;\n}\n\n.non-pe-icon {\n    width: 96px;\n    height: 96px;\n    border-radius: 24px;\n    background: linear-gradient(135deg, rgba(80, 130, 255, 0.2), rgba(80, 130, 255, 0.05));\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 3rem;\n    color: var(--blue);\n}\n\n.non-pe-hash-grid {\n    display: flex;\n    gap: 1.5rem;\n    flex-wrap: wrap;\n    justify-content: center;\n}\n\n.non-pe-hash {\n    min-width: 220px;\n    background: var(--bg-dark-3);\n    padding: 1rem 1.25rem;\n    border-radius: 12px;\n    border: 1px solid rgba(255, 255, 255, 0.05);\n    text-align: left;\n}\n\n.non-pe-hash h4 {\n    margin: 0 0 0.5rem 0;\n    font-size: 0.85rem;\n    text-transform: uppercase;\n    letter-spacing: 0.08rem;\n    color: var(--text-medium);\n}\n\n.non-pe-hash p {\n    font-family: 'Courier New', Courier, monospace;\n    font-size: 0.9rem;\n    word-break: break-all;\n    color: var(--text-light);\n}\n\nbody.is-non-pe .analysis-details-container,\nbody.is-non-pe #analysis-details-wrapper,\nbody.is-non-pe #disassembly-wrapper,\nbody.is-non-pe #file-internals-wrapper,\nbody.is-non-pe #graph-wrapper {\n    display: none !important;\n}\n\nbody.is-non-pe #result-state {\n    display: none !important;\n}\n\nbody.is-non-pe .non-pe-result {\n    display: flex;\n}\n\n\n/* --- NEW: Stats Dashboard Panel --- */\n.stats-wrapper {\n    display: flex; \n    flex-direction: column;\n    gap: 1.5rem;\n    width: 100%; /* Fill its flex parent */\n    box-sizing: border-box; /* Include padding in width */\n}\n\n/* By default, stats are visible, disassembly is hidden */\n.disassembly-wrapper { display: none; }\n\n/* When analyzing/showing results, hide stats and show disassembly */\nbody.is-analyzing .stats-wrapper,\nbody.is-showing-result .stats-wrapper {\n    display: none;\n}\nbody.is-analyzing .disassembly-wrapper,\nbody.is-showing-result .disassembly-wrapper {\n    display: flex; /* Use flex to match its own styles */\n}\n\n\n.stats-grid {\n    display: flex; \n    flex-direction: column;\n    /* Force stacking */\n    gap: 1.5rem;\n}\n\n.stat-card {\n    display: flex;\n    align-items: center;\n    gap: 1.5rem;\n    background-color: var(--bg-dark-2);\n    padding: 1.5rem;\n    border-radius: 12px;\n    border: 1px solid var(--border-color);\n}\n.stat-card i {\n    font-size: 2.5rem;\n    color: var(--blue);\n}\n.stat-content {\n    display: flex;\n    flex-direction: column;\n}\n.stat-number {\n    font-size: 2rem;\n    font-weight: 600;\n    color: var(--text-light);\n    line-height: 1.2;\n}\n.stat-label {\n    font-size: 0.9rem;\n    color: var(--text-medium);\n}\n\n.chart-container-wrapper {\n    display: flex;\n    flex-direction: column;\n    gap: 1.5rem;\n}\n\n.chart-container {\n    background-color: var(--bg-dark-2);\n    padding: 1.5rem;\n    border-radius: 12px;\n    border: 1px solid var(--border-color);\n    box-sizing: border-box;\n}\n.chart-container h3 {\n    margin-top: 0;\n    margin-bottom: 1.5rem;\n    text-align: center;\n    color: var(--text-light);\n    font-size: 1.1rem;\n}\n\n\n/* --- Disassembly Panel --- */\n.disassembly-wrapper {\n    /* display: none; set by default now */\n    flex-direction: column;\n    background-color: var(--bg-dark-2);\n    border-radius: 12px;\n    border: 1px solid var(--border-color);\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n    height: 600px; /* Fixed height */\n    max-height: 70vh;\n    opacity: 0;\n    transition: all 0.3s ease;\n    width: 100%;\n    box-sizing: border-box;\n}\n\nbody.is-analyzing .disassembly-wrapper,\nbody.is-showing-result .disassembly-wrapper {\n    opacity: 1;\n}\n\n.disassembly-header {\n    padding: 1rem 1.5rem;\n    border-bottom: 1px solid var(--border-color);\n    background-color: var(--bg-dark-3);\n    border-radius: 12px 12px 0 0;\n}\n.disassembly-header h3 {\n    margin: 0;\n    color: var(--text-light);\n    font-size: 1.1rem;\n    font-family: 'Courier New', Courier, monospace;\n}\n.disassembly-code {\n    flex-grow: 1;\n    overflow-y: auto;\n    padding: 1rem;\n    font-family: 'Courier New', Courier, monospace;\n    font-size: 0.95rem;\n}\n.disassembly-line {\n    display: block;\n    padding: 2px 1rem;\n    border-radius: 4px;\n    transition: background-color 0.2s ease;\n}\n.disassembly-line.active {\n    background-color: var(--blue);\n    color: var(--syntax-const-text); /* MODIFIED */\n}\n.disassembly-line .addr { color: var(--text-dark); margin-right: 1rem; }\n.disassembly-line .op { color: var(--syntax-op); font-weight: bold; width: 50px; display: inline-block; } /* MODIFIED */\n.disassembly-line .args { color: var(--text-light); }\n.disassembly-line .string { color: var(--syntax-string); } /* MODIFIED */\n.disassembly-line .comment { color: var(--green); margin-left: 1rem; }\n\n\n/* --- Analysis Details Panel --- */\n.analysis-details-container {\n    width: 100%;\n    background-color: var(--bg-dark-2);\n    border-radius: 12px;\n    border: 1px solid var(--border-color);\n    padding: 2rem;\n    display: none; /* Hidden by default */\n    box-sizing: border-box;\n}\nbody.is-showing-result .analysis-details-container {\n    display: block;\n}\n\n.progress-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 0.75rem;\n}\n.progress-header h3 {\n    margin: 0;\n    font-size: 1.1rem;\n    color: var(--text-light);\n}\n.score-percentage {\n    font-size: 1.2rem;\n    font-weight: 600;\n}\n.score-green { color: var(--green); }\n.score-yellow { color: var(--yellow); }\n.score-red { color: var(--red); }\n\n.progress-bar-background {\n    width: 100%;\n    height: 12px;\n    background-color: var(--bg-dark-3);\n    border-radius: 6px;\n    overflow: hidden;\n    margin-bottom: 1.5rem;\n}\n.progress-bar-fill {\n    height: 100%;\n    width: 0%;\n    border-radius: 6px;\n    transition: width 0.5s ease;\n}\n.progress-bar-green { background-color: var(--green); }\n.progress-bar-yellow { background-color: var(--yellow); }\n.progress-bar-red { background-color: var(--red); }\n\n.details-section {\n    margin-bottom: 1.25rem;\n}\n.details-section h4 {\n    margin: 0 0 0.5rem 0;\n    color: var(--text-medium);\n    font-size: 0.9rem;\n    text-transform: uppercase;\n}\n.details-section p {\n    margin: 0;\n    color: var(--text-light);\n    font-size: 1rem;\n}\n.hash-text {\n    font-family: 'Courier New', Courier, monospace;\n    font-size: 0.95rem;\n    word-break: break-all;\n}\n\n/* --- QR Code Section --- */\n.qr-section {\n    display: none; /* toggled on for PE */\n    align-items: center;\n}\n.qr-code-wrapper {\n    display: inline-flex;\n    padding: 0.5rem;\n    background: #fff;\n    border-radius: 8px;\n    box-shadow: 0 4px 12px rgba(0,0,0,0.08);\n}\n.qr-code-wrapper canvas,\n.qr-code-wrapper img {\n    width: 160px;\n    height: 160px;\n}\nbody.light-theme .qr-code-wrapper {\n    box-shadow: 0 2px 8px rgba(0,0,0,0.08);\n}\n\n/* --- Vendor & Signature --- */\n.details-grid {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 1.5rem;\n    margin-bottom: 1.25rem;\n}\n.vendor-info, .signature-info {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    font-size: 1rem;\n    font-weight: 500;\n}\n.vendor-info i {\n    font-size: 1.5rem;\n    color: var(--text-medium);\n}\n.signature-info i {\n    font-size: 1.25rem;\n}\n/* Use the levels from datasrcs.js */\n.sig-verified { color: var(--green); }\n.sig-untrusted { color: var(--red); }\n.sig-unknown { color: var(--yellow); }\n\n/* --- File Internals Card --- */\n.file-internals-container {\n    width: 100%;\n    background-color: var(--bg-dark-2);\n    border-radius: 12px;\n    border: 1px solid var(--border-color);\n    padding: 2rem;\n    display: none; /* Hidden by default */\n    box-sizing: border-box;\n    flex-direction: column;\n    gap: 1.5rem;\n}\nbody.is-showing-result .file-internals-container {\n    display: flex;\n}\n.file-internals-container h3 {\n    margin-top: 0;\n    margin-bottom: 0;\n    color: var(--text-light);\n    font-size: 1.25rem;\n    padding-bottom: 1rem;\n    border-bottom: 1px solid var(--border-color);\n}\n\n/* --- Entropy Bars --- */\n.entropy-bars {\n    display: flex;\n    flex-direction: column;\n    gap: 0.75rem;\n}\n.entropy-bar-row {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n}\n.entropy-bar-label {\n    width: 60px;\n    font-family: 'Courier New', Courier, monospace;\n    font-size: 0.9rem;\n    color: var(--text-medium);\n    flex-shrink: 0;\n}\n.entropy-bar-bg {\n    flex-grow: 1;\n    height: 20px;\n    background-color: var(--bg-dark-3);\n    border-radius: 4px;\n    overflow: hidden;\n}\n.entropy-bar-fill {\n    height: 100%;\n    width: 0%; /* Set by JS */\n    background-color: var(--blue);\n    border-radius: 4px;\n    transition: width 0.5s ease;\n    display: flex;\n    justify-content: flex-end;\n    align-items: center;\n    padding-right: 0.5rem;\n    box-sizing: border-box;\n}\n.entropy-bar-value {\n    font-size: 0.8rem;\n    font-weight: bold;\n    color: var(--syntax-const-text); /* MODIFIED */\n    text-shadow: 0 0 3px rgba(0,0,0,0.5);\n}\n/* Color coding for entropy bars */\n.entropy-bar-fill.low { background-color: var(--green); }\n.entropy-bar-fill.medium { background-color: var(--blue); }\n.entropy-bar-fill.high { background-color: var(--yellow); }\n.entropy-bar-fill.packed { background-color: var(--red); }\n\n/* --- Key Strings --- */\n.key-strings {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 0.5rem;\n}\n.key-string-tag {\n    font-family: 'Courier New', Courier, monospace;\n    font-size: 0.9rem;\n    background-color: var(--bg-dark-3);\n    border: 1px solid var(--border-color);\n    padding: 0.25rem 0.5rem;\n    border-radius: 4px;\n    color: var(--text-light);\n}\n.key-string-tag.suspicious {\n    border-color: var(--red);\n    color: var(--red);\n    background-color: #e74c3c1a;\n}\n.key-string-tag.benign {\n    border-color: var(--green);\n    color: var(--green);\n    background-color: #2ecc711a;\n}\n\n/* --- Buttons --- */\n.btn-wrapper {\n    margin-top: 2rem;\n    display: flex;\n    gap: 1rem;\n}\n.btn {\n    flex-grow: 1; /* Make buttons fill space */\n    background-color: var(--blue);\n    color: var(--syntax-const-text); /* MODIFIED */\n    border: none;\n    padding: 12px 24px;\n    border-radius: 6px;\n    font-size: 1rem;\n    font-weight: bold;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    text-decoration: none;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    gap: 0.5rem;\n}\n.btn:hover {\n    filter: brightness(1.2);\n}\n.btn-primary {\n    background-color: var(--blue);\n}\n.btn-secondary {\n    background-color: var(--bg-dark-4);\n    color: var(--text-light);\n}\n.btn-secondary:hover {\n    background-color: #555;\n}\n.btn i {\n    margin-right: 0.25rem;\n}\n\n\n/* --- Background Particle Animations --- */\n.animation-swarm {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%; \n    height: 100%;\n    z-index: -1;\n    pointer-events: none;\n    overflow: hidden; \n}\n\n/* Base style for each new span particle */\n.animation-swarm span {\n    position: absolute;\n    top: -20px; /* Start off-screen */\n    font-size: 1.5rem;\n    opacity: 0; /* Start invisible */\n    animation: fall 10s linear infinite;\n}\n\n/* The ::before holds the icon content */\n.animation-swarm span::before {\n    content: '';\n    font-family: \"Font Awesome 6 Free\";\n    font-weight: 900;\n    text-shadow: 0 0 5px;\n}\n\n/* Keyframes for falling (starts with opacity) */\n@keyframes fall {\n    0% {\n        transform: translateY(0vh) rotate(0);\n        opacity: 0.3;\n    }\n    100% {\n        transform: translateY(105vh) rotate(360deg);\n        opacity: 0;\n    }\n}\n\n/* Set icon and color based on body class */\nbody.result-safe-active .animation-swarm span::before {\n    content: '\\f132'; /* fa-shield-halved */\n    color: var(--green);\n}\nbody.result-suspicious-active .animation-swarm span::before {\n    content: '\\f071'; /* fa-exclamation-triangle */\n    color: var(--yellow);\n}\nbody.result-malware-active .animation-swarm span::before {\n    content: '\\f188'; /* fa-bug */\n    color: var(--red);\n}\n\n/* Give each particle a unique position and delay --- THIS IS THE FINAL FIX --- */\n/* All values are kept well away from the 90-100% range */\n.animation-swarm span:nth-child(1) { left: 10%; animation-delay: 0s; }\n.animation-swarm span:nth-child(2) { left: 20%; animation-delay: -2s; }\n.animation-swarm span:nth-child(3) { left: 30%; animation-delay: -4s; }\n.animation-swarm span:nth-child(4) { left: 40%; animation-delay: -6s; }\n.animation-swarm span:nth-child(5) { left: 50%; animation-delay: -8s; }\n.animation-swarm span:nth-child(6) { left: 60%; animation-delay: -1s; }\n.animation-swarm span:nth-child(7) { left: 70%; animation-delay: -3s; }\n.animation-swarm span:nth-child(8) { left: 75%; animation-delay: -5s; } /* Was 80% */\n.animation-swarm span:nth-child(9) { left: 15%; animation-delay: -7s; } /* Was 90% */\n.animation-swarm span:nth-child(10) { left: 5%; animation-delay: -9s; }\n\n\n/* --- History Panel --- */\n.history-overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0,0,0,0.5);\n    z-index: 1001;\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n}\n.history-panel {\n    position: fixed;\n    top: 0;\n    right: -450px; /* Start off-screen */\n    width: 400px;\n    max-width: 90%;\n    height: 100%;\n    background-color: var(--bg-dark-2);\n    z-index: 1002;\n    transition: all 0.3s ease;\n    display: flex;\n    flex-direction: column;\n}\nbody.is-history-open .history-overlay {\n    opacity: 1;\n    visibility: visible;\n}\nbody.is-history-open .history-panel {\n    right: 0;\n}\n.history-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 1rem 1.5rem;\n    border-bottom: 1px solid var(--border-color);\n}\n.history-header h3 {\n    margin: 0;\n    font-size: 1.2rem;\n}\n.history-close-btn {\n    background: none;\n    border: none;\n    color: var(--text-medium);\n    font-size: 1.5rem;\n    cursor: pointer;\n    transition: all 0.2s ease;\n}\n.history-close-btn:hover {\n    color: var(--text-light);\n}\n.history-list {\n    list-style: none;\n    padding: 0;\n    margin: 0;\n    overflow-y: auto;\n    flex-grow: 1;\n}\n.history-list li {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    padding: 1rem 1.5rem;\n    border-bottom: 1px solid var(--border-color);\n    transition: background-color 0.2s ease;\n}\n\n.history-list li:hover {\n    background-color: var(--bg-dark-3);\n}\n\n.history-item {\n    display: flex;\n    align-items: flex-start;\n    gap: 1rem;\n}\n\n.history-icon-wrapper {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.5rem;\n    min-width: 60px;\n}\n\n.history-icon {\n    font-size: 1.8rem;\n    width: 40px;\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 8px;\n    background-color: var(--bg-dark-3);\n}\n\n.history-icon.safe {\n    color: var(--green);\n    border: 2px solid var(--green);\n}\n\n.history-icon.suspicious {\n    color: var(--yellow);\n    border: 2px solid var(--yellow);\n}\n\n.history-icon.malware {\n    color: var(--red);\n    border: 2px solid var(--red);\n}\n\n.history-file-type {\n    font-size: 1rem;\n    color: var(--text-medium);\n}\n\n.history-details {\n    flex-grow: 1;\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n    min-width: 0; /* Allow text truncation */\n}\n\n.history-filename {\n    font-weight: 600;\n    color: var(--text-light);\n    font-size: 0.95rem;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.history-classification {\n    font-size: 0.85rem;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n}\n\n.history-classification.safe {\n    color: var(--green);\n}\n\n.history-classification.suspicious {\n    color: var(--yellow);\n}\n\n.history-classification.malware {\n    color: var(--red);\n}\n\n.history-hash {\n    font-family: 'Courier New', Courier, monospace;\n    font-size: 0.75rem;\n    color: var(--text-medium);\n    background-color: var(--bg-dark-3);\n    padding: 0.25rem 0.5rem;\n    border-radius: 4px;\n    word-break: break-all;\n    line-height: 1.4;\n}\n\n.history-date {\n    font-size: 0.8rem;\n    color: var(--text-medium);\n    white-space: nowrap;\n    align-self: flex-start;\n    padding-top: 0.25rem;\n}\n\n.history-item-empty,\n.history-item-loading {\n    color: var(--text-medium);\n    text-align: center;\n    padding: 2rem;\n    font-style: italic;\n}\n\n\n/* --- Hover Scroll Zones --- */\n.scroll-zone {\n    position: fixed;\n    left: 0;\n    width: 100%;\n    height: 80px;\n    z-index: 998;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n.scroll-zone.top { top: 60px; /* Below nav */ }\n.scroll-zone.bottom { bottom: 0; }\n\n.scroll-zone i {\n    font-size: 2rem;\n    color: var(--text-light);\n    opacity: 0;\n    transition: all 0.3s ease;\n    text-shadow: 0 0 15px rgba(0,0,0,0.7);\n}\n.scroll-zone.scrolling i {\n    opacity: 0.3;\n}\n.scroll-zone:hover i {\n    opacity: 0.7;\n}\n\n\n/* --- Graph Panel --- */\n.graph-wrapper {\n    background-color: var(--bg-dark-2);\n    border-radius: 12px;\n    border: 1px solid var(--border-color);\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n    margin-top: 1rem;\n    display: none; /* Hidden by default */\n    box-sizing: border-box;\n}\nbody.is-showing-result .graph-wrapper {\n    display: block; /* Show with results */\n}\n\n.graph-header {\n    padding: 1rem 1.5rem;\n    border-bottom: 1px solid var(--border-color);\n    background-color: var(--bg-dark-3);\n    border-radius: 12px 12px 0 0;\n}\n.graph-header h3 {\n    margin: 0;\n    color: var(--text-light);\n    font-size: 1.1rem;\n}\n.call-graph-container {\n    overflow: auto; /* Allow scrolling for large graphs */\n}\n.call-graph {\n    flex-grow: 1;\n    overflow: auto;\n    position: relative; /* KEY for node positioning */\n    min-height: 400px;\n    padding: 1rem;\n}\n\n.graph-node {\n    position: absolute;\n    padding: 0.75rem 1.25rem;\n    border-radius: 8px;\n    background-color: var(--bg-dark-3);\n    border: 2px solid var(--border-color);\n    font-family: 'Courier New', Courier, monospace;\n    font-weight: bold;\n    white-space: nowrap;\n    box-shadow: 0 4px 10px rgba(0,0,0,0.3);\n    z-index: 2;\n    text-align: center;\n}\n/* MODIFIED to use variables */\n.node-entry { background-color: var(--node-bg-entry); border-color: var(--green); color: var(--syntax-const-text); }\n.node-std { background-color: var(--bg-dark-3); border-color: var(--border-color); color: var(--text-light); }\n.node-api { background-color: var(--node-bg-api); border-color: var(--blue); color: var(--syntax-const-text); }\n.node-suspicious { background-color: var(--node-bg-suspicious); border-color: var(--yellow); color: var(--syntax-const-text); }\n.node-malicious { background-color: var(--node-bg-malicious); border-color: var(--red); color: var(--syntax-const-text); }\n\n.leader-line {\n    z-index: 1; /* Sit behind nodes */\n    opacity: 0.8;\n}\nbody.light-theme .chart-container {\n    color: var(--text-medium);\n}\n\n/* Light theme navigation buttons */\n/* Light theme navigation buttons */\nbody.light-theme .nav-btn {\n    background: linear-gradient(135deg, #8b5cf6, #7c3aed) !important;\n    color: white !important;\n    box-shadow: 0 4px 12px rgba(139, 92, 246, 0.5) !important;\n}\n\nbody.light-theme .nav-btn:hover:not(:disabled) {\n    background: linear-gradient(135deg, #7c3aed, #6d28d9) !important;\n    box-shadow: 0 6px 20px rgba(139, 92, 246, 0.7) !important;\n}\n\nbody.light-theme .nav-btn:disabled {\n    background: #e9ecef !important;\n    color: #adb5bd !important;\n    box-shadow: none !important;\n    opacity: 0.7 !important;\n}\n\nbody.light-theme .nav-info {\n    color: var(--text-light);\n    font-weight: 600;\n}\n\nbody.light-theme .scan-navigation {\n    border-top-color: var(--border-color);\n}\n","epoch":3,"telemetryInfo":{}}],["file:///home/trang/localnsv/mAIware/style.css::request_5c76fc1b-ce49-4733-b35a-1b234523720a",{"uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware/style.css","external":"file:///home/trang/localnsv/mAIware/style.css","path":"/home/trang/localnsv/mAIware/style.css","scheme":"file"},"requestId":"request_5c76fc1b-ce49-4733-b35a-1b234523720a","content":"/* --- Global & Fonts --- */\n:root {\n    /* --- Dark Theme (Default) --- */\n    --bg-dark-1: #121212;\n    --bg-dark-2: #1e1e1e;\n    --bg-dark-3: #2a2a2e;\n    --bg-dark-4: #333333;\n    --border-color: #444444;\n    --text-light: #e0e0e0;\n    --text-medium: #aaa;\n    --text-dark: #888;\n    \n    /* --- Semantic Colors --- */\n    --blue: #007bff;\n    --red: #e74c3c;\n    --yellow: #f1c40f;\n    --green: #2ecc71;\n    \n    /* --- Syntax & Node Colors --- */\n    --syntax-op: #c39eff;\n    --syntax-string: #e6db74;\n    --syntax-const-text: #ffffff; /* Constant white for dark buttons/nodes */\n    --node-bg-entry: #254a25;\n    --node-bg-api: #2a3e4a;\n    --node-bg-suspicious: #4a452a;\n    --node-bg-malicious: #4a2a2a;\n\n    --chart-legend-text: var(--text-light);  /* #e0e0e0 */\n    --chart-axes-text: var(--text-medium);   /* #aaa */\n    --chart-grid-line: var(--border-color);\n}\n\n/* --- Light Theme --- */\n/* Add \".light-theme\" to the <body> tag to activate */\nbody.light-theme {\n    --bg-dark-1: #f8f9fa;     /* Main background */\n    --bg-dark-2: #ffffff;     /* Card background */\n    --bg-dark-3: #e9ecef;     /* Hover/active background */\n    --bg-dark-4: #ced4da;     /* Secondary button background */\n    --border-color: #dee2e6;  /* Border color */\n    --text-light: #212529;    /* Main text */\n    --text-medium: #6c757d;   /* Secondary text */\n    --text-dark: #888;        /* Tertiary text (can stay gray) */\n    \n    /* Semantic colors are unchanged */\n    /* --blue, --red, --yellow, --green */\n    \n    /* --- Light Theme Syntax --- */\n    --syntax-op: #a040ff;       /* Darker purple */\n    --syntax-string: #b8860b;     /* Dark goldenrod */\n    --syntax-const-text: #ffffff; /* Stays white for colored buttons/nodes */\n    \n    /* Node backgrounds are unchanged, they look good on a light BG */\n    --chart-legend-text: var(--text-medium); /* User Request */\n    --chart-axes-text: var(--text-medium);   /* User Request */\n    --chart-grid-line: var(--border-color);\n}\n\n\n/* Apply overflow-x to html as well */\nhtml {\n    overflow-x: hidden;\n    font-size: 16px; /* Ensure base font size */\n}\n\nbody {\n    font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif;\n    background-image: url('https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.haitrieu.com%2Fwp-content%2Fuploads%2F2021%2F10%2FLogo-DH-Bach-Khoa-Ha-Noi-HUST-768x1155.png&f=1&nofb=1&ipt=598a3038f030b5dba19d0bf0aebe948286d6ce95654501c9835d2bd690d0810e');\n    background-size: cover;\n    background-position: center;\n    background-attachment: fixed;\n    background-repeat: no-repeat;\n    background-color: var(--bg-dark-1);\n    color: var(--text-light);\n    margin: 0;\n    padding-top: 60px; /* Make space for fixed top nav */\n    overflow-x: hidden; /* Prevent horizontal scroll */\n    width: 100%;\n    min-height: 100vh;\n}\n\n/* --- Main Grid Container --- */\n.main-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr; /* Simpler 2-column definition */\n    grid-template-rows: auto auto; /* Rows for content and graph */\n    gap: 2rem;\n    padding: 2rem; /* Spacing from nav and screen edges */\n    align-items: start;\n    \n    /* Set max-width on the grid itself */\n    max-width: 1400px; \n    /* Center the whole grid */\n    margin: 0 auto; \n    \n    min-height: calc(100vh - 60px); /* Full height minus nav */\n    box-sizing: border-box;\n    width: 100%;\n}\n\n.scanner-wrapper {\n    grid-column: 1 / 2; /* Span first column */\n    grid-row: 1 / 2;\n    display: flex;\n    flex-direction: column;\n    gap: 1.5rem;\n    width: 100%; /* Fill the column */\n}\n\n.right-panel-wrapper {\n    grid-column: 2 / 3; /* Span second column */\n    grid-row: 1 / 2;\n    display: flex; /* Make it a flex container */\n    flex-direction: column; /* Stack its children vertically */\n    gap: 1.5rem; /* Space between its children */\n    width: 100%; /* Fill the column */\n}\n\n.graph-wrapper {\n    grid-column: 1 / 3; /* Span BOTH columns */\n    grid-row: 2 / 3;\n    width: 100%;\n    /* max-width is now inherited from main-container */\n    justify-self: center; /* Center in the grid area */\n}\n\n\n/* --- Top Navigation --- */\n.top-nav {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 60px;\n    background-color: var(--bg-dark-2);\n    border-bottom: 1px solid var(--border-color);\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0 2rem;\n    z-index: 1000;\n    box-sizing: border-box;\n}\n\n.top-nav .logo {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    font-size: 1.3rem;\n    font-weight: 600;\n    color: var(--text-light);\n}\n\n.top-nav .logo i {\n    color: var(--blue);\n}\n\n.nav-links {\n    display: flex;\n    gap: 0.5rem;\n}\n\n.nav-link {\n    color: var(--text-medium);\n    font-size: 1.25rem;\n    padding: 0.75rem;\n    border-radius: 8px;\n    transition: all 0.2s ease;\n    position: relative;\n    text-decoration: none;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.nav-link .link-text {\n    font-size: 0.9rem;\n    font-weight: 500;\n    max-width: 0;\n    overflow: hidden;\n    white-space: nowrap;\n    transition: all 0.3s ease;\n}\n\n.nav-link:hover {\n    background-color: var(--bg-dark-3);\n    color: var(--text-light);\n}\n\n.nav-link:hover .link-text {\n    max-width: 80px; /* Expand text on hover */\n    margin-left: 0.25rem;\n}\n\n/* --- Tooltip --- */\n.nav-link:hover::before {\n    content: attr(data-tooltip);\n    position: absolute;\n    bottom: -35px;\n    left: 50%;\n    transform: translateX(-50%);\n    background-color: var(--bg-dark-3);\n    color: var(--text-light);\n    padding: 5px 10px;\n    border-radius: 4px;\n    font-size: 0.8rem;\n    white-space: nowrap;\n    opacity: 0;\n    transition: opacity 0.2s 0.3s; /* Delay tooltip */\n    pointer-events: none;\n}\n.nav-link:hover .link-text {\n    display: none; /* Hide expanded text if tooltip is showing */\n}\n.nav-link:hover:hover::before {\n    opacity: 1;\n}\n\n/* On smaller screens, stack the columns */\n@media (max-width: 1280px) { /* Widened breakpoint */\n    .main-container {\n        grid-template-columns: 1fr; /* Stack columns */\n        padding: 1rem;\n    }\n    .scanner-wrapper, .right-panel-wrapper, .graph-wrapper {\n        grid-column: 1 / 2; /* All in one column */\n        max-width: 100%;\n        justify-self: center;\n    }\n    .right-panel-wrapper {\n        grid-row: 2 / 3;\n    }\n    .graph-wrapper {\n        grid-row: 3 / 4;\n    }\n}\n\n/* Hide link text on very small screens */\n@media (max-width: 768px) {\n    .nav-link .link-text { display: none; }\n    .nav-link:hover .link-text { display: none; }\n    .top-nav { padding: 0 1rem; }\n}\n\n\n/* --- Main Scanner Box --- */\n.scanner-container {\n    width: 100%; /* Ensure it fills its flex parent */\n    background-color: var(--bg-dark-2);\n    border-radius: 12px;\n    border: 1px solid var(--border-color);\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n    padding: 2.5rem;\n    text-align: center;\n    overflow: hidden;\n    transition: all 0.3s ease;\n    box-sizing: border-box; /* Include padding in width */\n}\n\nh1 {\n    color: var(--text-light);\n    margin-top: 0;\n    margin-bottom: 1rem;\n}\n\n.scanner-container p {\n    color: var(--text-medium);\n    margin-bottom: 2rem;\n    font-size: 1.1rem;\n}\n\n.scanner-state {\n    display: none;\n}\n.scanner-state.active {\n    display: block;\n}\n\n/* --- State 1: Upload --- */\n.upload-zone {\n    border: 2px dashed var(--border-color);\n    border-radius: 8px;\n    padding: 3rem 2rem;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n.upload-zone:hover {\n    background-color: var(--bg-dark-3);\n    border-color: var(--blue);\n}\n.upload-icon {\n    font-size: 4rem;\n    color: var(--blue);\n    margin-bottom: 1rem;\n}\n.upload-zone h3 {\n    margin: 0;\n    color: var(--text-light);\n}\n.upload-zone span {\n    color: var(--text-dark);\n}\n\n.manual-upload {\n    margin-top: 1.5rem;\n    text-align: center;\n}\n\n.manual-upload .btn {\n    width: 100%;\n    justify-content: center;\n}\n\n.manual-scan-hint {\n    color: var(--text-dark);\n    font-size: 0.95rem;\n    margin: 0.75rem 0 0;\n}\n\n.manual-error {\n    color: var(--red);\n    font-size: 0.9rem;\n    margin-top: 0.5rem;\n    min-height: 1.2rem;\n}\n\n/* --- State 2: Analyzing --- */\n.analyzing-icon .loader {\n    width: 80px;\n    height: 80px;\n    border: 6px solid var(--bg-dark-4);\n    border-top-color: var(--blue);\n    border-radius: 50%;\n    animation: spin 1s linear infinite;\n    margin: 2rem auto;\n}\n@keyframes spin {\n    to { transform: rotate(360deg); }\n}\n.analyzing-state h3 {\n    color: var(--text-light);\n    margin-bottom: 0.5rem;\n}\n.analyzing-state .filename,\n.result-state .filename {\n    color: var(--text-medium);\n    font-family: 'Courier New', Courier, monospace;\n    font-size: 1.1rem;\n    word-break: break-all;\n}\n\n/* --- State 3: Result --- */\n.result-icon {\n    font-size: 6rem;\n    line-height: 1;\n    margin: 1.5rem 0;\n}\n.result-state h2 {\n    font-size: 2.5rem;\n    margin: 0 0 0.5rem 0;\n}\n.result-malware .result-icon, .result-malware h2 { color: var(--red); }\n.result-suspicious .result-icon, .result-suspicious h2 { color: var(--yellow); }\n.result-safe .result-icon, .result-safe h2 { color: var(--green); }\n.result-state p {\n    font-size: 1rem;\n    margin-bottom: 2rem;\n}\n\n/* --- Scan Navigation Controls --- */\n.scan-navigation {\n    display: none;\n    align-items: center;\n    justify-content: center;\n    gap: 1.5rem;\n    margin: 1.5rem 0;\n    padding: 1rem;\n    background: rgba(255, 255, 255, 0.03);\n    border-radius: 8px;\n}\n\n/* Show navigation only when results are displayed */\nbody.is-showing-result .scan-navigation,\nbody.is-non-pe .scan-navigation {\n    display: flex;\n}\n\n.nav-btn {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.75rem 1.5rem;\n    background: linear-gradient(135deg, var(--primary), var(--secondary));\n    color: white;\n    border: none;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 600;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);\n}\n\n.nav-btn:hover:not(:disabled) {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 20px rgba(139, 92, 246, 0.5);\n}\n\n.nav-btn:active:not(:disabled) {\n    transform: translateY(0);\n}\n\n.nav-btn:disabled {\n    background: rgba(255, 255, 255, 0.1) !important;\n    color: rgba(255, 255, 255, 0.3) !important;\n    cursor: not-allowed;\n    box-shadow: none !important;\n}\n\n.nav-info {\n    color: var(--text-medium);\n    font-size: 0.95rem;\n    font-weight: 500;\n    min-width: 80px;\n    text-align: center;\n}\n\n.non-pe-result {\n    display: none;\n    flex-direction: column;\n    align-items: center;\n    gap: 1.5rem;\n    color: var(--text-light);\n    padding: 1rem 0 0 0;\n}\n\n.non-pe-result.active {\n    display: flex;\n}\n\n.non-pe-icon {\n    width: 96px;\n    height: 96px;\n    border-radius: 24px;\n    background: linear-gradient(135deg, rgba(80, 130, 255, 0.2), rgba(80, 130, 255, 0.05));\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 3rem;\n    color: var(--blue);\n}\n\n.non-pe-hash-grid {\n    display: flex;\n    gap: 1.5rem;\n    flex-wrap: wrap;\n    justify-content: center;\n}\n\n.non-pe-hash {\n    min-width: 220px;\n    background: var(--bg-dark-3);\n    padding: 1rem 1.25rem;\n    border-radius: 12px;\n    border: 1px solid rgba(255, 255, 255, 0.05);\n    text-align: left;\n}\n\n.non-pe-hash h4 {\n    margin: 0 0 0.5rem 0;\n    font-size: 0.85rem;\n    text-transform: uppercase;\n    letter-spacing: 0.08rem;\n    color: var(--text-medium);\n}\n\n.non-pe-hash p {\n    font-family: 'Courier New', Courier, monospace;\n    font-size: 0.9rem;\n    word-break: break-all;\n    color: var(--text-light);\n}\n\nbody.is-non-pe .analysis-details-container,\nbody.is-non-pe #analysis-details-wrapper,\nbody.is-non-pe #disassembly-wrapper,\nbody.is-non-pe #file-internals-wrapper,\nbody.is-non-pe #graph-wrapper {\n    display: none !important;\n}\n\nbody.is-non-pe #result-state {\n    display: none !important;\n}\n\nbody.is-non-pe .non-pe-result {\n    display: flex;\n}\n\n\n/* --- NEW: Stats Dashboard Panel --- */\n.stats-wrapper {\n    display: flex; \n    flex-direction: column;\n    gap: 1.5rem;\n    width: 100%; /* Fill its flex parent */\n    box-sizing: border-box; /* Include padding in width */\n}\n\n/* By default, stats are visible, disassembly is hidden */\n.disassembly-wrapper { display: none; }\n\n/* When analyzing/showing results, hide stats and show disassembly */\nbody.is-analyzing .stats-wrapper,\nbody.is-showing-result .stats-wrapper {\n    display: none;\n}\nbody.is-analyzing .disassembly-wrapper,\nbody.is-showing-result .disassembly-wrapper {\n    display: flex; /* Use flex to match its own styles */\n}\n\n\n.stats-grid {\n    display: flex; \n    flex-direction: column;\n    /* Force stacking */\n    gap: 1.5rem;\n}\n\n.stat-card {\n    display: flex;\n    align-items: center;\n    gap: 1.5rem;\n    background-color: var(--bg-dark-2);\n    padding: 1.5rem;\n    border-radius: 12px;\n    border: 1px solid var(--border-color);\n}\n.stat-card i {\n    font-size: 2.5rem;\n    color: var(--blue);\n}\n.stat-content {\n    display: flex;\n    flex-direction: column;\n}\n.stat-number {\n    font-size: 2rem;\n    font-weight: 600;\n    color: var(--text-light);\n    line-height: 1.2;\n}\n.stat-label {\n    font-size: 0.9rem;\n    color: var(--text-medium);\n}\n\n.chart-container-wrapper {\n    display: flex;\n    flex-direction: column;\n    gap: 1.5rem;\n}\n\n.chart-container {\n    background-color: var(--bg-dark-2);\n    padding: 1.5rem;\n    border-radius: 12px;\n    border: 1px solid var(--border-color);\n    box-sizing: border-box;\n}\n.chart-container h3 {\n    margin-top: 0;\n    margin-bottom: 1.5rem;\n    text-align: center;\n    color: var(--text-light);\n    font-size: 1.1rem;\n}\n\n\n/* --- Disassembly Panel --- */\n.disassembly-wrapper {\n    /* display: none; set by default now */\n    flex-direction: column;\n    background-color: var(--bg-dark-2);\n    border-radius: 12px;\n    border: 1px solid var(--border-color);\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n    height: 600px; /* Fixed height */\n    max-height: 70vh;\n    opacity: 0;\n    transition: all 0.3s ease;\n    width: 100%;\n    box-sizing: border-box;\n}\n\nbody.is-analyzing .disassembly-wrapper,\nbody.is-showing-result .disassembly-wrapper {\n    opacity: 1;\n}\n\n.disassembly-header {\n    padding: 1rem 1.5rem;\n    border-bottom: 1px solid var(--border-color);\n    background-color: var(--bg-dark-3);\n    border-radius: 12px 12px 0 0;\n}\n.disassembly-header h3 {\n    margin: 0;\n    color: var(--text-light);\n    font-size: 1.1rem;\n    font-family: 'Courier New', Courier, monospace;\n}\n.disassembly-code {\n    flex-grow: 1;\n    overflow-y: auto;\n    padding: 1rem;\n    font-family: 'Courier New', Courier, monospace;\n    font-size: 0.95rem;\n}\n.disassembly-line {\n    display: block;\n    padding: 2px 1rem;\n    border-radius: 4px;\n    transition: background-color 0.2s ease;\n}\n.disassembly-line.active {\n    background-color: var(--blue);\n    color: var(--syntax-const-text); /* MODIFIED */\n}\n.disassembly-line .addr { color: var(--text-dark); margin-right: 1rem; }\n.disassembly-line .op { color: var(--syntax-op); font-weight: bold; width: 50px; display: inline-block; } /* MODIFIED */\n.disassembly-line .args { color: var(--text-light); }\n.disassembly-line .string { color: var(--syntax-string); } /* MODIFIED */\n.disassembly-line .comment { color: var(--green); margin-left: 1rem; }\n\n\n/* --- Analysis Details Panel --- */\n.analysis-details-container {\n    width: 100%;\n    background-color: var(--bg-dark-2);\n    border-radius: 12px;\n    border: 1px solid var(--border-color);\n    padding: 2rem;\n    display: none; /* Hidden by default */\n    box-sizing: border-box;\n}\nbody.is-showing-result .analysis-details-container {\n    display: block;\n}\n\n.progress-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 0.75rem;\n}\n.progress-header h3 {\n    margin: 0;\n    font-size: 1.1rem;\n    color: var(--text-light);\n}\n.score-percentage {\n    font-size: 1.2rem;\n    font-weight: 600;\n}\n.score-green { color: var(--green); }\n.score-yellow { color: var(--yellow); }\n.score-red { color: var(--red); }\n\n.progress-bar-background {\n    width: 100%;\n    height: 12px;\n    background-color: var(--bg-dark-3);\n    border-radius: 6px;\n    overflow: hidden;\n    margin-bottom: 1.5rem;\n}\n.progress-bar-fill {\n    height: 100%;\n    width: 0%;\n    border-radius: 6px;\n    transition: width 0.5s ease;\n}\n.progress-bar-green { background-color: var(--green); }\n.progress-bar-yellow { background-color: var(--yellow); }\n.progress-bar-red { background-color: var(--red); }\n\n.details-section {\n    margin-bottom: 1.25rem;\n}\n.details-section h4 {\n    margin: 0 0 0.5rem 0;\n    color: var(--text-medium);\n    font-size: 0.9rem;\n    text-transform: uppercase;\n}\n.details-section p {\n    margin: 0;\n    color: var(--text-light);\n    font-size: 1rem;\n}\n.hash-text {\n    font-family: 'Courier New', Courier, monospace;\n    font-size: 0.95rem;\n    word-break: break-all;\n}\n\n/* --- QR Code Section --- */\n.qr-section {\n    display: none; /* toggled on for PE */\n    align-items: center;\n}\n.qr-code-wrapper {\n    display: inline-flex;\n    padding: 0.5rem;\n    background: #fff;\n    border-radius: 8px;\n    box-shadow: 0 4px 12px rgba(0,0,0,0.08);\n}\n.qr-code-wrapper canvas,\n.qr-code-wrapper img {\n    width: 160px;\n    height: 160px;\n}\nbody.light-theme .qr-code-wrapper {\n    box-shadow: 0 2px 8px rgba(0,0,0,0.08);\n}\n\n/* --- Vendor & Signature --- */\n.details-grid {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 1.5rem;\n    margin-bottom: 1.25rem;\n}\n.vendor-info, .signature-info {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    font-size: 1rem;\n    font-weight: 500;\n}\n.vendor-info i {\n    font-size: 1.5rem;\n    color: var(--text-medium);\n}\n.signature-info i {\n    font-size: 1.25rem;\n}\n/* Use the levels from datasrcs.js */\n.sig-verified { color: var(--green); }\n.sig-untrusted { color: var(--red); }\n.sig-unknown { color: var(--yellow); }\n\n/* --- File Internals Card --- */\n.file-internals-container {\n    width: 100%;\n    background-color: var(--bg-dark-2);\n    border-radius: 12px;\n    border: 1px solid var(--border-color);\n    padding: 2rem;\n    display: none; /* Hidden by default */\n    box-sizing: border-box;\n    flex-direction: column;\n    gap: 1.5rem;\n}\nbody.is-showing-result .file-internals-container {\n    display: flex;\n}\n.file-internals-container h3 {\n    margin-top: 0;\n    margin-bottom: 0;\n    color: var(--text-light);\n    font-size: 1.25rem;\n    padding-bottom: 1rem;\n    border-bottom: 1px solid var(--border-color);\n}\n\n/* --- Entropy Bars --- */\n.entropy-bars {\n    display: flex;\n    flex-direction: column;\n    gap: 0.75rem;\n}\n.entropy-bar-row {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n}\n.entropy-bar-label {\n    width: 60px;\n    font-family: 'Courier New', Courier, monospace;\n    font-size: 0.9rem;\n    color: var(--text-medium);\n    flex-shrink: 0;\n}\n.entropy-bar-bg {\n    flex-grow: 1;\n    height: 20px;\n    background-color: var(--bg-dark-3);\n    border-radius: 4px;\n    overflow: hidden;\n}\n.entropy-bar-fill {\n    height: 100%;\n    width: 0%; /* Set by JS */\n    background-color: var(--blue);\n    border-radius: 4px;\n    transition: width 0.5s ease;\n    display: flex;\n    justify-content: flex-end;\n    align-items: center;\n    padding-right: 0.5rem;\n    box-sizing: border-box;\n}\n.entropy-bar-value {\n    font-size: 0.8rem;\n    font-weight: bold;\n    color: var(--syntax-const-text); /* MODIFIED */\n    text-shadow: 0 0 3px rgba(0,0,0,0.5);\n}\n/* Color coding for entropy bars */\n.entropy-bar-fill.low { background-color: var(--green); }\n.entropy-bar-fill.medium { background-color: var(--blue); }\n.entropy-bar-fill.high { background-color: var(--yellow); }\n.entropy-bar-fill.packed { background-color: var(--red); }\n\n/* --- Key Strings --- */\n.key-strings {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 0.5rem;\n}\n.key-string-tag {\n    font-family: 'Courier New', Courier, monospace;\n    font-size: 0.9rem;\n    background-color: var(--bg-dark-3);\n    border: 1px solid var(--border-color);\n    padding: 0.25rem 0.5rem;\n    border-radius: 4px;\n    color: var(--text-light);\n}\n.key-string-tag.suspicious {\n    border-color: var(--red);\n    color: var(--red);\n    background-color: #e74c3c1a;\n}\n.key-string-tag.benign {\n    border-color: var(--green);\n    color: var(--green);\n    background-color: #2ecc711a;\n}\n\n/* --- Buttons --- */\n.btn-wrapper {\n    margin-top: 2rem;\n    display: flex;\n    gap: 1rem;\n}\n.btn {\n    flex-grow: 1; /* Make buttons fill space */\n    background-color: var(--blue);\n    color: var(--syntax-const-text); /* MODIFIED */\n    border: none;\n    padding: 12px 24px;\n    border-radius: 6px;\n    font-size: 1rem;\n    font-weight: bold;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    text-decoration: none;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    gap: 0.5rem;\n}\n.btn:hover {\n    filter: brightness(1.2);\n}\n.btn-primary {\n    background-color: var(--blue);\n}\n.btn-secondary {\n    background-color: var(--bg-dark-4);\n    color: var(--text-light);\n}\n.btn-secondary:hover {\n    background-color: #555;\n}\n.btn i {\n    margin-right: 0.25rem;\n}\n\n\n/* --- Background Particle Animations --- */\n.animation-swarm {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%; \n    height: 100%;\n    z-index: -1;\n    pointer-events: none;\n    overflow: hidden; \n}\n\n/* Base style for each new span particle */\n.animation-swarm span {\n    position: absolute;\n    top: -20px; /* Start off-screen */\n    font-size: 1.5rem;\n    opacity: 0; /* Start invisible */\n    animation: fall 10s linear infinite;\n}\n\n/* The ::before holds the icon content */\n.animation-swarm span::before {\n    content: '';\n    font-family: \"Font Awesome 6 Free\";\n    font-weight: 900;\n    text-shadow: 0 0 5px;\n}\n\n/* Keyframes for falling (starts with opacity) */\n@keyframes fall {\n    0% {\n        transform: translateY(0vh) rotate(0);\n        opacity: 0.3;\n    }\n    100% {\n        transform: translateY(105vh) rotate(360deg);\n        opacity: 0;\n    }\n}\n\n/* Set icon and color based on body class */\nbody.result-safe-active .animation-swarm span::before {\n    content: '\\f132'; /* fa-shield-halved */\n    color: var(--green);\n}\nbody.result-suspicious-active .animation-swarm span::before {\n    content: '\\f071'; /* fa-exclamation-triangle */\n    color: var(--yellow);\n}\nbody.result-malware-active .animation-swarm span::before {\n    content: '\\f188'; /* fa-bug */\n    color: var(--red);\n}\n\n/* Give each particle a unique position and delay --- THIS IS THE FINAL FIX --- */\n/* All values are kept well away from the 90-100% range */\n.animation-swarm span:nth-child(1) { left: 10%; animation-delay: 0s; }\n.animation-swarm span:nth-child(2) { left: 20%; animation-delay: -2s; }\n.animation-swarm span:nth-child(3) { left: 30%; animation-delay: -4s; }\n.animation-swarm span:nth-child(4) { left: 40%; animation-delay: -6s; }\n.animation-swarm span:nth-child(5) { left: 50%; animation-delay: -8s; }\n.animation-swarm span:nth-child(6) { left: 60%; animation-delay: -1s; }\n.animation-swarm span:nth-child(7) { left: 70%; animation-delay: -3s; }\n.animation-swarm span:nth-child(8) { left: 75%; animation-delay: -5s; } /* Was 80% */\n.animation-swarm span:nth-child(9) { left: 15%; animation-delay: -7s; } /* Was 90% */\n.animation-swarm span:nth-child(10) { left: 5%; animation-delay: -9s; }\n\n\n/* --- History Panel --- */\n.history-overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0,0,0,0.5);\n    z-index: 1001;\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s ease;\n}\n.history-panel {\n    position: fixed;\n    top: 0;\n    right: -450px; /* Start off-screen */\n    width: 400px;\n    max-width: 90%;\n    height: 100%;\n    background-color: var(--bg-dark-2);\n    z-index: 1002;\n    transition: all 0.3s ease;\n    display: flex;\n    flex-direction: column;\n}\nbody.is-history-open .history-overlay {\n    opacity: 1;\n    visibility: visible;\n}\nbody.is-history-open .history-panel {\n    right: 0;\n}\n.history-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 1rem 1.5rem;\n    border-bottom: 1px solid var(--border-color);\n}\n.history-header h3 {\n    margin: 0;\n    font-size: 1.2rem;\n}\n.history-close-btn {\n    background: none;\n    border: none;\n    color: var(--text-medium);\n    font-size: 1.5rem;\n    cursor: pointer;\n    transition: all 0.2s ease;\n}\n.history-close-btn:hover {\n    color: var(--text-light);\n}\n.history-list {\n    list-style: none;\n    padding: 0;\n    margin: 0;\n    overflow-y: auto;\n    flex-grow: 1;\n}\n.history-list li {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    padding: 1rem 1.5rem;\n    border-bottom: 1px solid var(--border-color);\n    transition: background-color 0.2s ease;\n}\n\n.history-list li:hover {\n    background-color: var(--bg-dark-3);\n}\n\n.history-item {\n    display: flex;\n    align-items: flex-start;\n    gap: 1rem;\n}\n\n.history-icon-wrapper {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.5rem;\n    min-width: 60px;\n}\n\n.history-icon {\n    font-size: 1.8rem;\n    width: 40px;\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 8px;\n    background-color: var(--bg-dark-3);\n}\n\n.history-icon.safe {\n    color: var(--green);\n    border: 2px solid var(--green);\n}\n\n.history-icon.suspicious {\n    color: var(--yellow);\n    border: 2px solid var(--yellow);\n}\n\n.history-icon.malware {\n    color: var(--red);\n    border: 2px solid var(--red);\n}\n\n.history-file-type {\n    font-size: 1rem;\n    color: var(--text-medium);\n}\n\n.history-details {\n    flex-grow: 1;\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n    min-width: 0; /* Allow text truncation */\n}\n\n.history-filename {\n    font-weight: 600;\n    color: var(--text-light);\n    font-size: 0.95rem;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.history-classification {\n    font-size: 0.85rem;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n}\n\n.history-classification.safe {\n    color: var(--green);\n}\n\n.history-classification.suspicious {\n    color: var(--yellow);\n}\n\n.history-classification.malware {\n    color: var(--red);\n}\n\n.history-hash {\n    font-family: 'Courier New', Courier, monospace;\n    font-size: 0.75rem;\n    color: var(--text-medium);\n    background-color: var(--bg-dark-3);\n    padding: 0.25rem 0.5rem;\n    border-radius: 4px;\n    word-break: break-all;\n    line-height: 1.4;\n}\n\n.history-date {\n    font-size: 0.8rem;\n    color: var(--text-medium);\n    white-space: nowrap;\n    align-self: flex-start;\n    padding-top: 0.25rem;\n}\n\n.history-item-empty,\n.history-item-loading {\n    color: var(--text-medium);\n    text-align: center;\n    padding: 2rem;\n    font-style: italic;\n}\n\n\n/* --- Hover Scroll Zones --- */\n.scroll-zone {\n    position: fixed;\n    left: 0;\n    width: 100%;\n    height: 80px;\n    z-index: 998;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n.scroll-zone.top { top: 60px; /* Below nav */ }\n.scroll-zone.bottom { bottom: 0; }\n\n.scroll-zone i {\n    font-size: 2rem;\n    color: var(--text-light);\n    opacity: 0;\n    transition: all 0.3s ease;\n    text-shadow: 0 0 15px rgba(0,0,0,0.7);\n}\n.scroll-zone.scrolling i {\n    opacity: 0.3;\n}\n.scroll-zone:hover i {\n    opacity: 0.7;\n}\n\n\n/* --- Graph Panel --- */\n.graph-wrapper {\n    background-color: var(--bg-dark-2);\n    border-radius: 12px;\n    border: 1px solid var(--border-color);\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n    margin-top: 1rem;\n    display: none; /* Hidden by default */\n    box-sizing: border-box;\n}\nbody.is-showing-result .graph-wrapper {\n    display: block; /* Show with results */\n}\n\n.graph-header {\n    padding: 1rem 1.5rem;\n    border-bottom: 1px solid var(--border-color);\n    background-color: var(--bg-dark-3);\n    border-radius: 12px 12px 0 0;\n}\n.graph-header h3 {\n    margin: 0;\n    color: var(--text-light);\n    font-size: 1.1rem;\n}\n.call-graph-container {\n    overflow: auto; /* Allow scrolling for large graphs */\n}\n.call-graph {\n    flex-grow: 1;\n    overflow: auto;\n    position: relative; /* KEY for node positioning */\n    min-height: 400px;\n    padding: 1rem;\n}\n\n.graph-node {\n    position: absolute;\n    padding: 0.75rem 1.25rem;\n    border-radius: 8px;\n    background-color: var(--bg-dark-3);\n    border: 2px solid var(--border-color);\n    font-family: 'Courier New', Courier, monospace;\n    font-weight: bold;\n    white-space: nowrap;\n    box-shadow: 0 4px 10px rgba(0,0,0,0.3);\n    z-index: 2;\n    text-align: center;\n}\n/* MODIFIED to use variables */\n.node-entry { background-color: var(--node-bg-entry); border-color: var(--green); color: var(--syntax-const-text); }\n.node-std { background-color: var(--bg-dark-3); border-color: var(--border-color); color: var(--text-light); }\n.node-api { background-color: var(--node-bg-api); border-color: var(--blue); color: var(--syntax-const-text); }\n.node-suspicious { background-color: var(--node-bg-suspicious); border-color: var(--yellow); color: var(--syntax-const-text); }\n.node-malicious { background-color: var(--node-bg-malicious); border-color: var(--red); color: var(--syntax-const-text); }\n\n.leader-line {\n    z-index: 1; /* Sit behind nodes */\n    opacity: 0.8;\n}\nbody.light-theme .chart-container {\n    color: var(--text-medium);\n}\n\n/* Light theme navigation buttons */\n/* Light theme navigation buttons */\nbody.light-theme .nav-btn {\n    background: linear-gradient(135deg, #8b5cf6, #7c3aed) !important;\n    color: white !important;\n    box-shadow: 0 4px 12px rgba(139, 92, 246, 0.5) !important;\n}\n\nbody.light-theme .nav-btn:hover:not(:disabled) {\n    background: linear-gradient(135deg, #7c3aed, #6d28d9) !important;\n    box-shadow: 0 6px 20px rgba(139, 92, 246, 0.7) !important;\n}\n\nbody.light-theme .nav-btn:disabled {\n    background: #e9ecef !important;\n    color: #adb5bd !important;\n    box-shadow: none !important;\n    opacity: 0.7 !important;\n}\n\nbody.light-theme .nav-info {\n    color: var(--text-light);\n    font-weight: 600;\n}\n\nbody.light-theme .scan-navigation {\n    border-top-color: var(--border-color);\n}\n","epoch":7,"telemetryInfo":{}}],["file:///home/trang/localnsv/mAIware/background-controller.js::request_6e987b26-6b7b-49b1-88a8-e33cd26adc69",{"uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware/background-controller.js","external":"file:///home/trang/localnsv/mAIware/background-controller.js","path":"/home/trang/localnsv/mAIware/background-controller.js","scheme":"file"},"requestId":"request_6e987b26-6b7b-49b1-88a8-e33cd26adc69","content":"const { Tray, Menu, nativeImage } = require('electron')\nconst path = require('node:path')\n\nfunction setupBackgroundController({ app, createWindow, isBackgroundOnly }) {\n  const noop = () => {}\n  const singleInstance = app.requestSingleInstanceLock()\n\n  if (!singleInstance) {\n    app.quit()\n    return {\n      showWindow: noop,\n      hideWindow: noop,\n      toggleWindow: noop\n    }\n  }\n\n  let tray = null\n  let mainWindow = null\n  let isQuitting = false\n\n  const iconPath = path.join(__dirname, 'assets', 'icon.png')\n  let trayIcon = iconPath\n\n  try {\n    const iconImage = nativeImage.createFromPath(iconPath)\n    if (!iconImage.isEmpty()) {\n      trayIcon = iconImage\n    }\n  } catch (err) {\n    console.warn('[Background] Failed to load tray icon, falling back to path.', err.message)\n  }\n\n  const ensureTray = () => {\n    if (tray) {\n      return tray\n    }\n\n    tray = new Tray(trayIcon)\n    tray.setToolTip('mAIware')\n\n    tray.on('click', toggleWindow)\n    tray.on('double-click', showWindow)\n    tray.on('right-click', () => {\n      updateContextMenu()\n    })\n\n    updateContextMenu()\n    return tray\n  }\n\n  const destroyTray = () => {\n    if (tray) {\n      tray.destroy()\n      tray = null\n    }\n  }\n\n  const windowIsUsable = () => mainWindow && !mainWindow.isDestroyed()\n\n  const hideDockIfNeeded = () => {\n    if (process.platform === 'darwin' && app.dock && typeof app.dock.hide === 'function') {\n      app.dock.hide()\n    }\n  }\n\n  const showDockIfNeeded = () => {\n    if (process.platform === 'darwin' && app.dock && typeof app.dock.show === 'function') {\n      app.dock.show()\n    }\n  }\n\n  const updateContextMenu = () => {\n    if (!tray) {\n      return\n    }\n\n    const hasWindow = windowIsUsable()\n    const isVisible = hasWindow && mainWindow.isVisible()\n\n    const template = [\n      {\n        label: isVisible ? 'Hide Window' : 'Show Window',\n        enabled: hasWindow || typeof createWindow === 'function',\n        click: toggleWindow\n      },\n      { type: 'separator' },\n      {\n        label: 'Quit',\n        click: quitApplication\n      }\n    ]\n\n    tray.setContextMenu(Menu.buildFromTemplate(template))\n  }\n\n  const showWindow = () => {\n    if (windowIsUsable()) {\n      showDockIfNeeded()\n      if (!mainWindow.isVisible()) {\n        mainWindow.show()\n      }\n      mainWindow.focus()\n      updateContextMenu()\n      return mainWindow\n    }\n\n    if (typeof createWindow !== 'function') {\n      return null\n    }\n\n    let newWindow\n    try {\n      newWindow = createWindow()\n    } catch (err) {\n      console.error('[Background] Failed to create window:', err)\n      return null\n    }\n\n    if (isBackgroundOnly && newWindow && typeof newWindow.once === 'function') {\n      newWindow.once('ready-to-show', () => {\n        newWindow.show()\n        newWindow.focus()\n        updateContextMenu()\n      })\n    }\n\n    return newWindow || null\n  }\n\n  const hideWindow = () => {\n    if (!windowIsUsable()) {\n      updateContextMenu()\n      return\n    }\n\n    mainWindow.hide()\n    hideDockIfNeeded()\n    updateContextMenu()\n  }\n\n  const toggleWindow = () => {\n    if (!windowIsUsable()) {\n      showWindow()\n      return\n    }\n\n    if (mainWindow.isVisible()) {\n      hideWindow()\n    } else {\n      showWindow()\n    }\n  }\n\n  const quitApplication = () => {\n    isQuitting = true\n    showDockIfNeeded()\n    destroyTray()\n    if (windowIsUsable()) {\n      mainWindow.close()\n    }\n    app.quit()\n  }\n\n  const handleWindowCreated = (window) => {\n    mainWindow = window\n\n    ensureTray()\n    updateContextMenu()\n\n    window.on('close', (event) => {\n      if (isQuitting) {\n        return\n      }\n\n      event.preventDefault()\n      hideWindow()\n    })\n\n    window.on('minimize', (event) => {\n      if (isQuitting) {\n        return\n      }\n\n      event.preventDefault()\n      hideWindow()\n    })\n\n    window.on('show', () => {\n      showDockIfNeeded()\n      updateContextMenu()\n    })\n\n    window.on('hide', () => {\n      hideDockIfNeeded()\n      updateContextMenu()\n    })\n\n    window.on('closed', () => {\n      mainWindow = null\n      updateContextMenu()\n\n      if (!isQuitting) {\n        hideDockIfNeeded()\n      }\n    })\n  }\n\n  app.on('browser-window-created', (_event, window) => {\n    handleWindowCreated(window)\n  })\n\n  app.on('before-quit', () => {\n    isQuitting = true\n    destroyTray()\n  })\n\n  app.on('second-instance', () => {\n    showWindow()\n  })\n\n  app.whenReady().then(() => {\n    if (isBackgroundOnly) {\n      ensureTray()\n      updateContextMenu()\n      hideDockIfNeeded()\n    }\n  })\n\n  return {\n    showWindow,\n    hideWindow,\n    toggleWindow\n  }\n}\n\nmodule.exports = { setupBackgroundController }\n","epoch":11,"telemetryInfo":{}}],["file:///home/trang/localnsv/mAIware/index.html::request_12456880-9335-4f74-90f1-0ed95f9fb0ab",{"uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware/index.html","external":"file:///home/trang/localnsv/mAIware/index.html","path":"/home/trang/localnsv/mAIware/index.html","scheme":"file"},"requestId":"request_12456880-9335-4f74-90f1-0ed95f9fb0ab","content":"<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>mAIware AI Malware Detection Demo</title>\n    <!-- Font Awesome for icons (which you already had) -->\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\">\n    <!-- Chart.js for stats (which you already had) -->\n    <script src=\"https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js\"></script>\n    <!-- QRCode.js for QR generation -->\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js\"></script>\n    <!-- Link to the CSS file -->\n    <link rel=\"stylesheet\" href=\"style.css\">\n</head>\n\n<body>\n    <nav class=\"top-nav\">\n        <div class=\"logo\"> <i class=\"fas fa-shield-virus\"></i> <span>mAIware</span> </div>\n        <div class=\"nav-links\"> <a href=\"#\" class=\"nav-link\" data-tooltip=\"Login\"><i class=\"fas fa-sign-in-alt\"></i><span class=\"link-text\">Login</span></a> <a href=\"#\" class=\"nav-link\" data-tooltip=\"Sign Up\"><i class=\"fas fa-user-plus\"></i><span class=\"link-text\">Sign Up</span></a> <a href=\"#\" class=\"nav-link\" data-tooltip=\"Community\"><i class=\"fas fa-users\"></i><span class=\"link-text\">Community</span></a> <a href=\"#\" class=\"nav-link\" data-tooltip=\"API Docs\"><i class=\"fas fa-code\"></i><span class=\"link-text\">API</span></a> <a href=\"#\" id=\"history-btn\" class=\"nav-link\" data-tooltip=\"Scan History\"><i class=\"fas fa-history\"></i><span class=\"link-text\">History</span></a> <a href=\"#\" class=\"nav-link\" id=\"theme-toggle\" data-tooltip=\"Toggle Theme\"> <i class=\"fas fa-sun\"></i> </a> </div>\n    </nav>\n\n    <main class=\"main-container\">\n        <!-- Column 1 -->\n        <div class=\"scanner-wrapper\">\n            <!-- Main Scanner Box -->\n            <div class=\"scanner-container\">\n                <h1>AI Malware Detection</h1>\n                \n                <!-- Navigation Controls (Top Position) -->\n                <div class=\"scan-navigation scan-navigation-top\">\n                    <button id=\"prev-scan-btn\" class=\"nav-btn\" disabled>\n                        <i class=\"fas fa-chevron-left\"></i> Previous\n                    </button>\n                    <span id=\"nav-info\" class=\"nav-info\">1 of 1</span>\n                    <button id=\"next-scan-btn\" class=\"nav-btn\" disabled>\n                        Next <i class=\"fas fa-chevron-right\"></i>\n                    </button>\n                </div>\n                \n                <!-- State 1: Initial -->\n                <div id=\"initial-state\" class=\"scanner-state active\">\n                    <p>Watching your Downloads folder for new files...</p>\n                    <div id=\"drop-zone\" class=\"upload-zone\"> <i class=\"upload-icon fas fa-eye\"></i>\n                        <h3>Automatic Scanning Active</h3>\n                        <span>(Download a file to begin)</span>\n                    </div>\n                    <div class=\"manual-upload\">\n                        <button id=\"manual-scan-btn\" class=\"btn btn-primary\" type=\"button\">\n                            <i class=\"fas fa-upload\"></i>\n                            Scan a File Manually\n                        </button>\n                        <p class=\"manual-scan-hint\">Or keep downloading files to scan them automatically.</p>\n                        <p id=\"manual-scan-error\" class=\"manual-error\" role=\"alert\"></p>\n                    </div>\n                </div>\n\n                <!-- State 2: Analyzing -->\n                <div id=\"analyzing-state\" class=\"scanner-state\">\n                    <div class=\"analyzing-icon\">\n                        <div class=\"loader\"></div>\n                    </div>\n                    <h3>Analyzing...</h3> <span class=\"filename\" id=\"analyzing-filename\">demo_file.exe</span> </div>\n\n                <!-- State 3: Result -->\n                <div id=\"result-state\" class=\"scanner-state\"> <i class=\"result-icon\" id=\"result-icon\"></i>\n                    <h2 id=\"result-text\"></h2>\n                    <div class=\"filename\" id=\"result-filename\"></div>\n                    <p id=\"result-details\"></p>\n                    <!-- Removed the resetDemo() button as it's automatic now -->\n                </div>\n                <div id=\"non-pe-result\" class=\"scanner-state non-pe-result\">\n                    <div class=\"non-pe-icon\"><i class=\"fas fa-file\"></i></div>\n                    <h2 id=\"non-pe-title\">File is not a Windows PE executable</h2>\n                    <p class=\"filename\" id=\"non-pe-filename\"></p>\n                    <div class=\"non-pe-hash-grid\">\n                        <div class=\"non-pe-hash\">\n                            <h4>SHA256</h4>\n                            <p id=\"non-pe-hash-sha256\">...</p>\n                        </div>\n                        <div class=\"non-pe-hash\">\n                            <h4>MD5</h4>\n                            <p id=\"non-pe-hash-md5\">...</p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Analysis Details (Shows on result) -->\n            <div class=\"analysis-details-container\" id=\"analysis-details-wrapper\">\n                <div class=\"progress-header\">\n                    <h3>Malware Confidence</h3> <span class=\"score-percentage\" id=\"score-percentage\">0%</span> </div>\n                <div class=\"progress-bar-background\">\n                    <div class=\"progress-bar-fill\" id=\"progress-bar-fill\" style=\"width: 0%;\"></div>\n                </div>\n\n                <!-- This grid holds Vendor and Signature -->\n                <div class=\"details-grid\">\n                    <!-- Vendor UI Container -->\n                    <div class=\"details-section\" id=\"details-vendor\">\n                        <h4>Vendor Analysis</h4>\n                        <div class=\"vendor-info\">\n                            <i class=\"fas fa-question-circle\"></i>\n                            <span>Scanning...</span>\n                        </div>\n                    </div>\n                    <!-- Signature UI Container -->\n                    <div class=\"details-section\" id=\"details-signature\">\n                        <h4>Digital Signature</h4>\n                        <div class=\"signature-info\">\n                            <i class=\"fas fa-question-circle\"></i>\n                            <span>Checking...</span>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Reasoning (File Type/Packer) -->\n                <div class=\"details-section\">\n                    <h4>Key Findings</h4>\n                    <p id=\"details-reasoning\">...</p>\n                </div>\n                \n                <div class=\"details-section\">\n                    <h4>SHA256 Hash</h4>\n                    <p class=\"hash-text\" id=\"details-hash-sha256\">...</p>\n                </div>\n\n                <div class=\"details-section\">\n                    <h4>MD5 Hash</h4>\n                    <p class=\"hash-text\" id=\"details-hash-md5\">...</p>\n                </div>\n\n                <div class=\"details-section\">\n                    <h4>System IP</h4>\n                    <p class=\"hash-text\" id=\"details-system-ip\">Detecting...</p>\n                </div>\n\n                <!-- QR Code for PE results -->\n                <div class=\"details-section qr-section\" id=\"qr-section\" style=\"display:none;\">\n                    <h4>Scan Report QR</h4>\n                    <div id=\"qr-code\" class=\"qr-code-wrapper\"></div>\n                </div>\n\n                <div class=\"details-section\">\n                    <h4>What To Do Next</h4>\n                    <p id=\"details-recommendation\">...</p>\n                </div>\n\n                <div class=\"btn-wrapper\"> <button class=\"btn btn-primary\"><i class=\"fas fa-download\"></i> Download Report</button> <button class=\"btn btn-secondary\"><i class=\"fas fa-flag\"></i> Report False Positive</button> </div>\n            </div>\n        </div>\n\n        <!-- Column 2 -->\n        <div class=\"right-panel-wrapper\">\n            <!-- Stats (Shows on initial) -->\n            <div class=\"stats-wrapper\" id=\"stats-wrapper\">\n                <div class=\"stats-grid\">\n                    <div class=\"stat-card\"> <i class=\"fas fa-virus-slash\"></i>\n                        <div class=\"stat-content\"> <span class=\"stat-number\" data-target=\"14720938\">0</span> <span class=\"stat-label\">Malware Analyzed</span> </div>\n                    </div>\n                    <div class=\"stat-card\"> <i class=\"fas fa-users\"></i>\n                        <div class=\"stat-content\"> <span class=\"stat-number\" data-target=\"82041\">0</span> <span class=\"stat-label\">Active Users</span> </div>\n                    </div>\n                    <div class=\"stat-card\"> <i class=\"fas fa-chart-line\"></i>\n                        <div class=\"stat-content\"> <span class=\"stat-number\" data-target=\"1259024\">0</span> <span class=\"stat-label\">Site Visits (24h)</span> </div>\n                    </div>\n                </div>\n                <div class=\"chart-container-wrapper\">\n                    <div class=\"chart-container\">\n                        <h3>Top 5 Malware Families (30 Days)</h3> <canvas id=\"topMalwareChart\"></canvas> </div>\n                    <div class=\"chart-container\">\n                        <h3>Submission Types</h3> <canvas id=\"malwareTypesChart\"></canvas> </div>\n                </div>\n            </div>\n\n            <!-- Disassembly (Shows on analyzing/result) -->\n            <div class=\"disassembly-wrapper\" id=\"disassembly-wrapper\">\n                <div class=\"disassembly-header\">\n                    <h3>Disassembly: <span id=\"disassembly-filename\"></span></h3>\n                </div>\n                <div class=\"disassembly-code\" id=\"disassembly-code\"> </div>\n            </div>\n\n            <!-- File Internals (Shows on result) -->\n            <div class=\"file-internals-container\" id=\"file-internals-wrapper\">\n                <h3>File Internals</h3>\n                \n                <!-- Entropy UI Container -->\n                <div class=\"details-section\">\n                    <h4>Section Entropy (0=Normal, 8=Packed/Encrypted)</h4>\n                    <div class=\"entropy-bars\" id=\"entropy-bars-container\">\n                        <!-- JS will populate this -->\n                    </div>\n                </div>\n                \n                <!-- Key Strings UI Container -->\n                <div class=\"details-section\">\n                    <h4>Suspicious / Key Strings</h4>\n                    <div class=\"key-strings\" id=\"key-strings-container\">\n                        <!-- JS will populate this -->\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <!-- Full Width Row -->\n        <div class=\"graph-wrapper\" id=\"graph-wrapper\">\n            <div class=\"graph-header\">\n                <h3>Dynamic Function Call Graph (Simulation)</h3>\n            </div>\n            <div class=\"call-graph-container\">\n                <div class=\"call-graph\" id=\"call-graph\">\n                    <!-- JS will populate this -->\n                </div>\n            </div>\n        </div>\n    </main>\n\n    <!-- History Panel (Hidden by default) -->\n    <div class=\"history-overlay\" id=\"history-overlay\"></div>\n    <div class=\"history-panel\" id=\"history-panel\">\n        <div class=\"history-header\">\n            <h3>Scan History</h3> <button class=\"history-close-btn\" id=\"history-close-btn\"><i class=\"fas fa-times\"></i></button> </div>\n        <ul class=\"history-list\">\n            <!-- JS would populate this -->\n        </ul>\n    </div>\n\n    <!-- Scroll Zones -->\n    <div class=\"scroll-zone top\" id=\"scroll-zone-top\"><i class=\"fas fa-chevron-up\"></i></div>\n    <div class=\"scroll-zone bottom\" id=\"scroll-zone-bottom\"><i class=\"fas fa-chevron-down\"></i></div>\n    \n    <!-- LeaderLine for graph (which you already had) -->\n    <script src=\"https://cdn.jsdelivr.net/npm/leader-line-new@1.1.9/leader-line.min.js\"></script>\n    <!-- Link to the JS file -->\n    <script src=\"script.js\"></script>\n\n    <script>\n    // Apply saved theme class immediately (before DOMContentLoaded)\n    const savedTheme = localStorage.getItem('theme') || 'dark';\n    if (savedTheme === 'light') {\n        document.body.classList.add('light-theme');\n    }\n    \n    document.addEventListener('DOMContentLoaded', () => {\n        const themeToggleButton = document.getElementById('theme-toggle');\n        const body = document.body;\n        const themeIcon = themeToggleButton.querySelector('i');\n\n        // Set icon based on current theme\n        if (body.classList.contains('light-theme')) {\n            themeIcon.classList.remove('fa-sun');\n            themeIcon.classList.add('fa-moon');\n        }\n\n        // Function to apply the saved theme\n        const applyTheme = (theme) => {\n            if (theme === 'light') {\n                body.classList.add('light-theme');\n                themeIcon.classList.remove('fa-sun');\n                themeIcon.classList.add('fa-moon');\n            } else {\n                body.classList.remove('light-theme');\n                themeIcon.classList.remove('fa-moon');\n                themeIcon.classList.add('fa-sun');\n            }\n            \n            // Recreate charts with updated theme colors\n            if (window.recreateCharts) {\n                window.recreateCharts();\n            }\n        };\n\n        // Add click event for the toggle button\n        themeToggleButton.addEventListener('click', (e) => {\n            e.preventDefault(); // Stop the link from navigating\n            \n            // Check current theme\n            const isLightTheme = body.classList.contains('light-theme');\n            \n            // Set new theme\n            const newTheme = isLightTheme ? 'dark' : 'light';\n            \n            // Apply the new theme\n            applyTheme(newTheme);\n            \n            // Save the new theme to localStorage\n            localStorage.setItem('theme', newTheme);\n        });\n    });\n    </script>\n</body>\n</html>\n","epoch":18,"telemetryInfo":{}}],["file:///home/trang/localnsv/mAIware/script.js::request_12456880-9335-4f74-90f1-0ed95f9fb0ab",{"uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware/script.js","external":"file:///home/trang/localnsv/mAIware/script.js","path":"/home/trang/localnsv/mAIware/script.js","scheme":"file"},"requestId":"request_12456880-9335-4f74-90f1-0ed95f9fb0ab","content":"// --- MOCK DISASSEMBLY DATA ---\n// (We keep this for now, as requested)\nconst mockDisassemblyBenign = [\n    `<span class=\"addr\">0x401000</span> <span class=\"op\">PUSH</span> <span class=\"args\">ebp</span> <span class=\"comment\">; setup stack frame</span>`,\n    `<span class=\"addr\">0x401001</span> <span class=\"op\">MOV</span> <span class=\"args\">ebp, esp</span>`,\n    `<span class=\"addr\">0x401003</span> <span class=\"op\">SUB</span> <span class=\"args\">esp, 48h</span>`,\n    `<span class=\"addr\">0x40100C</span> <span class=\"op\">CALL</span> <span class=\"args\">0x4012A0</span> <span class=\"comment\">; initialize_string</span>`,\n    `<span class=\"addr\">0x401015</span> <span class=\"op\">CALL</span> <span class=\"args\">0x4013F0</span> <span class=\"comment\">; get_user_input</span>`,\n    `<span class=\"addr\">0x40101E</span> <span class=\"op\">CALL</span> <span class=\"args\">0x4015D0</span> <span class=\"comment\">; print_output</span>`,\n    `<span class=\"addr\">0x401028</span> <span class=\"op\">RETN</span>`,\n    `<span class=\"addr\">...</span>`,\n];\nconst mockDisassemblySuspicious = [\n    `<span class=\"addr\">0x401000</span> <span class=\"op\">PUSH</span> <span class=\"args\">ebp</span>`,\n    `<span class=\"addr\">0x401003</span> <span class=\"op\">SUB</span> <span class=\"args\">esp, 80h</span>`,\n    `<span class=\"addr\">0x40100D</span> <span class=\"op\">CALL</span> <span class=\"args\">0x4012A0</span> <span class=\"comment\">; read_file_to_buffer</span>`,\n    `<span class=\"addr\">0x40101B</span> <span class=\"op\">REP</span> <span class=\"op\">MOVSB</span> <span class=\"comment\">; unsafe buffer write</span>`,\n    `<span class=\"addr\">0x401020</span> <span class=\"op\">JGE</span> <span class=\"args\">0x401030</span> <span class=\"comment\">; jump if overflow</span>`,\n    `<span class=\"addr\">0x401028</span> <span class=\"op\">RETN</span>`,\n    `<span class=\"addr\">...</span>`,\n];\nconst mockDisassemblyMalware = [\n    `<span class=\"addr\">0x401000</span> <span class=\"op\">PUSH</span> <span class=\"args\">ebp</span> <span class=\"comment\">; setup stack frame</span>`,\n    `<span class=\"addr\">0x40100B</span> <span class=\"op\">CALL</span> <span class=\"args\">0x4011B0</span> <span class=\"comment\">; kernel32.LoadLibraryA</span>`,\n    `<span class=\"addr\">0x401013</span> <span class=\"op\">PUSH</span> <span class=\"string\">\"CreateRemoteThread\"</span>`,\n    `<span class=\"addr\">0x401019</span> <span class=\"op\">CALL</span> <span class=\"args\">0x4011C0</span> <span class=\"comment\">; kernel32.GetProcAddress</span>`,\n    `<span class=\"addr\">0x401028</span> <span class=\"op\">CALL</span> <span class=\"args\">0x4012F0</span> <span class=\"comment\">; decrypt_payload</span>`,\n    `<span class=\"addr\">0x401034</span> <span class=\"op\">CALL</span> <span class=\"args\">[ebp-24h]</span> <span class=\"comment\">; call CreateRemoteThread</span>`,\n    `<span class=\"addr\">0x401037</span> <span class=\"op\">JMP</span> <span class=\"args\">0x40102D</span> <span class=\"comment\">; loop?</span>`,\n    `<span class=\"addr\">...</span>`,\n];\n\n// --- REMOVED MOCK GRAPH DATA ---\n// const mockGraphSafe = ... (DELETED)\n// const mockGraphSuspicious = ... (DELETED)\n// const mockGraphMalware = ... (DELETED)\n\n// --- NAVIGATION STATE ---\nlet scanHistory = [];\nlet currentHistoryIndex = -1;\n\n// --- ELEMENT REFERENCES ---\nconst initialState = document.getElementById('initial-state');\nconst analyzingState = document.getElementById('analyzing-state');\nconst resultState = document.getElementById('result-state');\n\nconst analyzingFilename = document.getElementById('analyzing-filename');\nconst resultIcon = document.getElementById('result-icon');\nconst resultText = document.getElementById('result-text');\nconst resultFilename = document.getElementById('result-filename');\nconst resultDetails = document.getElementById('result-details');\nconst nonPeResultWrapper = document.getElementById('non-pe-result');\nconst nonPeFilename = document.getElementById('non-pe-filename');\nconst nonPeHashSha256 = document.getElementById('non-pe-hash-sha256');\nconst nonPeHashMd5 = document.getElementById('non-pe-hash-md5');\nconst manualScanBtn = document.getElementById('manual-scan-btn');\nconst manualScanError = document.getElementById('manual-scan-error');\n\nconst bodyEl = document.body;\nlet animationWrapper = null;\n\nconst disassemblyWrapper = document.getElementById('disassembly-wrapper');\nconst disassemblyCodeEl = document.getElementById('disassembly-code');\nconst disassemblyFilenameEl = document.getElementById('disassembly-filename');\n\n// Analysis Details elements\nconst analysisDetailsWrapper = document.getElementById('analysis-details-wrapper');\nconst progressBarFill = document.getElementById('progress-bar-fill');\nconst scorePercentage = document.getElementById('score-percentage');\nconst detailsReasoning = document.getElementById('details-reasoning'); // We'll reuse this\nconst detailsHashSha256 = document.getElementById('details-hash-sha256');\nconst detailsHashMd5 = document.getElementById('details-hash-md5');\nconst detailsSystemIp = document.getElementById('details-system-ip');\nconst detailsRecommendation = document.getElementById('details-recommendation');\nconst detailsVendor = document.getElementById('details-vendor');\nconst detailsSignature = document.getElementById('details-signature');\nconst fileInternalsWrapper = document.getElementById('file-internals-wrapper');\nconst entropyBarsContainer = document.getElementById('entropy-bars-container');\nconst keyStringsContainer = document.getElementById('key-strings-container');\n\n// History Panel elements\nconst historyBtn = document.getElementById('history-btn');\nconst historyPanel = document.getElementById('history-panel');\nconst historyCloseBtn = document.getElementById('history-close-btn');\nconst historyOverlay = document.getElementById('history-overlay');\nconst historyListEl = document.querySelector('.history-list');\n\n// Scroll Zone elements\nconst scrollZoneTop = document.getElementById('scroll-zone-top');\nconst scrollZoneBottom = document.getElementById('scroll-zone-bottom');\n\n// Graph Panel elements\nconst graphWrapper = document.getElementById('graph-wrapper');\nconst callGraphEl = document.getElementById('call-graph');\n\n// Stats elements\nconst statsWrapper = document.getElementById('stats-wrapper');\n\n\n// --- STATE ---\nlet disassemblyInterval = null;\nlet scrollInterval = null; // For auto-scrolling\nlet currentGraphLines = []; // Renamed from currentLines to avoid conflict\nlet currentFileMetadata = null;\nlet lastScanResult = null;\n\nfunction resolveScanStartedFilename(payload) {\n  if (typeof payload === 'string') {\n    return payload;\n  }\n\n  if (payload && typeof payload === 'object') {\n    if (typeof payload.filename === 'string' && payload.filename.length > 0) {\n      return payload.filename;\n    }\n\n    if (typeof payload.fullPath === 'string') {\n      const pathSegments = payload.fullPath.split(/[\\\\/]/);\n      return pathSegments[pathSegments.length - 1] || payload.fullPath;\n    }\n  }\n\n  return 'Unknown file';\n}\n\nfunction showManualScanError(message = '') {\n  if (!manualScanError) {\n    return;\n  }\n\n  manualScanError.textContent = message;\n}\n\nif (manualScanBtn) {\n  manualScanBtn.addEventListener('click', async (event) => {\n    event.preventDefault();\n    showManualScanError('');\n    manualScanBtn.disabled = true;\n\n    try {\n      const selection = await window.electronAPI.pickManualScanFile();\n      if (!selection || selection.canceled || !selection.filePath) {\n        return;\n      }\n\n      const response = await window.electronAPI.scanManualFile(selection.filePath);\n      if (!response || !response.ok) {\n        throw new Error(response && response.error ? response.error : 'Unable to start scan.');\n      }\n    } catch (err) {\n      const message = err instanceof Error ? err.message : 'Failed to start manual scan.';\n      showManualScanError(message);\n    } finally {\n      manualScanBtn.disabled = false;\n    }\n  });\n}\n\n// 1. Listen for the 'scan-started' message from the backend\nwindow.electronAPI.onScanStarted((payload) => {\n  const filename = resolveScanStartedFilename(payload);\n  console.log(`UI: Received scan-started for ${filename}`);\n\n    showManualScanError('');\n\n    // If user is viewing a result, don't auto-switch to analyzing.\n    if (bodyEl.classList.contains('is-showing-result') || bodyEl.classList.contains('is-non-pe')) {\n        console.log('UI: Result is being viewed; deferring analyzing UI switch');\n        return;\n    }\n\n  // 1. Set UI to \"Analyzing\" state\n  initialState.classList.remove('active'); //\n  analyzingState.classList.add('active'); //\n  analyzingFilename.textContent = filename; //\n  disassemblyFilenameEl.textContent = filename; //\n\n  currentFileMetadata = { filename, isPe: true };\n  lastScanResult = null;\n  nonPeResultWrapper.classList.remove('active');\n  bodyEl.classList.remove('is-non-pe');\n\n  // 2. Update body class to show disassembly\n  bodyEl.classList.remove('is-showing-result'); //\n  bodyEl.classList.add('is-analyzing'); //\n  removeAnimationClasses(); //\n  \n  // 3. Populate disassembly with a \"suspicious\" default and start animation\n  // (We don't know the result yet, so we pick one)\n  populateDisassembly(mockDisassemblySuspicious); //\n  startDisassemblyAnimation(); //\n\n  // 4. Clear old results\n  clearResultData();\n});\n\n// 2. Listen for the 'scan-result' message\nwindow.electronAPI.onScanResult((scanResult) => {\n  console.log(\"UI: Received scan-result:\", scanResult);\n\n  clearInterval(disassemblyInterval); //\n  disassemblyInterval = null; //\n\n  // Add to history\n  scanHistory.push(scanResult);\n  currentHistoryIndex = scanHistory.length - 1;\n\n    // If a result is already being viewed, do not auto-advance UI.\n    if (bodyEl.classList.contains('is-showing-result') || bodyEl.classList.contains('is-non-pe')) {\n        updateNavigationButtons();\n        return;\n    }\n\n    bodyEl.classList.remove('is-analyzing'); //\n    bodyEl.classList.add('is-showing-result'); //\n\n    analyzingState.classList.remove('active'); //\n    resultState.classList.add('active'); //\n\n    lastScanResult = scanResult;\n    renderScanResult();\n    updateNavigationButtons();\n});\n\nwindow.electronAPI.onScanFileMetadata((metadata) => {\n  if (!metadata || typeof metadata !== 'object') {\n    return;\n  }\n\n  currentFileMetadata = metadata;\n\n  if (lastScanResult && metadata.filename === lastScanResult.detected_filename) {\n    renderScanResult();\n  }\n});\n\nfunction renderScanResult() {\n  if (!lastScanResult) {\n    return;\n  }\n\n  const metadataMatches = currentFileMetadata && currentFileMetadata.filename === lastScanResult.detected_filename;\n  const isNonPe = metadataMatches && currentFileMetadata.isPe === false;\n\n  if (isNonPe) {\n    renderNonPeResult(lastScanResult);\n    return;\n  }\n\n  renderPeResult(lastScanResult);\n}\n\nfunction ensureAnimationWrapper() {\n  if (animationWrapper) {\n    return;\n  }\n\n  animationWrapper = document.createElement('div');\n  animationWrapper.className = 'animation-swarm';\n  for (let i = 0; i < 10; i++) {\n    const particle = document.createElement('span');\n    animationWrapper.appendChild(particle);\n  }\n  bodyEl.prepend(animationWrapper);\n}\n\nfunction renderPeResult(scanResult) {\n  removeAnimationClasses();\n  bodyEl.classList.remove('is-non-pe');\n  nonPeResultWrapper.classList.remove('active');\n\n  let resultIconClass = 'fas fa-check-circle'; //\n  let resultMockDisassembly = mockDisassemblyBenign; //\n  let resultBodyClass = 'result-safe-active'; //\n  let resultScannerClass = 'result-safe'; //\n  let resultProgressClass = 'progress-bar-green'; //\n  let resultScoreClass = 'score-green'; //\n  let recommendation = 'You can safely run this file.'; //\n\n  if (scanResult.classification.includes('Malware')) {\n    resultIconClass = 'fas fa-bug';\n    resultMockDisassembly = mockDisassemblyMalware;\n    resultBodyClass = 'result-malware-active'; //\n    resultScannerClass = 'result-malware'; //\n    resultProgressClass = 'progress-bar-red'; //\n    resultScoreClass = 'score-red'; //\n    recommendation = 'DO NOT OPEN. Quarantine this file immediately.'; //\n  } else if (scanResult.classification.includes('Suspicious')) {\n    resultIconClass = 'fas fa-exclamation-triangle'; //\n    resultMockDisassembly = mockDisassemblySuspicious; //\n    resultBodyClass = 'result-suspicious-active'; //\n    resultScannerClass = 'result-suspicious'; //\n    resultProgressClass = 'progress-bar-yellow'; //\n    resultScoreClass = 'score-yellow'; //\n    recommendation = 'Be cautious. Only run if you trust the source.'; //\n  }\n\n  ensureAnimationWrapper();\n  bodyEl.classList.add(resultBodyClass); //\n\n  resultState.className = `scanner-state active ${resultScannerClass}`; //\n  resultIcon.className = `result-icon ${resultIconClass}`; //\n  resultText.textContent = scanResult.classification; //\n\n  let detailsText = `Scanned ${scanResult.detected_filename}.`;\n  if (scanResult.malware_family) {\n    detailsText = `Family: ${scanResult.malware_family}`;\n  }\n  resultDetails.textContent = detailsText;\n  resultFilename.textContent = scanResult.detected_filename; //\n\n  progressBarFill.className = 'progress-bar-fill'; //\n  scorePercentage.className = 'score-percentage'; //\n  progressBarFill.classList.add(resultProgressClass); //\n  const rawConfidence = Number(scanResult.confidence_score);\n  const confidenceValue = Number.isFinite(rawConfidence) ? rawConfidence * 100 : 0;\n  progressBarFill.style.width = `${confidenceValue}%`; //\n  scorePercentage.textContent = `${Math.round(confidenceValue)}%`; //\n  scorePercentage.classList.add(resultScoreClass); //\n\n  detailsReasoning.textContent = `Filetype: ${scanResult.key_findings.file_type}. Packer: ${scanResult.key_findings.packer_detected}.`; //\n  const hashData = scanResult.file_hashes || {};\n  detailsHashSha256.textContent = hashData.sha256 || 'Not available'; //\n  detailsHashMd5.textContent = hashData.md5 || 'Not available'; //\n  updateSystemIpDisplay();\n  detailsRecommendation.textContent = recommendation;\n\n  populateVendor(scanResult.vendor); //\n  populateSignature(scanResult.key_findings.signature); //\n  populateEntropyBars(scanResult.key_findings.section_entropy || []); //\n  populateKeyStrings(scanResult.key_findings.key_strings || [], scanResult.classification); //\n\n  populateDisassembly(resultMockDisassembly); //\n\n  const apiList = scanResult.key_findings.api_imports || [];\n  const graphData = generateGraphData(apiList, scanResult.classification);\n  drawCallGraph(graphData);\n\n    // Generate QR for PE report\n    generatePeQr(scanResult);\n}\n\nfunction renderNonPeResult(scanResult) {\n  removeAnimationClasses();\n  bodyEl.classList.add('is-non-pe');\n  resultState.className = 'scanner-state active';\n  resultIcon.className = 'result-icon fas fa-file';\n  resultText.textContent = '';\n  resultDetails.textContent = '';\n  resultFilename.textContent = '';\n\n  const hashData = scanResult.file_hashes || {};\n  nonPeFilename.textContent = scanResult.detected_filename || '';\n  nonPeHashSha256.textContent = hashData.sha256 || 'Not available';\n  nonPeHashMd5.textContent = hashData.md5 || 'Not available';\n\n  detailsHashSha256.textContent = hashData.sha256 || 'Not available';\n  detailsHashMd5.textContent = hashData.md5 || 'Not available';\n\n  nonPeResultWrapper.classList.add('active');\n\n  callGraphEl.innerHTML = '';\n  currentGraphLines.forEach(line => line.remove());\n  currentGraphLines = [];\n  entropyBarsContainer.innerHTML = '';\n  keyStringsContainer.innerHTML = '';\n\n    // Hide QR for non-PE\n    clearQr();\n}\n\n/**\n * Clears all dynamic result data to prepare for the next scan.\n */\nfunction clearResultData() {\n    // Clear scanner panel\n    resultText.textContent = '';\n    resultDetails.textContent = '';\n    resultFilename.textContent = '';\n    nonPeResultWrapper.classList.remove('active');\n    nonPeFilename.textContent = '';\n    nonPeHashSha256.textContent = '...';\n    nonPeHashMd5.textContent = '...';\n    bodyEl.classList.remove('is-non-pe');\n\n    // Clear analysis panel\n    progressBarFill.style.width = `0%`;\n    scorePercentage.textContent = `0%`;\n    detailsReasoning.textContent = '...';\n    detailsHashSha256.textContent = '...';\n    detailsHashMd5.textContent = '...';\n    if (detailsSystemIp) {\n        detailsSystemIp.textContent = 'Detecting...';\n    }\n    detailsRecommendation.textContent = '...';\n\n    // Clear vendor\n    detailsVendor.innerHTML = `\n        <h4>Vendor Analysis</h4>\n        <div class=\"vendor-info\">\n            <i class=\"fas fa-question-circle\"></i>\n            <span>Scanning...</span>\n        </div>`;\n    \n    // Clear signature\n    detailsSignature.innerHTML = `\n        <h4>Digital Signature</h4>\n        <div class=\"signature-info\">\n            <i class=\"fas fa-question-circle\"></i>\n            <span>Checking...</span>\n        </div>`;\n    \n    // Clear internals\n    entropyBarsContainer.innerHTML = '';\n    keyStringsContainer.innerHTML = '';\n    \n    // Clear graph\n    callGraphEl.innerHTML = '';\n    currentGraphLines.forEach(line => line.remove());\n    currentGraphLines = [];\n}\n\n// --- QR helpers ---\nfunction clearQr() {\n    const qrSection = document.getElementById('qr-section');\n    const qrEl = document.getElementById('qr-code');\n    if (qrEl) qrEl.innerHTML = '';\n    if (qrSection) qrSection.style.display = 'none';\n}\n\nfunction generatePeQr(scanResult) {\n    const qrSection = document.getElementById('qr-section');\n    const qrEl = document.getElementById('qr-code');\n    if (!qrEl || !qrSection || typeof QRCode === 'undefined') return;\n\n    // Build a compact JSON report that fits in a QR\n    const report = {\n        filename: scanResult.detected_filename,\n        classification: scanResult.classification,\n        confidence: Number(scanResult.confidence_score),\n        family: scanResult.malware_family || null,\n        vendor: (scanResult.vendor && scanResult.vendor.name) ? scanResult.vendor.name : null,\n        hashes: {\n            sha256: scanResult.file_hashes?.sha256 || null,\n            md5: scanResult.file_hashes?.md5 || null\n        },\n        ts: Date.now()\n    };\n\n    // Show section and render\n    qrSection.style.display = 'block';\n    qrEl.innerHTML = '';\n    const json = JSON.stringify(report);\n    try {\n        new QRCode(qrEl, { text: json, width: 160, height: 160, colorDark: '#000', colorLight: '#fff', correctLevel: QRCode.CorrectLevel.M });\n    } catch (e) {\n        console.warn('QR generation failed', e);\n        qrEl.textContent = 'QR unavailable';\n    }\n}\n\n// --- VENDOR UI FUNCTION (IMPLEMENTED) ---\nfunction populateVendor(vendor) {\n    if (!vendor) return;\n    const icon = vendor.icon || 'fas fa-question-circle'; //\n    const name = vendor.name || 'Unknown'; //\n    detailsVendor.innerHTML = `\n        <h4>Vendor Analysis</h4> <div class=\"vendor-info\"> <i class=\"${icon}\"></i>\n            <span>${name}</span>\n        </div>\n    `;\n}\n\n// --- SIGNATURE UI FUNCTION (IMPLEMENTED) ---\nfunction populateSignature(signature) {\n    if (!signature) return;\n    let icon = signature.icon || 'fas fa-question-circle';\n    let cssClass = `sig-${signature.level || 'unknown'}`; // 'sig-verified', 'sig-untrusted', 'sig-unknown'\n\n    detailsSignature.innerHTML = `\n        <h4>Digital Signature</h4> <div class=\"signature-info ${cssClass}\"> <i class=\"${icon}\"></i>\n            <span>${signature.name}</span>\n        </div>\n    `;\n}\n\n// --- ENTROPY BARS UI FUNCTION (IMPLEMENTED) ---\nfunction populateEntropyBars(sections) {\n    entropyBarsContainer.innerHTML = ''; // Clear old bars\n    if (!sections || sections.length === 0) {\n        entropyBarsContainer.innerHTML = '<p class=\"hash-text\">No PE sections found to analyze.</p>';\n        return;\n    }\n\n    sections.forEach(section => { //\n        const value = section.entropy; //\n        const width = (value / 8.0) * 100; // Entropy is 0-8\n        let cssClass = 'low';\n        \n        if (value > 6.0) cssClass = 'medium';\n        if (value > 7.0) cssClass = 'high';\n        if (value > 7.8) cssClass = 'packed'; // Match style.css\n\n        const row = document.createElement('div');\n        row.className = 'entropy-bar-row';\n        row.innerHTML = `\n            <span class=\"entropy-bar-label\">${section.name}</span> <div class=\"entropy-bar-bg\">\n                <div class=\"entropy-bar-fill ${cssClass}\" style=\"width: ${width}%\">\n                    <span class=\"entropy-bar-value\">${value.toFixed(2)}</span>\n                </div>\n            </div>\n        `;\n        entropyBarsContainer.appendChild(row);\n    });\n}\n\n// --- KEY STRINGS UI FUNCTION (IMPLEMENTED) ---\nfunction populateKeyStrings(strings, classification) {\n    keyStringsContainer.innerHTML = ''; // Clear old strings\n    if (!strings || strings.length === 0) {\n        keyStringsContainer.innerHTML = '<span class=\"key-string-tag\">No notable strings found.</span>';\n        return;\n    }\n    \n    const tagClass = classification.includes('Benign') ? 'benign' : 'suspicious'; //\n\n    strings.forEach(str => { //\n        const tag = document.createElement('span');\n        tag.className = `key-string-tag ${tagClass}`;\n        tag.textContent = str;\n        keyStringsContainer.appendChild(tag);\n    });\n}\n\nfunction updateSystemIpDisplay() {\n    if (!detailsSystemIp || !window.electronAPI || typeof window.electronAPI.getSystemIp !== 'function') {\n        return;\n    }\n\n    detailsSystemIp.textContent = 'Detecting...';\n\n    window.electronAPI.getSystemIp()\n        .then((ip) => {\n            if (!ip) {\n                detailsSystemIp.textContent = 'Unavailable';\n                return;\n            }\n\n            detailsSystemIp.textContent = ip;\n        })\n        .catch(() => {\n            detailsSystemIp.textContent = 'Unavailable';\n        });\n}\n\nfunction removeAnimationClasses() {\n    bodyEl.classList.remove('result-safe-active');\n    bodyEl.classList.remove('result-suspicious-active');\n    bodyEl.classList.remove('result-malware-active');\n}\n\n// --- Disassembly Functions ---\n\nfunction populateDisassembly(codeLines) {\n    disassemblyCodeEl.innerHTML = '';\n    codeLines.forEach((line, index) => {\n        const lineEl = document.createElement('span');\n        lineEl.className = 'disassembly-line';\n        lineEl.id = `line-${index}`;\n        lineEl.innerHTML = line;\n        disassemblyCodeEl.appendChild(lineEl);\n    });\n}\n\nfunction startDisassemblyAnimation() {\n    if (disassemblyInterval) {\n        clearInterval(disassemblyInterval);\n    }\n    let currentLine = 0;\n    const totalLines = disassemblyCodeEl.children.length;\n\n    disassemblyInterval = setInterval(() => {\n        const prevLine = document.querySelector('.disassembly-line.active');\n        if (prevLine) {\n            prevLine.classList.remove('active');\n        }\n\n        const lineEl = document.getElementById(`line-${currentLine}`);\n        if (lineEl) {\n            lineEl.classList.add('active');\n            lineEl.scrollIntoView({\n                behavior: 'smooth',\n                block: 'center',\n                inline: 'nearest'\n            });\n        }\n        currentLine = (currentLine + 1) % totalLines;\n    }, 150);\n}\n\n/**\n * This function was MOVED here from jsonsamples.js\n * Dynamically generates the graph data based on API imports.\n * @param {string[]} apiImports - Array of API names (e.g., ['CreateRemoteThread'])\n * @param {string} classification - 'Benign', 'Suspicious', or 'Malware'\n * @returns {object} A graph object with 'nodes' and 'edges' arrays.\n */\nfunction generateGraphData(apiImports, classification) {\n    let nodes = [];\n    let edges = [];\n    const nodeSpacing = 150;\n    const startY = 100;\n    const startX = 250;\n\n    // 1. Add the Main Entry Point node\n    nodes.push({ \n        id: 'main-entry', \n        label: 'main()', \n        class: 'node-entry', \n        pos: { top: `${startY + (apiImports.length / 2) * (nodeSpacing / 2)}px`, left: '50px' } \n    });\n\n    if (!apiImports || apiImports.length === 0) {\n        // Benign/Empty graph\n        nodes.push({ id: 'benign-1', label: 'ReadFile', class: 'node-std', pos: { top: `${startY}px`, left: `${startX}px` } });\n        nodes.push({ id: 'benign-2', label: 'WriteFile', class: 'node-std', pos: { top: `${startY + nodeSpacing / 2}px`, left: `${startX}px` } });\n        edges.push({ from: 'main-entry', to: 'benign-1', options: { color: '#888' } });\n        edges.push({ from: 'main-entry', to: 'benign-2', options: { color: '#888' } });\n    } else {\n        // Suspicious/Malware graph\n        apiImports.forEach((apiName, index) => {\n            let nodeClass = 'node-api'; // Default\n            let edgeColor = '#888'; // Default\n\n            if (classification === 'Malware') {\n                nodeClass = 'node-malicious';\n                edgeColor = '#e74c3c'; // Malware red\n            } else if (classification === 'Suspicious') {\n                nodeClass = 'node-suspicious';\n                edgeColor = '#f1c40f'; // Suspicious yellow\n            } else {\n                // Benign\n                nodeClass = 'node-std';\n                edgeColor = '#888';\n            }\n\n\n            const nodeId = `api-${index}`;\n            const yPos = startY + (index * (nodeSpacing-50)); // Make them a bit closer\n            const xPos = startX + (index % 2 === 0 ? 0 : 150); // Stagger them\n\n            // Add the API node\n            nodes.push({\n                id: nodeId,\n                label: apiName,\n                class: nodeClass,\n                pos: { top: `${yPos}px`, left: `${xPos}px` }\n            });\n\n            // Add the edge from main\n            edges.push({\n                from: 'main-entry',\n                to: nodeId,\n                options: { color: edgeColor }\n            });\n        });\n    }\n\n    return { nodes, edges };\n}\n\n// --- Graph Drawing ---\nfunction drawCallGraph(graphData) {\n    // 1. Clear previous graph (both nodes and lines)\n    callGraphEl.innerHTML = '';\n    currentGraphLines.forEach(line => line.remove());\n    currentGraphLines = [];\n\n    if (!graphData || !graphData.nodes || !graphData.edges) {\n        console.error(\"Invalid graph data received\", graphData);\n        return;\n    }\n\n    // 2. Create and place all nodes\n    graphData.nodes.forEach(node => {\n        const nodeEl = document.createElement('div');\n        nodeEl.id = node.id;\n        nodeEl.className = `graph-node ${node.class}`;\n        nodeEl.style.top = node.pos.top;\n        nodeEl.style.left = node.pos.left;\n        nodeEl.textContent = node.label;\n        callGraphEl.appendChild(nodeEl);\n    });\n\n    // 3. Draw all edges (must be done *after* nodes are in DOM)\n    // Use a slight timeout to ensure DOM is ready\n    setTimeout(() => {\n        graphData.edges.forEach(edge => {\n            try {\n                const line = new LeaderLine(\n                    document.getElementById(edge.from),\n                    document.getElementById(edge.to),\n                    {\n                        color: edge.options.color,\n                        path: edge.options.path || 'straight',\n                        startSocket: edge.options.startSocket || 'auto',\n                        endSocket: edge.options.endSocket || 'auto',\n                        endPlug: 'arrow1',\n                        size: 3,\n                        endPlugSize: 1.5,\n                    }\n                );\n                currentGraphLines.push(line);\n            } catch(e) {\n                console.error(\"Could not draw line:\", e);\n            }\n        });\n    }, 500); // 500ms timeout to let CSS fade-in finish\n}\n\n\n// --- History Panel Logic ---\nasync function loadHistory() {\n  if (!historyListEl) return;\n  \n  historyListEl.innerHTML = '<li class=\"history-item-loading\">Loading...</li>';\n\n  try {\n    const historyData = await window.electronAPI.getHistory();\n\n    if (!historyData || historyData.length === 0) {\n      historyListEl.innerHTML = '<li class=\"history-item-empty\">No scan history found.</li>';\n      return;\n    }\n\n    historyListEl.innerHTML = '';\n\n    historyData.forEach(scan => {\n      const li = document.createElement('li');\n      li.className = 'history-item';\n\n      // Determine classification icon\n      let statusIcon = 'fas fa-check-circle';\n      let classType = 'safe';\n      if (scan.classification.includes('Malware')) {\n        statusIcon = 'fas fa-bug';\n        classType = 'malware';\n      } else if (scan.classification.includes('Suspicious')) {\n        statusIcon = 'fas fa-exclamation-triangle';\n        classType = 'suspicious';\n      }\n\n      // Determine file type icon based on extension\n      const filename = scan.detected_filename || '';\n      const ext = filename.split('.').pop().toLowerCase();\n      let fileTypeIcon = 'fas fa-file';\n      \n      if (['exe', 'dll', 'sys', 'msi'].includes(ext)) {\n        fileTypeIcon = 'fas fa-cog'; // Executable\n      } else if (['jpg', 'jpeg', 'png', 'gif', 'bmp', 'svg', 'webp'].includes(ext)) {\n        fileTypeIcon = 'fas fa-image'; // Image\n      } else if (['js', 'ts', 'py', 'java', 'cpp', 'c', 'h', 'cs', 'go', 'rs', 'php', 'rb'].includes(ext)) {\n        fileTypeIcon = 'fas fa-code'; // Code\n      } else if (['pdf', 'doc', 'docx', 'txt', 'rtf', 'odt'].includes(ext)) {\n        fileTypeIcon = 'fas fa-file-alt'; // Document\n      } else if (['zip', 'rar', '7z', 'tar', 'gz', 'bz2'].includes(ext)) {\n        fileTypeIcon = 'fas fa-file-archive'; // Archive\n      } else if (['mp3', 'wav', 'ogg', 'flac', 'aac'].includes(ext)) {\n        fileTypeIcon = 'fas fa-file-audio'; // Audio\n      } else if (['mp4', 'avi', 'mkv', 'mov', 'wmv', 'flv'].includes(ext)) {\n        fileTypeIcon = 'fas fa-file-video'; // Video\n      } else if (['html', 'htm', 'css', 'xml', 'json'].includes(ext)) {\n        fileTypeIcon = 'fas fa-file-code'; // Web file\n      }\n\n      const scanDate = new Date(scan.scanDate).toLocaleString();\n      const hashSha256 = scan.file_hashes?.sha256 || 'N/A';\n      const hashDisplay = hashSha256.substring(0, 16) + '...'; // Show first 16 chars\n\n      li.innerHTML = `\n        <div class=\"history-icon-wrapper\">\n          <div class=\"history-icon ${classType}\">\n            <i class=\"${statusIcon}\"></i>\n          </div>\n          <div class=\"history-file-type\">\n            <i class=\"${fileTypeIcon}\"></i>\n          </div>\n        </div>\n        <div class=\"history-details\">\n          <span class=\"history-filename\" title=\"${filename}\">${filename}</span>\n          <span class=\"history-classification ${classType}\">${scan.classification}</span>\n          <span class=\"history-hash\" title=\"${hashSha256}\">SHA256: ${hashDisplay}</span>\n        </div>\n        <span class=\"history-date\">${scanDate}</span>\n      `;\n      \n      historyListEl.appendChild(li);\n    });\n\n  } catch (err) {\n    console.error('Failed to load history:', err);\n    historyListEl.innerHTML = '<li class=\"history-item-empty\">Error loading history.</li>';\n  }\n}\n\nfunction toggleHistoryPanel() {\n  bodyEl.classList.toggle('is-history-open');\n  \n  // ADD THIS: If we are opening the panel, load the history\n  if (bodyEl.classList.contains('is-history-open')) {\n    loadHistory();\n  }\n}\n\nhistoryBtn.addEventListener('click', (e) => {\n    e.preventDefault();\n    toggleHistoryPanel();\n});\nhistoryCloseBtn.addEventListener('click', toggleHistoryPanel);\nhistoryOverlay.addEventListener('click', toggleHistoryPanel);\n\n\n// --- Auto-scroll Logic ---\nfunction startScrolling(direction) {\n    if (scrollInterval) {\n        clearInterval(scrollInterval);\n    }\n    scrollInterval = setInterval(() => {\n        window.scrollBy(0, direction * 10); // 10 pixels at a time\n    }, 20); // every 20ms\n}\n\nfunction stopScrolling() {\n    clearInterval(scrollInterval);\n    scrollInterval = null;\n}\n\nscrollZoneTop.addEventListener('mouseenter', () => {\n    startScrolling(-1); // Scroll Up\n    scrollZoneTop.classList.add('scrolling');\n});\nscrollZoneTop.addEventListener('mouseleave', () => {\n    stopScrolling();\n    scrollZoneTop.classList.remove('scrolling');\n});\n\nscrollZoneBottom.addEventListener('mouseenter', () => {\n    startScrolling(1); // Scroll Down\n    scrollZoneBottom.classList.add('scrolling');\n});\nscrollZoneBottom.addEventListener('mouseleave', () => {\n    stopScrolling();\n    scrollZoneBottom.classList.remove('scrolling');\n});\n\n\n// --- Chart instances ---\nlet malwareTypesChart = null;\nlet topMalwareChart = null;\n\n// --- Function to create/recreate charts ---\nwindow.recreateCharts = function() {\n    // Check if light theme is active\n    const isLightTheme = document.body.classList.contains('light-theme');\n    \n    // Set colors based on theme\n    const chartLegendColor = isLightTheme ? '#6c757d' : '#e0e0e0';\n    const chartAxesColor = isLightTheme ? '#6c757d' : '#aaa';\n    const chartGridColor = isLightTheme ? '#dee2e6' : '#444444';\n\n    // Destroy existing charts if they exist\n    if (malwareTypesChart) {\n        malwareTypesChart.destroy();\n    }\n    if (topMalwareChart) {\n        topMalwareChart.destroy();\n    }\n\n    // Create Malware Types Chart (Doughnut)\n    const typesCtx = document.getElementById('malwareTypesChart');\n    if (typesCtx) {\n        malwareTypesChart = new Chart(typesCtx, {\n            type: 'doughnut',\n            data: {\n                labels: ['PE (exe/dll)', 'JavaScript', 'VBS', 'Macro', 'Other'],\n                datasets: [{\n                    label: 'Submission Types',\n                    data: [65, 15, 8, 7, 5],\n                    backgroundColor: [\n                        '#007bff', // Blue\n                        '#f1c40f', // Yellow\n                        '#e74c3c', // Red\n                        '#9b59b6', // Purple\n                        '#34495e'  // Gray\n                    ],\n                    borderColor: '#2a2a2e',\n                    borderWidth: 3,\n                }]\n            },\n            options: {\n                responsive: true,\n                plugins: {\n                    legend: {\n                        position: 'right',\n                        labels: {\n                            color: chartLegendColor,\n                            boxWidth: 20\n                        }\n                    }\n                }\n            }\n        });\n    }\n\n    // Create Top Malware Chart (Line)\n    const topMalwareCtx = document.getElementById('topMalwareChart');\n    if (topMalwareCtx) {\n        topMalwareChart = new Chart(topMalwareCtx, {\n            type: 'line',\n            data: {\n                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5'],\n                datasets: [\n                    {\n                        label: 'Zeus',\n                        data: [120, 150, 130, 180, 160],\n                        borderColor: '#e74c3c',\n                        backgroundColor: '#e74c3c20',\n                        fill: true,\n                        tension: 0.4\n                    },\n                    {\n                        label: 'WannaCry',\n                        data: [80, 90, 110, 100, 130],\n                        borderColor: '#007bff',\n                        backgroundColor: '#007bff20',\n                        fill: true,\n                        tension: 0.4\n                    },\n                    {\n                        label: 'Emotet',\n                        data: [50, 60, 80, 70, 90],\n                        borderColor: '#f1c40f',\n                        backgroundColor: '#f1c40f20',\n                        fill: true,\n                        tension: 0.4\n                    }\n                ]\n            },\n            options: {\n                responsive: true,\n                plugins: {\n                    legend: {\n                        labels: {\n                            color: chartLegendColor\n                        }\n                    }\n                },\n                scales: {\n                    x: {\n                        ticks: { color: chartAxesColor },\n                        grid: { color: chartGridColor + '50' }\n                    },\n                    y: {\n                        ticks: { color: chartAxesColor },\n                        grid: { color: chartGridColor }\n                    }\n                }\n            }\n        });\n    }\n};\n\n// --- NAVIGATION FUNCTIONS ---\nfunction updateNavigationButtons() {\n    const prevBtn = document.getElementById('prev-scan-btn');\n    const nextBtn = document.getElementById('next-scan-btn');\n    const navInfo = document.getElementById('nav-info');\n    \n    if (!prevBtn || !nextBtn) return;\n    \n    // Disable/enable buttons based on position\n    prevBtn.disabled = currentHistoryIndex <= 0;\n    nextBtn.disabled = currentHistoryIndex >= scanHistory.length - 1;\n    \n    // Update info text\n    if (navInfo && scanHistory.length > 0) {\n        navInfo.textContent = `${currentHistoryIndex + 1} of ${scanHistory.length}`;\n    }\n}\n\nfunction showPreviousScan() {\n    if (currentHistoryIndex > 0) {\n        currentHistoryIndex--;\n        lastScanResult = scanHistory[currentHistoryIndex];\n        renderScanResult();\n        updateNavigationButtons();\n    }\n}\n\nfunction showNextScan() {\n    if (currentHistoryIndex < scanHistory.length - 1) {\n        currentHistoryIndex++;\n        lastScanResult = scanHistory[currentHistoryIndex];\n        renderScanResult();\n        updateNavigationButtons();\n    }\n}\n\n// Initialize history from electron-store on load\nasync function initializeScanHistory() {\n    try {\n        const storedHistory = await window.electronAPI.getHistory();\n        if (storedHistory && Array.isArray(storedHistory)) {\n            scanHistory = storedHistory;\n            currentHistoryIndex = scanHistory.length - 1;\n        }\n    } catch (error) {\n        console.error('Failed to load scan history:', error);\n    }\n}\n\n// --- Run on Page Load ---\ndocument.addEventListener('DOMContentLoaded', () => {\n    // 1. Animate Stat Cards\n    const statNumbers = document.querySelectorAll('.stat-number');\n    statNumbers.forEach(stat => {\n        const target = +stat.getAttribute('data-target');\n        const duration = 2000;\n        const stepTime = 20;\n        const steps = duration / stepTime;\n        const increment = target / steps;\n        let current = 0;\n\n        const updateCount = () => {\n            current += increment;\n            if (current < target) {\n                stat.textContent = Math.ceil(current).toLocaleString();\n                setTimeout(updateCount, stepTime);\n            } else {\n                stat.textContent = target.toLocaleString();\n            }\n        };\n        updateCount();\n    });\n\n    // 2. Create the charts\n    recreateCharts();\n    \n    // 3. Initialize scan history\n    initializeScanHistory();\n    \n    // 4. Setup navigation button handlers\n    const prevBtn = document.getElementById('prev-scan-btn');\n    const nextBtn = document.getElementById('next-scan-btn');\n    \n    if (prevBtn) prevBtn.addEventListener('click', showPreviousScan);\n    if (nextBtn) nextBtn.addEventListener('click', showNextScan);\n});\n","epoch":19,"telemetryInfo":{}}]],"operations":[{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware/style.css","external":"file:///home/trang/localnsv/mAIware/style.css","path":"/home/trang/localnsv/mAIware/style.css","scheme":"file"},"requestId":"request_aae1e94a-0d53-44bf-b0fa-88b6365ff1cf","epoch":4,"edits":[{"text":"body {\n    font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif;\n    background-image: url('https://img6.thuthuatphanmem.vn/uploads/2022/02/12/background-thoi-su-3d-dep_095011550.jpg');\n    background-size: cover;\n    background-position: center;\n    background-attachment: fixed;\n    background-repeat: no-repeat;\n    background-color: var(--bg-dark-1);\n    color: var(--text-light);\n    margin: 0;\n    padding-top: 60px; /* Make space for fixed top nav */\n    overflow-x: hidden; /* Prevent horizontal scroll */\n    width: 100%;\n    min-height: 100vh;\n}","range":{"startLineNumber":66,"startColumn":1,"endLineNumber":75,"endColumn":2}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware/style.css","external":"file:///home/trang/localnsv/mAIware/style.css","path":"/home/trang/localnsv/mAIware/style.css","scheme":"file"},"requestId":"request_5c76fc1b-ce49-4733-b35a-1b234523720a","epoch":8,"edits":[{"text":"body {\n    font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif;\n    background-image: url('https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcdn.haitrieu.com%2Fwp-content%2Fuploads%2F2021%2F10%2FLogo-DH-Bach-Khoa-Ha-Noi-HUST-768x1155.png&f=1&nofb=1&ipt=598a3038f030b5dba19d0bf0aebe948286d6ce95654501c9835d2bd690d0810e');\n    background-size: cover;\n    background-position: center;\n    background-attachment: fixed;\n    background-repeat: no-repeat;\n    background-color: var(--bg-dark-1);\n    filter: blur(8px);\n    color: var(--text-light);\n    margin: 0;\n    padding-top: 60px; /* Make space for fixed top nav */\n    overflow-x: hidden; /* Prevent horizontal scroll */\n    width: 100%;\n    min-height: 100vh;\n}","range":{"startLineNumber":66,"startColumn":1,"endLineNumber":80,"endColumn":2}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware/background-controller.js","external":"file:///home/trang/localnsv/mAIware/background-controller.js","path":"/home/trang/localnsv/mAIware/background-controller.js","scheme":"file"},"requestId":"request_6e987b26-6b7b-49b1-88a8-e33cd26adc69","epoch":12,"edits":[{"text":"const { Tray, Menu, nativeImage } = require('electron')\nconst path = require('node:path')\nconst https = require('https')\n\nfunction setupBackgroundController({ app, createWindow, isBackgroundOnly }) {\n  const noop = () => {}\n  const singleInstance = app.requestSingleInstanceLock()\n\n  if (!singleInstance) {\n    app.quit()\n    return {\n      showWindow: noop,\n      hideWindow: noop,\n      toggleWindow: noop\n    }\n  }\n\n  let tray = null\n  let mainWindow = null\n  let isQuitting = false\n\n  const iconUrl = 'https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fibrand.vn%2Fwp-content%2Fuploads%2F2024%2F09%2Flogo-bach-khoa-2-768x1152.jpg&f=1&nofb=1&ipt=9ee07fc7c498234ec2f6ef4012b6d4ffa36dc23d41159f0953d42765e24bf88f'\n  const iconPath = path.join(__dirname, 'assets', 'icon.png')\n  let trayIcon = iconPath\n\n  // Try to load icon from URL first, fallback to local file\n  try {\n    https.get(iconUrl, (response) => {\n      const chunks = []\n      response.on('data', (chunk) => chunks.push(chunk))\n      response.on('end', () => {\n        const buffer = Buffer.concat(chunks)\n        const iconImage = nativeImage.createFromBuffer(buffer)\n        if (!iconImage.isEmpty()) {\n          trayIcon = iconImage\n          if (tray) {\n            tray.setImage(iconImage)\n          }\n        }\n      })\n    }).on('error', (err) => {\n      console.warn('[Background] Failed to load tray icon from URL, trying local file.', err.message)\n    })\n  } catch (err) {\n    console.warn('[Background] Failed to fetch tray icon from URL.', err.message)\n  }\n\n  // Fallback to local icon\n  try {\n    const iconImage = nativeImage.createFromPath(iconPath)\n    if (!iconImage.isEmpty()) {\n      trayIcon = iconImage\n    }\n  } catch (err) {\n    console.warn('[Background] Failed to load tray icon, falling back to path.', err.message)\n  }","range":{"startLineNumber":1,"startColumn":1,"endLineNumber":31,"endColumn":4}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware/index.html","external":"file:///home/trang/localnsv/mAIware/index.html","path":"/home/trang/localnsv/mAIware/index.html","scheme":"file"},"requestId":"request_12456880-9335-4f74-90f1-0ed95f9fb0ab","epoch":20,"edits":[{"text":"    <nav class=\"top-nav\">\n        <div class=\"logo\"> <i class=\"fas fa-shield-virus\"></i> <span>mAIware</span> </div>\n        <div class=\"nav-links\"> <a href=\"#\" id=\"home-btn\" class=\"nav-link\" data-tooltip=\"Home\"><i class=\"fas fa-home\"></i><span class=\"link-text\">Home</span></a> <a href=\"#\" class=\"nav-link\" data-tooltip=\"Login\"><i class=\"fas fa-sign-in-alt\"></i><span class=\"link-text\">Login</span></a> <a href=\"#\" class=\"nav-link\" data-tooltip=\"Sign Up\"><i class=\"fas fa-user-plus\"></i><span class=\"link-text\">Sign Up</span></a> <a href=\"#\" class=\"nav-link\" data-tooltip=\"Community\"><i class=\"fas fa-users\"></i><span class=\"link-text\">Community</span></a> <a href=\"#\" class=\"nav-link\" data-tooltip=\"API Docs\"><i class=\"fas fa-code\"></i><span class=\"link-text\">API</span></a> <a href=\"#\" id=\"history-btn\" class=\"nav-link\" data-tooltip=\"Scan History\"><i class=\"fas fa-history\"></i><span class=\"link-text\">History</span></a> <a href=\"#\" class=\"nav-link\" id=\"theme-toggle\" data-tooltip=\"Toggle Theme\"> <i class=\"fas fa-sun\"></i> </a> </div>\n    </nav>","range":{"startLineNumber":19,"startColumn":1,"endLineNumber":22,"endColumn":11}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware/script.js","external":"file:///home/trang/localnsv/mAIware/script.js","path":"/home/trang/localnsv/mAIware/script.js","scheme":"file"},"requestId":"request_12456880-9335-4f74-90f1-0ed95f9fb0ab","epoch":21,"edits":[{"text":"function removeAnimationClasses() {\n    bodyEl.classList.remove('result-safe-active');\n    bodyEl.classList.remove('result-suspicious-active');\n    bodyEl.classList.remove('result-malware-active');\n}\n\n// --- Reset to Initial State Function ---\nfunction resetToInitialState() {\n    // Clear any running intervals\n    if (disassemblyInterval) {\n        clearInterval(disassemblyInterval);\n        disassemblyInterval = null;\n    }\n    \n    // Remove all state classes from body\n    bodyEl.classList.remove('is-analyzing');\n    bodyEl.classList.remove('is-showing-result');\n    bodyEl.classList.remove('is-non-pe');\n    removeAnimationClasses();\n    \n    // Hide all states except initial\n    initialState.classList.add('active');\n    analyzingState.classList.remove('active');\n    resultState.classList.remove('active');\n    nonPeResultWrapper.classList.remove('active');\n    \n    // Clear any error messages\n    if (manualScanError) {\n        manualScanError.textContent = '';\n    }\n    \n    // Scroll to top smoothly\n    window.scrollTo({ top: 0, behavior: 'smooth' });\n}","range":{"startLineNumber":556,"startColumn":1,"endLineNumber":560,"endColumn":2}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware/script.js","external":"file:///home/trang/localnsv/mAIware/script.js","path":"/home/trang/localnsv/mAIware/script.js","scheme":"file"},"requestId":"request_12456880-9335-4f74-90f1-0ed95f9fb0ab","epoch":22,"edits":[{"text":"// History Panel elements\nconst historyBtn = document.getElementById('history-btn');\nconst historyPanel = document.getElementById('history-panel');\nconst historyCloseBtn = document.getElementById('history-close-btn');\nconst historyOverlay = document.getElementById('history-overlay');\nconst historyListEl = document.querySelector('.history-list');\n\n// Home button element\nconst homeBtn = document.getElementById('home-btn');","range":{"startLineNumber":81,"startColumn":1,"endLineNumber":86,"endColumn":63}}]},{"type":"textEdit","uri":{"$mid":1,"fsPath":"/home/trang/localnsv/mAIware/script.js","external":"file:///home/trang/localnsv/mAIware/script.js","path":"/home/trang/localnsv/mAIware/script.js","scheme":"file"},"requestId":"request_12456880-9335-4f74-90f1-0ed95f9fb0ab","epoch":24,"edits":[{"text":"// Home button event listener\nhomeBtn.addEventListener('click', (e) => {\n    e.preventDefault();\n    resetToInitialState();\n});\n\nhistoryBtn.addEventListener('click', (e) => {\n    e.preventDefault();\n    toggleHistoryPanel();\n});\nhistoryCloseBtn.addEventListener('click', toggleHistoryPanel);\nhistoryOverlay.addEventListener('click', toggleHistoryPanel);","range":{"startLineNumber":847,"startColumn":1,"endLineNumber":852,"endColumn":62}}]}],"epochCounter":25},"recentSnapshot":{"entries":[{"resource":"file:///home/trang/localnsv/mAIware/style.css","languageId":"css","originalHash":"e966676","currentHash":"4dea668","state":2,"snapshotUri":"chat-editing-snapshot-text-model:/home/trang/localnsv/mAIware/style.css?%7B%22sessionId%22%3A%2260b140d3-7125-496b-b31c-540b0b9c4ba7%22%2C%22requestId%22%3A%22%22%2C%22undoStop%22%3A%22%22%7D","telemetryInfo":{"requestId":"request_5c76fc1b-ce49-4733-b35a-1b234523720a","agentId":"github.copilot.editsAgent","modelId":"copilot/claude-sonnet-4.5","modeId":"agent"}},{"resource":"file:///home/trang/localnsv/mAIware/background-controller.js","languageId":"javascript","originalHash":"1609e63","currentHash":"00b12ae","state":2,"snapshotUri":"chat-editing-snapshot-text-model:/home/trang/localnsv/mAIware/background-controller.js?%7B%22sessionId%22%3A%2260b140d3-7125-496b-b31c-540b0b9c4ba7%22%2C%22requestId%22%3A%22%22%2C%22undoStop%22%3A%22%22%7D","telemetryInfo":{"requestId":"request_6e987b26-6b7b-49b1-88a8-e33cd26adc69","agentId":"github.copilot.editsAgent","modelId":"copilot/claude-sonnet-4.5","modeId":"agent"}},{"resource":"file:///home/trang/localnsv/mAIware/index.html","languageId":"html","originalHash":"98f0cb3","currentHash":"98f0cb3","state":1,"snapshotUri":"chat-editing-snapshot-text-model:/home/trang/localnsv/mAIware/index.html?%7B%22sessionId%22%3A%2260b140d3-7125-496b-b31c-540b0b9c4ba7%22%2C%22requestId%22%3A%22%22%2C%22undoStop%22%3A%22%22%7D","telemetryInfo":{"requestId":"request_12456880-9335-4f74-90f1-0ed95f9fb0ab","agentId":"github.copilot.editsAgent","modelId":"copilot/claude-sonnet-4.5","modeId":"agent"}},{"resource":"file:///home/trang/localnsv/mAIware/script.js","languageId":"javascript","originalHash":"f8224b7","currentHash":"f8224b7","state":1,"snapshotUri":"chat-editing-snapshot-text-model:/home/trang/localnsv/mAIware/script.js?%7B%22sessionId%22%3A%2260b140d3-7125-496b-b31c-540b0b9c4ba7%22%2C%22requestId%22%3A%22%22%2C%22undoStop%22%3A%22%22%7D","telemetryInfo":{"requestId":"request_12456880-9335-4f74-90f1-0ed95f9fb0ab","agentId":"github.copilot.editsAgent","modelId":"copilot/claude-sonnet-4.5","modeId":"agent"}}]}}